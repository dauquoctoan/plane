"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8114],{46987:function(e,t){t.Z={src:"/_next/static/media/issue.bb65b2fd.svg",height:110,width:97,blurWidth:0,blurHeight:0}},90288:function(e,t){t.Z={src:"/_next/static/media/slack.d7da2526.png",height:1600,width:1600,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAARVBMVEVMaXEqtnszyfU0yPUvu4A0xvDxtisAocLtsS3gG1roHF4utXw1xO7kGlbstC4utn7qsC7ssi7gHlrlHlsftnz1uiTqC1OUeE8eAAAAF3RSTlMAlJN+z9WTAtWLy6uqoYaFsKSu2nFwcQ7JuvIAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA+SURBVHicFcGJEcAgCADBU0HAJ+bvv9RMdjFGTh3DKFnEYKgWkdXJquVeKTEj3se9ckZrm/sBXK1u/GbUHT48IwHO7BYFBwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},29350:function(e,t,s){s.d(t,{u7:function(){return d},tG:function(){return R},VG:function(){return g},Dq:function(){return p},Fd:function(){return P},a6:function(){return O},Yf:function(){return f}});var l=s(24246),n=s(79894),r=s.n(n),a=s(25449),i=s(74273),o=s(10712),c=s(10634);let d=e=>{var t,s,n,d,u,m;let{cycle:h,workspaceSlug:p,projectId:x}=e,{getUserDetails:f}=(0,c.Kb)(),v=h&&h.owned_by_id?f(h.owned_by_id):void 0,g=null!==(n=(0,i._U)(h.end_date))&&void 0!==n?n:0,j=null==h?void 0:null===(t=h.status)||void 0===t?void 0:t.toLocaleLowerCase(),b=(null!==(d=null===(s=h.distribution)||void 0===s?void 0:s.assignees)&&void 0!==d?d:[]).filter(e=>e.display_name);return(0,l.jsxs)("div",{className:"flex items-center justify-between px-3 py-1.5 rounded border-[0.5px] border-custom-border-100 bg-custom-background-90",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 cursor-default",children:[(0,l.jsx)(a.Y7,{cycleGroup:j,className:"h-4 w-4"}),(0,l.jsx)(a.u,{tooltipContent:h.name,position:"top-left",children:(0,l.jsx)("h3",{className:"break-words text-lg font-medium",children:(0,o.aF)(h.name,70)})}),(0,l.jsx)(a.u,{tooltipContent:"Start date: ".concat((0,i.ot)(null!==(u=h.start_date)&&void 0!==u?u:"")," Due Date: ").concat((0,i.ot)(null!==(m=h.end_date)&&void 0!==m?m:"")),position:"top-left",children:(0,l.jsx)("span",{className:"flex gap-1 whitespace-nowrap rounded-sm text-custom-text-400 font-semibold text-sm leading-5",children:"".concat(g," ").concat(g>1?"days":"day"," left")})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"rounded-sm text-sm",children:(0,l.jsxs)("div",{className:"flex gap-2 divide-x spac divide-x-border-300 text-sm whitespace-nowrap text-custom-text-300 font-medium",children:[(0,l.jsx)(a.qE,{name:null==v?void 0:v.display_name,src:null==v?void 0:v.avatar}),b.length>0&&(0,l.jsx)("span",{className:"pl-2",children:(0,l.jsx)(a.HE,{showTooltip:!0,children:b.map(e=>{var t,s;return(0,l.jsx)(a.qE,{name:null!==(t=null==e?void 0:e.display_name)&&void 0!==t?t:"",src:null!==(s=null==e?void 0:e.avatar)&&void 0!==s?s:"",showTooltip:!1},e.assignee_id)})})})]})}),(0,l.jsx)(r(),{href:"/".concat(p,"/projects/").concat(x,"/cycles/").concat(h.id),className:"".concat((0,a.A6)("outline-primary","sm")," cursor-pointer"),children:"View Cycle"})]})]})};var u=s(14522),m=s(70540),h=s(74371);let p=e=>{let{cycle:t}=e,s=u.Js.map((e,s)=>({id:s,name:e.title,value:t.total_issues>0?t[e.key]:0,color:e.color})),n={completed:t.completed_issues,started:t.started_issues,unstarted:t.unstarted_issues,backlog:t.backlog_issues};return(0,l.jsxs)("div",{className:"flex flex-col min-h-[17rem] gap-5 py-4 px-3.5 border border-custom-border-200 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,l.jsx)("h3",{className:"text-base text-custom-text-300 font-semibold",children:"Progress"}),t.total_issues>0&&(0,l.jsx)("span",{className:"flex gap-1 text-sm text-custom-text-400 font-medium whitespace-nowrap rounded-sm px-3 py-1 ",children:"".concat(t.completed_issues+t.cancelled_issues,"/").concat(t.total_issues-t.cancelled_issues," ").concat(t.completed_issues+t.cancelled_issues>1?"Issues":"Issue"," closed")})]}),t.total_issues>0&&(0,l.jsx)(a.Ov,{size:"lg",data:s})]}),t.total_issues>0?(0,l.jsxs)("div",{className:"flex flex-col gap-5",children:[Object.keys(n).map((e,t)=>(0,l.jsx)(l.Fragment,{children:n[e]>0&&(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,l.jsx)("span",{className:"block h-3 w-3 rounded-full",style:{backgroundColor:u.Js[t].color}}),(0,l.jsx)("span",{className:"text-custom-text-300 capitalize font-medium w-16",children:e})]}),(0,l.jsx)("span",{className:"text-custom-text-300",children:"".concat(n[e]," ").concat(n[e]>1?"Issues":"Issue")})]})},t)})),t.cancelled_issues>0&&(0,l.jsx)("span",{className:"flex items-center gap-2 text-sm text-custom-text-300",children:(0,l.jsxs)("span",{children:["".concat(t.cancelled_issues," cancelled ").concat(t.cancelled_issues>1?"issues are":"issue is"," excluded from this report.")," "]})})]}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(h.ub,{type:m.C.ACTIVE_CYCLE_PROGRESS_EMPTY_STATE,layout:"screen-simple",size:"sm"})})]})};var x=s(91256);let f=e=>{let{project:t}=e;return(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(null==t?void 0:t.logo_props)&&(0,l.jsx)(x.h0,{logo:t.logo_props}),(0,l.jsx)("h2",{className:"text-xl font-semibold",children:null==t?void 0:t.name})]})};var v=s(96883);let g=e=>{var t,s,n,r;let{cycle:a}=e;return(0,l.jsxs)("div",{className:"flex flex-col justify-center min-h-[17rem] gap-5 py-4 px-3.5 border border-custom-border-200 rounded-lg",children:[(0,l.jsx)("div",{className:"flex items-center justify-between gap-4",children:(0,l.jsx)("h3",{className:"text-base text-custom-text-300 font-semibold",children:"Issue burndown"})}),a.total_issues>0?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"h-full w-full px-2",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4 py-1 text-xs text-custom-text-300",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 text-custom-text-300",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,l.jsx)("span",{className:"h-2 w-2 rounded-full bg-[#A9BBD0]"}),(0,l.jsx)("span",{children:"Ideal"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,l.jsx)("span",{className:"h-2 w-2 rounded-full bg-[#4C8FFF]"}),(0,l.jsx)("span",{children:"Current"})]})]}),(0,l.jsx)("span",{children:"Pending issues - ".concat(a.backlog_issues+a.unstarted_issues+a.started_issues)})]}),(0,l.jsx)("div",{className:"relative  h-full",children:(0,l.jsx)(v.Z,{className:"h-full",distribution:null!==(s=null===(t=a.distribution)||void 0===t?void 0:t.completion_chart)&&void 0!==s?s:{},startDate:null!==(n=a.start_date)&&void 0!==n?n:"",endDate:null!==(r=a.end_date)&&void 0!==r?r:"",totalIssues:a.total_issues})})]})}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(h.ub,{type:m.C.ACTIVE_CYCLE_CHART_EMPTY_STATE,layout:"screen-simple",size:"sm"})})})]})};var j=s(27378),b=s(50649),y=s(30201),w=s(66570),N=s(12625),k=s(23258),C=s(36738),S=s(82750),_=s(93997),I=s(6780),E=s(15108);let P=(0,b.Pi)(e=>{var t,s;let{workspaceSlug:n,projectId:o,cycle:d}=e,{storedValue:u,setValue:p}=(0,E.Z)("activeCycleTab","Assignees"),{issues:{fetchActiveCycleIssues:x}}=(0,c.gk)(_.rS.CYCLE),{fetchWorkspaceStates:f}=(0,c.eD)(),{data:v}=(0,y.ZP)(n&&o&&d.id?(0,S.EE)(d.id,{priority:"urgent,high"}):null,n&&o&&d.id?()=>x(n,o,d.id):null);(0,y.ZP)(n?"WORKSPACE_STATES_".concat(n):null,n?()=>f(n.toString()):null);let g=null!=v?v:[];return(0,l.jsx)("div",{className:"flex flex-col gap-4 p-4 min-h-[17rem] overflow-hidden col-span-1 lg:col-span-2 xl:col-span-1 border border-custom-border-200 rounded-lg",children:(0,l.jsxs)(N.O.Group,{as:j.Fragment,defaultIndex:(e=>{switch(e){case"Priority-Issues":default:return 0;case"Assignees":return 1;case"Labels":return 2}})(u),onChange:e=>{switch(e){case 0:default:return p("Priority-Issues");case 1:return p("Assignees");case 2:return p("Labels")}},children:[(0,l.jsxs)(N.O.List,{as:"div",className:"relative border-[0.5px] border-custom-border-200 rounded bg-custom-background-80 p-[1px] grid",style:{gridTemplateColumns:"repeat(3, 1fr)"},children:[(0,l.jsx)(N.O,{className:e=>{let{selected:t}=e;return(0,I.cn)("relative z-[1] font-semibold text-xs rounded-[3px] py-1.5 text-custom-text-400 focus:outline-none transition duration-500",{"text-custom-text-300 bg-custom-background-100":t,"hover:text-custom-text-300":!t})},children:"Priority Issues"}),(0,l.jsx)(N.O,{className:e=>{let{selected:t}=e;return(0,I.cn)("relative z-[1] font-semibold text-xs rounded-[3px] py-1.5 text-custom-text-400 focus:outline-none transition duration-500",{"text-custom-text-300 bg-custom-background-100":t,"hover:text-custom-text-300":!t})},children:"Assignees"}),(0,l.jsx)(N.O,{className:e=>{let{selected:t}=e;return(0,I.cn)("relative z-[1] font-semibold text-xs rounded-[3px] py-1.5 text-custom-text-400 focus:outline-none transition duration-500",{"text-custom-text-300 bg-custom-background-100":t,"hover:text-custom-text-300":!t})},children:"Labels"})]}),(0,l.jsxs)(N.O.Panels,{as:j.Fragment,children:[(0,l.jsx)(N.O.Panel,{as:"div",className:"flex h-52 w-full flex-col gap-1 overflow-y-auto  text-custom-text-200 vertical-scrollbar scrollbar-sm",children:(0,l.jsx)("div",{className:"flex flex-col gap-1 h-full w-full overflow-y-auto vertical-scrollbar scrollbar-sm",children:g?g.length>0?g.map(e=>{var t,s,c,u;return(0,l.jsxs)(r(),{href:"/".concat(n,"/projects/").concat(o,"/issues/").concat(e.id),className:"group flex cursor-pointer items-center justify-between gap-2 rounded-md hover:bg-custom-background-90 p-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 flex-grow w-full min-w-24 truncate",children:[(0,l.jsx)(a.bJ,{priority:e.priority,withContainer:!0,size:12}),(0,l.jsx)(a.u,{tooltipHeading:"Issue ID",tooltipContent:"".concat(null===(t=d.project_detail)||void 0===t?void 0:t.identifier,"-").concat(e.sequence_id),children:(0,l.jsxs)("span",{className:"flex-shrink-0 text-xs text-custom-text-200",children:[null===(s=d.project_detail)||void 0===s?void 0:s.identifier,"-",e.sequence_id]})}),(0,l.jsx)(a.u,{position:"top-left",tooltipHeading:"Title",tooltipContent:e.name,children:(0,l.jsx)("span",{className:"text-[0.825rem] text-custom-text-100 truncate",children:e.name})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[(0,l.jsx)(C.sb,{value:null!==(c=e.state_id)&&void 0!==c?c:void 0,onChange:()=>{},projectId:null!==(u=null==o?void 0:o.toString())&&void 0!==u?u:"",disabled:!0,buttonVariant:"background-with-text",buttonContainerClassName:"cursor-pointer max-w-24",showTooltip:!0}),e.target_date&&(0,l.jsx)(a.u,{tooltipHeading:"Target Date",tooltipContent:(0,i.ot)(e.target_date),children:(0,l.jsxs)("div",{className:"h-full flex truncate items-center gap-1.5 rounded text-xs px-2 py-0.5 bg-custom-background-80 group-hover:bg-custom-background-100 cursor-pointer",children:[(0,l.jsx)(w.Z,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"text-xs truncate",children:(0,i.MP)(e.target_date)})]})})]})]},e.id)}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(h.ub,{type:m.C.ACTIVE_CYCLE_PRIORITY_ISSUE_EMPTY_STATE,layout:"screen-simple",size:"sm"})}):(0,l.jsxs)(a.aN,{className:"space-y-3",children:[(0,l.jsx)(a.aN.Item,{height:"50px"}),(0,l.jsx)(a.aN.Item,{height:"50px"}),(0,l.jsx)(a.aN.Item,{height:"50px"})]})})}),(0,l.jsx)(N.O.Panel,{as:"div",className:"flex h-52 w-full flex-col gap-1 overflow-y-auto text-custom-text-200 vertical-scrollbar scrollbar-sm",children:(null==d?void 0:null===(t=d.distribution)||void 0===t?void 0:t.assignees)&&d.distribution.assignees.length>0?d.distribution.assignees.map((e,t)=>{var s,n;return e.assignee_id?(0,l.jsx)(k.F_,{title:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(a.qE,{name:null!==(s=null==e?void 0:e.display_name)&&void 0!==s?s:void 0,src:null!==(n=null==e?void 0:e.avatar)&&void 0!==n?n:void 0}),(0,l.jsx)("span",{children:e.display_name})]}),completed:e.completed_issues,total:e.total_issues},e.assignee_id):(0,l.jsx)(k.F_,{title:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"h-5 w-5 rounded-full border-2 border-custom-border-200 bg-custom-background-80",children:(0,l.jsx)("img",{src:"/user.png",height:"100%",width:"100%",className:"rounded-full",alt:"User"})}),(0,l.jsx)("span",{children:"No assignee"})]}),completed:e.completed_issues,total:e.total_issues},"unassigned-".concat(t))}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(h.ub,{type:m.C.ACTIVE_CYCLE_ASSIGNEE_EMPTY_STATE,layout:"screen-simple",size:"sm"})})}),(0,l.jsx)(N.O.Panel,{as:"div",className:"flex h-52 w-full flex-col gap-1 overflow-y-auto  text-custom-text-200 vertical-scrollbar scrollbar-sm",children:(null==d?void 0:null===(s=d.distribution)||void 0===s?void 0:s.labels)&&d.distribution.labels.length>0?d.distribution.labels.map((e,t)=>{var s,n,r;return(0,l.jsx)(k.F_,{title:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"block h-3 w-3 rounded-full",style:{backgroundColor:null!==(s=e.color)&&void 0!==s?s:"#000000"}}),(0,l.jsx)("span",{className:"text-xs",children:null!==(n=e.label_name)&&void 0!==n?n:"No labels"})]}),completed:e.completed_issues,total:e.total_issues},null!==(r=e.label_id)&&void 0!==r?r:"no-label-".concat(t))}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(h.ub,{type:m.C.ACTIVE_CYCLE_LABEL_EMPTY_STATE,layout:"screen-simple",size:"sm"})})})]})]})})}),R=e=>{let{cycle:t,workspaceSlug:s,projectId:n}=e;return(0,l.jsxs)("div",{className:"flex flex-col gap-4 p-4 rounded-xl border border-custom-border-200 bg-custom-background-100",children:[(0,l.jsx)(f,{project:t.project_detail}),(0,l.jsx)(d,{cycle:t,workspaceSlug:s,projectId:n}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-3 lg:grid-cols-2 xl:grid-cols-3",children:[(0,l.jsx)(p,{cycle:t}),(0,l.jsx)(g,{cycle:t}),(0,l.jsx)(P,{cycle:t,workspaceSlug:s,projectId:n})]})]},t.id)},F=new(s(38876)).K,O=e=>{let{workspaceSlug:t,cursor:s,perPage:n,updateTotalPages:r,updateResultsCount:i}=e,{data:o}=(0,y.ZP)(t&&s?(0,S.dW)(t,s,"".concat(n)):null,t&&s?()=>F.workspaceActiveCycles(t.toString(),s,n):null);return((0,j.useEffect)(()=>{o&&(r(o.total_pages),i(o.results.length))},[r,i,o]),o)?(0,l.jsx)(l.Fragment,{children:o.results.map(e=>(0,l.jsx)("div",{className:"px-5 pt-5 last:pb-5",children:(0,l.jsx)(R,{workspaceSlug:null==t?void 0:t.toString(),projectId:e.project_id,cycle:e})},e.id))}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(a.$j,{})})}},42903:function(e,t,s){s.d(t,{o:function(){return d}});var l=s(24246),n=s(50649),r=s(79894),a=s.n(r),i=s(86677),o=s(66410),c=s(10634);let d=(0,n.Pi)(()=>{let e=(0,i.useRouter)(),{workspaceSlug:t,projectId:s}=e.query,n=e.pathname.split("/").pop(),{getProjectById:r}=(0,c.PY)();if(!s)return null;let d=r(null==s?void 0:s.toString());return d?(0,l.jsx)(l.Fragment,{children:o.c.map(e=>e.shouldRender(d)&&(0,l.jsx)(a(),{href:"/".concat(t,"/projects/").concat(s,"/archives/").concat(e.key),children:(0,l.jsx)("span",{className:"flex min-w-min flex-shrink-0 whitespace-nowrap border-b-2 py-3 px-4 text-sm font-medium outline-none ".concat(e.key===n?"border-custom-primary-100 text-custom-primary-100":"border-transparent hover:border-custom-border-200 text-custom-text-300 hover:text-custom-text-400"),children:e.label})},e.key))}):null})},4314:function(e,t,s){s.d(t,{H:function(){return i},P:function(){return o}});var l=s(24246);s(27378);var n=s(79894),r=s.n(n),a=s(25449);let i=e=>{let{title:t,prependTitleElement:s,appendTitleElement:n,actionableItems:i,itemLink:o,onItemClick:c,isMobile:d=!1,parentRef:u}=e;return(0,l.jsxs)("div",{ref:u,className:"relative",children:[(0,l.jsx)(r(),{href:o,onClick:c,children:(0,l.jsxs)("div",{className:"group h-24 sm:h-[52px] flex w-full flex-col items-center justify-between gap-3 sm:gap-5 px-6 py-4 sm:py-0 text-sm border-b border-custom-border-200 bg-custom-background-100 hover:bg-custom-background-90 sm:flex-row",children:[(0,l.jsx)("div",{className:"relative flex w-full items-center justify-between gap-3 overflow-hidden",children:(0,l.jsxs)("div",{className:"relative flex w-full items-center gap-3 overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 truncate",children:[s&&(0,l.jsx)("span",{className:"flex items-center flex-shrink-0",children:s}),(0,l.jsx)(a.u,{tooltipContent:t,position:"top",isMobile:d,children:(0,l.jsx)("span",{className:"truncate text-sm",children:t})})]}),n&&(0,l.jsx)("span",{className:"flex items-center flex-shrink-0",children:n})]})}),(0,l.jsx)("span",{className:"h-6 w-96 flex-shrink-0"})]})}),i&&(0,l.jsx)("div",{className:"absolute right-5 bottom-4 flex items-center gap-1.5",children:(0,l.jsx)("div",{className:"relative flex items-center gap-4 sm:w-auto sm:flex-shrink-0 sm:justify-end",children:i})})]})},o=e=>{let{children:t}=e;return(0,l.jsx)("div",{className:"flex h-full w-full flex-col overflow-y-auto vertical-scrollbar scrollbar-lg",children:t})}},89001:function(e,t,s){var l=s(24246),n=s(27378),r=s(6780);t.Z=e=>{let{defaultHeight:t="300px",root:s,verticalOffset:a=50,horizontalOffset:i=0,as:o="div",children:c,classNames:d="",alwaysRender:u=!1,placeholderChildren:m=null,pauseHeightUpdateWhileRendering:h=!1,changingReference:p}=e,[x,f]=(0,n.useState)(u),v=(0,n.useRef)(t),g=(0,n.useRef)(null),j=u||x;(0,n.useEffect)(()=>{if(g.current){let e=new IntersectionObserver(e=>{f(e[e.length-1].isIntersecting)},{root:null==s?void 0:s.current,rootMargin:"".concat(a,"% ").concat(i,"% ").concat(a,"% ").concat(i,"%")});return e.observe(g.current),()=>{g.current&&e.unobserve(g.current)}}},[g,c,p,s,a,i]),(0,n.useEffect)(()=>{g.current&&j&&(v.current="".concat(g.current.offsetHeight,"px"))},[j,g,u,h]);let b=j?(0,l.jsx)(l.Fragment,{children:c}):m,y=j&&!h?{}:{height:v.current,width:"100%"},w=j?d:(0,r.cn)(d,"bg-custom-background-80");return n.createElement(o,{ref:g,style:y,className:w},b)}},96883:function(e,t,s){var l=s(24246);s(27378);var n=s(44720),r=s(15083),a=s(92775),i=s(74273);let o={ideal:{strokeDasharray:"6, 3",strokeWidth:1},default:{strokeWidth:1}},c=e=>{let{series:t,lineGenerator:s,xScale:n,yScale:r}=e;return t.map(e=>{let{id:t,data:a,color:i}=e;return(0,l.jsx)("path",{d:s(a.map(e=>({x:n(e.data.x),y:r(e.data.y)}))),fill:"none",stroke:null!=i?i:"#ddd",style:o[t]||o.default},t)})};t.Z=e=>{let{distribution:t,startDate:s,endDate:o,totalIssues:d,className:u=""}=e,m=Object.keys(null!=t?t:[]).map(e=>({currentDate:(0,i.MP)(e),pending:t[e]}));return(0,l.jsx)("div",{className:"flex w-full items-center justify-center ".concat(u),children:(0,l.jsx)(a.xr,{animate:!0,curve:"monotoneX",height:"160px",width:"100%",enableGridY:!1,lineWidth:1,margin:{top:30,right:30,bottom:30,left:30},data:[{id:"pending",color:"#3F76FF",data:m.length>0?m.map((e,t)=>({index:t,x:e.currentDate,y:e.pending,color:"#3F76FF"})):[],enableArea:!0},{id:"ideal",color:"#a9bbd0",fill:"transparent",data:m.length>0?[{x:m[0].currentDate,y:d},{x:m[m.length-1].currentDate,y:0}]:[]}],layers:["grid","markers","areas",c,"slices","points","axes","legends"],axisBottom:{tickValues:(()=>{let e=(0,i._3)(s),t=(0,i._3)(o),l=[];e&&t&&(0,n.Z)(e)&&(0,n.Z)(t)&&(l=(0,r.Z)({start:e,end:t}));let a=l.length;if(a<=4)return l.map(e=>(0,i.MP)(e));{let e=Math.ceil(a/4),t=[];for(let s=0;s<a;s+=e)t.push((0,i.MP)(l[s]));return t.includes((0,i.MP)(l[a-1]))||t.push((0,i.MP)(l[a-1])),t}})()},enablePoints:!1,enableArea:!0,colors:e=>{var t;return null!==(t=e.color)&&void 0!==t?t:"#3F76FF"},customYAxisTickValues:[0,d],gridXValues:m.length>0?m.map((e,t)=>t%2==0?e.currentDate:""):void 0,enableSlices:"x",sliceTooltip:e=>(0,l.jsxs)("div",{className:"rounded-md border border-custom-border-200 bg-custom-background-80 p-2 text-xs",children:[e.slice.points[0].data.yFormatted,(0,l.jsx)("span",{className:"text-custom-text-200",children:" issues pending on "}),e.slice.points[0].data.xFormatted]}),theme:{background:"transparent",axis:{domain:{line:{stroke:"rgb(var(--color-border))",strokeWidth:1}}}}})})}},40240:function(e,t,s){s.d(t,{u7:function(){return N},VG:function(){return U},Dq:function(){return q},T6:function(){return g},Fd:function(){return L},zg:function(){return K},bH:function(){return Q},Vw:function(){return e3},zw:function(){return e0},lD:function(){return e5},S:function(){return e1},wF:function(){return H},UE:function(){return eK},FU:function(){return eq},XD:function(){return eA},fm:function(){return eo},zq:function(){return eV},yy:function(){return eu},VR:function(){return em},CK:function(){return eD},UB:function(){return eH},Gy:function(){return en},YE:function(){return ee},nb:function(){return et},_D:function(){return ej},Lz:function(){return ep},G0:function(){return ev},P1:function(){return eg},Li:function(){return u},Jf:function(){return eZ},a8:function(){return ea},M2:function(){return ec},fS:function(){return ed},$6:function(){return eX},IT:function(){return eG},y7:function(){return P},ZI:function(){return F}});var l=s(24246),n=s(43659),r=s(38579),a=s.n(r),i=s(92775),o=s(10634),c={src:"/_next/static/media/all-filters.2df66526.svg",height:217,width:205,blurWidth:0,blurHeight:0},d={src:"/_next/static/media/name-filter.f5ac7670.svg",height:217,width:205,blurWidth:0,blurHeight:0};let u=(0,n.Pi)(e=>{let{layout:t,workspaceSlug:s,projectId:n,peekCycle:r}=e,{getFilteredCycleIds:u,getFilteredCompletedCycleIds:m,loader:h}=(0,o.nv)(),{searchQuery:p}=(0,o.lj)(),x=u(n,"gantt"===t),f=m(n);return h||!x?(0,l.jsxs)(l.Fragment,{children:["list"===t&&(0,l.jsx)(i.ci,{}),"board"===t&&(0,l.jsx)(i.Cv,{}),"gantt"===t&&(0,l.jsx)(i.OT,{})]}):0===x.length&&(null==f?void 0:f.length)===0?(0,l.jsx)("div",{className:"h-full w-full grid place-items-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(a(),{src:""===p.trim()?c:d,className:"h-36 sm:h-48 w-36 sm:w-48 mx-auto",alt:"No matching cycles"}),(0,l.jsx)("h5",{className:"text-xl font-medium mt-7 mb-1",children:"No matching cycles"}),(0,l.jsx)("p",{className:"text-custom-text-400 text-base",children:""===p.trim()?"Remove the filters to see all cycles":"Remove the search criteria to see all cycles"})]})}):(0,l.jsxs)(l.Fragment,{children:["list"===t&&(0,l.jsx)(ej,{completedCycleIds:null!=f?f:[],cycleIds:x,workspaceSlug:s,projectId:n}),"board"===t&&(0,l.jsx)(en,{completedCycleIds:null!=f?f:[],cycleIds:x,workspaceSlug:s,projectId:n,peekCycle:r}),"gantt"===t&&(0,l.jsx)(ep,{cycleIds:x,workspaceSlug:s})]})});var m=s(50649),h=s(29350);(0,m.Pi)(e=>{let{cycle:t,workspaceSlug:s,projectId:n}=e,{getProjectById:r}=(0,o.PY)(),a=r(n);return a?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.Yf,{project:a}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 rounded border border-custom-border-200",children:[(0,l.jsx)(h.u7,{cycle:t,workspaceSlug:s,projectId:n}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",children:[(0,l.jsx)(h.Dq,{cycle:t}),(0,l.jsx)(h.VG,{cycle:t}),(0,l.jsx)(h.Fd,{cycle:t,workspaceSlug:s,projectId:n})]})]})]}):null});var p=s(30201),x=s(25449),f=s(74371),v=s(70540);let g=(0,n.Pi)(e=>{let{workspaceSlug:t,projectId:s}=e,{fetchActiveCycle:n,currentProjectActiveCycleId:r,currentProjectUpcomingCycleIds:a,getActiveCycleById:i}=(0,o.nv)(),{updateDisplayFilters:c}=(0,o.lj)(),d=r?i(r):null,{isLoading:u}=(0,p.ZP)(t&&s?"PROJECT_ACTIVE_CYCLE_".concat(s):null,t&&s?()=>n(t,s):null),m=()=>c(s,{active_tab:"all"});return!d&&u?(0,l.jsx)(x.aN,{children:(0,l.jsx)(x.aN.Item,{height:"250px"})}):d?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsx)(N,{cycle:d,workspaceSlug:t,projectId:s}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-3 lg:grid-cols-2 xl:grid-cols-3",children:[(0,l.jsx)(q,{cycle:d}),(0,l.jsx)(U,{cycle:d}),(0,l.jsx)(L,{cycle:d,workspaceSlug:t,projectId:s})]})]}),a&&(0,l.jsx)(F,{handleEmptyStateAction:m})]}):(null==a?void 0:a.length)===0?(0,l.jsx)(f.ub,{type:v.C.PROJECT_CYCLE_ACTIVE,size:"sm"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"h-52 w-full grid place-items-center mb-6",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h5",{className:"text-xl font-medium mb-1",children:"No active cycle"}),(0,l.jsxs)("p",{className:"text-custom-text-400 text-base",children:["Create new cycles to find them here or check",(0,l.jsx)("br",{}),"'","All","'"," cycles tab to see all cycles or"," ",(0,l.jsx)("button",{type:"button",className:"text-custom-primary-100 font-medium",onClick:m,children:"click here"})]})]})}),(0,l.jsx)(F,{handleEmptyStateAction:m})]})});var j=s(79894),b=s.n(j),y=s(74273),w=s(10712);let N=e=>{var t,s,n,r,a,i;let{cycle:c,workspaceSlug:d,projectId:u}=e,{getUserDetails:m}=(0,o.Kb)(),h=c&&c.owned_by_id?m(c.owned_by_id):void 0,p=null!==(n=(0,y._U)(c.end_date))&&void 0!==n?n:0,f=null===(t=c.status)||void 0===t?void 0:t.toLocaleLowerCase(),v=(null!==(r=null===(s=c.distribution)||void 0===s?void 0:s.assignees)&&void 0!==r?r:[]).filter(e=>e.display_name);return(0,l.jsxs)("div",{className:"flex items-center justify-between px-3 py-1.5 rounded border-[0.5px] border-custom-border-100 bg-custom-background-90",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 cursor-default",children:[(0,l.jsx)(x.Y7,{cycleGroup:null!=f?f:"draft",className:"h-4 w-4"}),(0,l.jsx)(x.u,{tooltipContent:c.name,position:"top-left",children:(0,l.jsx)("h3",{className:"break-words text-lg font-medium",children:(0,w.aF)(c.name,70)})}),(0,l.jsx)(x.u,{tooltipContent:"Start date: ".concat((0,y.ot)(null!==(a=c.start_date)&&void 0!==a?a:"")," Due Date: ").concat((0,y.ot)(null!==(i=c.end_date)&&void 0!==i?i:"")),position:"top-left",children:(0,l.jsx)("span",{className:"flex gap-1 whitespace-nowrap rounded-sm text-custom-text-400 font-semibold text-sm leading-5",children:"".concat(p," ").concat(p>1?"days":"day"," left")})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"rounded-sm text-sm",children:(0,l.jsxs)("div",{className:"flex gap-2 divide-x spac divide-x-border-300 text-sm whitespace-nowrap text-custom-text-300 font-medium",children:[(0,l.jsx)(x.qE,{name:null==h?void 0:h.display_name,src:null==h?void 0:h.avatar}),v.length>0&&(0,l.jsx)("span",{className:"pl-2",children:(0,l.jsx)(x.HE,{showTooltip:!0,children:v.map(e=>{var t,s;return(0,l.jsx)(x.qE,{name:null!==(t=null==e?void 0:e.display_name)&&void 0!==t?t:"",src:null!==(s=null==e?void 0:e.avatar)&&void 0!==s?s:"",showTooltip:!1},e.assignee_id)})})})]})}),(0,l.jsx)(b(),{href:"/".concat(d,"/projects/").concat(u,"/cycles/").concat(c.id),className:"".concat((0,x.A6)("outline-primary","sm")," cursor-pointer"),children:"View Cycle"})]})]})};var k=s(27378),C=s(23258),S=s(15108),_=s(86677),I=s(93164),E=s(865);let P=(0,m.Pi)(e=>{var t,s;let{cycleId:n}=e,r=(0,k.useRef)(null),{workspaceSlug:a,projectId:i}=(0,_.useRouter)().query,{captureEvent:c}=(0,o.DN)(),{addCycleToFavorites:d,getCycleById:u,removeCycleFromFavorites:m}=(0,o.nv)(),{getUserDetails:h}=(0,o.Kb)(),p=u(n),f=e=>{if(e.preventDefault(),!a||!i)return;let t=d(null==a?void 0:a.toString(),i.toString(),n).then(()=>{c(E.KE,{cycle_id:n,element:"List layout",state:"SUCCESS"})});(0,x.uW)(t,{loading:"Adding cycle to favorites...",success:{title:"Success!",message:()=>"Cycle added to favorites."},error:{title:"Error!",message:()=>"Couldn't add the cycle to favorites. Please try again."}})},v=e=>{if(e.preventDefault(),!a||!i)return;let t=m(null==a?void 0:a.toString(),i.toString(),n).then(()=>{c(E.Bw,{cycle_id:n,element:"List layout",state:"SUCCESS"})});(0,x.uW)(t,{loading:"Removing cycle from favorites...",success:{title:"Success!",message:()=>"Cycle removed from favorites."},error:{title:"Error!",message:()=>"Couldn't remove the cycle from favorites. Please try again."}})};return p?(0,l.jsxs)(b(),{ref:r,href:"/".concat(a,"/projects/").concat(i,"/cycles/").concat(n),className:"py-5 px-2 flex items-center justify-between gap-2 hover:bg-custom-background-90",children:[(0,l.jsx)("h6",{className:"font-medium text-base",children:p.name}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[p.start_date&&p.end_date&&(0,l.jsxs)("div",{className:"text-xs text-custom-text-300",children:[(0,y.ot)(p.start_date)," - ",(0,y.ot)(p.end_date)]}),p.assignee_ids&&(null===(t=p.assignee_ids)||void 0===t?void 0:t.length)>0?(0,l.jsx)(x.HE,{showTooltip:!1,children:null===(s=p.assignee_ids)||void 0===s?void 0:s.map(e=>{let t=h(e);return(0,l.jsx)(x.qE,{name:null==t?void 0:t.display_name,src:null==t?void 0:t.avatar},null==t?void 0:t.id)})}):(0,l.jsx)("span",{className:"flex h-5 w-5 items-end justify-center rounded-full border border-dashed border-custom-text-400 bg-custom-background-80",children:(0,l.jsx)(I.Z,{className:"h-4 w-4 text-custom-text-400"})}),(0,l.jsx)(C.MD,{onClick:e=>{p.is_favorite?v(e):f(e)},selected:!!p.is_favorite}),a&&i&&(0,l.jsx)(eH,{parentRef:r,cycleId:n,projectId:i.toString(),workspaceSlug:a.toString()})]})]}):null});var R=s(35704);let F=(0,m.Pi)(e=>{let{handleEmptyStateAction:t}=e,{currentProjectUpcomingCycleIds:s}=(0,o.nv)(),{resolvedTheme:n}=(0,R.F)();return s?(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"bg-custom-background-80 font-semibold text-sm py-1 px-2 rounded inline-block text-custom-text-400",children:"Next cycles"}),s.length>0?(0,l.jsx)("div",{className:"mt-2 divide-y-[0.5px] divide-custom-border-200 border-b-[0.5px] border-custom-border-200",children:s.map(e=>(0,l.jsx)(P,{cycleId:e},e))}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full py-20",children:(0,l.jsxs)("div",{className:"text-center flex flex-col gap-2.5 items-center",children:[(0,l.jsx)("div",{className:"h-24 w-24",children:(0,l.jsx)(a(),{src:"/empty-state/active-cycle/cycle-".concat("light"===n?"light":"dark",".webp"),alt:"button image",width:78,height:78,layout:"responsive",lazyBoundary:"100%"})}),(0,l.jsx)("h5",{className:"text-xl font-medium mb-1",children:"No upcoming cycles"}),(0,l.jsxs)("p",{className:"text-custom-text-400 text-base",children:["Create new cycles to find them here or check",(0,l.jsx)("br",{}),"'","All","'"," cycles tab to see all cycles or"," ",(0,l.jsx)("button",{type:"button",className:"text-custom-primary-100 font-medium",onClick:t,children:"click here"})]})]})})]}):null});var O=s(66570),T=s(12625),A=s(36738),D=s(82750),M=s(93997),z=s(6780);let L=(0,m.Pi)(e=>{var t,s,n,r,a;let{workspaceSlug:i,projectId:c,cycle:d}=e,{storedValue:u,setValue:m}=(0,S.Z)("activeCycleTab","Assignees"),{issues:{fetchActiveCycleIssues:h}}=(0,o.gk)(M.rS.CYCLE),{currentProjectDetails:g}=(0,o.PY)(),{data:j}=(0,p.ZP)(i&&c&&d.id?(0,D.EE)(d.id,{priority:"urgent,high"}):null,i&&c&&d.id?()=>h(i,c,d.id):null),w=null!=j?j:[];return(0,l.jsx)("div",{className:"flex flex-col gap-4 p-4 min-h-[17rem] overflow-hidden col-span-1 lg:col-span-2 xl:col-span-1 border border-custom-border-200 rounded-lg",children:(0,l.jsxs)(T.O.Group,{as:k.Fragment,defaultIndex:(e=>{switch(e){case"Priority-Issues":default:return 0;case"Assignees":return 1;case"Labels":return 2}})(u),onChange:e=>{switch(e){case 0:default:return m("Priority-Issues");case 1:return m("Assignees");case 2:return m("Labels")}},children:[(0,l.jsxs)(T.O.List,{as:"div",className:"relative border-[0.5px] border-custom-border-200 rounded bg-custom-background-80 p-[1px] grid",style:{gridTemplateColumns:"repeat(3, 1fr)"},children:[(0,l.jsx)(T.O,{className:e=>{let{selected:t}=e;return(0,z.cn)("relative z-[1] font-semibold text-xs rounded-[3px] py-1.5 text-custom-text-400 focus:outline-none transition duration-500",{"text-custom-text-300 bg-custom-background-100":t,"hover:text-custom-text-300":!t})},children:"Priority Issues"}),(0,l.jsx)(T.O,{className:e=>{let{selected:t}=e;return(0,z.cn)("relative z-[1] font-semibold text-xs rounded-[3px] py-1.5 text-custom-text-400 focus:outline-none transition duration-500",{"text-custom-text-300 bg-custom-background-100":t,"hover:text-custom-text-300":!t})},children:"Assignees"}),(0,l.jsx)(T.O,{className:e=>{let{selected:t}=e;return(0,z.cn)("relative z-[1] font-semibold text-xs rounded-[3px] py-1.5 text-custom-text-400 focus:outline-none transition duration-500",{"text-custom-text-300 bg-custom-background-100":t,"hover:text-custom-text-300":!t})},children:"Labels"})]}),(0,l.jsxs)(T.O.Panels,{as:k.Fragment,children:[(0,l.jsx)(T.O.Panel,{as:"div",className:"flex h-52 w-full flex-col gap-1 overflow-y-auto  text-custom-text-200 vertical-scrollbar scrollbar-sm",children:(0,l.jsx)("div",{className:"flex flex-col gap-1 h-full w-full overflow-y-auto vertical-scrollbar scrollbar-sm",children:w?w.length>0?w.map(e=>{var t,s;return(0,l.jsxs)(b(),{href:"/".concat(i,"/projects/").concat(c,"/issues/").concat(e.id),className:"group flex cursor-pointer items-center justify-between gap-2 rounded-md hover:bg-custom-background-90 p-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 flex-grow w-full min-w-24 truncate",children:[(0,l.jsx)(x.bJ,{priority:e.priority,withContainer:!0,size:12}),(0,l.jsx)(x.u,{tooltipHeading:"Issue ID",tooltipContent:"".concat(null==g?void 0:g.identifier,"-").concat(e.sequence_id),children:(0,l.jsxs)("span",{className:"flex-shrink-0 text-xs text-custom-text-200",children:[null==g?void 0:g.identifier,"-",e.sequence_id]})}),(0,l.jsx)(x.u,{position:"top-left",tooltipHeading:"Title",tooltipContent:e.name,children:(0,l.jsx)("span",{className:"text-[0.825rem] text-custom-text-100 truncate",children:e.name})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[(0,l.jsx)(A.sb,{value:null!==(t=e.state_id)&&void 0!==t?t:void 0,onChange:()=>{},projectId:null!==(s=null==c?void 0:c.toString())&&void 0!==s?s:"",disabled:!0,buttonVariant:"background-with-text",buttonContainerClassName:"cursor-pointer max-w-24",showTooltip:!0}),e.target_date&&(0,l.jsx)(x.u,{tooltipHeading:"Target Date",tooltipContent:(0,y.ot)(e.target_date),children:(0,l.jsxs)("div",{className:"h-full flex truncate items-center gap-1.5 rounded text-xs px-2 py-0.5 bg-custom-background-80 group-hover:bg-custom-background-100 cursor-pointer",children:[(0,l.jsx)(O.Z,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"text-xs truncate",children:(0,y.MP)(e.target_date)})]})})]})]},e.id)}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(f.ub,{type:v.C.ACTIVE_CYCLE_PRIORITY_ISSUE_EMPTY_STATE,layout:"screen-simple",size:"sm"})}):(0,l.jsxs)(x.aN,{className:"space-y-3",children:[(0,l.jsx)(x.aN.Item,{height:"50px"}),(0,l.jsx)(x.aN.Item,{height:"50px"}),(0,l.jsx)(x.aN.Item,{height:"50px"})]})})}),(0,l.jsx)(T.O.Panel,{as:"div",className:"flex h-52 w-full flex-col gap-1 overflow-y-auto text-custom-text-200 vertical-scrollbar scrollbar-sm",children:(null==d?void 0:null===(t=d.distribution)||void 0===t?void 0:t.assignees)&&d.distribution.assignees.length>0?null===(n=d.distribution)||void 0===n?void 0:null===(s=n.assignees)||void 0===s?void 0:s.map((e,t)=>{var s,n;return e.assignee_id?(0,l.jsx)(C.F_,{title:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(x.qE,{name:null!==(s=null==e?void 0:e.display_name)&&void 0!==s?s:void 0,src:null!==(n=null==e?void 0:e.avatar)&&void 0!==n?n:void 0}),(0,l.jsx)("span",{children:e.display_name})]}),completed:e.completed_issues,total:e.total_issues},e.assignee_id):(0,l.jsx)(C.F_,{title:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"h-5 w-5 rounded-full border-2 border-custom-border-200 bg-custom-background-80",children:(0,l.jsx)("img",{src:"/user.png",height:"100%",width:"100%",className:"rounded-full",alt:"User"})}),(0,l.jsx)("span",{children:"No assignee"})]}),completed:e.completed_issues,total:e.total_issues},"unassigned-".concat(t))}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(f.ub,{type:v.C.ACTIVE_CYCLE_ASSIGNEE_EMPTY_STATE,layout:"screen-simple",size:"sm"})})}),(0,l.jsx)(T.O.Panel,{as:"div",className:"flex h-52 w-full flex-col gap-1 overflow-y-auto  text-custom-text-200 vertical-scrollbar scrollbar-sm",children:(null==d?void 0:null===(r=d.distribution)||void 0===r?void 0:r.labels)&&d.distribution.labels.length>0?null===(a=d.distribution.labels)||void 0===a?void 0:a.map((e,t)=>{var s,n,r;return(0,l.jsx)(C.F_,{title:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"block h-3 w-3 rounded-full",style:{backgroundColor:null!==(s=e.color)&&void 0!==s?s:"#000000"}}),(0,l.jsx)("span",{className:"text-xs",children:null!==(n=e.label_name)&&void 0!==n?n:"No labels"})]}),completed:e.completed_issues,total:e.total_issues},null!==(r=e.label_id)&&void 0!==r?r:"no-label-".concat(t))}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(f.ub,{type:v.C.ACTIVE_CYCLE_LABEL_EMPTY_STATE,layout:"screen-simple",size:"sm"})})})]})]})})});var Z=s(14522);let q=e=>{let{cycle:t}=e,s=Z.zV.map((e,s)=>({id:s,name:e.title,value:t.total_issues>0?t[e.key]:0,color:e.color})),n={completed:t.completed_issues,started:t.started_issues,unstarted:t.unstarted_issues,backlog:t.backlog_issues};return(0,l.jsxs)("div",{className:"flex flex-col min-h-[17rem] gap-5 py-4 px-3.5 border border-custom-border-200 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,l.jsx)("h3",{className:"text-base text-custom-text-300 font-semibold",children:"Progress"}),t.total_issues>0&&(0,l.jsx)("span",{className:"flex gap-1 text-sm text-custom-text-400 font-medium whitespace-nowrap rounded-sm px-3 py-1 ",children:"".concat(t.completed_issues+t.cancelled_issues,"/").concat(t.total_issues-t.cancelled_issues," ").concat(t.completed_issues+t.cancelled_issues>1?"Issues":"Issue"," closed")})]}),t.total_issues>0&&(0,l.jsx)(x.Ov,{size:"lg",data:s})]}),t.total_issues>0?(0,l.jsxs)("div",{className:"flex flex-col gap-5",children:[Object.keys(n).map((e,t)=>(0,l.jsx)(l.Fragment,{children:n[e]>0&&(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,l.jsx)("span",{className:"block h-3 w-3 rounded-full",style:{backgroundColor:Z.zV[t].color}}),(0,l.jsx)("span",{className:"text-custom-text-300 capitalize font-medium w-16",children:e})]}),(0,l.jsx)("span",{className:"text-custom-text-300",children:"".concat(n[e]," ").concat(n[e]>1?"Issues":"Issue")})]})},t)})),t.cancelled_issues>0&&(0,l.jsx)("span",{className:"flex items-center gap-2 text-sm text-custom-text-300",children:(0,l.jsxs)("span",{children:["".concat(t.cancelled_issues," cancelled ").concat(t.cancelled_issues>1?"issues are":"issue is"," excluded from this report.")," "]})})]}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(f.ub,{type:v.C.ACTIVE_CYCLE_PROGRESS_EMPTY_STATE,layout:"screen-simple",size:"sm"})})]})};var B=s(96883);let U=e=>{var t,s,n,r;let{cycle:a}=e;return(0,l.jsxs)("div",{className:"flex flex-col justify-center min-h-[17rem] gap-5 py-4 px-3.5 border border-custom-border-200 rounded-lg",children:[(0,l.jsx)("div",{className:"flex items-center justify-between gap-4",children:(0,l.jsx)("h3",{className:"text-base text-custom-text-300 font-semibold",children:"Issue burndown"})}),a.total_issues>0?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"h-full w-full px-2",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4 py-1 text-xs text-custom-text-300",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 text-custom-text-300",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,l.jsx)("span",{className:"h-2 w-2 rounded-full bg-[#A9BBD0]"}),(0,l.jsx)("span",{children:"Ideal"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,l.jsx)("span",{className:"h-2 w-2 rounded-full bg-[#4C8FFF]"}),(0,l.jsx)("span",{children:"Current"})]})]}),(0,l.jsx)("span",{children:"Pending issues - ".concat(a.backlog_issues+a.unstarted_issues+a.started_issues)})]}),(0,l.jsx)("div",{className:"relative  h-full",children:(0,l.jsx)(B.Z,{className:"h-full",distribution:null!==(s=null===(t=a.distribution)||void 0===t?void 0:t.completion_chart)&&void 0!==s?s:{},startDate:null!==(n=a.start_date)&&void 0!==n?n:"",endDate:null!==(r=a.end_date)&&void 0!==r?r:"",totalIssues:a.total_issues})})]})}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(f.ub,{type:v.C.ACTIVE_CYCLE_CHART_EMPTY_STATE,layout:"screen-simple",size:"sm"})})})]})};var V=s(82558),W=s(60801);let K=(0,n.Pi)(e=>{let{editable:t,handleRemove:s,values:n}=e,r=e=>{let t="",s=W.UC.find(t=>t.value===e);if(s)t=s.name;else{let s=e.split(";");if(2===s.length){let[e,l]=s;t="".concat((0,w.fm)(l)," ").concat((0,y.ot)(e))}}return t};return(0,l.jsx)(l.Fragment,{children:n.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)("span",{className:"normal-case",children:r(e)}),t&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>s(e),children:(0,l.jsx)(V.Z,{size:10,strokeWidth:2})})]},e))})});var Y=s(51374);let J=["start_date","end_date"],H=(0,n.Pi)(e=>{let{appliedFilters:t,handleClearAllFilters:s,handleRemoveFilter:n,alwaysAllowEditing:r}=e,{membership:{currentProjectRole:a}}=(0,o.aF)();if(!t||0===Object.keys(t).length)return null;let i=r||a&&a>=Y.MC.MEMBER;return(0,l.jsxs)("div",{className:"flex flex-wrap items-stretch gap-2 bg-custom-background-100",children:[Object.entries(t).map(e=>{let[t,s]=e;if(s&&(!Array.isArray(s)||0!==s.length))return(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2 rounded-md border border-custom-border-200 px-2 py-1 capitalize",children:[(0,l.jsx)("span",{className:"text-xs text-custom-text-300",children:(0,w.y2)(t)}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-1",children:["status"===t&&(0,l.jsx)(Q,{editable:i,handleRemove:e=>n("status",e),values:s}),J.includes(t)&&(0,l.jsx)(K,{editable:i,handleRemove:e=>n(t,e),values:s}),i&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>n(t,null),children:(0,l.jsx)(V.Z,{size:12,strokeWidth:2})})]})]},t)}),i&&(0,l.jsxs)("button",{type:"button",onClick:s,className:"flex items-center gap-2 rounded-md border border-custom-border-200 px-2 py-1 text-xs text-custom-text-300 hover:text-custom-text-200",children:["Clear all",(0,l.jsx)(V.Z,{size:12,strokeWidth:2})]})]})}),Q=(0,n.Pi)(e=>{let{handleRemove:t,values:s,editable:n}=e;return(0,l.jsx)(l.Fragment,{children:s.map(e=>{let s=Z.PI.find(t=>t.value===e);return(0,l.jsxs)("div",{className:(0,z.cn)("flex items-center gap-1 rounded p-1 text-xs",null==s?void 0:s.bgColor,null==s?void 0:s.textColor),children:[null==s?void 0:s.title,n&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(V.Z,{size:10,strokeWidth:2})})]},e)})})});var G=s(19711),$=s(93116),X=s(18894);let ee=(0,m.Pi)(e=>{var t,s,n,r;let{cycleId:a,workspaceSlug:i,projectId:c}=e,d=(0,k.useRef)(null),u=(0,_.useRouter)(),{captureEvent:m}=(0,o.DN)(),{membership:{currentProjectRole:h}}=(0,o.aF)(),{addCycleToFavorites:p,removeCycleFromFavorites:f,getCycleById:v}=(0,o.nv)(),{getUserDetails:g}=(0,o.Kb)(),j=v(a),{isMobile:w}=(0,X.L)();if(!j)return null;let N=null===(t=j.status)||void 0===t?void 0:t.toLocaleLowerCase(),S=(0,y._3)(j.end_date),I=(0,y._3)(j.start_date),P=j.start_date||j.end_date,R=!!h&&h>=$.fp.MEMBER,F=Z.PI.find(e=>e.value===N),O=j.backlog_issues+j.unstarted_issues+j.started_issues+j.completed_issues+j.cancelled_issues,T=j.completed_issues/O*100,A=j?0===O?"0 Issue":O===j.completed_issues?"".concat(O," Issue").concat(O>1?"s":""):"".concat(j.completed_issues,"/").concat(O," Issues"):"0 Issue",D=e=>{if(e.preventDefault(),!i||!c)return;let t=p(null==i?void 0:i.toString(),c.toString(),a).then(()=>{m(E.KE,{cycle_id:a,element:"Grid layout",state:"SUCCESS"})});(0,x.uW)(t,{loading:"Adding cycle to favorites...",success:{title:"Success!",message:()=>"Cycle added to favorites."},error:{title:"Error!",message:()=>"Couldn't add the cycle to favorites. Please try again."}})},M=e=>{if(e.preventDefault(),!i||!c)return;let t=f(null==i?void 0:i.toString(),c.toString(),a).then(()=>{m(E.Bw,{cycle_id:a,element:"Grid layout",state:"SUCCESS"})});(0,x.uW)(t,{loading:"Removing cycle from favorites...",success:{title:"Success!",message:()=>"Cycle removed from favorites."},error:{title:"Error!",message:()=>"Couldn't remove the cycle from favorites. Please try again."}})},z=null!==(s=(0,y._U)(j.end_date))&&void 0!==s?s:0;return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(b(),{ref:d,href:"/".concat(i,"/projects/").concat(c,"/cycles/").concat(j.id),children:(0,l.jsxs)("div",{className:"flex h-44 w-full flex-col justify-between rounded  border border-custom-border-100 bg-custom-background-100 p-4 text-sm hover:shadow-md",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 truncate",children:[(0,l.jsx)("span",{className:"flex-shrink-0",children:(0,l.jsx)(x.Y7,{cycleGroup:N,className:"h-3.5 w-3.5"})}),(0,l.jsx)(x.u,{tooltipContent:j.name,position:"top",isMobile:w,children:(0,l.jsx)("span",{className:"truncate text-base font-medium",children:j.name})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[F&&(0,l.jsx)("span",{className:"flex h-6 w-20 items-center justify-center rounded-sm text-center text-xs",style:{color:F.color,backgroundColor:"".concat(F.color,"20")},children:"current"===F.value?"".concat(z," ").concat(z>1?"days":"day"," left"):"".concat(F.label)}),(0,l.jsx)("button",{onClick:e=>{let{query:t}=u;e.preventDefault(),e.stopPropagation(),t.peekCycle?(delete t.peekCycle,u.push({pathname:u.pathname,query:{...t}})):u.push({pathname:u.pathname,query:{...t,peekCycle:a}})},children:(0,l.jsx)(G.Z,{className:"h-4 w-4 text-custom-text-400"})})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 text-custom-text-200",children:[(0,l.jsx)(x.uQ,{className:"h-4 w-4 text-custom-text-300"}),(0,l.jsx)("span",{className:"text-xs text-custom-text-300",children:A})]}),j.assignee_ids&&j.assignee_ids.length>0&&(0,l.jsx)(x.u,{tooltipContent:"".concat(j.assignee_ids.length," Members"),isMobile:w,children:(0,l.jsx)("div",{className:"flex cursor-default items-center gap-1",children:(0,l.jsx)(x.HE,{showTooltip:!1,children:j.assignee_ids.map(e=>{let t=g(e);return(0,l.jsx)(x.qE,{name:null==t?void 0:t.display_name,src:null==t?void 0:t.avatar},null==t?void 0:t.id)})})})})]}),(0,l.jsx)(x.u,{isMobile:w,tooltipContent:isNaN(T)?"0":"".concat(T.toFixed(0),"%"),position:"top-left",children:(0,l.jsx)("div",{className:"flex w-full items-center",children:(0,l.jsx)("div",{className:"bar relative h-1.5 w-full rounded bg-custom-background-90",style:{boxShadow:"1px 1px 4px 0px rgba(161, 169, 191, 0.35) inset"},children:(0,l.jsx)("div",{className:"absolute left-0 top-0 h-1.5 rounded bg-blue-600 duration-300",style:{width:"".concat(isNaN(T)?0:T.toFixed(0),"%")}})})})}),(0,l.jsx)("div",{className:"flex items-center justify-between",children:P?(0,l.jsxs)("span",{className:"text-xs text-custom-text-300",children:[null!==(n=(0,y.ot)(I))&&void 0!==n?n:"_ _"," - ",null!==(r=(0,y.ot)(S))&&void 0!==r?r:"_ _"]}):(0,l.jsx)("span",{className:"text-xs text-custom-text-400",children:"No due date"})})]})]})}),(0,l.jsxs)("div",{className:"absolute right-4 bottom-3.5 flex items-center gap-1.5",children:[R&&(0,l.jsx)(C.MD,{onClick:e=>{j.is_favorite?M(e):D(e)},selected:!!j.is_favorite}),(0,l.jsx)(eH,{parentRef:d,cycleId:a,projectId:c,workspaceSlug:i})]})]})}),et=e=>{let{cycleIds:t,peekCycle:s,projectId:n,workspaceSlug:r}=e;return(0,l.jsx)("div",{className:"w-full grid grid-cols-1 gap-6 ".concat(s?"lg:grid-cols-1 xl:grid-cols-2 3xl:grid-cols-3":"lg:grid-cols-2 xl:grid-cols-3 3xl:grid-cols-4"," auto-rows-max transition-all"),children:t.map(e=>(0,l.jsx)(ee,{workspaceSlug:r,projectId:n,cycleId:e},e))})};var es=s(78543),el=s(49505);let en=(0,n.Pi)(e=>{let{completedCycleIds:t,cycleIds:s,workspaceSlug:n,projectId:r,peekCycle:a}=e;return(0,l.jsx)("div",{className:"h-full w-full",children:(0,l.jsxs)("div",{className:"flex h-full w-full justify-between",children:[(0,l.jsxs)("div",{className:"h-full w-full flex flex-col p-8 space-y-8 vertical-scrollbar scrollbar-lg",children:[s.length>0&&(0,l.jsx)(et,{cycleIds:s,peekCycle:a,projectId:r,workspaceSlug:n}),0!==t.length&&(0,l.jsxs)(el.p,{as:"div",className:"space-y-4",children:[(0,l.jsx)(el.p.Button,{className:"bg-custom-background-80 font-semibold text-sm py-1 px-2 rounded flex items-center gap-1",children:e=>{let{open:s}=e;return(0,l.jsxs)(l.Fragment,{children:["Completed cycles (",t.length,")",(0,l.jsx)(es.Z,{className:(0,z.cn)("h-3 w-3 transition-all",{"rotate-90":s})})]})}}),(0,l.jsx)(el.p.Panel,{children:(0,l.jsx)(et,{cycleIds:t,peekCycle:a,projectId:r,workspaceSlug:n})})]})]}),(0,l.jsx)(eD,{projectId:r,workspaceSlug:n})]})})});var er=s(68114);let ea=(0,n.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:n,searchQuery:r}=e,[a,i]=(0,k.useState)(!0),[o,c]=(0,k.useState)(!1),d=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,u=W.UC.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())),m=()=>((null==s?void 0:s.filter(e=>(0,y.hc)(e.split(";")[0])))||[]).length>0;return(0,l.jsxs)(l.Fragment,{children:[o&&(0,l.jsx)(C.iF,{handleClose:()=>c(!1),isOpen:o,onSelect:e=>n(e),title:"Due date"}),(0,l.jsx)(er.YHs,{title:"Due date".concat(d>0?" (".concat(d,")"):""),isPreviewEnabled:a,handleIsPreviewEnabled:()=>i(!a)}),a&&(0,l.jsx)("div",{children:u.length>0?(0,l.jsxs)(l.Fragment,{children:[u.map(e=>(0,l.jsx)(er.f2,{isChecked:null!=s&&!!s.includes(e.value),onClick:()=>n(e.value),title:e.name,multiple:!0},e.value)),(0,l.jsx)(er.f2,{isChecked:m(),onClick:()=>{m()?n((null==s?void 0:s.filter(e=>e.includes("-")))||[]):c(!0)},title:"Custom",multiple:!0})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})});var ei=s(81630);let eo=(0,n.Pi)(e=>{var t,s,n;let{filters:r,handleFiltersUpdate:a,isArchived:i=!1}=e,[o,c]=(0,k.useState)("");return(0,l.jsxs)("div",{className:"flex h-full w-full flex-col overflow-hidden",children:[(0,l.jsx)("div",{className:"bg-custom-background-100 p-2.5 pb-0",children:(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border-[0.5px] border-custom-border-200 bg-custom-background-90 px-1.5 py-1 text-xs",children:[(0,l.jsx)(ei.Z,{className:"text-custom-text-400",size:12,strokeWidth:2}),(0,l.jsx)("input",{type:"text",className:"w-full bg-custom-background-90 outline-none placeholder:text-custom-text-400",placeholder:"Search",value:o,onChange:e=>c(e.target.value),autoFocus:!0}),""!==o&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>c(""),children:(0,l.jsx)(V.Z,{className:"text-custom-text-300",size:12,strokeWidth:2})})]})}),(0,l.jsxs)("div",{className:"h-full w-full divide-y divide-custom-border-200 overflow-y-auto px-2.5 vertical-scrollbar scrollbar-sm",children:[!i&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(ed,{appliedFilters:null!==(t=r.status)&&void 0!==t?t:null,handleUpdate:e=>a("status",e),searchQuery:o})}),(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(ec,{appliedFilters:null!==(s=r.start_date)&&void 0!==s?s:null,handleUpdate:e=>a("start_date",e),searchQuery:o})}),(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(ea,{appliedFilters:null!==(n=r.end_date)&&void 0!==n?n:null,handleUpdate:e=>a("end_date",e),searchQuery:o})})]})]})}),ec=(0,n.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:n,searchQuery:r}=e,[a,i]=(0,k.useState)(!0),[o,c]=(0,k.useState)(!1),d=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,u=W.UC.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())),m=()=>((null==s?void 0:s.filter(e=>(0,y.hc)(e.split(";")[0])))||[]).length>0;return(0,l.jsxs)(l.Fragment,{children:[o&&(0,l.jsx)(C.iF,{handleClose:()=>c(!1),isOpen:o,onSelect:e=>n(e),title:"Start date"}),(0,l.jsx)(er.YHs,{title:"Start date".concat(d>0?" (".concat(d,")"):""),isPreviewEnabled:a,handleIsPreviewEnabled:()=>i(!a)}),a&&(0,l.jsx)("div",{children:u.length>0?(0,l.jsxs)(l.Fragment,{children:[u.map(e=>(0,l.jsx)(er.f2,{isChecked:null!=s&&!!s.includes(e.value),onClick:()=>n(e.value),title:e.name,multiple:!0},e.value)),(0,l.jsx)(er.f2,{isChecked:m(),onClick:()=>{m()?n((null==s?void 0:s.filter(e=>e.includes("-")))||[]):c(!0)},title:"Custom",multiple:!0})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})}),ed=(0,n.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:n,searchQuery:r}=e,[a,i]=(0,k.useState)(!0),o=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,c=Z.PI.filter(e=>e.value.includes(r.toLowerCase()));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(er.YHs,{title:"Status of the cycle".concat(o>0?" (".concat(o,")"):""),isPreviewEnabled:a,handleIsPreviewEnabled:()=>i(!a)}),a&&(0,l.jsx)("div",{children:c.length>0?c.map(e=>(0,l.jsx)(er.f2,{isChecked:null!=s&&!!s.includes(e.value),onClick:()=>n(e.value),title:e.title},e.value)):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})}),eu=(0,m.Pi)(e=>{var t,s,n;let{cycleId:r}=e,a=(0,_.useRouter)(),{router:{workspaceSlug:i}}=(0,o.IX)(),{getCycleById:c}=(0,o.nv)(),d=c(r),{isMobile:u}=(0,X.L)(),m=null==d?void 0:null===(t=d.status)||void 0===t?void 0:t.toLocaleLowerCase();return(0,l.jsxs)("div",{className:"relative flex h-full w-full items-center rounded",style:{backgroundColor:"current"===m?"#09a953":"upcoming"===m?"#f7ae59":"completed"===m?"#3f76ff":"draft"===m?"rgb(var(--color-text-200))":""},onClick:()=>a.push("/".concat(i,"/projects/").concat(null==d?void 0:d.project_id,"/cycles/").concat(null==d?void 0:d.id)),children:[(0,l.jsx)("div",{className:"absolute left-0 top-0 h-full w-full bg-custom-background-100/50"}),(0,l.jsx)(x.u,{isMobile:u,tooltipContent:(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("h5",{children:null==d?void 0:d.name}),(0,l.jsxs)("div",{children:[(0,y.ot)(null!==(s=null==d?void 0:d.start_date)&&void 0!==s?s:"")," to"," ",(0,y.ot)(null!==(n=null==d?void 0:d.end_date)&&void 0!==n?n:"")]})]}),position:"top-left",children:(0,l.jsx)("div",{className:"relative w-full truncate px-2.5 py-1 text-sm text-custom-text-100",children:null==d?void 0:d.name})})]})}),em=(0,m.Pi)(e=>{var t;let{cycleId:s}=e,{router:{workspaceSlug:n}}=(0,o.IX)(),{getCycleById:r}=(0,o.nv)(),a=r(s),i=null==a?void 0:null===(t=a.status)||void 0===t?void 0:t.toLocaleLowerCase();return(0,l.jsxs)(b(),{className:"relative flex h-full w-full items-center gap-2",href:"/".concat(n,"/projects/").concat(null==a?void 0:a.project_id,"/cycles/").concat(null==a?void 0:a.id),children:[(0,l.jsx)(x.sI,{className:"h-5 w-5 flex-shrink-0",color:"".concat("current"===i?"#09a953":"upcoming"===i?"#f7ae59":"completed"===i?"#3f76ff":"draft"===i?"rgb(var(--color-text-200))":"")}),(0,l.jsx)("h6",{className:"flex-grow truncate text-sm font-medium",children:null==a?void 0:a.name})]})});var eh=s(95633);let ep=(0,n.Pi)(e=>{var t;let{cycleIds:s}=e,{workspaceSlug:n}=(0,_.useRouter)().query,{getCycleById:r,updateCycleDetails:a}=(0,o.nv)(),i=async(e,t)=>{if(!n||!e)return;let s={...t};t.sort_order&&(s.sort_order=t.sort_order.newSortOrder),await a(n.toString(),e.project_id,e.id,s)};return(0,l.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,l.jsx)(eh.TB,{title:"Cycles",loaderTitle:"Cycles",blocks:s?(t=s.map(e=>r(e)))?t.filter(e=>null!==e&&e.start_date&&e.end_date).map(e=>{var t,s;return{data:e,id:null!==(t=null==e?void 0:e.id)&&void 0!==t?t:"",sort_order:null!==(s=null==e?void 0:e.sort_order)&&void 0!==s?s:0,start_date:(0,y._3)(null==e?void 0:e.start_date),target_date:(0,y._3)(null==e?void 0:e.end_date)}}):[]:null,blockUpdateHandler:(e,t)=>i(e,t),sidebarToRender:e=>(0,l.jsx)(eh.dO,{...e}),blockToRender:e=>(0,l.jsx)(eu,{cycleId:e.id}),enableBlockLeftResize:!1,enableBlockRightResize:!1,enableBlockMove:!1,enableReorder:!0})})});var ex=s(1759),ef=s(4314);let ev=(0,m.Pi)(e=>{var t;let{cycleId:s,workspaceSlug:n,projectId:r}=e,a=(0,k.useRef)(null),i=(0,_.useRouter)(),{isMobile:c}=(0,X.L)(),{getCycleById:d}=(0,o.nv)(),u=d(s);if(!u)return null;let m=u.status?u.status.toLocaleLowerCase():"draft",h=u.backlog_issues+u.unstarted_issues+u.started_issues+u.completed_issues+u.cancelled_issues,p=u.completed_issues/h*100,f=isNaN(p)?0:Math.floor(p),v=e=>{let{query:t}=i;e.preventDefault(),e.stopPropagation(),t.peekCycle?(delete t.peekCycle,i.push({pathname:i.pathname,query:{...t}})):i.push({pathname:i.pathname,query:{...t,peekCycle:s}})};return(0,l.jsx)(ef.H,{title:null!==(t=null==u?void 0:u.name)&&void 0!==t?t:"",itemLink:"/".concat(n,"/projects/").concat(r,"/cycles/").concat(u.id),onItemClick:e=>{u.archived_at&&v(e)},prependTitleElement:(0,l.jsx)(x.QT,{size:30,percentage:f,strokeWidth:3,children:"completed"===m?100===f?(0,l.jsx)(ex.Z,{className:"h-3 w-3 stroke-[2] text-custom-primary-100"}):(0,l.jsx)("span",{className:"text-sm text-custom-primary-100",children:"!"}):100===f?(0,l.jsx)(ex.Z,{className:"h-3 w-3 stroke-[2] text-custom-primary-100"}):(0,l.jsx)("span",{className:"text-xs text-custom-text-300",children:"".concat(f,"%")})}),appendTitleElement:(0,l.jsx)("button",{onClick:v,className:"z-[5] flex-shrink-0 ".concat(c?"flex":"hidden group-hover:flex"),children:(0,l.jsx)(G.Z,{className:"h-4 w-4 text-custom-text-400"})}),actionableItems:(0,l.jsx)(eb,{workspaceSlug:n,projectId:r,cycleId:s,cycleDetails:u,parentRef:a}),isMobile:c,parentRef:a})}),eg=e=>{let{cycleIds:t,projectId:s,workspaceSlug:n}=e;return(0,l.jsx)(l.Fragment,{children:t.map(e=>(0,l.jsx)(ev,{cycleId:e,workspaceSlug:n,projectId:s},e))})},ej=(0,n.Pi)(e=>{let{completedCycleIds:t,cycleIds:s,workspaceSlug:n,projectId:r,isArchived:a=!1}=e;return(0,l.jsx)("div",{className:"h-full overflow-y-auto",children:(0,l.jsxs)("div",{className:"flex h-full w-full justify-between",children:[(0,l.jsxs)(ef.P,{children:[(0,l.jsx)(eg,{cycleIds:s,projectId:r,workspaceSlug:n}),0!==t.length&&(0,l.jsxs)(el.p,{as:"div",className:"py-8 pl-3 space-y-4",children:[(0,l.jsx)(el.p.Button,{className:"bg-custom-background-80 font-semibold text-sm py-1 px-2 rounded ml-5 flex items-center gap-1",children:e=>{let{open:s}=e;return(0,l.jsxs)(l.Fragment,{children:["Completed cycles (",t.length,")",(0,l.jsx)(es.Z,{className:(0,z.cn)("h-3 w-3 transition-all",{"rotate-90":s})})]})}}),(0,l.jsx)(el.p.Panel,{children:(0,l.jsx)(eg,{cycleIds:t,projectId:r,workspaceSlug:n})})]})]}),(0,l.jsx)(eD,{projectId:r,workspaceSlug:n,isArchived:a})]})})}),eb=(0,m.Pi)(e=>{var t,s,n,r,a,i;let{workspaceSlug:c,projectId:d,cycleId:u,cycleDetails:m,parentRef:h}=e,{isMobile:p}=(0,X.L)(),{addCycleToFavorites:f,removeCycleFromFavorites:v}=(0,o.nv)(),{captureEvent:g}=(0,o.DN)(),{membership:{currentProjectRole:j}}=(0,o.aF)(),{getUserDetails:b}=(0,o.Kb)(),w=(0,y._3)(m.end_date),N=(0,y._3)(m.start_date),k=m.status?m.status.toLocaleLowerCase():"draft",S=!!j&&j>=Y.MC.MEMBER,_=m.start_date||m.end_date,P=Z.PI.find(e=>e.value===k),R=null!==(r=(0,y._U)(m.end_date))&&void 0!==r?r:0,F=e=>{if(e.preventDefault(),!c||!d)return;let t=f(null==c?void 0:c.toString(),d.toString(),u).then(()=>{g(E.KE,{cycle_id:u,element:"List layout",state:"SUCCESS"})});(0,x.uW)(t,{loading:"Adding cycle to favorites...",success:{title:"Success!",message:()=>"Cycle added to favorites."},error:{title:"Error!",message:()=>"Couldn't add the cycle to favorites. Please try again."}})},O=e=>{if(e.preventDefault(),!c||!d)return;let t=v(null==c?void 0:c.toString(),d.toString(),u).then(()=>{g(E.Bw,{cycle_id:u,element:"List layout",state:"SUCCESS"})});(0,x.uW)(t,{loading:"Removing cycle from favorites...",success:{title:"Success!",message:()=>"Cycle removed from favorites."},error:{title:"Error!",message:()=>"Couldn't remove the cycle from favorites. Please try again."}})};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"text-xs text-custom-text-300 flex-shrink-0",children:_&&"".concat(null!==(a=(0,y.ot)(N))&&void 0!==a?a:"_ _"," - ").concat(null!==(i=(0,y.ot)(w))&&void 0!==i?i:"_ _")}),P&&(0,l.jsx)("div",{className:"relative flex h-6 w-20 flex-shrink-0 items-center justify-center rounded-sm text-center text-xs",style:{color:P.color,backgroundColor:"".concat(P.color,"20")},children:"current"===P.value?"".concat(R," ").concat(R>1?"days":"day"," left"):"".concat(P.label)}),(0,l.jsx)(x.u,{tooltipContent:"".concat(null===(t=m.assignee_ids)||void 0===t?void 0:t.length," Members"),isMobile:p,children:(0,l.jsx)("div",{className:"flex w-10 cursor-default items-center justify-center",children:m.assignee_ids&&(null===(s=m.assignee_ids)||void 0===s?void 0:s.length)>0?(0,l.jsx)(x.HE,{showTooltip:!1,children:null===(n=m.assignee_ids)||void 0===n?void 0:n.map(e=>{let t=b(e);return(0,l.jsx)(x.qE,{name:null==t?void 0:t.display_name,src:null==t?void 0:t.avatar},null==t?void 0:t.id)})}):(0,l.jsx)("span",{className:"flex h-5 w-5 items-end justify-center rounded-full border border-dashed border-custom-text-400 bg-custom-background-80",children:(0,l.jsx)(I.Z,{className:"h-4 w-4 text-custom-text-400"})})})}),S&&!m.archived_at&&(0,l.jsx)(C.MD,{onClick:e=>{m.is_favorite?O(e):F(e)},selected:!!m.is_favorite}),(0,l.jsx)(eH,{parentRef:h,cycleId:u,projectId:d,workspaceSlug:c})]})});var ey=s(90104),ew=s.n(ey),eN=s(88039),ek=s(3515),eC=s(9204),eS=s(54129),e_=s(41256),eI=s(75437),eE=s(65709),eP=s(93965),eR=s(30335),eF=s(38876);let eO={start_date:null,end_date:null},eT=new eF.K,eA=(0,n.Pi)(e=>{var t;let{cycleId:s,handleClose:n,isArchived:r}=e,[a,i]=(0,k.useState)(!1),[c,d]=(0,k.useState)(!1),u=(0,_.useRouter)(),{workspaceSlug:m,projectId:h,peekCycle:p}=u.query,{setTrackElement:f,captureCycleEvent:v}=(0,o.DN)(),{membership:{currentProjectRole:g}}=(0,o.aF)(),{getCycleById:j,updateCycleDetails:b,restoreCycle:N}=(0,o.nv)(),{getUserDetails:S}=(0,o.Kb)(),I=j(s),P=I?S(I.owned_by_id):void 0,{control:R,reset:F}=(0,eN.cI)({defaultValues:eO}),O=(e,t)=>{m&&h&&s&&b(m.toString(),h.toString(),s.toString(),e).then(e=>{v({eventName:E.T7,payload:{...e,changed_properties:[t],element:"Right side-peek",state:"SUCCESS"}})}).catch(()=>{v({eventName:E.T7,payload:{...e,element:"Right side-peek",state:"FAILED"}})})},T=async()=>{m&&h&&await N(m.toString(),h.toString(),s).then(()=>{(0,x.fz)({type:x.do.SUCCESS,title:"Restore success",message:"Your cycle can be found in project cycles."}),u.push("/".concat(m.toString(),"/projects/").concat(h.toString(),"/archives/cycles"))}).catch(()=>(0,x.fz)({type:x.do.ERROR,title:"Error!",message:"Cycle could not be restored. Please try again."}))};(0,k.useEffect)(()=>{I&&F({...I})},[I,F]);let D=async e=>{try{return(await eT.cycleDateCheck(m,h,e)).status}catch(e){return!1}},z=async(e,t)=>{if(!e||!t)return;let s={start_date:(0,y.ss)(e),end_date:(0,y.ss)(t)};(I&&I.start_date&&I.end_date?await D({...s,cycle_id:I.id}):await D(s))?(O(s,"date_range"),(0,x.fz)({type:x.do.SUCCESS,title:"Success!",message:"Cycle updated successfully."})):((0,x.fz)({type:x.do.ERROR,title:"Error!",message:"You already have a cycle on the given dates, if you want to create a draft cycle, you can do that by removing both the dates."}),F({...I}))},{issuesFilter:{issueFilters:L,updateFilters:q}}=(0,o.gk)(M.rS.CYCLE),U=(0,k.useCallback)((e,t)=>{var l,n,r,a;if(!m||!h)return;let i=null!==(n=null==L?void 0:null===(l=L.filters)||void 0===l?void 0:l[e])&&void 0!==n?n:[];Array.isArray(t)?t.forEach(e=>{i.includes(e)?i.splice(i.indexOf(e),1):i.push(e)}):(null==L?void 0:null===(a=L.filters)||void 0===a?void 0:null===(r=a[e])||void 0===r?void 0:r.includes(t))?i.splice(i.indexOf(t),1):i.push(t),q(m.toString(),h.toString(),M.gc.FILTERS,{[e]:i},s)},[m,h,s,L,q]),V=null==I?void 0:null===(t=I.status)||void 0===t?void 0:t.toLocaleLowerCase(),W="completed"===V,K=(0,y._3)(null==I?void 0:I.start_date),Y=(0,y._3)(null==I?void 0:I.end_date),J=K&&K<=new Date,H=Y&&K&&Y>=K,Q=I?W&&(null==I?void 0:I.progress_snapshot)?Math.round(I.progress_snapshot.completed_issues/I.progress_snapshot.total_issues*100):Math.round(I.completed_issues/I.total_issues*100):null;if(!I)return(0,l.jsxs)(x.aN,{className:"px-5",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(x.aN.Item,{height:"15px",width:"50%"}),(0,l.jsx)(x.aN.Item,{height:"15px",width:"30%"})]}),(0,l.jsxs)("div",{className:"mt-8 space-y-3",children:[(0,l.jsx)(x.aN.Item,{height:"30px"}),(0,l.jsx)(x.aN.Item,{height:"30px"}),(0,l.jsx)(x.aN.Item,{height:"30px"})]})]});let G=Z.PI.find(e=>e.value===V),X=W&&!ew()(I.progress_snapshot)?0===I.progress_snapshot.total_issues?"0 Issue":"".concat(I.progress_snapshot.completed_issues,"/").concat(I.progress_snapshot.total_issues):0===I.total_issues?"0 Issue":"".concat(I.completed_issues,"/").concat(I.total_issues),ee=(0,y._U)(I.end_date),et=!!g&&g>=$.fp.MEMBER;return(0,l.jsxs)("div",{className:"relative",children:[I&&m&&h&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e3,{workspaceSlug:m.toString(),projectId:h.toString(),cycleId:s,isOpen:a,handleClose:()=>i(!1)}),(0,l.jsx)(eq,{cycle:I,isOpen:c,handleClose:()=>d(!1),workspaceSlug:m.toString(),projectId:h.toString()})]}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"sticky z-10 top-0 flex items-center justify-between bg-custom-sidebar-background-100 py-5",children:[(0,l.jsx)("div",{children:(0,l.jsx)("button",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-custom-border-300",onClick:()=>n(),children:(0,l.jsx)(es.Z,{className:"h-3 w-3 stroke-2 text-white"})})}),(0,l.jsxs)("div",{className:"flex items-center gap-3.5",children:[!r&&(0,l.jsx)("button",{onClick:()=>{(0,w.fQ)("".concat(m,"/projects/").concat(h,"/cycles/").concat(s)).then(()=>{(0,x.fz)({type:x.do.SUCCESS,title:"Link Copied!",message:"Cycle link copied to clipboard."})}).catch(()=>{(0,x.fz)({type:x.do.ERROR,title:"Some error occurred"})})},children:(0,l.jsx)(ek.Z,{className:"h-3 w-3 text-custom-text-300"})}),et&&(0,l.jsxs)(x.fR,{placement:"bottom-end",ellipsis:!0,children:[!r&&(0,l.jsx)(x.fR.MenuItem,{onClick:()=>i(!0),disabled:!W,children:W?(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(x.rK,{className:"h-3 w-3"}),"Archive cycle"]}):(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)(x.rK,{className:"h-3 w-3"}),(0,l.jsxs)("div",{className:"-mt-1",children:[(0,l.jsx)("p",{children:"Archive cycle"}),(0,l.jsxs)("p",{className:"text-xs text-custom-text-400",children:["Only completed cycle ",(0,l.jsx)("br",{})," can be archived."]})]})]})}),r&&(0,l.jsx)(x.fR.MenuItem,{onClick:T,children:(0,l.jsxs)("span",{className:"flex items-center justify-start gap-2",children:[(0,l.jsx)(eC.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:"Restore cycle"})]})}),!W&&(0,l.jsx)(x.fR.MenuItem,{onClick:()=>{f("CYCLE_PAGE_SIDEBAR"),d(!0)},children:(0,l.jsxs)("span",{className:"flex items-center justify-start gap-2",children:[(0,l.jsx)(eS.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:"Delete cycle"})]})})]})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-3 pt-2",children:[(0,l.jsx)("div",{className:"flex items-center gap-5",children:G&&(0,l.jsx)("span",{className:"flex h-6 w-20 items-center justify-center rounded-sm text-center text-xs",style:{color:G.color,backgroundColor:"".concat(G.color,"20")},children:"current"===G.value&&void 0!==ee?"".concat(ee," ").concat(G.label):"".concat(G.label)})}),(0,l.jsx)("h4",{className:"w-full break-words text-xl font-semibold text-custom-text-100",children:I.name})]}),I.description&&(0,l.jsx)(x.Kx,{className:"outline-none ring-none w-full max-h-max bg-transparent !p-0 !m-0 !border-0 resize-none text-sm leading-5 text-custom-text-200",value:I.description,disabled:!0}),(0,l.jsxs)("div",{className:"flex flex-col gap-5 pb-6 pt-2.5",children:[(0,l.jsxs)("div",{className:"flex items-center justify-start gap-1",children:[(0,l.jsxs)("div",{className:"flex w-2/5 items-center justify-start gap-2 text-custom-text-300",children:[(0,l.jsx)(e_.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-base",children:"Date range"})]}),(0,l.jsx)("div",{className:"h-7 w-3/5",children:(0,l.jsx)(eN.Qr,{control:R,name:"start_date",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(eN.Qr,{control:R,name:"end_date",render:e=>{let{field:{value:n,onChange:a}}=e;return(0,l.jsx)(A.CF,{className:"h-7",buttonContainerClassName:"w-full",buttonVariant:"background-with-text",minDate:new Date,value:{from:(0,y._3)(t),to:(0,y._3)(n)},onSelect:e=>{s((null==e?void 0:e.from)?(0,y.ss)(e.from):null),a((null==e?void 0:e.to)?(0,y.ss)(e.to):null),z(null==e?void 0:e.from,null==e?void 0:e.to)},placeholder:{from:"Start date",to:"End date"},required:"draft"!==I.status,disabled:!et||r})}})}})})]}),(0,l.jsxs)("div",{className:"flex items-center justify-start gap-1",children:[(0,l.jsxs)("div",{className:"flex w-2/5 items-center justify-start gap-2 text-custom-text-300",children:[(0,l.jsx)(eI.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-base",children:"Lead"})]}),(0,l.jsx)("div",{className:"flex w-3/5 items-center rounded-sm",children:(0,l.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,l.jsx)(x.qE,{name:null==P?void 0:P.display_name,src:null==P?void 0:P.avatar}),(0,l.jsx)("span",{className:"text-sm text-custom-text-200",children:null==P?void 0:P.display_name})]})})]}),(0,l.jsxs)("div",{className:"flex items-center justify-start gap-1",children:[(0,l.jsxs)("div",{className:"flex w-2/5 items-center justify-start gap-2 text-custom-text-300",children:[(0,l.jsx)(x.uQ,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-base",children:"Issues"})]}),(0,l.jsx)("div",{className:"flex w-3/5 items-center",children:(0,l.jsx)("span",{className:"px-1.5 text-sm text-custom-text-300",children:X})})]})]}),(0,l.jsx)("div",{className:"flex flex-col",children:(0,l.jsx)("div",{className:"flex w-full flex-col items-center justify-start gap-2 border-t border-custom-border-200 px-1.5 py-5",children:(0,l.jsx)(el.p,{defaultOpen:!0,children:e=>{var t,s,n,r;let{open:a}=e;return(0,l.jsxs)("div",{className:"relative  flex  h-full w-full flex-col ".concat(a?"":"flex-row"),children:[(0,l.jsxs)(el.p.Button,{className:"flex w-full items-center justify-between gap-2 p-1.5",disabled:!J||!H,children:[(0,l.jsx)("div",{className:"flex items-center justify-start gap-2 text-sm",children:(0,l.jsx)("span",{className:"font-medium text-custom-text-200",children:"Progress"})}),(0,l.jsxs)("div",{className:"flex items-center gap-2.5",children:[Q?(0,l.jsx)("span",{className:"flex h-5 w-9 items-center justify-center rounded bg-amber-500/20 text-xs font-medium text-amber-500",children:Q?"".concat(Q,"%"):""}):"",J&&H?(0,l.jsx)(eE.Z,{className:"h-3 w-3 ".concat(a?"rotate-180 transform":""),"aria-hidden":"true"}):(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(eP.Z,{height:14,width:14,className:"text-custom-text-200"}),(0,l.jsx)("span",{className:"text-xs italic text-custom-text-200",children:(null==I?void 0:I.start_date)&&(null==I?void 0:I.end_date)?"This cycle isn't active yet.":"Invalid date. Please enter valid date."})]})]})]}),(0,l.jsx)(eR.u,{show:a,children:(0,l.jsx)(el.p.Panel,{children:(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[W&&!ew()(I.progress_snapshot)?(0,l.jsx)(l.Fragment,{children:(null===(t=I.progress_snapshot.distribution)||void 0===t?void 0:t.completion_chart)&&I.start_date&&I.end_date&&(0,l.jsxs)("div",{className:"h-full w-full pt-4",children:[(0,l.jsx)("div",{className:"flex  items-start  gap-4 py-2 text-xs",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 text-custom-text-100",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,l.jsx)("span",{className:"h-2.5 w-2.5 rounded-full bg-[#A9BBD0]"}),(0,l.jsx)("span",{children:"Ideal"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,l.jsx)("span",{className:"h-2.5 w-2.5 rounded-full bg-[#4C8FFF]"}),(0,l.jsx)("span",{children:"Current"})]})]})}),(0,l.jsx)("div",{className:"relative h-40 w-80",children:(0,l.jsx)(B.Z,{distribution:null===(s=I.progress_snapshot.distribution)||void 0===s?void 0:s.completion_chart,startDate:I.start_date,endDate:I.end_date,totalIssues:I.progress_snapshot.total_issues})})]})}):(0,l.jsx)(l.Fragment,{children:(null===(n=I.distribution)||void 0===n?void 0:n.completion_chart)&&I.start_date&&I.end_date&&(0,l.jsxs)("div",{className:"h-full w-full pt-4",children:[(0,l.jsx)("div",{className:"flex  items-start  gap-4 py-2 text-xs",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 text-custom-text-100",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,l.jsx)("span",{className:"h-2.5 w-2.5 rounded-full bg-[#A9BBD0]"}),(0,l.jsx)("span",{children:"Ideal"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,l.jsx)("span",{className:"h-2.5 w-2.5 rounded-full bg-[#4C8FFF]"}),(0,l.jsx)("span",{children:"Current"})]})]})}),(0,l.jsx)("div",{className:"relative h-40 w-80",children:(0,l.jsx)(B.Z,{distribution:null===(r=I.distribution)||void 0===r?void 0:r.completion_chart,startDate:I.start_date,endDate:I.end_date,totalIssues:I.total_issues})})]})}),W&&!ew()(I.progress_snapshot)?(0,l.jsx)(l.Fragment,{children:I.progress_snapshot.total_issues>0&&I.progress_snapshot.distribution&&(0,l.jsx)("div",{className:"h-full w-full border-t border-custom-border-200 pt-5",children:(0,l.jsx)(C.R,{distribution:I.progress_snapshot.distribution,groupedIssues:{backlog:I.progress_snapshot.backlog_issues,unstarted:I.progress_snapshot.unstarted_issues,started:I.progress_snapshot.started_issues,completed:I.progress_snapshot.completed_issues,cancelled:I.progress_snapshot.cancelled_issues},totalIssues:I.progress_snapshot.total_issues,isPeekView:!!p,isCompleted:W,filters:L,handleFiltersUpdate:U})})}):(0,l.jsx)(l.Fragment,{children:I.total_issues>0&&I.distribution&&(0,l.jsx)("div",{className:"h-full w-full border-t border-custom-border-200 pt-5",children:(0,l.jsx)(C.R,{distribution:I.distribution,groupedIssues:{backlog:I.backlog_issues,unstarted:I.unstarted_issues,started:I.started_issues,completed:I.completed_issues,cancelled:I.cancelled_issues},totalIssues:I.total_issues,isPeekView:!!p,isCompleted:W,filters:L,handleFiltersUpdate:U})})})]})})})]})}})})})]})]})}),eD=(0,n.Pi)(e=>{var t;let{projectId:s,workspaceSlug:n,isArchived:r=!1}=e,a=(0,_.useRouter)(),{peekCycle:i}=a.query,c=k.useRef(null),{fetchCycleDetails:d,fetchArchivedCycleDetails:u}=(0,o.nv)();return(0,k.useEffect)(()=>{i&&(r?u(n,s,i.toString()):d(n,s,i.toString()))},[u,d,r,i,s,n]),(0,l.jsx)(l.Fragment,{children:i&&(0,l.jsx)("div",{ref:c,className:"flex h-full w-full max-w-[24rem] flex-shrink-0 flex-col gap-3.5 overflow-y-auto border-l border-custom-border-100 bg-custom-sidebar-background-100 px-6 duration-300 fixed md:relative right-0 z-[9]",style:{boxShadow:"0px 1px 4px 0px rgba(0, 0, 0, 0.06), 0px 2px 4px 0px rgba(16, 24, 40, 0.06), 0px 1px 8px -1px rgba(16, 24, 40, 0.06)"},children:(0,l.jsx)(eA,{cycleId:null!==(t=null==i?void 0:i.toString())&&void 0!==t?t:"",handleClose:()=>{delete a.query.peekCycle,a.push({pathname:a.pathname,query:{...a.query}})},isArchived:r})})})});var eM=s(64273),ez=s(1422),eL=s(42683);let eZ=(0,m.Pi)(e=>{var t;let{projectId:s}=e,n=(0,k.useRef)(null),{currentProjectDisplayFilters:r,currentProjectFilters:a,searchQuery:i,updateDisplayFilters:c,updateFilters:d,updateSearchQuery:u}=(0,o.lj)(),{isMobile:m}=(0,X.L)(),[h,p]=(0,k.useState)(""!==i);(0,eL.Z)(n,()=>{h&&""===i.trim()&&p(!1)});let f=null!==(t=null==r?void 0:r.layout)&&void 0!==t?t:"list",v=(0,k.useCallback)((e,t)=>{var l,n;if(!s)return;let r=null!==(l=null==a?void 0:a[e])&&void 0!==l?l:[];Array.isArray(t)?t.forEach(e=>{r.includes(e)?r.splice(r.indexOf(e),1):r.push(e)}):(null==a?void 0:null===(n=a[e])||void 0===n?void 0:n.includes(t))?r.splice(r.indexOf(t),1):r.push(t),d(s,{[e]:r})},[a,s,d]),g=0!==(0,ez.w)(null!=a?a:{});return(0,l.jsxs)("div",{className:"h-[50px] flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 border-b border-custom-border-200 px-6 sm:pb-0",children:[(0,l.jsx)(T.O.List,{as:"div",className:"flex items-center overflow-x-scroll",children:Z.pT.map(e=>(0,l.jsx)(T.O,{className:e=>{let{selected:t}=e;return"border-b-2 p-4 text-sm font-medium outline-none ".concat(t?"border-custom-primary-100 text-custom-primary-100":"border-transparent")},children:e.name},e.key))}),(null==r?void 0:r.active_tab)!=="active"&&(0,l.jsxs)("div",{className:"hidden h-full sm:flex items-center gap-3 self-end",children:[!h&&(0,l.jsx)("button",{type:"button",className:"-mr-5 p-2 hover:bg-custom-background-80 rounded text-custom-text-400 grid place-items-center",onClick:()=>{var e;p(!0),null===(e=n.current)||void 0===e||e.focus()},children:(0,l.jsx)(ei.Z,{className:"h-3.5 w-3.5"})}),(0,l.jsxs)("div",{className:(0,z.cn)("ml-auto flex items-center justify-start gap-1 rounded-md border border-transparent bg-custom-background-100 text-custom-text-400 w-0 transition-[width] ease-linear overflow-hidden opacity-0",{"w-64 px-2.5 py-1.5 border-custom-border-200 opacity-100":h}),children:[(0,l.jsx)(ei.Z,{className:"h-3.5 w-3.5"}),(0,l.jsx)("input",{ref:n,className:"w-full max-w-[234px] border-none bg-transparent text-sm text-custom-text-100 placeholder:text-custom-text-400 focus:outline-none",placeholder:"Search",value:i,onChange:e=>u(e.target.value),onKeyDown:e=>{if("Escape"===e.key){if(i&&""!==i.trim())u("");else{var t;p(!1),null===(t=n.current)||void 0===t||t.blur()}}}}),h&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>{u(""),p(!1)},children:(0,l.jsx)(V.Z,{className:"h-3 w-3"})})]}),(0,l.jsx)(er.lqY,{icon:(0,l.jsx)(eM.Z,{className:"h-3 w-3"}),title:"Filters",placement:"bottom-end",isFiltersApplied:g,children:(0,l.jsx)(eo,{filters:null!=a?a:{},handleFiltersUpdate:v})}),(0,l.jsx)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1",children:Z.UY.map(e=>(0,l.jsx)(x.u,{tooltipContent:e.title,isMobile:m,children:(0,l.jsx)("button",{type:"button",className:"group grid h-[22px] w-7 place-items-center overflow-hidden rounded transition-all hover:bg-custom-background-100 ".concat(f==e.key?"bg-custom-background-100 shadow-custom-shadow-2xs":""),onClick:()=>c(s,{layout:e.key}),children:(0,l.jsx)(e.icon,{strokeWidth:2,className:"h-3.5 w-3.5 ".concat(f==e.key?"text-custom-text-100":"text-custom-text-200")})})},e.key))})]})]})}),eq=(0,n.Pi)(e=>{let{isOpen:t,handleClose:s,cycle:n,workspaceSlug:r,projectId:a}=e,[i,c]=(0,k.useState)(!1),{captureCycleEvent:d}=(0,o.DN)(),{deleteCycle:u}=(0,o.nv)(),m=(0,_.useRouter)(),{cycleId:h,peekCycle:p}=m.query,f=async()=>{if(n){c(!0);try{await u(r,a,n.id).then(()=>{(0,x.fz)({type:x.do.SUCCESS,title:"Success!",message:"Cycle deleted successfully."}),d({eventName:E.yr,payload:{...n,state:"SUCCESS"}})}).catch(()=>{d({eventName:E.yr,payload:{...n,state:"FAILED"}})}),(h||p)&&m.push("/".concat(r,"/projects/").concat(a,"/cycles")),s()}catch(e){(0,x.fz)({type:x.do.ERROR,title:"Warning!",message:"Something went wrong please try again later."})}c(!1)}};return(0,l.jsx)(C.qv,{handleClose:s,handleSubmit:f,isDeleting:i,isOpen:t,title:"Delete Cycle",content:(0,l.jsxs)(l.Fragment,{children:["Are you sure you want to delete cycle",' "',(0,l.jsx)("span",{className:"break-words font-medium text-custom-text-100",children:null==n?void 0:n.name}),'"',"? All of the data related to the cycle will be permanently removed. This action cannot be undone."]})})});var eB=s(26313);let eU={name:"",description:"",start_date:null,end_date:null},eV=e=>{var t;let{handleFormSubmit:s,handleClose:n,status:r,projectId:a,setActiveProject:i,data:o}=e,{formState:{errors:c,isSubmitting:d,dirtyFields:u},handleSubmit:m,control:h,reset:p}=(0,eN.cI)({defaultValues:{project_id:a,name:(null==o?void 0:o.name)||"",description:(null==o?void 0:o.description)||"",start_date:(null==o?void 0:o.start_date)||null,end_date:(null==o?void 0:o.end_date)||null}});return(0,k.useEffect)(()=>{p({...eU,...o})},[o,p]),(0,l.jsxs)("form",{onSubmit:m(e=>s(e,u)),children:[(0,l.jsxs)("div",{className:"space-y-5 p-5",children:[(0,l.jsxs)("div",{className:"flex items-center gap-x-3",children:[!r&&(0,l.jsx)(eN.Qr,{control:h,name:"project_id",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(A.MB,{value:t,onChange:e=>{s(e),i(e)},buttonVariant:"border-with-text",renderCondition:e=>(0,eB.Fn)(e),tabIndex:7})})}}),(0,l.jsxs)("h3",{className:"text-xl font-medium text-custom-text-200",children:[r?"Update":"Create"," Cycle"]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)(eN.Qr,{name:"name",control:h,rules:{required:"Title is required",maxLength:{value:255,message:"Title should be less than 255 characters"}},render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(x.II,{name:"name",type:"text",placeholder:"Title",className:"w-full text-base",value:t,inputSize:"md",onChange:s,hasError:!!(null==c?void 0:c.name),tabIndex:1,autoFocus:!0})}}),(0,l.jsx)("span",{className:"text-xs text-red-500",children:null==c?void 0:null===(t=c.name)||void 0===t?void 0:t.message})]}),(0,l.jsx)("div",{children:(0,l.jsx)(eN.Qr,{name:"description",control:h,render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(x.Kx,{name:"description",placeholder:"Description",className:"w-full text-base resize-none min-h-24",hasError:!!(null==c?void 0:c.description),value:t,onChange:s,tabIndex:2})}})}),(0,l.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:(0,l.jsx)(eN.Qr,{control:h,name:"start_date",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(eN.Qr,{control:h,name:"end_date",render:e=>{let{field:{value:n,onChange:r}}=e;return(0,l.jsx)(A.CF,{buttonVariant:"border-with-text",className:"h-7",minDate:new Date,value:{from:(0,y._3)(t),to:(0,y._3)(n)},onSelect:e=>{s((null==e?void 0:e.from)?(0,y.ss)(e.from):null),r((null==e?void 0:e.to)?(0,y.ss)(e.to):null)},placeholder:{from:"Start date",to:"End date"},hideIcon:{to:!0},tabIndex:3})}})}})})]})]}),(0,l.jsxs)("div",{className:"px-5 py-4 flex items-center justify-end gap-2 border-t-[0.5px] border-custom-border-200",children:[(0,l.jsx)(x.zx,{variant:"neutral-primary",size:"sm",onClick:n,tabIndex:4,children:"Cancel"}),(0,l.jsx)(x.zx,{variant:"primary",size:"sm",type:"submit",loading:d,tabIndex:5,children:o?d?"Updating":"Update Cycle":d?"Creating":"Create Cycle"})]})]})},eW=new eF.K,eK=e=>{let{isOpen:t,handleClose:s,data:n,workspaceSlug:r,projectId:a}=e,[i,c]=(0,k.useState)(null),{captureCycleEvent:d}=(0,o.DN)(),{workspaceProjectIds:u}=(0,o.PY)(),{createCycle:m,updateCycleDetails:h}=(0,o.nv)(),{setValue:p}=(0,S.Z)("cycle_tab","active"),f=async e=>{var t;if(!r||!a)return;let s=null!==(t=e.project_id)&&void 0!==t?t:a.toString();await m(r,s,e).then(e=>{(0,x.fz)({type:x.do.SUCCESS,title:"Success!",message:"Cycle created successfully."}),d({eventName:E.Lf,payload:{...e,state:"SUCCESS"}})}).catch(t=>{var s;(0,x.fz)({type:x.do.ERROR,title:"Error!",message:null!==(s=null==t?void 0:t.detail)&&void 0!==s?s:"Error in creating cycle. Please try again."}),d({eventName:E.Lf,payload:{...e,state:"FAILED"}})})},v=async(e,t,s)=>{var l;if(!r||!a)return;let n=null!==(l=t.project_id)&&void 0!==l?l:a.toString();await h(r,n,e,t).then(e=>{let t=Object.keys(s);d({eventName:E.T7,payload:{...e,changed_properties:t,state:"SUCCESS"}}),(0,x.fz)({type:x.do.SUCCESS,title:"Success!",message:"Cycle updated successfully."})}).catch(e=>{var s;d({eventName:E.T7,payload:{...t,state:"FAILED"}}),(0,x.fz)({type:x.do.ERROR,title:"Error!",message:null!==(s=null==e?void 0:e.detail)&&void 0!==s?s:"Error in updating cycle. Please try again."})})},g=async(e,t)=>{let s=!1;return await eW.cycleDateCheck(r,e,t).then(e=>{s=e.status}),s},j=async(e,t)=>{if(!r||!a)return;let l={...e},i=!0;if(l.start_date&&l.end_date){var o,c;i=(null==n?void 0:n.start_date)&&(null==n?void 0:n.end_date)?await g(null!==(o=l.project_id)&&void 0!==o?o:a,{start_date:l.start_date,end_date:l.end_date,cycle_id:n.id}):await g(null!==(c=l.project_id)&&void 0!==c?c:a,{start_date:l.start_date,end_date:l.end_date})}i?(n?await v(n.id,l,t):await f(l).then(()=>{p("all")}),s()):(0,x.fz)({type:x.do.ERROR,title:"Error!",message:"You already have a cycle on the given dates, if you want to create a draft cycle, remove the dates."})};return(0,k.useEffect)(()=>{var e;if(!t){c(null);return}if(n&&n.project_id){c(n.project_id);return}u&&u.length>0&&!i&&c(null!==(e=null!=a?a:null==u?void 0:u[0])&&void 0!==e?e:null)},[i,n,a,u,t]),(0,l.jsx)(C.QU,{isOpen:t,handleClose:s,position:C.fM.TOP,width:C.j4.XXL,children:(0,l.jsx)(eV,{handleFormSubmit:j,handleClose:s,status:!!n,projectId:null!=i?i:"",setActiveProject:c,data:n})})};var eY=s(62468),eJ=s(37969);let eH=(0,m.Pi)(e=>{var t;let{parentRef:s,cycleId:n,projectId:r,workspaceSlug:a}=e,i=(0,_.useRouter)(),[c,d]=(0,k.useState)(!1),[u,m]=(0,k.useState)(!1),[h,p]=(0,k.useState)(!1),{setTrackElement:f}=(0,o.DN)(),{membership:{currentWorkspaceAllProjectsRole:v}}=(0,o.aF)(),{getCycleById:g,restoreCycle:j}=(0,o.nv)(),b=g(n),y=!!(null==b?void 0:b.archived_at),N=(null==b?void 0:null===(t=b.status)||void 0===t?void 0:t.toLowerCase())==="completed",C=!!v&&v[r]>=Y.MC.MEMBER,S="".concat(a,"/projects/").concat(r,"/cycles/").concat(n),I=async()=>await j(a,r,n).then(()=>{(0,x.fz)({type:x.do.SUCCESS,title:"Restore success",message:"Your cycle can be found in project cycles."}),i.push("/".concat(a,"/projects/").concat(r,"/archives/cycles"))}).catch(()=>(0,x.fz)({type:x.do.ERROR,title:"Error!",message:"Cycle could not be restored. Please try again."})),E=[{key:"edit",title:"Edit",icon:eY.Z,action:()=>{f("Cycles page list layout"),d(!0)},shouldRender:C&&!N&&!y},{key:"open-new-tab",action:()=>window.open("/".concat(S),"_blank"),title:"Open in new tab",icon:eJ.Z,shouldRender:!y},{key:"copy-link",action:()=>(0,w.fQ)(S).then(()=>{(0,x.fz)({type:x.do.SUCCESS,title:"Link Copied!",message:"Cycle link copied to clipboard."})}),title:"Copy link",icon:ek.Z,shouldRender:!y},{key:"archive",action:()=>m(!0),title:"Archive",description:N?void 0:"Only completed cycle can\nbe archived.",icon:x.rK,className:"items-start",iconClassName:"mt-1",shouldRender:C&&!y,disabled:!N},{key:"restore",action:I,title:"Restore",icon:eC.Z,shouldRender:C&&y},{key:"delete",action:()=>{f("Cycles page list layout"),p(!0)},title:"Delete",icon:eS.Z,shouldRender:C&&!N&&!y}];return(0,l.jsxs)(l.Fragment,{children:[b&&(0,l.jsxs)("div",{className:"fixed",children:[(0,l.jsx)(eK,{data:b,isOpen:c,handleClose:()=>d(!1),workspaceSlug:a,projectId:r}),(0,l.jsx)(e3,{workspaceSlug:a,projectId:r,cycleId:n,isOpen:u,handleClose:()=>m(!1)}),(0,l.jsx)(eq,{cycle:b,isOpen:h,handleClose:()=>p(!1),workspaceSlug:a,projectId:r})]}),(0,l.jsx)(x.xV,{parentRef:s,items:E}),(0,l.jsx)(x.fR,{ellipsis:!0,placement:"bottom-end",closeOnSelect:!0,children:E.map(e=>!1===e.shouldRender?null:(0,l.jsxs)(x.fR.MenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.action()},className:(0,z.cn)("flex items-center gap-2",{"text-custom-text-400":e.disabled},e.className),disabled:e.disabled,children:[e.icon&&(0,l.jsx)(e.icon,{className:(0,z.cn)("h-3 w-3",e.iconClassName)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:e.title}),e.description&&(0,l.jsx)("p",{className:(0,z.cn)("text-custom-text-300 whitespace-pre-line",{"text-custom-text-400":e.disabled}),children:e.description})]})]},e.key))})]})});var eQ=s(15455);let eG=(0,n.Pi)(e=>{let{isOpen:t,handleClose:s}=e,[n,r]=(0,k.useState)(""),{currentProjectIncompleteCycleIds:a,getCycleById:i}=(0,o.nv)(),{issues:{transferIssuesFromCycle:c}}=(0,o.gk)(M.rS.CYCLE),{workspaceSlug:d,projectId:u,cycleId:m}=(0,_.useRouter)().query,h=async e=>{d&&u&&m&&await c(d.toString(),u.toString(),m.toString(),e).then(()=>{(0,x.fz)({type:x.do.SUCCESS,title:"Success!",message:"Issues have been transferred successfully"})}).catch(()=>{(0,x.fz)({type:x.do.ERROR,title:"Error!",message:"Issues cannot be transfer. Please try again."})})},p=null==a?void 0:a.filter(e=>{var t;let s=i(e);return null==s?void 0:null===(t=s.name)||void 0===t?void 0:t.toLowerCase().includes(null==n?void 0:n.toLowerCase())});return(0,l.jsx)(eR.u.Root,{show:t,as:k.Fragment,children:(0,l.jsxs)(eQ.V,{as:"div",className:"relative z-20",onClose:s,children:[(0,l.jsx)(eR.u.Child,{as:k.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-10",children:(0,l.jsx)("div",{className:"mt-10 flex min-h-full items-start justify-center p-4 text-center sm:p-0 md:mt-20",children:(0,l.jsx)(eR.u.Child,{as:k.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,l.jsx)(eQ.V.Panel,{className:"relative transform rounded-lg bg-custom-background-100 py-5 text-left shadow-custom-shadow-md transition-all sm:w-full sm:max-w-2xl",children:(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-5",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(x.lA,{className:"h-4 w-4",color:"#495057"}),(0,l.jsx)("h4",{className:"text-xl font-medium text-custom-text-100",children:"Transfer Issues"})]}),(0,l.jsx)("button",{onClick:s,children:(0,l.jsx)(V.Z,{className:"h-4 w-4"})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 border-b border-custom-border-200 px-5 pb-3",children:[(0,l.jsx)(ei.Z,{className:"h-4 w-4 text-custom-text-200"}),(0,l.jsx)("input",{className:"bg-custom-background-90 outline-none",placeholder:"Search for a cycle...",onChange:e=>r(e.target.value),value:n})]}),(0,l.jsx)("div",{className:"flex w-full flex-col items-start gap-2 px-5",children:p?p.length>0?p.map(e=>{let t=i(e);if(t)return(0,l.jsxs)("button",{className:"flex w-full items-center gap-4 rounded px-4 py-3 text-sm text-custom-text-200 hover:bg-custom-background-90",onClick:()=>{h({new_cycle_id:e}),s()},children:[(0,l.jsx)(x.sI,{className:"h-5 w-5"}),(0,l.jsxs)("div",{className:"flex w-full justify-between",children:[(0,l.jsx)("span",{children:null==t?void 0:t.name}),t.status&&(0,l.jsx)("span",{className:" flex items-center rounded-full bg-custom-background-80  px-2 capitalize",children:t.status.toLocaleLowerCase()})]})]},e)}):(0,l.jsxs)("div",{className:"flex w-full items-center justify-center gap-4 p-5 text-sm",children:[(0,l.jsx)(eP.Z,{className:"h-3.5 w-3.5 text-custom-text-200"}),(0,l.jsx)("span",{className:"text-center text-custom-text-200",children:"You dont have any current cycle. Please create one to transfer the issues."})]}):(0,l.jsx)("p",{className:"text-center text-custom-text-200",children:"Loading..."})})]})})})})})]})})}),e$=new eF.K,eX=e=>{let{handleClick:t,disabled:s=!1}=e,{workspaceSlug:n,projectId:r,cycleId:a}=(0,_.useRouter)().query,{data:i}=(0,p.ZP)(a?(0,D.BN)(a):null,n&&r&&a?()=>e$.getCycleDetails(n,r,a):null),o=i?i.backlog_issues+i.unstarted_issues+i.started_issues:0;return(0,l.jsxs)("div",{className:"-mt-2 mb-4 flex items-center justify-between px-4 pt-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-custom-text-200",children:[(0,l.jsx)(eP.Z,{className:"h-3.5 w-3.5 text-custom-text-200"}),(0,l.jsx)("span",{children:"Completed cycles are not editable."})]}),ew()(null==i?void 0:i.progress_snapshot)&&o>0&&(0,l.jsx)("div",{children:(0,l.jsx)(x.zx,{variant:"primary",prependIcon:(0,l.jsx)(x.lA,{color:"white"}),onClick:t,disabled:s,children:"Transfer Issues"})})]})},e0=(0,n.Pi)(()=>{var e;let{workspaceSlug:t,projectId:s}=(0,_.useRouter)().query,{fetchArchivedCycles:n,currentProjectArchivedCycleIds:r,loader:a}=(0,o.nv)(),{clearAllFilters:c,currentProjectArchivedFilters:d,updateFilters:u}=(0,o.lj)(),m=null!==(e=null==r?void 0:r.length)&&void 0!==e?e:0;return((0,p.ZP)(t&&s?"ARCHIVED_CYCLES_".concat(t.toString(),"_").concat(s.toString()):null,async()=>{t&&s&&await n(t.toString(),s.toString())},{revalidateIfStale:!1,revalidateOnFocus:!1}),t&&s)?a||!r?(0,l.jsx)(i.ci,{}):(0,l.jsxs)(l.Fragment,{children:[0!==(0,ez.w)(null!=d?d:{})&&(0,l.jsx)("div",{className:"border-b border-custom-border-200 px-5 py-3",children:(0,l.jsx)(H,{appliedFilters:null!=d?d:{},handleClearAllFilters:()=>c(s.toString(),"archived"),handleRemoveFilter:(e,t)=>{var l;if(!s)return;let n=null!==(l=null==d?void 0:d[e])&&void 0!==l?l:[];n=t?n.filter(e=>e!==t):[],u(s.toString(),{[e]:n},"archived")}})}),0===m?(0,l.jsx)("div",{className:"h-full place-items-center",children:(0,l.jsx)(f.ub,{type:v.C.PROJECT_ARCHIVED_NO_CYCLES})}):(0,l.jsx)("div",{className:"relative h-full w-full overflow-auto",children:(0,l.jsx)(e1,{workspaceSlug:t.toString(),projectId:s.toString()})})]}):(0,l.jsx)(l.Fragment,{})}),e1=(0,n.Pi)(e=>{let{workspaceSlug:t,projectId:s}=e,{getFilteredArchivedCycleIds:n,loader:r}=(0,o.nv)(),{archivedCyclesSearchQuery:u}=(0,o.lj)(),m=n(s);return r||!m?(0,l.jsx)(i.ci,{}):0===m.length?(0,l.jsx)("div",{className:"h-full w-full grid place-items-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(a(),{src:""===u.trim()?c:d,className:"h-36 sm:h-48 w-36 sm:w-48 mx-auto",alt:"No matching cycles"}),(0,l.jsx)("h5",{className:"text-xl font-medium mt-7 mb-1",children:"No matching cycles"}),(0,l.jsx)("p",{className:"text-custom-text-400 text-base",children:""===u.trim()?"Remove the filters to see all cycles":"Remove the search criteria to see all cycles"})]})}):(0,l.jsx)(ej,{completedCycleIds:[],cycleIds:m,workspaceSlug:t,projectId:s,isArchived:!0})});var e2=s(42903);let e5=(0,n.Pi)(()=>{let{projectId:e}=(0,_.useRouter)().query,t=(0,k.useRef)(null),{currentProjectArchivedFilters:s,archivedCyclesSearchQuery:n,updateFilters:r,updateArchivedCyclesSearchQuery:a}=(0,o.lj)(),[i,c]=(0,k.useState)(""!==n);(0,eL.Z)(t,()=>{i&&""===n.trim()&&c(!1)});let d=(0,k.useCallback)((t,l)=>{var n,a;if(!e)return;let i=null!==(n=null==s?void 0:s[t])&&void 0!==n?n:[];Array.isArray(l)?l.forEach(e=>{i.includes(e)?i.splice(i.indexOf(e),1):i.push(e)}):(null==s?void 0:null===(a=s[t])||void 0===a?void 0:a.includes(l))?i.splice(i.indexOf(l),1):i.push(l),r(e.toString(),{[t]:i},"archived")},[s,e,r]),u=0!==(0,ez.w)(null!=s?s:{});return(0,l.jsxs)("div",{className:"group relative flex border-b border-custom-border-200",children:[(0,l.jsx)("div",{className:"flex w-full items-center overflow-x-auto px-4 gap-2 horizontal-scrollbar scrollbar-sm",children:(0,l.jsx)(e2.o,{})}),(0,l.jsxs)("div",{className:"h-full flex items-center gap-3 self-end px-8",children:[!i&&(0,l.jsx)("button",{type:"button",className:"-mr-5 p-2 hover:bg-custom-background-80 rounded text-custom-text-400 grid place-items-center",onClick:()=>{var e;c(!0),null===(e=t.current)||void 0===e||e.focus()},children:(0,l.jsx)(ei.Z,{className:"h-3.5 w-3.5"})}),(0,l.jsxs)("div",{className:(0,z.cn)("ml-auto flex items-center justify-start gap-1 rounded-md border border-transparent bg-custom-background-100 text-custom-text-400 w-0 transition-[width] ease-linear overflow-hidden opacity-0",{"w-64 px-2.5 py-1.5 border-custom-border-200 opacity-100":i}),children:[(0,l.jsx)(ei.Z,{className:"h-3.5 w-3.5"}),(0,l.jsx)("input",{ref:t,className:"w-full max-w-[234px] border-none bg-transparent text-sm text-custom-text-100 placeholder:text-custom-text-400 focus:outline-none",placeholder:"Search",value:n,onChange:e=>a(e.target.value),onKeyDown:e=>{if("Escape"===e.key){if(n&&""!==n.trim())a("");else{var s;c(!1),null===(s=t.current)||void 0===s||s.blur()}}}}),i&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>{a(""),c(!1)},children:(0,l.jsx)(V.Z,{className:"h-3 w-3"})})]}),(0,l.jsx)(er.lqY,{icon:(0,l.jsx)(eM.Z,{className:"h-3 w-3"}),title:"Filters",placement:"bottom-end",isFiltersApplied:u,children:(0,l.jsx)(eo,{filters:null!=s?s:{},handleFiltersUpdate:d,isArchived:!0})})]})]})}),e3=e=>{let{workspaceSlug:t,projectId:s,cycleId:n,isOpen:r,handleClose:a}=e,i=(0,_.useRouter)(),[c,d]=(0,k.useState)(!1),{getCycleNameById:u,archiveCycle:m}=(0,o.nv)(),h=u(n),p=()=>{d(!1),a()},f=async()=>{d(!0),await m(t,s,n).then(()=>{(0,x.fz)({type:x.do.SUCCESS,title:"Archive success",message:"Your archives can be found in project archives."}),p(),i.push("/".concat(t,"/projects/").concat(s,"/cycles"))}).catch(()=>(0,x.fz)({type:x.do.ERROR,title:"Error!",message:"Cycle could not be archived. Please try again."})).finally(()=>d(!1))};return(0,l.jsx)(eR.u.Root,{show:r,as:k.Fragment,children:(0,l.jsxs)(eQ.V,{as:"div",className:"relative z-20",onClose:p,children:[(0,l.jsx)(eR.u.Child,{as:k.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,l.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,l.jsx)(eR.u.Child,{as:k.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,l.jsx)(eQ.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-full sm:max-w-lg",children:(0,l.jsxs)("div",{className:"px-5 py-4",children:[(0,l.jsxs)("h3",{className:"text-xl font-medium 2xl:text-2xl",children:["Archive cycle ",h]}),(0,l.jsx)("p",{className:"mt-3 text-sm text-custom-text-200",children:"Are you sure you want to archive the cycle? All your archives can be restored later."}),(0,l.jsxs)("div",{className:"mt-3 flex justify-end gap-2",children:[(0,l.jsx)(x.zx,{variant:"neutral-primary",size:"sm",onClick:p,children:"Cancel"}),(0,l.jsx)(x.zx,{size:"sm",tabIndex:1,onClick:f,loading:c,children:c?"Archiving":"Archive"})]})]})})})})})]})})}},36738:function(e,t,s){s.d(t,{_X:function(){return P},qp:function(){return M},CF:function(){return A},ym:function(){return q},Yp:function(){return I},xL:function(){return V},Iw:function(){return Q},MB:function(){return $},sb:function(){return X}});var l=s(24246),n=s(27378),r=s(43659),a=s(65709),i=s(66778),o=s(6780),c=s(10634),d=s(93270),u=s(42683),m=s(25449),h=s(18894);let p=["border-with-text","border-without-text"],x=["background-with-text","background-without-text"],f=["border-without-text","background-without-text","transparent-without-text"],v=["border-with-text","background-with-text","transparent-with-text"],g=e=>{let{children:t,className:s,isActive:n,tooltipContent:r,tooltipHeading:a,showTooltip:i,variant:o}=e,c=p.includes(o)?j:x.includes(o)?b:y;return(0,l.jsx)(c,{className:s,isActive:n,tooltipContent:r,tooltipHeading:a,showTooltip:i,children:t})},j=e=>{let{children:t,className:s,isActive:n,tooltipContent:r,tooltipHeading:a,showTooltip:i}=e,{isMobile:c}=(0,h.L)();return(0,l.jsx)(m.u,{tooltipHeading:a,tooltipContent:r,disabled:!i,isMobile:c,children:(0,l.jsx)("div",{className:(0,o.cn)("h-full flex items-center gap-1.5 border-[0.5px] border-custom-border-300 hover:bg-custom-background-80 rounded text-xs px-2 py-0.5",{"bg-custom-background-80":n},s),children:t})})},b=e=>{let{children:t,className:s,tooltipContent:n,tooltipHeading:r,showTooltip:a}=e,{isMobile:i}=(0,h.L)();return(0,l.jsx)(m.u,{tooltipHeading:r,tooltipContent:n,disabled:!a,isMobile:i,children:(0,l.jsx)("div",{className:(0,o.cn)("h-full flex items-center gap-1.5 rounded text-xs px-2 py-0.5 bg-custom-background-80",s),children:t})})},y=e=>{let{children:t,className:s,isActive:n,tooltipContent:r,tooltipHeading:a,showTooltip:i}=e,{isMobile:c}=(0,h.L)();return(0,l.jsx)(m.u,{tooltipHeading:a,tooltipContent:r,disabled:!i,isMobile:c,children:(0,l.jsx)("div",{className:(0,o.cn)("h-full flex items-center gap-1.5 rounded text-xs px-2 py-0.5 hover:bg-custom-background-80",{"bg-custom-background-80":n},s),children:t})})};var w=s(84563),N=s(50649),k=s(69570),C=s(81630),S=s(1759);let _=(0,N.Pi)(e=>{let{projectId:t,referenceElement:s,placement:r,isOpen:a}=e,[o,d]=(0,n.useState)(""),[u,h]=(0,n.useState)(null),p=(0,n.useRef)(null),{router:{workspaceSlug:x}}=(0,c.IX)(),{getUserDetails:f,project:{getProjectMemberIds:v,fetchProjectMembers:g},workspace:{workspaceMemberIds:j}}=(0,c.Kb)(),{currentUser:b}=(0,c.aF)(),{styles:y,attributes:w}=(0,k.D)(s,u,{placement:null!=r?r:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]});(0,n.useEffect)(()=>{a&&(_(),p.current&&p.current.focus())},[a]);let N=t?v(t):j,_=()=>{!N&&x&&t&&g(x,t)},I=null==N?void 0:N.map(e=>{let t=f(e);return{value:e,query:"".concat(null==t?void 0:t.display_name," ").concat(null==t?void 0:t.first_name," ").concat(null==t?void 0:t.last_name),content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(m.qE,{name:null==t?void 0:t.display_name,src:null==t?void 0:t.avatar}),(0,l.jsx)("span",{className:"flex-grow truncate",children:(null==b?void 0:b.id)===e?"You":null==t?void 0:t.display_name})]})}}),E=""===o?I:null==I?void 0:I.filter(e=>e.query.toLowerCase().includes(o.toLowerCase()));return(0,l.jsx)(i.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsxs)("div",{className:"my-1 w-48 rounded border-[0.5px] border-custom-border-300 bg-custom-background-100 px-2 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none",ref:h,style:y.popper,...w.popper,children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border border-custom-border-100 bg-custom-background-90 px-2",children:[(0,l.jsx)(C.Z,{className:"h-3.5 w-3.5 text-custom-text-400",strokeWidth:1.5}),(0,l.jsx)(i.h.Input,{as:"input",ref:p,className:"w-full bg-transparent py-1 text-xs text-custom-text-200 placeholder:text-custom-text-400 focus:outline-none",value:o,onChange:e=>d(e.target.value),placeholder:"Search",displayValue:e=>null==e?void 0:e.name,onKeyDown:e=>{""!==o&&"Escape"===e.key&&(e.stopPropagation(),d(""))}})]}),(0,l.jsx)("div",{className:"mt-2 max-h-48 space-y-1 overflow-y-scroll",children:E?E.length>0?E.map(e=>(0,l.jsx)(i.h.Option,{value:e.value,className:e=>{let{active:t,selected:s}=e;return"w-full truncate flex items-center justify-between gap-2 rounded px-1 py-1.5 cursor-pointer select-none ".concat(t?"bg-custom-background-80":""," ").concat(s?"text-custom-text-100":"text-custom-text-200")},children:t=>{let{selected:s}=t;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"flex-grow truncate",children:e.content}),s&&(0,l.jsx)(S.Z,{className:"h-3.5 w-3.5 flex-shrink-0"})]})}},e.value)):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"No matching results"}):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"Loading..."})})]})})}),I=(0,r.Pi)(e=>{var t,s;let{button:r,buttonClassName:m,buttonContainerClassName:h,buttonVariant:p,className:x="",disabled:f=!1,dropdownArrow:j=!1,dropdownArrowClassName:b="",hideIcon:y=!1,multiple:N,onChange:k,onClose:C,placeholder:S="Members",tooltipContent:I,placement:E,projectId:P,showTooltip:R=!1,tabIndex:F,value:O}=e,[T,A]=(0,n.useState)(!1),D=(0,n.useRef)(null),[M,z]=(0,n.useState)(null),{getUserDetails:L}=(0,c.Kb)(),Z={value:O,onChange:k,disabled:f};N&&(Z.multiple=!0);let q=()=>{T&&(A(!1),C&&C())},B=()=>{A(e=>!e),T&&C&&C()},U=(0,d.j)(B,q),V=e=>{e.stopPropagation(),e.preventDefault(),B()};return(0,u.Z)(D,q),(0,l.jsxs)(i.h,{as:"div",ref:D,tabIndex:F,className:(0,o.cn)("h-full",x),onChange:e=>{k(e),N||q()},onKeyDown:U,...Z,children:[(0,l.jsx)(i.h.Button,{as:n.Fragment,children:r?(0,l.jsx)("button",{ref:z,type:"button",className:(0,o.cn)("clickable block h-full w-full outline-none",h),onClick:V,children:r}):(0,l.jsx)("button",{ref:z,type:"button",className:(0,o.cn)("clickable block h-full max-w-full outline-none",{"cursor-not-allowed text-custom-text-200":f,"cursor-pointer":!f},h),onClick:V,children:(0,l.jsxs)(g,{className:m,isActive:T,tooltipHeading:S,tooltipContent:null!=I?I:"".concat(null!==(s=null==O?void 0:O.length)&&void 0!==s?s:0," assignee").concat((null==O?void 0:O.length)!==1?"s":""),showTooltip:R,variant:p,children:[!y&&(0,l.jsx)(w.g,{showTooltip:R,userIds:O}),v.includes(p)&&(0,l.jsx)("span",{className:"flex-grow truncate text-xs leading-5",children:Array.isArray(O)&&O.length>0?1===O.length?null===(t=L(O[0]))||void 0===t?void 0:t.display_name:"":S}),j&&(0,l.jsx)(a.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",b),"aria-hidden":"true"})]})})}),T&&(0,l.jsx)(_,{isOpen:T,projectId:P,placement:E,referenceElement:M})]})}),E=(0,N.Pi)(e=>{var t,s;let{projectId:r,isOpen:a,referenceElement:o,placement:d}=e,[u,h]=(0,n.useState)(""),[p,x]=(0,n.useState)(null),f=(0,n.useRef)(null),{router:{workspaceSlug:v}}=(0,c.IX)(),{getProjectCycleIds:g,fetchAllCycles:j,getCycleById:b}=(0,c.nv)();(0,n.useEffect)(()=>{a&&(_(),f.current&&f.current.focus())},[a]);let{styles:y,attributes:w}=(0,k.D)(o,p,{placement:null!=d?d:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),N=null===(t=null!==(s=g(r))&&void 0!==s?s:[])||void 0===t?void 0:t.filter(e=>{let t=b(e);return null==t||!t.status||(null==t?void 0:t.status.toLowerCase())!="completed"}),_=()=>{v&&!N&&j(v,r)},I=null==N?void 0:N.map(e=>{let t=b(e),s=(null==t?void 0:t.status)?t.status.toLocaleLowerCase():"draft";return{value:e,query:"".concat(null==t?void 0:t.name),content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(m.Y7,{cycleGroup:s,className:"h-3.5 w-3.5 flex-shrink-0"}),(0,l.jsx)("span",{className:"flex-grow truncate",children:null==t?void 0:t.name})]})}});null==I||I.unshift({value:null,query:"No cycle",content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(m.sI,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"flex-grow truncate",children:"No cycle"})]})});let E=""===u?I:null==I?void 0:I.filter(e=>e.query.toLowerCase().includes(u.toLowerCase()));return(0,l.jsx)(i.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsxs)("div",{className:"my-1 w-48 rounded border-[0.5px] border-custom-border-300 bg-custom-background-100 px-2 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none",ref:x,style:y.popper,...w.popper,children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border border-custom-border-100 bg-custom-background-90 px-2",children:[(0,l.jsx)(C.Z,{className:"h-3.5 w-3.5 text-custom-text-400",strokeWidth:1.5}),(0,l.jsx)(i.h.Input,{as:"input",ref:f,className:"w-full bg-transparent py-1 text-xs text-custom-text-200 placeholder:text-custom-text-400 focus:outline-none",value:u,onChange:e=>h(e.target.value),placeholder:"Search",displayValue:e=>null==e?void 0:e.name,onKeyDown:e=>{""!==u&&"Escape"===e.key&&(e.stopPropagation(),h(""))}})]}),(0,l.jsx)("div",{className:"mt-2 max-h-48 space-y-1 overflow-y-scroll",children:E?E.length>0?E.map(e=>(0,l.jsx)(i.h.Option,{value:e.value,className:e=>{let{active:t,selected:s}=e;return"w-full truncate flex items-center justify-between gap-2 rounded px-1 py-1.5 cursor-pointer select-none ".concat(t?"bg-custom-background-80":""," ").concat(s?"text-custom-text-100":"text-custom-text-200")},children:t=>{let{selected:s}=t;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"flex-grow truncate",children:e.content}),s&&(0,l.jsx)(S.Z,{className:"h-3.5 w-3.5 flex-shrink-0"})]})}},e.value)):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"No matches found"}):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"Loading..."})})]})})}),P=(0,r.Pi)(e=>{let{button:t,buttonClassName:s,buttonContainerClassName:r,buttonVariant:h,className:p="",disabled:x=!1,dropdownArrow:f=!1,dropdownArrowClassName:j="",hideIcon:b=!1,onChange:y,onClose:w,placeholder:N="",placement:k,projectId:C,showTooltip:S=!1,tabIndex:_,value:I}=e,[P,R]=(0,n.useState)(!1),{getCycleNameById:F}=(0,c.nv)(),O=(0,n.useRef)(null),[T,A]=(0,n.useState)(null),D=I?F(I):null,M=()=>{P&&(R(!1),w&&w())},z=()=>{R(e=>!e),P&&w&&w()},L=(0,d.j)(z,M),Z=e=>{e.stopPropagation(),e.preventDefault(),z()};return(0,u.Z)(O,M),(0,l.jsxs)(i.h,{as:"div",ref:O,tabIndex:_,className:(0,o.cn)("h-full",p),value:I,onChange:e=>{y(e),M()},disabled:x,onKeyDown:L,children:[(0,l.jsx)(i.h.Button,{as:n.Fragment,children:t?(0,l.jsx)("button",{ref:A,type:"button",className:(0,o.cn)("clickable block h-full w-full outline-none hover:bg-custom-background-80",r),onClick:Z,children:t}):(0,l.jsx)("button",{ref:A,type:"button",className:(0,o.cn)("clickable block h-full max-w-full outline-none hover:bg-custom-background-80",{"cursor-not-allowed text-custom-text-200":x,"cursor-pointer":!x},r),onClick:Z,children:(0,l.jsxs)(g,{className:s,isActive:P,tooltipHeading:"Cycle",tooltipContent:null!=D?D:N,showTooltip:S,variant:h,children:[!b&&(0,l.jsx)(m.sI,{className:"h-3 w-3 flex-shrink-0"}),v.includes(h)&&(!!D||!!N)&&(0,l.jsx)("span",{className:"flex-grow truncate max-w-40",children:null!=D?D:N}),f&&(0,l.jsx)(a.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",j),"aria-hidden":"true"})]})})}),P&&(0,l.jsx)(E,{isOpen:P,projectId:C,placement:k,referenceElement:T})]})});var R=s(62153),F=s(17480),O=s(44973),T=s(74273);let A=e=>{let{applyButtonText:t="Apply changes",bothRequired:s=!0,buttonClassName:r,buttonContainerClassName:a,buttonFromDateClassName:c,buttonToDateClassName:h,buttonVariant:p,cancelButtonText:x="Cancel",className:f,disabled:v=!1,hideIcon:j={from:!0,to:!0},icon:b=(0,l.jsx)(F.Z,{className:"h-3 w-3 flex-shrink-0"}),minDate:y,maxDate:w,onSelect:N,placeholder:C={from:"Add date",to:"Add date"},placement:S,required:_=!1,showTooltip:I=!1,tabIndex:E,value:P}=e,[A,D]=(0,n.useState)(!1),[M,z]=(0,n.useState)(P),L=(0,n.useRef)(null),[Z,q]=(0,n.useState)(null),[B,U]=(0,n.useState)(null),{styles:V,attributes:W}=(0,k.D)(Z,B,{placement:null!=S?S:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),K=()=>{Z&&Z.focus()},Y=()=>{A&&(D(!1),z({from:P.from,to:P.to}),Z&&Z.blur())},J=()=>{A||K(),D(e=>!e)},H=(0,d.j)(J,Y);(0,u.Z)(L,Y);let Q=[];return y&&Q.push({before:y}),w&&Q.push({after:w}),(0,n.useEffect)(()=>{z(P)},[P]),(0,l.jsxs)(i.h,{as:"div",ref:L,tabIndex:E,className:(0,o.cn)("h-full",f),onKeyDown:e=>{"Enter"===e.key&&A||H(e)},disabled:v,children:[(0,l.jsx)(i.h.Button,{as:n.Fragment,children:(0,l.jsx)("button",{ref:q,type:"button",className:(0,o.cn)("clickable block h-full max-w-full outline-none",{"cursor-not-allowed text-custom-text-200":v,"cursor-pointer":!v},a),onClick:e=>{e.stopPropagation(),e.preventDefault(),J()},children:(0,l.jsxs)(g,{className:r,isActive:A,tooltipHeading:"Date range",tooltipContent:(0,l.jsxs)(l.Fragment,{children:[M.from?(0,T.ot)(M.from):"N/A"," - ",M.to?(0,T.ot)(M.to):"N/A"]}),showTooltip:I,variant:p,children:[(0,l.jsxs)("span",{className:(0,o.cn)("h-full flex items-center justify-center gap-1 rounded-sm flex-grow",c),children:[!j.from&&b,M.from?(0,T.ot)(M.from):C.from]}),(0,l.jsx)(O.Z,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsxs)("span",{className:(0,o.cn)("h-full flex items-center justify-center gap-1 rounded-sm flex-grow",h),children:[!j.to&&b,M.to?(0,T.ot)(M.to):C.to]})]})})}),A&&(0,l.jsx)(i.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsx)("div",{className:"my-1 bg-custom-background-100 shadow-custom-shadow-rg rounded-md overflow-hidden p-3",ref:U,style:V.popper,...W.popper,children:(0,l.jsx)(R._W,{selected:M,onSelect:e=>{var t,l;s||N(e),z({from:null!==(t=null==e?void 0:e.from)&&void 0!==t?t:void 0,to:null!==(l=null==e?void 0:e.to)&&void 0!==l?l:void 0})},mode:"range",disabled:Q,showOutsideDays:!0,initialFocus:!0,footer:s&&(0,l.jsxs)("div",{className:"grid grid-cols-2 items-center gap-3.5 pt-6 relative",children:[(0,l.jsx)("div",{className:"absolute left-0 top-1 h-[0.5px] w-full border-t-[0.5px] border-custom-border-300"}),(0,l.jsx)(m.zx,{variant:"neutral-primary",onClick:()=>{z({from:void 0,to:void 0}),Y()},children:x}),(0,l.jsx)(m.zx,{onClick:()=>{N(M),Y()},disabled:_?!(M.from&&M.to):!!M.from!=!!M.to,children:t})]})})})})]})};var D=s(82558);let M=e=>{let{buttonClassName:t="",buttonContainerClassName:s,buttonVariant:r,className:a="",clearIconClassName:c="",closeOnSelect:m=!0,disabled:h=!1,hideIcon:p=!1,icon:x=(0,l.jsx)(F.Z,{className:"h-3 w-3 flex-shrink-0"}),isClearable:f=!0,minDate:j,maxDate:b,onChange:y,onClose:w,placeholder:N="Date",placement:C,showTooltip:S=!1,tabIndex:_,value:I}=e,[E,P]=(0,n.useState)(!1),O=(0,n.useRef)(null),[A,M]=(0,n.useState)(null),[z,L]=(0,n.useState)(null),{styles:Z,attributes:q}=(0,k.D)(A,z,{placement:null!=C?C:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),B=I&&""!==I.toString().trim(),U=()=>{A&&A.focus()},V=()=>{E&&(P(!1),A&&A.blur(),w&&w())},W=()=>{E||U(),P(e=>!e),E&&w&&w()},K=e=>{y(e),m&&V()},Y=(0,d.j)(W,V);(0,u.Z)(O,V);let J=[];return j&&J.push({before:j}),b&&J.push({after:b}),(0,l.jsxs)(i.h,{as:"div",ref:O,tabIndex:_,className:(0,o.cn)("h-full",a),onKeyDown:e=>{"Enter"===e.key&&E||Y(e)},disabled:h,children:[(0,l.jsx)(i.h.Button,{as:n.Fragment,children:(0,l.jsx)("button",{type:"button",className:(0,o.cn)("clickable block h-full max-w-full outline-none",{"cursor-not-allowed text-custom-text-200":h,"cursor-pointer":!h},s),ref:M,onClick:e=>{e.stopPropagation(),e.preventDefault(),W()},children:(0,l.jsxs)(g,{className:t,isActive:E,tooltipHeading:N,tooltipContent:I?(0,T.ot)(I):"None",showTooltip:S,variant:r,children:[!p&&x,v.includes(r)&&(0,l.jsx)("span",{className:"flex-grow truncate",children:I?(0,T.ot)(I):N}),f&&!h&&B&&(0,l.jsx)(D.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",c),onClick:e=>{e.stopPropagation(),e.preventDefault(),y(null)}})]})})}),E&&(0,l.jsx)(i.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsx)("div",{className:"my-1 bg-custom-background-100 shadow-custom-shadow-rg rounded-md overflow-hidden p-3",ref:L,style:Z.popper,...q.popper,children:(0,l.jsx)(R._W,{selected:(0,T._3)(I),defaultMonth:(0,T._3)(I),onSelect:e=>{K(null!=e?e:null)},showOutsideDays:!0,initialFocus:!0,disabled:J,mode:"single"})})})]})};var z=s(95099),L=s.n(z),Z=s(73470);let q=(0,r.Pi)(e=>{var t,s;let{button:r,buttonClassName:m,buttonContainerClassName:h,buttonVariant:p,className:x="",disabled:f=!1,dropdownArrow:j=!1,dropdownArrowClassName:b="",hideIcon:y=!1,onChange:w,onClose:N,placeholder:_="",placement:I,projectId:E,showTooltip:P=!1,tabIndex:R,value:F}=e,[O,T]=(0,n.useState)(""),[A,D]=(0,n.useState)(!1),M=(0,n.useRef)(null),z=(0,n.useRef)(null),[q,B]=(0,n.useState)(null),[U,V]=(0,n.useState)(null),{styles:W,attributes:K}=(0,k.D)(q,U,{placement:null!=I?I:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),{router:{workspaceSlug:Y}}=(0,c.IX)(),{fetchProjectEstimates:J,getProjectActiveEstimateDetails:H,getEstimatePointValue:Q}=(0,c.ZT)(),G=H(E),$=null===(t=L()(null!==(s=null==G?void 0:G.points)&&void 0!==s?s:[],"key"))||void 0===t?void 0:t.map(e=>({value:e.key,query:"".concat(null==e?void 0:e.value),content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(Z.Z,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"flex-grow truncate",children:e.value})]})}));null==$||$.unshift({value:null,query:"No estimate",content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(Z.Z,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"flex-grow truncate",children:"No estimate"})]})});let X=""===O?$:null==$?void 0:$.filter(e=>e.query.toLowerCase().includes(O.toLowerCase())),ee=null!==F?Q(F,E):null,et=()=>{!G&&Y&&J(Y,E)},es=()=>{A&&(D(!1),N&&N())},el=()=>{A||et(),D(e=>!e),A&&N&&N()},en=(0,d.j)(el,es),er=e=>{e.stopPropagation(),e.preventDefault(),el()};return(0,u.Z)(M,es),(0,n.useEffect)(()=>{A&&z.current&&z.current.focus()},[A]),(0,l.jsxs)(i.h,{as:"div",ref:M,tabIndex:R,className:(0,o.cn)("h-full w-full",x),value:F,onChange:e=>{w(e),es()},disabled:f,onKeyDown:en,children:[(0,l.jsx)(i.h.Button,{as:n.Fragment,children:r?(0,l.jsx)("button",{ref:B,type:"button",className:(0,o.cn)("clickable block h-full w-full outline-none",h),onClick:er,children:r}):(0,l.jsx)("button",{ref:B,type:"button",className:(0,o.cn)("clickable block h-full max-w-full outline-none",{"cursor-not-allowed text-custom-text-200":f,"cursor-pointer":!f},h),onClick:er,children:(0,l.jsxs)(g,{className:m,isActive:A,tooltipHeading:"Estimate",tooltipContent:null!==ee?ee:_,showTooltip:P,variant:p,children:[!y&&(0,l.jsx)(Z.Z,{className:"h-3 w-3 flex-shrink-0"}),(ee||_)&&v.includes(p)&&(0,l.jsx)("span",{className:"flex-grow truncate",children:null!==ee?ee:_}),j&&(0,l.jsx)(a.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",b),"aria-hidden":"true"})]})})}),A&&(0,l.jsx)(i.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsxs)("div",{className:"my-1 w-48 rounded border-[0.5px] border-custom-border-300 bg-custom-background-100 px-2 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none",ref:V,style:W.popper,...K.popper,children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border border-custom-border-100 bg-custom-background-90 px-2",children:[(0,l.jsx)(C.Z,{className:"h-3.5 w-3.5 text-custom-text-400",strokeWidth:1.5}),(0,l.jsx)(i.h.Input,{as:"input",ref:z,className:"w-full bg-transparent py-1 text-xs text-custom-text-200 placeholder:text-custom-text-400 focus:outline-none",value:O,onChange:e=>T(e.target.value),placeholder:"Search",displayValue:e=>null==e?void 0:e.name,onKeyDown:e=>{""!==O&&"Escape"===e.key&&(e.stopPropagation(),T(""))}})]}),(0,l.jsx)("div",{className:"mt-2 max-h-48 space-y-1 overflow-y-scroll",children:X?X.length>0?X.map(e=>(0,l.jsx)(i.h.Option,{value:e.value,className:e=>{let{active:t,selected:s}=e;return"w-full truncate flex items-center justify-between gap-2 rounded px-1 py-1.5 cursor-pointer select-none ".concat(t?"bg-custom-background-80":""," ").concat(s?"text-custom-text-100":"text-custom-text-200")},children:t=>{let{selected:s}=t;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"flex-grow truncate",children:e.content}),s&&(0,l.jsx)(S.Z,{className:"h-3.5 w-3.5 flex-shrink-0"})]})}},e.value)):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"No matching results"}):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"Loading..."})})]})})]})}),B=(0,N.Pi)(e=>{let{projectId:t,isOpen:s,referenceElement:r,placement:a,multiple:d}=e,[u,h]=(0,n.useState)(""),[p,x]=(0,n.useState)(null),f=(0,n.useRef)(null),{router:{workspaceSlug:v}}=(0,c.IX)(),{getProjectModuleIds:g,fetchModules:j,getModuleById:b}=(0,c.b7)();(0,n.useEffect)(()=>{s&&(_(),f.current&&f.current.focus())},[s]);let{styles:y,attributes:w}=(0,k.D)(r,p,{placement:null!=a?a:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),N=g(t),_=()=>{v&&!N&&j(v,t)},I=null==N?void 0:N.map(e=>{let t=b(e);return{value:e,query:"".concat(null==t?void 0:t.name),content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(m.kB,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"flex-grow truncate",children:null==t?void 0:t.name})]})}});d||null==I||I.unshift({value:null,query:"No module",content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(m.kB,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"flex-grow truncate",children:"No module"})]})});let E=""===u?I:null==I?void 0:I.filter(e=>e.query.toLowerCase().includes(u.toLowerCase()));return(0,l.jsx)(i.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsxs)("div",{className:"my-1 w-48 rounded border-[0.5px] border-custom-border-300 bg-custom-background-100 px-2 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none",ref:x,style:y.popper,...w.popper,children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border border-custom-border-100 bg-custom-background-90 px-2",children:[(0,l.jsx)(C.Z,{className:"h-3.5 w-3.5 text-custom-text-400",strokeWidth:1.5}),(0,l.jsx)(i.h.Input,{as:"input",ref:f,className:"w-full bg-transparent py-1 text-xs text-custom-text-200 placeholder:text-custom-text-400 focus:outline-none",value:u,onChange:e=>h(e.target.value),placeholder:"Search",displayValue:e=>null==e?void 0:e.name,onKeyDown:e=>{""!==u&&"Escape"===e.key&&(e.stopPropagation(),h(""))}})]}),(0,l.jsx)("div",{className:"mt-2 max-h-48 space-y-1 overflow-y-scroll",children:E?E.length>0?E.map(e=>(0,l.jsx)(i.h.Option,{value:e.value,className:e=>{let{active:t,selected:s}=e;return(0,o.cn)("w-full truncate flex items-center justify-between gap-2 rounded px-1 py-1.5 cursor-pointer select-none",{"bg-custom-background-80":t,"text-custom-text-100":s,"text-custom-text-200":!s})},children:t=>{let{selected:s}=t;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"flex-grow truncate",children:e.content}),s&&(0,l.jsx)(S.Z,{className:"h-3.5 w-3.5 flex-shrink-0"})]})}},e.value)):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"No matching results"}):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"Loading..."})})]})})}),U=e=>{var t;let{disabled:s,dropdownArrow:n,dropdownArrowClassName:r,hideIcon:i,hideText:d,onChange:u,placeholder:p,showCount:x,showTooltip:f=!1,value:v}=e,{getModuleById:g}=(0,c.b7)(),{isMobile:j}=(0,h.L)();return Array.isArray(v)?(0,l.jsxs)(l.Fragment,{children:[x?(0,l.jsxs)("div",{className:"relative flex items-center gap-1 max-w-full",children:[!i&&(0,l.jsx)(m.kB,{className:"h-3 w-3 flex-shrink-0"}),(v.length>0||!!p)&&(0,l.jsx)("div",{className:"max-w-40 flex-grow truncate",children:v.length>0?1===v.length?"".concat((null===(t=g(v[0]))||void 0===t?void 0:t.name)||"module"):"".concat(v.length," Module").concat(1===v.length?"":"s"):p})]}):v.length>0?(0,l.jsx)("div",{className:"flex max-w-full flex-grow flex-wrap items-center gap-2 truncate py-0.5",children:v.map(e=>{let t=g(e);return(0,l.jsxs)("div",{className:"flex max-w-full items-center gap-1 rounded bg-custom-background-80 px-1.5 py-1 text-custom-text-200",children:[!i&&(0,l.jsx)(m.kB,{className:"h-2.5 w-2.5 flex-shrink-0"}),!d&&(0,l.jsx)(m.u,{tooltipHeading:"Title",tooltipContent:null==t?void 0:t.name,disabled:!f,isMobile:j,children:(0,l.jsx)("span",{className:"max-w-40 flex-grow truncate text-xs font-medium",children:null==t?void 0:t.name})}),!s&&(0,l.jsx)(m.u,{tooltipContent:"Remove",disabled:!f,isMobile:j,children:(0,l.jsx)("button",{type:"button",className:"flex-shrink-0",onClick:()=>{u(v.filter(t=>t!==e))},children:(0,l.jsx)(D.Z,{className:"h-2.5 w-2.5 text-custom-text-300 hover:text-red-500"})})})]},e)})}):(0,l.jsxs)(l.Fragment,{children:[!i&&(0,l.jsx)(m.kB,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"flex-grow truncate text-left",children:p})]}),n&&(0,l.jsx)(a.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",r),"aria-hidden":"true"})]}):(0,l.jsxs)(l.Fragment,{children:[!i&&(0,l.jsx)(m.kB,{className:"h-3 w-3 flex-shrink-0"}),!d&&(0,l.jsx)("span",{className:"flex-grow truncate text-left",children:null!=v?v:p}),n&&(0,l.jsx)(a.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",r),"aria-hidden":"true"})]})},V=(0,r.Pi)(e=>{let{button:t,buttonClassName:s,buttonContainerClassName:r,buttonVariant:a,className:m="",disabled:h=!1,dropdownArrow:p=!1,dropdownArrowClassName:x="",hideIcon:v=!1,multiple:j,onChange:b,onClose:y,placeholder:w="",placement:N,projectId:k,showCount:C=!1,showTooltip:S=!1,tabIndex:_,value:I}=e,[E,P]=(0,n.useState)(!1),R=(0,n.useRef)(null),F=(0,n.useRef)(null),[O,T]=(0,n.useState)(null),{getModuleNameById:A}=(0,c.b7)(),D=()=>{E&&(P(!1),y&&y())},M=()=>{P(e=>!e),E&&y&&y()},z=(0,d.j)(M,D),L=e=>{e.stopPropagation(),e.preventDefault(),M()};(0,u.Z)(R,D);let Z={value:I,onChange:e=>{b(e),j||D()},disabled:h};return j&&(Z.multiple=!0),(0,n.useEffect)(()=>{E&&F.current&&F.current.focus()},[E]),(0,l.jsxs)(i.h,{as:"div",ref:R,tabIndex:_,className:(0,o.cn)("h-full",m),onKeyDown:z,...Z,children:[(0,l.jsx)(i.h.Button,{as:n.Fragment,children:t?(0,l.jsx)("button",{ref:T,type:"button",className:(0,o.cn)("clickable block h-full w-full outline-none hover:bg-custom-background-80",r),onClick:L,children:t}):(0,l.jsx)("button",{ref:T,type:"button",className:(0,o.cn)("clickable block h-full max-w-full outline-none hover:bg-custom-background-80",{"cursor-not-allowed text-custom-text-200":h,"cursor-pointer":!h},r),onClick:L,children:(0,l.jsx)(g,{className:s,isActive:E,tooltipHeading:"Module",tooltipContent:Array.isArray(I)?"".concat(I.map(e=>A(e)).toString().replaceAll(",",", ")):"",showTooltip:S,variant:a,children:(0,l.jsx)(U,{disabled:h,dropdownArrow:p,dropdownArrowClassName:x,hideIcon:v,hideText:f.includes(a),placeholder:w,showCount:C,showTooltip:S,value:I,onChange:b})})})}),E&&(0,l.jsx)(B,{isOpen:E,projectId:k,placement:N,referenceElement:O,multiple:j})]})});var W=s(35704),K=s(93997);let Y=e=>{var t;let{className:s,dropdownArrow:n,dropdownArrowClassName:r,hideIcon:i=!1,hideText:c=!1,highlightUrgent:d,priority:u,showTooltip:p}=e,x=K.Ku.find(e=>e.key===u),{isMobile:f}=(0,h.L)();return(0,l.jsx)(m.u,{tooltipHeading:"Priority",tooltipContent:null!==(t=null==x?void 0:x.title)&&void 0!==t?t:"None",disabled:!p,isMobile:f,children:(0,l.jsxs)("div",{className:(0,o.cn)("h-full flex items-center gap-1.5 border-[0.5px] rounded text-xs px-2 py-0.5",{urgent:"bg-red-500/20 text-red-950 border-red-500",high:"bg-orange-500/20 text-orange-950 border-orange-500",medium:"bg-yellow-500/20 text-yellow-950 border-yellow-500",low:"bg-custom-primary-100/20 text-custom-primary-950 border-custom-primary-100",none:"hover:bg-custom-background-80 border-custom-border-300"}[u],{"px-0.5":c,"bg-red-600 border-red-600":"urgent"===u&&c&&d},s),children:[!i&&(0,l.jsx)("div",{className:(0,o.cn)({"bg-red-600 p-1 rounded":"urgent"===u&&!c&&d}),children:(0,l.jsx)(m.bJ,{priority:u,size:12,className:(0,o.cn)("flex-shrink-0",{"h-3.5 w-3.5":c,"translate-x-[0.0625rem]":c&&"high"===u,"translate-x-0.5":c&&"medium"===u,"translate-x-1":c&&"low"===u,"text-white":"urgent"===u&&d})})}),!c&&(0,l.jsx)("span",{className:"flex-grow truncate",children:null==x?void 0:x.title}),n&&(0,l.jsx)(a.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",r),"aria-hidden":"true"})]})})},J=e=>{var t;let{className:s,dropdownArrow:n,dropdownArrowClassName:r,hideIcon:i=!1,hideText:c=!1,highlightUrgent:d,priority:u,showTooltip:p}=e,x=K.Ku.find(e=>e.key===u),{isMobile:f}=(0,h.L)();return(0,l.jsx)(m.u,{tooltipHeading:"Priority",tooltipContent:null!==(t=null==x?void 0:x.title)&&void 0!==t?t:"None",disabled:!p,isMobile:f,children:(0,l.jsxs)("div",{className:(0,o.cn)("h-full flex items-center gap-1.5 rounded text-xs px-2 py-0.5",{urgent:"bg-red-500/20 text-red-950",high:"bg-orange-500/20 text-orange-950",medium:"bg-yellow-500/20 text-yellow-950",low:"bg-blue-500/20 text-blue-950",none:"bg-custom-background-80"}[u],{"px-0.5":c,"bg-red-600 border-red-600":"urgent"===u&&c&&d},s),children:[!i&&(0,l.jsx)("div",{className:(0,o.cn)({"bg-red-600 p-1 rounded":"urgent"===u&&!c&&d}),children:(0,l.jsx)(m.bJ,{priority:u,size:12,className:(0,o.cn)("flex-shrink-0",{"h-3.5 w-3.5":c,"translate-x-[0.0625rem]":c&&"high"===u,"translate-x-0.5":c&&"medium"===u,"translate-x-1":c&&"low"===u,"text-white":"urgent"===u&&d})})}),!c&&(0,l.jsx)("span",{className:"flex-grow truncate",children:null==x?void 0:x.title}),n&&(0,l.jsx)(a.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",r),"aria-hidden":"true"})]})})},H=e=>{var t;let{className:s,dropdownArrow:n,dropdownArrowClassName:r,hideIcon:i=!1,hideText:c=!1,isActive:d=!1,highlightUrgent:u,priority:p,showTooltip:x}=e,f=K.Ku.find(e=>e.key===p),{isMobile:v}=(0,h.L)();return(0,l.jsx)(m.u,{tooltipHeading:"Priority",tooltipContent:null!==(t=null==f?void 0:f.title)&&void 0!==t?t:"None",disabled:!x,isMobile:v,children:(0,l.jsxs)("div",{className:(0,o.cn)("h-full flex items-center gap-1.5 rounded text-xs px-2 py-0.5 hover:bg-custom-background-80",{urgent:"text-red-950",high:"text-orange-950",medium:"text-yellow-950",low:"text-blue-950",none:"hover:text-custom-text-300"}[p],{"px-0.5":c,"bg-red-600 border-red-600":"urgent"===p&&c&&u,"bg-custom-background-80":d},s),children:[!i&&(0,l.jsx)("div",{className:(0,o.cn)({"bg-red-600 p-1 rounded":"urgent"===p&&!c&&u}),children:(0,l.jsx)(m.bJ,{priority:p,size:12,className:(0,o.cn)("flex-shrink-0",{"h-3.5 w-3.5":c,"translate-x-[0.0625rem]":c&&"high"===p,"translate-x-0.5":c&&"medium"===p,"translate-x-1":c&&"low"===p,"text-white":"urgent"===p&&u})})}),!c&&(0,l.jsx)("span",{className:"flex-grow truncate",children:null==f?void 0:f.title}),n&&(0,l.jsx)(a.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",r),"aria-hidden":"true"})]})})},Q=e=>{let{button:t,buttonClassName:s,buttonContainerClassName:r,buttonVariant:a,className:c="",disabled:h=!1,dropdownArrow:v=!1,dropdownArrowClassName:g="",hideIcon:j=!1,highlightUrgent:b=!0,onChange:y,onClose:w,placement:N,showTooltip:_=!1,tabIndex:I,value:E}=e,[P,R]=(0,n.useState)(""),[F,O]=(0,n.useState)(!1),T=(0,n.useRef)(null),A=(0,n.useRef)(null),[D,M]=(0,n.useState)(null),[z,L]=(0,n.useState)(null),{styles:Z,attributes:q}=(0,k.D)(D,z,{placement:null!=N?N:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),{resolvedTheme:B}=(0,W.F)(),U=K.Ku.map(e=>({value:e.key,query:e.key,content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(m.bJ,{priority:e.key,size:14,withContainer:!0}),(0,l.jsx)("span",{className:"flex-grow truncate",children:e.title})]})})),V=""===P?U:U.filter(e=>e.query.toLowerCase().includes(P.toLowerCase())),Q=()=>{F&&(O(!1),w&&w())},G=()=>{O(e=>!e),F&&w&&w()},$=(0,d.j)(G,Q),X=e=>{e.stopPropagation(),e.preventDefault(),G()};(0,u.Z)(T,Q);let ee=p.includes(a)?Y:x.includes(a)?J:H;return(0,n.useEffect)(()=>{F&&A.current&&A.current.focus()},[F]),(0,l.jsxs)(i.h,{as:"div",ref:T,tabIndex:I,className:(0,o.cn)("h-full",{"bg-custom-background-80":F},c),value:E,onChange:e=>{y(e),Q()},disabled:h,onKeyDown:$,children:[(0,l.jsx)(i.h.Button,{as:n.Fragment,children:t?(0,l.jsx)("button",{ref:M,type:"button",className:(0,o.cn)("clickable block h-full w-full outline-none",r),onClick:X,children:t}):(0,l.jsx)("button",{ref:M,type:"button",className:(0,o.cn)("clickable block h-full max-w-full outline-none",{"cursor-not-allowed text-custom-text-200":h,"cursor-pointer":!h},r),onClick:X,children:(0,l.jsx)(ee,{priority:E,className:(0,o.cn)(s,{"text-custom-text-200":(null==B?void 0:B.includes("dark"))||"custom"===B}),highlightUrgent:b,dropdownArrow:v&&!h,dropdownArrowClassName:g,hideIcon:j,showTooltip:_,hideText:f.includes(a)})})}),F&&(0,l.jsx)(i.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsxs)("div",{className:"my-1 w-48 rounded border-[0.5px] border-custom-border-300 bg-custom-background-100 px-2 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none",ref:L,style:Z.popper,...q.popper,children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border border-custom-border-100 bg-custom-background-90 px-2",children:[(0,l.jsx)(C.Z,{className:"h-3.5 w-3.5 text-custom-text-400",strokeWidth:1.5}),(0,l.jsx)(i.h.Input,{as:"input",ref:A,className:"w-full bg-transparent py-1 text-xs text-custom-text-200 placeholder:text-custom-text-400 focus:outline-none",value:P,onChange:e=>R(e.target.value),placeholder:"Search",displayValue:e=>null==e?void 0:e.name,onKeyDown:e=>{""!==P&&"Escape"===e.key&&(e.stopPropagation(),R(""))}})]}),(0,l.jsx)("div",{className:"mt-2 max-h-48 space-y-1 overflow-y-scroll",children:V.length>0?V.map(e=>(0,l.jsx)(i.h.Option,{value:e.value,className:e=>{let{active:t,selected:s}=e;return"w-full truncate flex items-center justify-between gap-2 rounded px-1 py-1.5 cursor-pointer select-none ".concat(t?"bg-custom-background-80":""," ").concat(s?"text-custom-text-100":"text-custom-text-200")},children:t=>{let{selected:s}=t;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"flex-grow truncate",children:e.content}),s&&(0,l.jsx)(S.Z,{className:"h-3.5 w-3.5 flex-shrink-0"})]})}},e.value)):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"No matching results"})})]})})]})};var G=s(91256);let $=(0,r.Pi)(e=>{var t,s;let{button:r,buttonClassName:m,buttonContainerClassName:h,buttonVariant:p,className:x="",disabled:f=!1,dropdownArrow:j=!1,dropdownArrowClassName:b="",hideIcon:y=!1,onChange:w,onClose:N,placeholder:_="Project",placement:I,renderCondition:E,showTooltip:P=!1,tabIndex:R,value:F}=e,[O,T]=(0,n.useState)(""),[A,D]=(0,n.useState)(!1),M=(0,n.useRef)(null),z=(0,n.useRef)(null),[L,Z]=(0,n.useState)(null),[q,B]=(0,n.useState)(null),{styles:U,attributes:V}=(0,k.D)(L,q,{placement:null!=I?I:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),{joinedProjectIds:W,getProjectById:K}=(0,c.PY)(),Y=null==W?void 0:W.map(e=>{let t=K(e);if(!E||!t||E(t))return{value:e,query:"".concat(null==t?void 0:t.name),content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[t&&(0,l.jsx)("span",{className:"grid place-items-center flex-shrink-0 h-4 w-4",children:(0,l.jsx)(G.h0,{logo:null==t?void 0:t.logo_props,className:"text-sm"})}),(0,l.jsx)("span",{className:"flex-grow truncate",children:null==t?void 0:t.name})]})}}),J=""===O?Y:null==Y?void 0:Y.filter(e=>null==e?void 0:e.query.toLowerCase().includes(O.toLowerCase())),H=F?K(F):null,Q=()=>{A&&(D(!1),N&&N())},$=()=>{D(e=>!e)},X=(0,d.j)($,Q),ee=e=>{e.stopPropagation(),e.preventDefault(),$()};return(0,u.Z)(M,Q),(0,n.useEffect)(()=>{A&&z.current&&z.current.focus()},[A]),(0,l.jsxs)(i.h,{as:"div",ref:M,tabIndex:R,className:(0,o.cn)("h-full",x),value:F,onChange:e=>{w(e),Q()},disabled:f,onKeyDown:X,children:[(0,l.jsx)(i.h.Button,{as:n.Fragment,children:r?(0,l.jsx)("button",{ref:Z,type:"button",className:(0,o.cn)("clickable block h-full w-full outline-none",h),onClick:ee,children:r}):(0,l.jsx)("button",{ref:Z,type:"button",className:(0,o.cn)("clickable block h-full max-w-full outline-none",{"cursor-not-allowed text-custom-text-200":f,"cursor-pointer":!f},h),onClick:ee,children:(0,l.jsxs)(g,{className:m,isActive:A,tooltipHeading:"Project",tooltipContent:null!==(t=null==H?void 0:H.name)&&void 0!==t?t:_,showTooltip:P,variant:p,children:[!y&&H&&(0,l.jsx)("span",{className:"grid place-items-center flex-shrink-0 h-4 w-4",children:(0,l.jsx)(G.h0,{logo:H.logo_props,className:"text-sm"})}),v.includes(p)&&(0,l.jsx)("span",{className:"flex-grow truncate max-w-40",children:null!==(s=null==H?void 0:H.name)&&void 0!==s?s:_}),j&&(0,l.jsx)(a.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",b),"aria-hidden":"true"})]})})}),A&&(0,l.jsx)(i.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsxs)("div",{className:"my-1 w-48 rounded border-[0.5px] border-custom-border-300 bg-custom-background-100 px-2 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none",ref:B,style:U.popper,...V.popper,children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border border-custom-border-100 bg-custom-background-90 px-2",children:[(0,l.jsx)(C.Z,{className:"h-3.5 w-3.5 text-custom-text-400",strokeWidth:1.5}),(0,l.jsx)(i.h.Input,{as:"input",ref:z,className:"w-full bg-transparent py-1 text-xs text-custom-text-200 placeholder:text-custom-text-400 focus:outline-none",value:O,onChange:e=>T(e.target.value),placeholder:"Search",displayValue:e=>null==e?void 0:e.name})]}),(0,l.jsx)("div",{className:"mt-2 max-h-48 space-y-1 overflow-y-scroll",children:J?J.length>0?J.map(e=>{if(e)return(0,l.jsx)(i.h.Option,{value:e.value,className:e=>{let{active:t,selected:s}=e;return"w-full truncate flex items-center justify-between gap-2 rounded px-1 py-1.5 cursor-pointer select-none ".concat(t?"bg-custom-background-80":""," ").concat(s?"text-custom-text-100":"text-custom-text-200")},children:t=>{let{selected:s}=t;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"flex-grow truncate",children:e.content}),s&&(0,l.jsx)(S.Z,{className:"h-3.5 w-3.5 flex-shrink-0"})]})}},e.value)}):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"No matching results"}):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"Loading..."})})]})})]})}),X=(0,r.Pi)(e=>{var t,s,r;let{button:h,buttonClassName:p,buttonContainerClassName:x,buttonVariant:f,className:j="",disabled:b=!1,dropdownArrow:y=!1,dropdownArrowClassName:w="",hideIcon:N=!1,onChange:_,onClose:I,placement:E,projectId:P,showTooltip:R=!1,tabIndex:F,value:O}=e,[T,A]=(0,n.useState)(""),[D,M]=(0,n.useState)(!1),[z,L]=(0,n.useState)(!1),Z=(0,n.useRef)(null),q=(0,n.useRef)(null),[B,U]=(0,n.useState)(null),[V,W]=(0,n.useState)(null),{styles:K,attributes:Y}=(0,k.D)(B,V,{placement:null!=E?E:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),{router:{workspaceSlug:J}}=(0,c.IX)(),{fetchProjectStates:H,getProjectStates:Q,getStateById:G}=(0,c.eD)(),$=Q(P),X=null==$?void 0:$.find(e=>e.default),ee=O||(null==X?void 0:X.id),et=null==$?void 0:$.map(e=>({value:e.id,query:"".concat(null==e?void 0:e.name),content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(m.b_,{stateGroup:e.group,color:e.color,className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"flex-grow truncate",children:null==e?void 0:e.name})]})})),es=""===T?et:null==et?void 0:et.filter(e=>e.query.toLowerCase().includes(T.toLowerCase())),el=ee?G(ee):void 0,en=async()=>{!$&&J&&(L(!0),await H(J,P),L(!1))};(0,n.useEffect)(()=>{P&&en()},[P]);let er=()=>{D&&(M(!1),I&&I())},ea=()=>{D||en(),M(e=>!e),D&&I&&I()},ei=(0,d.j)(ea,er),eo=e=>{e.stopPropagation(),e.preventDefault(),ea()};return(0,u.Z)(Z,er),(0,n.useEffect)(()=>{D&&q.current&&q.current.focus()},[D]),(0,l.jsxs)(i.h,{as:"div",ref:Z,tabIndex:F,className:(0,o.cn)("h-full",j),value:ee,onChange:e=>{_(e),er()},disabled:b,onKeyDown:ei,children:[(0,l.jsx)(i.h.Button,{as:n.Fragment,children:h?(0,l.jsx)("button",{ref:U,type:"button",className:(0,o.cn)("clickable block h-full w-full outline-none",x),onClick:eo,children:h}):(0,l.jsx)("button",{ref:U,type:"button",className:(0,o.cn)("clickable block h-full max-w-full outline-none",{"cursor-not-allowed text-custom-text-200":b,"cursor-pointer":!b},x),onClick:eo,children:(0,l.jsx)(g,{className:p,isActive:D,tooltipHeading:"State",tooltipContent:null!==(t=null==el?void 0:el.name)&&void 0!==t?t:"State",showTooltip:R,variant:f,children:z?(0,l.jsx)(m.$j,{className:"w-3.5 h-3.5"}):(0,l.jsxs)(l.Fragment,{children:[!N&&(0,l.jsx)(m.b_,{stateGroup:null!==(s=null==el?void 0:el.group)&&void 0!==s?s:"backlog",color:null==el?void 0:el.color,className:"h-3 w-3 flex-shrink-0"}),v.includes(f)&&(0,l.jsx)("span",{className:"flex-grow truncate",children:null!==(r=null==el?void 0:el.name)&&void 0!==r?r:"State"}),y&&(0,l.jsx)(a.Z,{className:(0,o.cn)("h-2.5 w-2.5 flex-shrink-0",w),"aria-hidden":"true"})]})})})}),D&&(0,l.jsx)(i.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsxs)("div",{className:"my-1 w-48 rounded border-[0.5px] border-custom-border-300 bg-custom-background-100 px-2 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none",ref:W,style:K.popper,...Y.popper,children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border border-custom-border-100 bg-custom-background-90 px-2",children:[(0,l.jsx)(C.Z,{className:"h-3.5 w-3.5 text-custom-text-400",strokeWidth:1.5}),(0,l.jsx)(i.h.Input,{as:"input",ref:q,className:"w-full bg-transparent py-1 text-xs text-custom-text-200 placeholder:text-custom-text-400 focus:outline-none",value:T,onChange:e=>A(e.target.value),placeholder:"Search",displayValue:e=>null==e?void 0:e.name,onKeyDown:e=>{""!==T&&"Escape"===e.key&&(e.stopPropagation(),A(""))}})]}),(0,l.jsx)("div",{className:"mt-2 max-h-48 space-y-1 overflow-y-scroll",children:es?es.length>0?es.map(e=>(0,l.jsx)(i.h.Option,{value:e.value,className:e=>{let{active:t,selected:s}=e;return"w-full truncate flex items-center justify-between gap-2 rounded px-1 py-1.5 cursor-pointer select-none ".concat(t?"bg-custom-background-80":""," ").concat(s?"text-custom-text-100":"text-custom-text-200")},children:t=>{let{selected:s}=t;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"flex-grow truncate",children:e.content}),s&&(0,l.jsx)(S.Z,{className:"h-3.5 w-3.5 flex-shrink-0"})]})}},e.value)):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"No matches found"}):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"Loading..."})})]})})]})})},84563:function(e,t,s){s.d(t,{g:function(){return i}});var l=s(24246),n=s(43659),r=s(25449),a=s(10634);let i=(0,n.Pi)(e=>{let{showTooltip:t,userIds:s}=e,{getUserDetails:n}=(0,a.Kb)();if(Array.isArray(s)){if(s.length>0)return(0,l.jsx)(r.HE,{size:"md",showTooltip:!t,children:s.map(e=>{let t=n(e);if(t)return(0,l.jsx)(r.qE,{src:t.avatar,name:t.display_name},e)})})}else if(s){let e=n(s);return(0,l.jsx)(r.qE,{src:null==e?void 0:e.avatar,name:null==e?void 0:e.display_name,size:"md",showTooltip:!t})}return(0,l.jsx)(r.Ti,{className:"h-3 w-3 flex-shrink-0"})})},16925:function(e,t,s){s.d(t,{KZ:function(){return v},d6:function(){return l.d},WH:function(){return c},LD:function(){return g.L},hh:function(){return j.h}});var l=s(9533),n=s(24246),r=s(27378),a=s(80473),i=s(6780),o=s(10634);let c=r.forwardRef((e,t)=>{let{...s}=e,{mentionHighlights:l}=(0,o.W4)({});return(0,n.jsx)(a.sq,{ref:t,mentionHandler:{highlights:l},...s,containerClassName:(0,i.cn)(s.containerClassName,"relative p-2")})});c.displayName="LiteTextReadOnlyEditor";var d=s(85997),u=s(80372),m=s(25449),h=s(12021),p=s(93997);let x=[{icon:d.Z,key:p.Es.INTERNAL,label:"Private"},{icon:u.Z,key:p.Es.EXTERNAL,label:"Public"}],f=h.O.lite,v=e=>{let{accessSpecifier:t,executeCommand:s,handleAccessChange:l,handleSubmit:a,isCommentEmpty:o,isSubmitting:c,showAccessSpecifier:d,showSubmitButton:u,editorRef:h}=e,[p,v]=(0,r.useState)({}),g=(0,r.useCallback)(()=>{if(null==h?void 0:h.current){let e={};Object.values(f).flat().forEach(t=>{e[t.key]=h.current.isMenuItemActive(t.key)}),v(e)}},[h]);return(0,r.useEffect)(()=>{if(!(null==h?void 0:h.current))return;let e=h.current.onStateChange(g);return g(),()=>e()},[h,g]),(0,n.jsxs)("div",{className:"flex h-9 w-full items-stretch gap-1.5 bg-custom-background-90 overflow-x-scroll",children:[d&&(0,n.jsx)("div",{className:"flex flex-shrink-0 items-stretch gap-0.5 rounded border-[0.5px] border-custom-border-200 p-1",children:x.map(e=>{let s=t===e.key;return(0,n.jsx)(m.u,{tooltipContent:e.label,children:(0,n.jsx)("button",{type:"button",onClick:()=>null==l?void 0:l(e.key),className:(0,i.cn)("grid place-items-center aspect-square rounded-sm p-1 hover:bg-custom-background-80",{"bg-custom-background-80":s}),children:(0,n.jsx)(e.icon,{className:(0,i.cn)("h-3.5 w-3.5 text-custom-text-400",{"text-custom-text-100":s}),strokeWidth:2})})},e.key)})}),(0,n.jsxs)("div",{className:"flex w-full items-stretch justify-between gap-2 rounded border-[0.5px] border-custom-border-200 p-1",children:[(0,n.jsx)("div",{className:"flex items-stretch",children:Object.keys(f).map((e,t)=>(0,n.jsx)("div",{className:(0,i.cn)("flex items-stretch gap-0.5 border-r border-custom-border-200 px-2.5",{"pl-0":0===t,"pr-0":t===Object.keys(f).length-1}),children:f[e].map(e=>(0,n.jsx)(m.u,{tooltipContent:(0,n.jsxs)("p",{className:"flex flex-col gap-1 text-center text-xs",children:[(0,n.jsx)("span",{className:"font-medium",children:e.name}),e.shortcut&&(0,n.jsx)("kbd",{className:"text-custom-text-400",children:e.shortcut.join(" + ")})]}),children:(0,n.jsx)("button",{type:"button",onClick:()=>s(e.key),className:(0,i.cn)("grid place-items-center aspect-square rounded-sm p-0.5 text-custom-text-400 hover:bg-custom-background-80",{"bg-custom-background-80 text-custom-text-100":p[e.key]}),children:(0,n.jsx)(e.icon,{className:(0,i.cn)("h-3.5 w-3.5",{"text-custom-text-100":p[e.key]}),strokeWidth:2.5})})},e.key))},e))}),u&&(0,n.jsx)("div",{className:"sticky right-1",children:(0,n.jsx)(m.zx,{type:"submit",variant:"primary",className:"px-2.5 py-1.5 text-xs",onClick:a,disabled:o,loading:c,children:"Comment"})})]})]})};var g=s(20141),j=s(67972)},9533:function(e,t,s){s.d(t,{d:function(){return u}});var l=s(24246),n=s(27378),r=s(80473),a=s(16925),i=s(6780),o=s(10712),c=s(10634);let d=new(s(44029)).I,u=n.forwardRef((e,t)=>{var s,n,u;let{containerClassName:m,workspaceSlug:h,workspaceId:p,projectId:x,accessSpecifier:f,handleAccessChange:v,showAccessSpecifier:g=!1,showSubmitButton:j=!0,isSubmitting:b=!1,...y}=e,{currentUser:w}=(0,c.aF)(),{getUserDetails:N,project:{getProjectMemberIds:k}}=(0,c.Kb)(),C=k(x),S=null==C?void 0:C.map(e=>N(e)),{mentionHighlights:_,mentionSuggestions:I}=(0,c.W4)({workspaceSlug:h,projectId:x,members:S,user:null!=w?w:void 0}),E=(null===(s=e.initialValue)||void 0===s?void 0:s.trim())===""||"<p></p>"===e.initialValue||(0,o.dn)(null!==(u=e.initialValue)&&void 0!==u?u:"")&&!(null===(n=e.initialValue)||void 0===n?void 0:n.includes("mention-component"));function P(e){return!!e&&"object"==typeof e&&"current"in e}return(0,l.jsxs)("div",{className:"border border-custom-border-200 rounded p-3 space-y-3",children:[(0,l.jsx)(r._j,{ref:t,fileHandler:{upload:d.getUploadFileFunction(h),delete:d.getDeleteImageFunction(p),restore:d.getRestoreImageFunction(p),cancel:d.cancelUpload},mentionHandler:{highlights:_,suggestions:I},...y,containerClassName:(0,i.cn)(m,"relative")}),(0,l.jsx)(a.KZ,{accessSpecifier:f,executeCommand:e=>{if(P(t)){var s;null===(s=t.current)||void 0===s||s.executeMenuItemCommand(e)}},handleAccessChange:v,handleSubmit:e=>{var t;return null===(t=y.onEnterKeyPress)||void 0===t?void 0:t.call(y,e)},isCommentEmpty:E,isSubmitting:b,showAccessSpecifier:g,editorRef:P(t)?t:null,showSubmitButton:j})]})});u.displayName="LiteTextEditor"},20141:function(e,t,s){s.d(t,{L:function(){return c}});var l=s(24246),n=s(27378),r=s(27718),a=s(6780),i=s(10634);let o=new(s(44029)).I,c=(0,n.forwardRef)((e,t)=>{let{containerClassName:s,workspaceSlug:n,workspaceId:c,projectId:d,...u}=e,{currentUser:m}=(0,i.aF)(),{getUserDetails:h,project:{getProjectMemberIds:p}}=(0,i.Kb)(),x=p(d),f=null==x?void 0:x.map(e=>h(e)),{mentionHighlights:v,mentionSuggestions:g}=(0,i.W4)({workspaceSlug:n,projectId:d,members:f,user:null!=m?m:void 0});return(0,l.jsx)(r.Jo,{ref:t,fileHandler:{upload:o.getUploadFileFunction(n),delete:o.getDeleteImageFunction(c),restore:o.getRestoreImageFunction(c),cancel:o.cancelUpload},mentionHandler:{highlights:v,suggestions:g},...u,containerClassName:(0,a.cn)("relative pl-3",s)})});c.displayName="RichTextEditor"},95633:function(e,t,s){s.d(t,{p1:function(){return P},MW:function(){return $},dO:function(){return ec},Lj:function(){return R},qj:function(){return E},VR:function(){return L},HW:function(){return B},TB:function(){return X},Jf:function(){return ef},tF:function(){return F},AN:function(){return em},sW:function(){return ex},ey:function(){return O},t7:function(){return T},Dm:function(){return A},dB:function(){return D}});var l=s(24246),n=s(50649),r=s(6780),a=s(74273),i=s(10634),o=s(27378),c=s(64083),d=s(47542),u=s(25449),m=s(18894),h=s(79588),p=s(98315);let x=[{key:0,shortTitle:"sun",title:"sunday"},{key:1,shortTitle:"mon",title:"monday"},{key:2,shortTitle:"tue",title:"tuesday"},{key:3,shortTitle:"wed",title:"wednesday"},{key:4,shortTitle:"thurs",title:"thursday"},{key:5,shortTitle:"fri",title:"friday"},{key:6,shortTitle:"sat",title:"saturday"}],f=[{key:0,shortTitle:"jan",title:"january"},{key:1,shortTitle:"feb",title:"february"},{key:2,shortTitle:"mar",title:"march"},{key:3,shortTitle:"apr",title:"april"},{key:4,shortTitle:"may",title:"may"},{key:5,shortTitle:"jun",title:"june"},{key:6,shortTitle:"jul",title:"july"},{key:7,shortTitle:"aug",title:"august"},{key:8,shortTitle:"sept",title:"september"},{key:9,shortTitle:"oct",title:"october"},{key:10,shortTitle:"nov",title:"november"},{key:11,shortTitle:"dec",title:"december"}],v=[{key:"month",title:"Month",data:{startDate:new Date,currentDate:new Date,endDate:new Date,approxFilterRange:6,width:55}}],g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"month";return v.find(t=>t.key===e)};class j{constructor(){this.currentView="month",this.currentViewData=void 0,this.activeBlockId=null,this.renderView=[],this.isBlockActive=(0,p.Om)(e=>this.activeBlockId===e),this.updateCurrentView=e=>{this.currentView=e},this.updateCurrentViewData=e=>{this.currentViewData=e},this.updateActiveBlockId=e=>{this.activeBlockId=e},this.updateRenderView=e=>{this.renderView=e},this.initGantt=()=>{let e=g(this.currentView);(0,h.z)(()=>{this.currentViewData=e})},(0,h.rC)(this,{currentView:h.LO.ref,currentViewData:h.LO,activeBlockId:h.LO.ref,renderView:h.LO,updateCurrentView:h.aD.bound,updateCurrentViewData:h.aD.bound,updateActiveBlockId:h.aD.bound,updateRenderView:h.aD.bound}),this.initGantt()}}let b=new j,y=(0,o.createContext)(b),w=()=>{let e=null!=b?b:new j;return b||(b=e),e},N=e=>{let{children:t}=e,s=w();return(0,l.jsx)(y.Provider,{value:s,children:t})},k=()=>{let e=(0,o.useContext)(y);if(void 0===e)throw Error("useGanttChart must be used within GanttStoreProvider");return e},C=(0,n.Pi)(e=>{let{block:t,blockUpdateHandler:s}=e,[n,r]=(0,o.useState)(!1),[i,h]=(0,o.useState)(0),[p,x]=(0,o.useState)(null),f=(0,o.useRef)(null),{isMobile:v}=(0,m.L)(),{currentViewData:g}=k();return(0,o.useEffect)(()=>{let e=f.current;if(!e)return;let t=e=>{if(!g)return;h(e.offsetX);let{startDate:t,width:s}=g.data;x((0,c.Z)(t,i/s))};return e.addEventListener("mousemove",t),()=>{null==e||e.removeEventListener("mousemove",t)}},[i,g]),(0,l.jsxs)("div",{className:"relative h-full w-full",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[(0,l.jsx)("div",{ref:f,className:"h-full w-full"}),n&&(0,l.jsx)(u.u,{tooltipContent:p&&(0,a.ot)(p),isMobile:v,children:(0,l.jsx)("button",{type:"button",className:"absolute top-1/2 -translate-x-1/2 -translate-y-1/2 h-8 w-8 bg-custom-background-80 p-1.5 rounded border border-custom-border-300 grid place-items-center text-custom-text-200 hover:text-custom-text-100",style:{marginLeft:"".concat(i,"px")},onClick:()=>{var e,l;if(!g)return;let{startDate:n,width:r}=g.data,o=(0,c.Z)(n,i/r),d=(0,c.Z)(o,1);s(t.data,{start_date:null!==(e=(0,a.ss)(o))&&void 0!==e?e:void 0,target_date:null!==(l=(0,a.ss)(d))&&void 0!==l?l:void 0})},children:(0,l.jsx)(d.Z,{className:"h-3.5 w-3.5"})})})]})});var S=s(44973);let _=(0,n.Pi)(e=>{var t,s,n,a;let{block:i,blockToRender:c,handleBlock:d,enableBlockLeftResize:u,enableBlockRightResize:m,enableBlockMove:h,ganttContainerRef:p}=e,[x,f]=(0,o.useState)(!1),[v,g]=(0,o.useState)(!1),[j,b]=(0,o.useState)(!1),[y,w]=(0,o.useState)(!0),[N,C]=(0,o.useState)(0),_=(0,o.useRef)(null),{currentViewData:I}=k(),E=e=>{let t=0,s=document.querySelector("#gantt-container"),l=document.querySelector("#gantt-sidebar");if(!s||!l)return 0;if(e.clientX-(s.getBoundingClientRect().left+l.clientWidth)<=70){if(e.movementX>0)return 0;t=-5,s.scrollBy(t,0)}else t=e.movementX;if(s.getBoundingClientRect().right-e.clientX<=70){if(e.movementX<0)return 0;t=5,s.scrollBy(t,0)}else t=e.movementX;return t},P=(null===(t=i.position)||void 0===t?void 0:t.marginLeft)&&(null===(s=i.position)||void 0===s?void 0:s.width)&&N>i.position.marginLeft+i.position.width;return(0,o.useEffect)(()=>{let e=p.current;if(!e)return;let t=()=>C(e.scrollLeft);return e.addEventListener("scroll",t),()=>{e.removeEventListener("scroll",t)}},[p]),(0,o.useEffect)(()=>{let e=document.querySelector("#gantt-container"),t=_.current;if(!t||!e)return;let s=new IntersectionObserver(e=>{e.forEach(e=>{w(!e.isIntersecting)})},{root:e,rootMargin:"0px 0px 0px -".concat(360,"px")});return s.observe(t),()=>{s.unobserve(t)}},[]),(0,l.jsxs)(l.Fragment,{children:[y&&(0,l.jsx)("button",{type:"button",className:"sticky z-[1] grid h-8 w-8 translate-y-1.5 cursor-pointer place-items-center rounded border border-custom-border-300 bg-custom-background-80 text-custom-text-200 hover:text-custom-text-100",style:{left:"".concat(364,"px")},onClick:()=>{let e=document.querySelector("#gantt-container");e&&i.position&&(e.scrollLeft=i.position.marginLeft-4)},children:(0,l.jsx)(S.Z,{className:(0,r.cn)("h-3.5 w-3.5",{"rotate-180":P})})}),(0,l.jsxs)("div",{ref:_,className:"group relative inline-flex h-full cursor-pointer items-center font-medium transition-all",style:{marginLeft:"".concat(null===(n=i.position)||void 0===n?void 0:n.marginLeft,"px"),width:"".concat(null===(a=i.position)||void 0===a?void 0:a.width,"px")},children:[u&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{onMouseDown:e=>{var t,s;if(!I||!_.current||!i.position||0!==e.button)return;let l=_.current,n=I.data.width,r=null!==(t=l.clientWidth)&&void 0!==t?t:parseInt(i.position.width.toString(),10),a=null!==(s=l.clientWidth)&&void 0!==s?s:parseInt(i.position.width.toString(),10),o=parseInt(l.style.marginLeft),c=e=>{var t,s;let r=0;r=E(e);let c=Math.round((a-=r)/n)*n,d=o-(c-(null!==(s=null===(t=i.position)||void 0===t?void 0:t.width)&&void 0!==s?s:0));o=d,!(c<n)&&(l.style.width="".concat(c,"px"),l.style.marginLeft="".concat(d,"px"),i.position&&(i.position.width=c,i.position.marginLeft=d))},u=()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",u),d(Math.ceil((l.clientWidth-r)/n),"left")};document.addEventListener("mousemove",c),document.addEventListener("mouseup",u)},onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),className:"absolute -left-2.5 top-1/2 -translate-y-1/2 z-[3] h-full w-6 cursor-col-resize rounded-md"}),(0,l.jsx)("div",{className:(0,r.cn)("absolute left-1 top-1/2 -translate-y-1/2 h-7 w-1 rounded-sm bg-custom-background-100 transition-all duration-300",{"-left-2.5":x})})]}),(0,l.jsx)("div",{className:(0,r.cn)("relative z-[2] flex h-8 w-full items-center rounded",{"pointer-events-none":j}),onMouseDown:e=>{if(!h||!I||!_.current||!i.position||0!==e.button)return;let t=_.current,s=I.data.width,l=parseInt(t.style.marginLeft),n=parseInt(t.style.marginLeft),r=e=>{b(!0);let l=0;l=E(e);let r=Math.round((n+=l)/s)*s;t.style.marginLeft="".concat(r,"px"),i.position&&(i.position.marginLeft=r)},a=()=>{b(!1),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",a),d(Math.ceil((parseInt(t.style.marginLeft)-l)/s),"move")};document.addEventListener("mousemove",r),document.addEventListener("mouseup",a)},children:c(i.data)}),m&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{onMouseDown:e=>{var t,s;if(!I||!_.current||!i.position||0!==e.button)return;let l=_.current,n=I.data.width,r=null!==(t=l.clientWidth)&&void 0!==t?t:parseInt(i.position.width.toString(),10),a=null!==(s=l.clientWidth)&&void 0!==s?s:parseInt(i.position.width.toString(),10),o=e=>{let t=0;t=E(e);let s=Math.round((a+=t)/n)*n;!(s<n)&&(l.style.width="".concat(Math.max(s,80),"px"),i.position&&(i.position.width=Math.max(s,80)))},c=()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",c),d(Math.ceil((l.clientWidth-r)/n),"right")};document.addEventListener("mousemove",o),document.addEventListener("mouseup",c)},onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),className:"absolute -right-2.5 top-1/2 -translate-y-1/2 z-[2] h-full w-6 cursor-col-resize rounded-md"}),(0,l.jsx)("div",{className:(0,r.cn)("absolute right-1 top-1/2 -translate-y-1/2 h-7 w-1 rounded-sm bg-custom-background-100 transition-all duration-300",{"-right-2.5":v})})]})]})]})}),I=(0,n.Pi)(e=>{let{block:t,blockToRender:s,blockUpdateHandler:n,enableBlockLeftResize:o,enableBlockRightResize:c,enableBlockMove:d,enableAddBlock:u,ganttContainerRef:m}=e,{updateActiveBlockId:h,isBlockActive:p}=k(),{getIsIssuePeeked:x}=(0,i.p1)(),f=t.start_date&&t.target_date,v=(e,t,s)=>{var l,r;let i=(0,a._3)(e.start_date),o=(0,a._3)(e.target_date);if(!i||!o)return;let c=new Date(i),d=new Date(o);"left"===s?c.setDate(i.getDate()-t):"right"===s?d.setDate(o.getDate()+t):"move"===s&&(c.setDate(i.getDate()+t),d.setDate(o.getDate()+t)),n(e.data,{start_date:null!==(l=(0,a.ss)(c))&&void 0!==l?l:void 0,target_date:null!==(r=(0,a.ss)(d))&&void 0!==r?r:void 0})};return(0,l.jsx)("div",{className:"relative min-w-full w-max",style:{height:"".concat(44,"px")},children:(0,l.jsx)("div",{className:(0,r.cn)("relative h-full",{"bg-custom-background-80":p(t.id),"rounded-l border border-r-0 border-custom-primary-70 hover:border-custom-primary-70":x(t.data.id)}),onMouseEnter:()=>h(t.id),onMouseLeave:()=>h(null),children:f?(0,l.jsx)(_,{block:t,blockToRender:s,handleBlock:function(){for(var e=arguments.length,s=Array(e),l=0;l<e;l++)s[l]=arguments[l];return v(t,...s)},enableBlockLeftResize:o,enableBlockRightResize:c,enableBlockMove:d,ganttContainerRef:m}):u&&(0,l.jsx)(C,{block:t,blockUpdateHandler:n})})},"block-".concat(t.id))}),E=e=>{let{itemsContainerWidth:t,blocks:s,blockToRender:n,blockUpdateHandler:r,enableBlockLeftResize:a,enableBlockRightResize:i,enableBlockMove:o,enableAddBlock:c,ganttContainerRef:d,showAllBlocks:u}=e;return(0,l.jsx)("div",{className:"h-full",style:{width:"".concat(t,"px"),transform:"translateY(".concat(60,"px)")},children:null==s?void 0:s.map(e=>{if(u||e.start_date&&e.target_date)return(0,l.jsx)(I,{block:e,blockToRender:n,blockUpdateHandler:r,enableBlockLeftResize:a,enableBlockRightResize:i,enableBlockMove:o,enableAddBlock:c,ganttContainerRef:d},e.id)})})},P=(0,n.Pi)(()=>{let{currentView:e,currentViewData:t,renderView:s}=k();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"absolute flex h-full flex-grow divide-x divide-custom-border-200",children:s&&s.length>0&&s.map((e,s)=>(0,l.jsxs)("div",{className:"relative flex flex-col",children:[(0,l.jsx)("div",{className:"relative border-b border-custom-border-200",children:(0,l.jsx)("div",{className:"sticky left-0 inline-flex whitespace-nowrap px-2 py-1 text-sm font-medium capitalize",children:null==e?void 0:e.title})}),(0,l.jsx)("div",{className:"flex h-full w-full divide-x divide-custom-border-200",children:e.children&&e.children.length>0&&e.children.map((e,n)=>{var r;return(0,l.jsxs)("div",{className:"relative flex h-full flex-col overflow-hidden whitespace-nowrap",style:{width:"".concat(null==t?void 0:t.data.width,"px")},children:[(0,l.jsx)("div",{className:"flex-shrink-0 border-b py-1 text-center text-sm font-medium capitalize ".concat((null==e?void 0:e.today)?"border-red-500 text-red-500":"border-custom-border-200"),children:(0,l.jsx)("div",{children:e.title})}),(0,l.jsx)("div",{className:"relative flex h-full w-full flex-1 justify-center ".concat(["sat","sun"].includes((null==e?void 0:null===(r=e.dayData)||void 0===r?void 0:r.shortTitle)||"")?"bg-custom-background-80":""),children:(null==e?void 0:e.today)&&(0,l.jsx)("div",{className:"absolute bottom-0 top-0 border border-red-500",children:" "})})]},"sub-title-".concat(s,"-").concat(n))})})]},"title-".concat(s)))})})}),R=(0,n.Pi)(()=>{let{currentView:e,currentViewData:t,renderView:s}=k();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"absolute flex h-full flex-grow divide-x divide-custom-border-200",children:s&&s.length>0&&s.map((e,s)=>(0,l.jsxs)("div",{className:"relative flex flex-col",children:[(0,l.jsx)("div",{className:"relative border-b border-custom-border-200",children:(0,l.jsx)("div",{className:"sticky left-0 inline-flex whitespace-nowrap px-2 py-1 text-sm font-medium capitalize",children:null==e?void 0:e.title})}),(0,l.jsx)("div",{className:"flex h-full w-full divide-x divide-custom-border-200",children:e.children&&e.children.length>0&&e.children.map((e,n)=>{var r;return(0,l.jsxs)("div",{className:"relative flex h-full flex-col overflow-hidden whitespace-nowrap",style:{width:"".concat(null==t?void 0:t.data.width,"px")},children:[(0,l.jsx)("div",{className:"flex-shrink-0 border-b py-1 text-center text-sm font-medium capitalize ".concat((null==e?void 0:e.today)?"border-red-500 text-red-500":"border-custom-border-200"),children:(0,l.jsx)("div",{children:e.title})}),(0,l.jsx)("div",{className:"relative flex h-full w-full flex-1 justify-center ".concat(["sat","sun"].includes((null==e?void 0:null===(r=e.dayData)||void 0===r?void 0:r.shortTitle)||"")?"bg-gray-100":""),children:(null==e?void 0:e.today)&&(0,l.jsx)("div",{className:"absolute bottom-0 top-0 border border-red-500",children:" "})})]},"sub-title-".concat(s,"-").concat(n))})})]},"title-".concat(s)))})})}),F=(0,n.Pi)(()=>{let{currentView:e,currentViewData:t,renderView:s}=k();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"absolute flex h-full flex-grow divide-x divide-custom-border-200",children:s&&s.length>0&&s.map((e,s)=>(0,l.jsxs)("div",{className:"relative flex flex-col",children:[(0,l.jsx)("div",{className:"relative border-b border-custom-border-200",children:(0,l.jsx)("div",{className:"sticky left-0 inline-flex whitespace-nowrap px-2 py-1 text-sm font-medium capitalize",children:null==e?void 0:e.title})}),(0,l.jsx)("div",{className:"flex h-full w-full divide-x divide-custom-border-200",children:e.children&&e.children.length>0&&e.children.map((e,n)=>{var r;return(0,l.jsxs)("div",{className:"relative flex h-full flex-col overflow-hidden whitespace-nowrap",style:{width:"".concat(null==t?void 0:t.data.width,"px")},children:[(0,l.jsx)("div",{className:"flex-shrink-0 border-b py-1 text-center text-sm font-medium capitalize ".concat((null==e?void 0:e.today)?"border-red-500 text-red-500":"border-custom-border-200"),children:(0,l.jsx)("div",{children:e.title})}),(0,l.jsx)("div",{className:"relative flex h-full w-full flex-1 justify-center ".concat(["sat","sun"].includes((null==e?void 0:null===(r=e.dayData)||void 0===r?void 0:r.shortTitle)||"")?"bg-gray-100":""),children:(null==e?void 0:e.today)&&(0,l.jsx)("div",{className:"absolute bottom-0 top-0 border border-red-500",children:" "})})]},"sub-title-".concat(s,"-").concat(n))})})]},"title-".concat(s)))})})}),O=(0,n.Pi)(()=>{let{currentViewData:e,renderView:t}=k();return(0,l.jsx)("div",{className:"absolute top-0 left-0 min-h-full h-max w-max flex divide-x divide-custom-border-100/50",children:null==t?void 0:t.map((t,s)=>{var n,a;return(0,l.jsxs)("div",{className:"relative flex flex-col",children:[(0,l.jsxs)("div",{className:"w-full sticky top-0 z-[5] bg-custom-background-100 flex-shrink-0",style:{height:"".concat(60,"px")},children:[(0,l.jsx)("div",{className:"h-1/2",children:(0,l.jsx)("div",{className:"sticky inline-flex whitespace-nowrap px-3 py-2 text-xs font-medium capitalize",style:{left:"".concat(360,"px")},children:null==t?void 0:t.title})}),(0,l.jsx)("div",{className:"h-1/2 w-full flex",children:null==t?void 0:null===(n=t.children)||void 0===n?void 0:n.map((t,n)=>(0,l.jsx)("div",{className:"flex-shrink-0 border-b-[0.5px] border-custom-border-200 py-1 text-center capitalize",style:{width:"".concat(null==e?void 0:e.data.width,"px")},children:(0,l.jsxs)("div",{className:"space-x-1 text-xs",children:[(0,l.jsx)("span",{className:"text-custom-text-200",children:t.dayData.shortTitle[0]})," ",(0,l.jsx)("span",{className:(0,r.cn)({"rounded-full bg-custom-primary-100 px-1 text-white":t.today}),children:t.day})]})},"sub-title-".concat(s,"-").concat(n)))})]}),(0,l.jsx)("div",{className:"h-full w-full flex-grow flex divide-x divide-custom-border-100/50",children:null==t?void 0:null===(a=t.children)||void 0===a?void 0:a.map((t,n)=>{var r;return(0,l.jsx)("div",{className:"h-full overflow-hidden",style:{width:"".concat(null==e?void 0:e.data.width,"px")},children:["sat","sun"].includes(null==t?void 0:null===(r=t.dayData)||void 0===r?void 0:r.shortTitle)&&(0,l.jsx)("div",{className:"h-full bg-custom-background-90"})},"column-".concat(s,"-").concat(n))})})]},"month-".concat(null==t?void 0:t.month,"-").concat(null==t?void 0:t.year))})})}),T=(0,n.Pi)(()=>{let{currentView:e,currentViewData:t,renderView:s}=k();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"absolute flex h-full flex-grow divide-x divide-custom-border-200",children:s&&s.length>0&&s.map((e,s)=>(0,l.jsxs)("div",{className:"relative flex flex-col",children:[(0,l.jsx)("div",{className:"relative border-b border-custom-border-200",children:(0,l.jsx)("div",{className:"sticky left-0 inline-flex whitespace-nowrap px-2 py-1 text-sm font-medium capitalize",children:null==e?void 0:e.title})}),(0,l.jsx)("div",{className:"flex h-full w-full divide-x divide-custom-border-200",children:e.children&&e.children.length>0&&e.children.map((e,n)=>(0,l.jsxs)("div",{className:"relative flex h-full flex-col overflow-hidden whitespace-nowrap",style:{width:"".concat(null==t?void 0:t.data.width,"px")},children:[(0,l.jsx)("div",{className:"flex-shrink-0 border-b py-1 text-center text-sm font-medium capitalize ".concat((null==e?void 0:e.today)?"border-red-500 text-red-500":"border-custom-border-200"),children:(0,l.jsx)("div",{children:e.title})}),(0,l.jsx)("div",{className:"relative flex h-full w-full flex-1 justify-center",children:(null==e?void 0:e.today)&&(0,l.jsx)("div",{className:"absolute bottom-0 top-0 border border-red-500",children:" "})})]},"sub-title-".concat(s,"-").concat(n)))})]},"title-".concat(s)))})})}),A=(0,n.Pi)(()=>{let{currentView:e,currentViewData:t,renderView:s}=k();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"absolute flex h-full flex-grow divide-x divide-custom-border-200",children:s&&s.length>0&&s.map((e,s)=>(0,l.jsxs)("div",{className:"relative flex flex-col",children:[(0,l.jsx)("div",{className:"relative border-b border-custom-border-200",children:(0,l.jsx)("div",{className:"sticky left-0 inline-flex whitespace-nowrap px-2 py-1 text-sm font-medium capitalize",children:null==e?void 0:e.title})}),(0,l.jsx)("div",{className:"flex h-full w-full divide-x divide-custom-border-200",children:e.children&&e.children.length>0&&e.children.map((e,n)=>{var r;return(0,l.jsxs)("div",{className:"relative flex h-full flex-col overflow-hidden whitespace-nowrap",style:{width:"".concat(null==t?void 0:t.data.width,"px")},children:[(0,l.jsx)("div",{className:"flex-shrink-0 border-b py-1 text-center text-sm font-medium capitalize ".concat((null==e?void 0:e.today)?"border-red-500 text-red-500":"border-custom-border-200"),children:(0,l.jsx)("div",{children:e.title})}),(0,l.jsx)("div",{className:"relative flex h-full w-full flex-1 justify-center ".concat(["sat","sun"].includes((null==e?void 0:null===(r=e.dayData)||void 0===r?void 0:r.shortTitle)||"")?"bg-custom-background-80":""),children:(null==e?void 0:e.today)&&(0,l.jsx)("div",{className:"absolute bottom-0 top-0 border border-red-500",children:" "})})]},"sub-title-".concat(s,"-").concat(n))})})]},"title-".concat(s)))})})}),D=(0,n.Pi)(()=>{let{currentView:e,currentViewData:t,renderView:s}=k();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"absolute flex h-full flex-grow divide-x divide-custom-border-200",children:s&&s.length>0&&s.map((e,s)=>(0,l.jsxs)("div",{className:"relative flex flex-col",children:[(0,l.jsx)("div",{className:"relative border-b border-custom-border-200",children:(0,l.jsx)("div",{className:"sticky left-0 inline-flex whitespace-nowrap px-2 py-1 text-sm font-medium capitalize",children:null==e?void 0:e.title})}),(0,l.jsx)("div",{className:"flex h-full w-full divide-x divide-custom-border-200",children:e.children&&e.children.length>0&&e.children.map((e,n)=>(0,l.jsxs)("div",{className:"relative flex h-full flex-col overflow-hidden whitespace-nowrap",style:{width:"".concat(null==t?void 0:t.data.width,"px")},children:[(0,l.jsx)("div",{className:"flex-shrink-0 border-b py-1 text-center text-sm font-medium capitalize ".concat((null==e?void 0:e.today)?"border-red-500 text-red-500":"border-custom-border-200"),children:(0,l.jsx)("div",{children:e.title})}),(0,l.jsx)("div",{className:"relative flex h-full w-full flex-1 justify-center",children:(null==e?void 0:e.today)&&(0,l.jsx)("div",{className:"absolute bottom-0 top-0 border border-red-500",children:" "})})]},"sub-title-".concat(s,"-").concat(n)))})]},"title-".concat(s)))})})});var M=s(72258),z=s(96652);let L=(0,n.Pi)(e=>{let{blocks:t,fullScreenMode:s,handleChartView:n,handleToday:a,loaderTitle:i,title:o,toggleFullScreenMode:c}=e,{currentView:d}=k();return(0,l.jsxs)("div",{className:"relative flex w-full flex-shrink-0 flex-wrap items-center gap-2 whitespace-nowrap px-2.5 py-2",children:[(0,l.jsx)("div",{className:"flex items-center gap-2 text-lg font-medium",children:o}),(0,l.jsx)("div",{className:"ml-auto",children:(0,l.jsx)("div",{className:"ml-auto text-sm font-medium",children:t?"".concat(t.length," ").concat(i):"Loading..."})}),(0,l.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:v.map(e=>(0,l.jsx)("div",{className:(0,r.cn)("cursor-pointer rounded-sm p-1 px-2 text-xs",{"bg-custom-background-80":d===(null==e?void 0:e.key),"hover:bg-custom-background-90":d!==(null==e?void 0:e.key)}),onClick:()=>n(null==e?void 0:e.key),children:null==e?void 0:e.title},null==e?void 0:e.key))}),(0,l.jsx)("button",{type:"button",className:"rounded-sm p-1 px-2 text-xs hover:bg-custom-background-80",onClick:a,children:"Today"}),(0,l.jsx)("button",{type:"button",className:"flex items-center justify-center rounded-sm border border-custom-border-200 p-1 transition-all hover:bg-custom-background-80",onClick:c,children:s?(0,l.jsx)(M.Z,{className:"h-4 w-4"}):(0,l.jsx)(z.Z,{className:"h-4 w-4"})})]})});var Z=s(65331),q=s(27680);let B=(0,n.Pi)(e=>{let{blocks:t,blockToRender:s,blockUpdateHandler:n,bottomSpacing:a,chartBlocks:i,enableBlockLeftResize:c,enableBlockMove:d,enableBlockRightResize:u,enableReorder:m,enableAddBlock:h,itemsContainerWidth:p,showAllBlocks:x,sidebarToRender:f,title:v,updateCurrentViewRenderPayload:g,quickAdd:j}=e,b=(0,o.useRef)(null),{currentView:y,currentViewData:w}=k();if((0,o.useEffect)(()=>{let e=b.current;if(e)return(0,Z.$)((0,q.O)({element:e,getAllowedAxis:()=>"vertical"}))},[null==b?void 0:b.current]),!y)return null;let N={hours:F,day:R,week:A,bi_week:P,month:O,quarter:T,year:D}[y];return(0,l.jsxs)("div",{id:"gantt-container",className:(0,r.cn)("h-full w-full overflow-auto vertical-scrollbar horizontal-scrollbar scrollbar-lg flex border-t-[0.5px] border-custom-border-200",{"mb-8":a}),ref:b,onScroll:e=>{let{clientWidth:t,scrollLeft:s,scrollWidth:l}=e.currentTarget;l-(s+t)<1e3&&g("right",y),(s>=t+1e3?1e3:s-t)<1e3&&g("left",y)},children:[(0,l.jsx)(ef,{blocks:t,blockUpdateHandler:n,enableReorder:m,sidebarToRender:f,title:v,quickAdd:j}),(0,l.jsxs)("div",{className:"relative min-h-full h-max flex-shrink-0 flex-grow",children:[(0,l.jsx)(N,{}),w&&(0,l.jsx)(E,{itemsContainerWidth:p,blocks:i,blockToRender:s,blockUpdateHandler:n,enableBlockLeftResize:c,enableBlockRightResize:u,enableBlockMove:d,enableAddBlock:h,ganttContainerRef:b,showAllBlocks:x})]})]})}),U=(e,t,s)=>new Date(s,t,e),V=(e,t)=>{let s=new Date(t,e,1);return s.setMonth(s.getMonth()+1),s.setDate(s.getDate()-1),s.getDate()},W=e=>{let t=new Date(e.getFullYear(),0,1),s=t.getDay(),l=new Date(t.getTime()-864e5*s);return Math.floor((e.getTime()-l.getTime())/6048e5)+1},K=(e,t)=>{let s=[],l=e.getFullYear(),n=e.getMonth(),r=t.getFullYear(),a=t.getMonth(),i=new Date(l,n);for(;i<=t;){let e=i.getFullYear(),t=i.getMonth();s.push(new Date(e,t)),i.setMonth(i.getMonth()+1)}return r===i.getFullYear()&&a===i.getMonth()&&s.push(t),s},Y=(e,t)=>{let s=[],l=V(e,t),n=new Date;return Array.from(Array(l).keys()).map(l=>{let r=U(l+1,e,t);s.push({date:r,day:l+1,dayData:x[r.getDay()],weekNumber:W(r),title:"".concat(x[r.getDay()].shortTitle," ").concat(l+1),active:!1,today:n.getFullYear()===t&&n.getMonth()===e&&n.getDate()===l+1})}),s},J=(e,t)=>({year:t,month:e,monthData:f[e],children:Y(e,t),title:"".concat(f[e].title," ").concat(t)}),H=(e,t)=>{let s=e,l=[],n=s.data.approxFilterRange||6,r=[],a=new Date,i=new Date;if(null===t){let e=s.data.currentDate;a=new Date(e.getFullYear(),e.getMonth()-n,e.getDate()),i=new Date(e.getFullYear(),e.getMonth()+n,e.getDate()),a&&i&&(r=K(a,i)),s={...s,data:{...s.data,startDate:r[0],endDate:r[r.length-1]}}}else if("left"===t){let e=s.data.startDate;a=new Date(e.getFullYear(),e.getMonth()-n,e.getDate()),i=new Date(e.getFullYear(),e.getMonth()-1,e.getDate()),a&&i&&(r=K(a,i)),s={...s,data:{...s.data,startDate:r[0]}}}else if("right"===t){let e=s.data.endDate;a=new Date(e.getFullYear(),e.getMonth()+1,e.getDate()),i=new Date(e.getFullYear(),e.getMonth()+n,e.getDate()),a&&i&&(r=K(a,i)),s={...s,data:{...s.data,endDate:r[r.length-1]}}}if(r&&r.length>0)for(let e in r){let t=r[parseInt(e)],s=t.getFullYear(),n=t.getMonth();l.push(J(n,s))}let o=l.map(e=>e.children.length).reduce((e,t)=>e+t,0)*e.data.width;return{state:s,payload:l,scrollWidth:o}},Q=(e,t)=>(e.setHours(0,0,0,0),t.setHours(0,0,0,0),Math.abs(Math.floor((e.getTime()-t.getTime())/864e5))),G=(e,t)=>{let s=0,{startDate:l}=e.data,{start_date:n,target_date:r}=t;if(!n||!r)return;l.setHours(0,0,0,0),n.setHours(0,0,0,0),r.setHours(0,0,0,0);let i=(0,a.sX)(l,n,!1);if(!i)return;s=i*e.data.width;let o=(n.getFullYear()-l.getFullYear())*12;return o-=l.getMonth(),o+=n.getMonth(),{marginLeft:s+=o,width:(Math.abs(Math.floor((n.getTime()-r.getTime())/864e5))+1)*e.data.width+1}},$=(0,n.Pi)(e=>{let{border:t,title:s,blocks:n=null,loaderTitle:a,blockUpdateHandler:i,sidebarToRender:c,blockToRender:d,enableBlockLeftResize:u,enableBlockRightResize:m,enableBlockMove:h,enableReorder:p,enableAddBlock:x,bottomSpacing:f,showAllBlocks:v,quickAdd:j}=e,[b,y]=(0,o.useState)(0),[w,N]=(0,o.useState)(!1),[C,S]=(0,o.useState)(null),{currentView:_,currentViewData:I,renderView:E,updateCurrentView:P,updateCurrentViewData:R,updateRenderView:F}=k(),O=(e,t)=>t?t.map(t=>({...t,position:G(e,t)})):[];(0,o.useEffect)(()=>{I&&n&&S(()=>O(I,n))},[I,n]);let T=(e,t)=>{let s;let l=t&&t===(null==I?void 0:I.key)?I:g(t);void 0!==l&&("month"===t&&(s=H(l,e)),s.payload.length>0&&(R(s.state),"left"===e?(P(t),F([...s.payload,...E]),D(s.scrollWidth),y(b+s.scrollWidth)):"right"===e?(P(t),F([...E,...s.payload]),y(b+s.scrollWidth)):(P(t),F(s.payload),y(s.scrollWidth),setTimeout(()=>{M(s.state,s.state.data.currentDate)},50))))},A=()=>T(null,_);(0,o.useEffect)(()=>{A()},[]);let D=e=>{let t=document.querySelector("#gantt-container");t&&(t.scrollLeft=e+(null==t?void 0:t.scrollLeft),y(e+(null==t?void 0:t.scrollLeft)))},M=(e,t)=>{let s=document.querySelector("#gantt-container");if(!s)return;let l=null==s?void 0:s.clientWidth,n=0,r=0;"month"===_&&(r=Q(e.data.startDate,t)),n=r*e.data.width-(l/2-e.data.width)+180,s.scrollLeft=n};return(0,l.jsxs)("div",{className:(0,r.cn)("relative flex flex-col h-full select-none rounded-sm bg-custom-background-100 shadow",{"fixed inset-0 z-20 bg-custom-background-100":w,"border-[0.5px] border-custom-border-200":t}),children:[(0,l.jsx)(L,{blocks:n,fullScreenMode:w,toggleFullScreenMode:()=>N(e=>!e),handleChartView:e=>T(null,e),handleToday:A,loaderTitle:a,title:s}),(0,l.jsx)(B,{blocks:n,blockToRender:d,blockUpdateHandler:i,bottomSpacing:f,chartBlocks:C,enableBlockLeftResize:u,enableBlockMove:h,enableBlockRightResize:m,enableReorder:p,enableAddBlock:x,itemsContainerWidth:b,showAllBlocks:v,sidebarToRender:c,title:s,updateCurrentViewRenderPayload:T,quickAdd:j})]})}),X=e=>{let{border:t=!0,title:s,blocks:n,loaderTitle:r="blocks",blockUpdateHandler:a,sidebarToRender:i,blockToRender:o,enableBlockLeftResize:c=!1,enableBlockRightResize:d=!1,enableBlockMove:u=!1,enableReorder:m=!1,enableAddBlock:h=!1,bottomSpacing:p=!1,showAllBlocks:x=!1,quickAdd:f}=e;return(0,l.jsx)(N,{children:(0,l.jsx)($,{border:t,title:s,blocks:n,loaderTitle:r,blockUpdateHandler:a,sidebarToRender:i,blockToRender:o,enableBlockLeftResize:c,enableBlockRightResize:d,enableBlockMove:u,enableReorder:m,enableAddBlock:h,bottomSpacing:p,showAllBlocks:x,quickAdd:f})})};var ee=s(97964),et=s(58329),es=s(20107),el=s(42683);let en=(0,n.Pi)(e=>{let{id:t,isLastChild:s,children:n,onDrop:r,isDragEnabled:a}=e,[i,c]=(0,o.useState)(!1),[d,m]=(0,o.useState)(void 0),h=(0,o.useRef)(null),p=(0,o.useRef)(null);return(0,o.useEffect)(()=>{let e=h.current,l=p.current;if(e)return(0,Z.$)((0,ee.En)({element:e,canDrag:()=>a,dragHandle:null!=l?l:void 0,getInitialData:()=>({id:t}),onDragStart:()=>{c(!0)},onDrop:()=>{c(!1)}}),(0,ee.wO)({element:e,canDrop:e=>{var s;let{source:l}=e;return(null==l?void 0:null===(s=l.data)||void 0===s?void 0:s.id)!==t},getData:e=>{let{input:l,element:n}=e;return(0,et.n)({id:t},{input:l,element:n,currentLevel:0,indentPerLevel:0,mode:s?"last-in-group":"standard"})},onDrag:e=>{var t;let{self:l}=e,n=null===(t=(0,et.E)(null==l?void 0:l.data))||void 0===t?void 0:t.type;m(n?"reorder-below"===n&&s?"DRAG_BELOW":"DRAG_OVER":void 0)},onDragLeave:()=>{m(void 0)},onDrop:e=>{var t,l,n,a;let{self:i,source:o}=e;m(void 0);let c=null===(t=(0,et.E)(null==i?void 0:i.data))||void 0===t?void 0:t.type,d=c?"reorder-below"===c&&s?"DRAG_BELOW":"DRAG_OVER":void 0;d&&(r(null==o?void 0:null===(l=o.data)||void 0===l?void 0:l.id,null==i?void 0:null===(n=i.data)||void 0===n?void 0:n.id,"DRAG_BELOW"===d),(0,es.jH)(null==o?void 0:null===(a=o.element)||void 0===a?void 0:a.id,!1,!0))}}))},[null==h?void 0:h.current,null==p?void 0:p.current,s,r]),(0,el.Z)(h,()=>{var e,t;return null==h?void 0:null===(t=h.current)||void 0===t?void 0:null===(e=t.classList)||void 0===e?void 0:e.remove(es.$B)}),(0,l.jsxs)("div",{id:"issue-draggable-".concat(t),className:"relative",ref:h,children:[(0,l.jsx)(u.fH,{classNames:"absolute top-0",isVisible:"DRAG_OVER"===d}),n(i,p),s&&(0,l.jsx)(u.fH,{isVisible:"DRAG_BELOW"===d})]})}),er=(e,t,s,l,n)=>{if(!l||!e||!t)return;let r=l.findIndex(t=>t.id===e),a=s?l.length:l.findIndex(e=>e.id===t);if(-1===r||-1===a||r===a)return;let i=l[r].sort_order;i=0===a?l[0].sort_order-1e3:a===l.length?l[l.length-1].sort_order+1e3:(l[a].sort_order+l[a-1].sort_order)/2,n(l[r].data,{sort_order:{destinationIndex:a,newSortOrder:i,sourceIndex:r}})};var ea=s(12248),ei=s(40240);let eo=(0,n.Pi)(e=>{let{block:t,enableReorder:s,isDragging:n,dragHandleRef:i}=e,{updateActiveBlockId:o,isBlockActive:c}=k(),d=(0,a.sX)(t.start_date,t.target_date);return(0,l.jsx)("div",{className:(0,r.cn)({"rounded bg-custom-background-80":n}),onMouseEnter:()=>o(t.id),onMouseLeave:()=>o(null),children:(0,l.jsxs)("div",{id:"sidebar-block-".concat(t.id),className:(0,r.cn)("group w-full flex items-center gap-2 pl-2 pr-4",{"bg-custom-background-80":c(t.id)}),style:{height:"".concat(44,"px")},children:[s&&(0,l.jsxs)("button",{type:"button",className:"flex flex-shrink-0 rounded p-0.5 text-custom-sidebar-text-200 opacity-0 group-hover:opacity-100",ref:i,children:[(0,l.jsx)(ea.Z,{className:"h-3.5 w-3.5"}),(0,l.jsx)(ea.Z,{className:"-ml-5 h-3.5 w-3.5"})]}),(0,l.jsxs)("div",{className:"flex h-full flex-grow items-center justify-between gap-2 truncate",children:[(0,l.jsx)("div",{className:"flex-grow truncate",children:(0,l.jsx)(ei.VR,{cycleId:t.data.id})}),d&&(0,l.jsxs)("div",{className:"flex-shrink-0 text-sm text-custom-text-200",children:[d," day",d>1?"s":""]})]})]})})}),ec=e=>{let{blockUpdateHandler:t,blocks:s,enableReorder:n}=e,r=(e,l,n)=>{er(e,l,n,s,t)};return(0,l.jsx)("div",{className:"h-full",children:s?s.map((e,t)=>(0,l.jsx)(en,{id:e.id,isLastChild:t===s.length-1,isDragEnabled:n,onDrop:r,children:(t,s)=>(0,l.jsx)(eo,{block:e,enableReorder:n,isDragging:t,dragHandleRef:s})},e.id)):(0,l.jsxs)(u.aN,{className:"space-y-3 pr-2",children:[(0,l.jsx)(u.aN.Item,{height:"34px"}),(0,l.jsx)(u.aN.Item,{height:"34px"}),(0,l.jsx)(u.aN.Item,{height:"34px"}),(0,l.jsx)(u.aN.Item,{height:"34px"})]})})};var ed=s(68114);let eu=(0,n.Pi)(e=>{let{block:t,enableReorder:s,isDragging:n,dragHandleRef:o}=e,{updateActiveBlockId:c,isBlockActive:d}=k(),{getIsIssuePeeked:u}=(0,i.p1)(),m=(0,a.sX)(t.start_date,t.target_date);return(0,l.jsx)("div",{className:(0,r.cn)({"rounded bg-custom-background-80":n,"rounded-l border border-r-0 border-custom-primary-70 hover:border-custom-primary-70":u(t.data.id)}),onMouseEnter:()=>c(t.id),onMouseLeave:()=>c(null),children:(0,l.jsxs)("div",{className:(0,r.cn)("group w-full flex items-center gap-2 pl-2 pr-4",{"bg-custom-background-80":d(t.id)}),style:{height:"".concat(44,"px")},children:[s&&(0,l.jsxs)("button",{type:"button",className:"flex flex-shrink-0 rounded p-0.5 text-custom-sidebar-text-200 opacity-0 group-hover:opacity-100",ref:o,children:[(0,l.jsx)(ea.Z,{className:"h-3.5 w-3.5"}),(0,l.jsx)(ea.Z,{className:"-ml-5 h-3.5 w-3.5"})]}),(0,l.jsxs)("div",{className:"flex h-full flex-grow items-center justify-between gap-2 truncate",children:[(0,l.jsx)("div",{className:"flex-grow truncate",children:(0,l.jsx)(ed.JP6,{issueId:t.data.id})}),m&&(0,l.jsx)("div",{className:"flex-shrink-0 text-sm text-custom-text-200",children:(0,l.jsxs)("span",{children:[m," day",m>1?"s":""]})})]})]})})}),em=e=>{let{blockUpdateHandler:t,blocks:s,enableReorder:n,showAllBlocks:r=!1}=e,a=(e,l,n)=>{er(e,l,n,s,t)};return(0,l.jsx)("div",{children:s?s.map((e,t)=>{let i=e.start_date&&e.target_date;if(r||i)return(0,l.jsx)(en,{id:e.id,isLastChild:t===s.length-1,isDragEnabled:n,onDrop:a,children:(t,s)=>(0,l.jsx)(eu,{block:e,enableReorder:n,isDragging:t,dragHandleRef:s})},e.id)}):(0,l.jsxs)(u.aN,{className:"space-y-3 pr-2",children:[(0,l.jsx)(u.aN.Item,{height:"34px"}),(0,l.jsx)(u.aN.Item,{height:"34px"}),(0,l.jsx)(u.aN.Item,{height:"34px"}),(0,l.jsx)(u.aN.Item,{height:"34px"})]})})};var eh=s(98036);let ep=(0,n.Pi)(e=>{let{block:t,enableReorder:s,isDragging:n,dragHandleRef:i}=e,{updateActiveBlockId:o,isBlockActive:c}=k(),d=(0,a.sX)(t.start_date,t.target_date);return(0,l.jsx)("div",{className:(0,r.cn)({"rounded bg-custom-background-80":n}),onMouseEnter:()=>o(t.id),onMouseLeave:()=>o(null),children:(0,l.jsxs)("div",{id:"sidebar-block-".concat(t.id),className:(0,r.cn)("group w-full flex items-center gap-2 pl-2 pr-4",{"bg-custom-background-80":c(t.id)}),style:{height:"".concat(44,"px")},children:[s&&(0,l.jsxs)("button",{type:"button",className:"flex flex-shrink-0 rounded p-0.5 text-custom-sidebar-text-200 opacity-0 group-hover:opacity-100",ref:i,children:[(0,l.jsx)(ea.Z,{className:"h-3.5 w-3.5"}),(0,l.jsx)(ea.Z,{className:"-ml-5 h-3.5 w-3.5"})]}),(0,l.jsxs)("div",{className:"flex h-full flex-grow items-center justify-between gap-2 truncate",children:[(0,l.jsx)("div",{className:"flex-grow truncate",children:(0,l.jsx)(eh.y1,{moduleId:t.data.id})}),void 0!==d&&(0,l.jsxs)("div",{className:"flex-shrink-0 text-sm text-custom-text-200",children:[d," day",d>1?"s":""]})]})]})})}),ex=e=>{let{blockUpdateHandler:t,blocks:s,enableReorder:n}=e,r=(e,l,n)=>{er(e,l,n,s,t)};return(0,l.jsx)("div",{className:"h-full",children:s?s.map((e,t)=>(0,l.jsx)(en,{id:e.id,isLastChild:t===s.length-1,isDragEnabled:n,onDrop:r,children:(t,s)=>(0,l.jsx)(ep,{block:e,enableReorder:n,isDragging:t,dragHandleRef:s})},e.id)):(0,l.jsxs)(u.aN,{className:"space-y-3 pr-2",children:[(0,l.jsx)(u.aN.Item,{height:"34px"}),(0,l.jsx)(u.aN.Item,{height:"34px"}),(0,l.jsx)(u.aN.Item,{height:"34px"}),(0,l.jsx)(u.aN.Item,{height:"34px"})]})})},ef=e=>{let{blocks:t,blockUpdateHandler:s,enableReorder:n,sidebarToRender:r,title:a,quickAdd:i}=e;return(0,l.jsxs)("div",{id:"gantt-sidebar",className:"sticky left-0 z-10 min-h-full h-max flex-shrink-0 border-r-[0.5px] border-custom-border-200 bg-custom-background-100",style:{width:"".concat(360,"px")},children:[(0,l.jsxs)("div",{className:"box-border flex-shrink-0 flex items-end justify-between gap-2 border-b-[0.5px] border-custom-border-200 pb-2 pl-8 pr-4 text-sm font-medium text-custom-text-300 sticky top-0 z-10 bg-custom-background-100",style:{height:"".concat(60,"px")},children:[(0,l.jsx)("h6",{children:a}),(0,l.jsx)("h6",{children:"Duration"})]}),(0,l.jsx)("div",{className:"min-h-full h-max bg-custom-background-100 overflow-hidden",children:r&&r({title:a,blockUpdateHandler:s,blocks:t,enableReorder:n})}),i||null]})}},3240:function(e,t,s){var l=s(24246),n=s(27378),r=s(43659),a=s(38579),i=s.n(a),o=s(79894),c=s.n(o),d=s(86677),u=s(30201),m=s(19823),h=s(25449),p=s(74371),x=s(82680),f=s(92775),v=s(70540),g=s(82750),j=s(93116),b=s(10634),y=s(89789);let w=new(s(90893)).Vo,N=(0,r.Pi)(()=>{let[e,t]=(0,n.useState)(!1),[s,r]=(0,n.useState)(!1),[a,o]=(0,n.useState)(null),{workspaceSlug:N,provider:k}=(0,d.useRouter)().query,{currentUser:C,currentUserLoader:S}=(0,b.aF)(),{}=(0,y.Z)({user:C,isLoading:S}),{data:_}=(0,u.ZP)(N?(0,g.sX)(N):null,N?()=>w.getImporterServicesList(N):null),I=e=>{o(e),r(!0)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.l0,{isOpen:s,handleClose:()=>r(!1),data:a,user:C}),(0,l.jsxs)("div",{className:"h-full",children:[(!k||"csv"===k)&&(0,l.jsxs)(l.Fragment,{children:[j.nC.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 border-b border-custom-border-100 bg-custom-background-100 px-4 py-6",children:[(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"relative h-10 w-10 flex-shrink-0",children:(0,l.jsx)(i(),{src:e.logo,layout:"fill",objectFit:"cover",alt:"".concat(e.title," Logo")})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"flex items-center gap-4 text-sm font-medium",children:e.title}),(0,l.jsx)("p",{className:"text-sm tracking-tight text-custom-text-200",children:e.description})]})]}),(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(c(),{href:"/".concat(N,"/settings/imports?provider=").concat(e.provider),children:(0,l.jsx)("span",{children:(0,l.jsx)(h.zx,{variant:"primary",children:e.type})})})})]},e.provider)),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"flex items-center border-b border-custom-border-100 pb-3.5 pt-7",children:(0,l.jsxs)("h3",{className:"flex gap-2 text-xl font-medium",children:["Previous Imports",(0,l.jsxs)("button",{type:"button",className:"flex flex-shrink-0 items-center gap-1 rounded bg-custom-background-80 px-1.5 py-1 text-xs outline-none",onClick:()=>{t(!0),(0,u.JG)((0,g.sX)(N)).then(()=>t(!1))},children:[(0,l.jsx)(m.Z,{className:"h-3 w-3 ".concat(e?"animate-spin":"")})," ",e?"Refreshing...":"Refresh status"]})]})}),(0,l.jsx)("div",{className:"flex flex-col",children:_?_.length>0?(0,l.jsx)("div",{className:"space-y-2",children:(0,l.jsx)("div",{className:"divide-y divide-custom-border-200",children:_.map(t=>(0,l.jsx)(x.Jr,{service:t,refreshing:e,handleDelete:()=>I(t)},t.id))})}):(0,l.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,l.jsx)(p.ub,{type:v.C.WORKSPACE_SETTINGS_IMPORT,size:"sm"})}):(0,l.jsx)(f.cD,{})})]})]}),k&&"github"===k&&(0,l.jsx)(x.h9,{}),k&&"jira"===k&&(0,l.jsx)(x.d5,{})]})]})});t.Z=N},82680:function(e,t,s){s.d(t,{l0:function(){return h},Td:function(){return R},Md:function(){return F},L:function(){return O},_i:function(){return D},Ox:function(){return M},h9:function(){return G},up:function(){return L},d5:function(){return eo},lC:function(){return eg},NO:function(){return ee},Jr:function(){return v},gU:function(){return P},GZ:function(){return en}});var l=s(24246),n=s(27378),r=s(86677),a=s(30201),i=s(80986),o=s(30335),c=s(15455),d=s(25449),u=s(82750);let m=new(s(34353)).V,h=e=>{let{isOpen:t,handleClose:s,data:h}=e,[p,x]=(0,n.useState)(!1),[f,v]=(0,n.useState)(!1),{workspaceSlug:g}=(0,r.useRouter)().query;return h?(0,l.jsx)(o.u.Root,{show:t,as:n.Fragment,children:(0,l.jsxs)(c.V,{as:"div",className:"relative z-20",onClose:s,children:[(0,l.jsx)(o.u.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-20 overflow-y-auto",children:(0,l.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,l.jsx)(o.u.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,l.jsx)(c.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:(0,l.jsxs)("div",{className:"flex flex-col gap-6 p-6",children:[(0,l.jsxs)("div",{className:"flex w-full items-center justify-start gap-6",children:[(0,l.jsx)("span",{className:"place-items-center rounded-full bg-red-500/20 p-4",children:(0,l.jsx)(i.Z,{className:"h-6 w-6 text-red-500","aria-hidden":"true"})}),(0,l.jsx)("span",{className:"flex items-center justify-start",children:(0,l.jsx)("h3",{className:"text-xl font-medium 2xl:text-2xl",children:"Delete Project"})})]}),(0,l.jsx)("span",{children:(0,l.jsxs)("p",{className:"text-sm leading-7 text-custom-text-200",children:["Are you sure you want to delete import from"," ",(0,l.jsx)("span",{className:"break-words font-semibold capitalize text-custom-text-100",children:null==h?void 0:h.service}),"? All of the data related to the import will be permanently removed. This action cannot be undone."]})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-sm text-custom-text-200",children:["To confirm, type ",(0,l.jsx)("span",{className:"font-medium text-custom-text-100",children:"delete import"})," below:"]}),(0,l.jsx)(d.II,{id:"typeDelete",type:"text",name:"typeDelete",onChange:e=>{"delete import"===e.target.value?v(!0):v(!1)},placeholder:"Enter 'delete import'",className:"mt-2 w-full"})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)(d.zx,{variant:"neutral-primary",size:"sm",onClick:s,children:"Cancel"}),(0,l.jsx)(d.zx,{variant:"danger",size:"sm",tabIndex:1,onClick:()=>{g&&h&&(x(!0),(0,a.JG)((0,u.sX)(g),e=>(null!=e?e:[]).filter(e=>e.id!==h.id),!1),m.deleteImporterService(g,h.service,h.id).catch(()=>(0,d.fz)({type:d.do.ERROR,title:"Error!",message:"Something went wrong. Please try again."})).finally(()=>{x(!1),s()}))},disabled:!f,loading:p,children:p?"Deleting...":"Delete Project"})]})]})})})})})]})}):(0,l.jsx)(l.Fragment,{})};s(3240);var p=s(54129),x=s(93116),f=s(74273);let v=e=>{var t,s;let{service:n,refreshing:r,handleDelete:a}=e;return(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 px-4 py-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h4",{className:"flex items-center gap-2 text-sm",children:[(0,l.jsxs)("span",{children:["Import from"," ",(0,l.jsx)("span",{className:"font-medium",children:null===(t=x.nC.find(e=>e.provider===n.service))||void 0===t?void 0:t.title})," to"," ",(0,l.jsx)("span",{className:"font-medium",children:n.project_detail.name})]}),(0,l.jsx)("span",{className:"rounded px-2 py-0.5 text-xs capitalize ".concat("completed"===n.status?"bg-green-500/20 text-green-500":"processing"===n.status?"bg-yellow-500/20 text-yellow-500":"failed"===n.status?"bg-red-500/20 text-red-500":""),children:r?"Refreshing...":n.status})]}),(0,l.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-xs text-custom-text-200",children:[(0,l.jsx)("span",{children:(0,f.ot)(n.created_at)}),"|",(0,l.jsxs)("span",{children:["Imported by ",null===(s=n.initiated_by_detail)||void 0===s?void 0:s.display_name]})]})]}),(0,l.jsx)(d.fR,{ellipsis:!0,children:(0,l.jsx)(d.fR.MenuItem,{onClick:a,children:(0,l.jsxs)("span",{className:"flex items-center justify-start gap-2",children:[(0,l.jsx)(p.Z,{className:"h-3.5 w-3.5"}),"Delete import"]})})})]})};var g=s(43659),j=s(38579),b=s.n(j),y=s(39709),w=s(10634),N=e=>{let{provider:t,stateParams:s,github_app_name:l,slack_client_id:a}=e,[i,o]=(0,n.useState)(!1),{workspaceSlug:c,projectId:d}=(0,r.useRouter)().query,u={github:"https://github.com/apps/".concat(l,"/installations/new?state=").concat(null==c?void 0:c.toString()),slack:"https://slack.com/oauth/v2/authorize?scope=chat:write,im:history,im:write,links:read,links:write,users:read,users:read.email&amp;user_scope=&amp;&client_id=".concat(a,"&state=").concat(null==c?void 0:c.toString()),slackChannel:"https://slack.com/oauth/v2/authorize?scope=incoming-webhook&client_id=".concat(a,"&state=").concat(null==c?void 0:c.toString(),",").concat(null==d?void 0:d.toString()).concat(s?","+s:"")},m=(0,n.useRef)(),h=()=>{let e=setInterval(()=>{(!m||m.current.closed||void 0===m.current.closed)&&(clearInterval(e),o(!1))},1e3)},p=()=>{if(!t)return;let e=window.innerWidth/2-300,s=window.innerHeight/2-300,l=u[t];return window.open(l,"","width=".concat(600,", height=").concat(600,", top=").concat(s,", left=").concat(e))};return{startAuth:()=>{m.current=p(),h(),o(!0)},isConnecting:i}},k=s(18894),C=s(90893),S=s(93384),_=s(90288);let I={github:{logo:S.Z,installed:"Activate GitHub on individual projects to sync with specific repositories.",notInstalled:"Connect with GitHub with your Plane workspace to sync project issues."},slack:{logo:_.Z,installed:"Activate Slack on individual projects to sync with specific channels.",notInstalled:"Connect with Slack with your Plane workspace to sync project issues."}},E=new C.Vo,P=(0,g.Pi)(e=>{let{integration:t}=e,[s,i]=(0,n.useState)(!1),{workspaceSlug:o}=(0,r.useRouter)().query,{config:{envConfig:c}}=(0,w.IX)(),{membership:{currentWorkspaceRole:m}}=(0,w.aF)(),h=20===m,{isMobile:p}=(0,k.L)(),{startAuth:x,isConnecting:f}=N({provider:t.provider,github_app_name:(null==c?void 0:c.github_app_name)||"",slack_client_id:(null==c?void 0:c.slack_client_id)||""}),{data:v}=(0,a.ZP)(o?(0,u.De)(o):null,()=>o?E.getWorkspaceIntegrationsList(o):null),g=async()=>{var e;if(!o||!t||!v)return;let s=null==v?void 0:null===(e=v.find(e=>e.integration===t.id))||void 0===e?void 0:e.id;i(!0),await E.deleteWorkspaceIntegration(o,null!=s?s:"").then(()=>{(0,a.JG)((0,u.De)(o),e=>null==e?void 0:e.filter(e=>e.id!==s),!1),i(!1),(0,d.fz)({type:d.do.SUCCESS,title:"Deleted successfully!",message:"".concat(t.title," integration deleted successfully.")})}).catch(()=>{i(!1),(0,d.fz)({type:d.do.ERROR,title:"Error!",message:"".concat(t.title," integration could not be deleted. Please try again.")})})},j=null==v?void 0:v.find(e=>e.integration_detail.id===t.id);return(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 border-b border-custom-border-100 bg-custom-background-100 px-4 py-6",children:[(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"h-10 w-10 flex-shrink-0",children:(0,l.jsx)(b(),{src:I[t.provider].logo,alt:"".concat(t.title," Logo")})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"flex items-center gap-2 text-sm font-medium",children:[t.title,v?j&&(0,l.jsx)(y.Z,{className:"h-3.5 w-3.5 fill-transparent text-green-500"}):null]}),(0,l.jsx)("p",{className:"text-sm tracking-tight text-custom-text-200",children:v?j?I[t.provider].installed:I[t.provider].notInstalled:"Loading..."})]})]}),v?j?(0,l.jsx)(d.u,{isMobile:p,disabled:h,tooltipContent:h?null:"You don't have permission to perform this",children:(0,l.jsx)(d.zx,{className:"".concat(h?"":"hover:cursor-not-allowed"),variant:"danger",onClick:()=>{h&&g()},disabled:!h,loading:s,children:s?"Uninstalling...":"Uninstall"})}):(0,l.jsx)(d.u,{isMobile:p,disabled:h,tooltipContent:h?null:"You don't have permission to perform this",children:(0,l.jsx)(d.zx,{className:"".concat(h?"":"hover:cursor-not-allowed"),variant:"primary",onClick:()=>{h&&x()},loading:f,children:f?"Installing...":"Install"})}):(0,l.jsx)(d.aN,{children:(0,l.jsx)(d.aN.Item,{height:"32px",width:"64px"})})]})}),R=(0,g.Pi)(e=>{let{workspaceIntegration:t,provider:s}=e,{config:{envConfig:n}}=(0,w.IX)(),{startAuth:r,isConnecting:a}=N({provider:s,github_app_name:(null==n?void 0:n.github_app_name)||"",slack_client_id:(null==n?void 0:n.slack_client_id)||""});return(0,l.jsx)("div",{children:t&&(null==t?void 0:t.id)?(0,l.jsx)(d.zx,{variant:"primary",disabled:!0,children:"Successfully Connected"}):(0,l.jsx)(d.zx,{variant:"primary",onClick:r,loading:a,children:a?"Connecting...":"Connect"})})}),F=e=>{let{handleStepChange:t,provider:s,appIntegrations:n,workspaceIntegrations:r}=e,a=n&&n.length>0&&n.find(e=>e.provider===s),i=a&&r&&r.length>0&&r.find(e=>e.integration_detail.id===a.id);return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 py-5",children:[(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("div",{className:"font-medium",children:"Configure"}),(0,l.jsx)("div",{className:"text-sm text-custom-text-200",children:"Set up your GitHub import."})]}),(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(R,{workspaceIntegration:i,provider:s})})]}),(0,l.jsx)("div",{className:"flex items-center justify-end",children:(0,l.jsx)(d.zx,{variant:"primary",onClick:()=>t("import-data"),disabled:!i||null==i||!i.id,children:"Next"})})]})},O=e=>{let{handleStepChange:t,watch:s}=e;return(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsxs)("h4",{className:"font-medium text-custom-text-200",children:["You are about to import issues from ",s("github").full_name,". Click on ",'"',"Confirm & Import",'" ',"to complete the process."]}),(0,l.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,l.jsx)(d.zx,{variant:"neutral-primary",onClick:()=>t("import-users"),children:"Back"}),(0,l.jsx)(d.zx,{variant:"primary",type:"submit",children:"Confirm & Import"})]})]})};var T=s(88039),A=s(10712);let D=(0,g.Pi)(e=>{let{handleStepChange:t,integration:s,control:n,watch:r}=e,{workspaceProjectIds:a,getProjectById:i}=(0,w.PY)(),o=null==a?void 0:a.map(e=>{var t;let s=i(e);return{value:"".concat(null==s?void 0:s.id),query:"".concat(null==s?void 0:s.name),content:(0,l.jsx)("p",{children:(0,A.aF)(null!==(t=null==s?void 0:s.name)&&void 0!==t?t:"",25)})}});return(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"grid grid-cols-12 gap-4 sm:gap-16",children:[(0,l.jsxs)("div",{className:"col-span-12 sm:col-span-8",children:[(0,l.jsx)("h4",{className:"font-semibold",children:"Select Repository"}),(0,l.jsx)("p",{className:"text-xs text-custom-text-200",children:"Select the repository that you want the issues to be imported from."})]}),(0,l.jsx)("div",{className:"col-span-12 sm:col-span-4",children:s&&(0,l.jsx)(T.Qr,{control:n,name:"github",render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(ee,{integration:s,value:t?t.id:null,label:t?"".concat(t.full_name):(0,l.jsx)("span",{className:"text-custom-text-200",children:"Select Repository"}),onChange:n,characterLimit:50})}})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-12 gap-4 sm:gap-16",children:[(0,l.jsxs)("div",{className:"col-span-12 sm:col-span-8",children:[(0,l.jsx)("h4",{className:"font-semibold",children:"Select Project"}),(0,l.jsx)("p",{className:"text-xs text-custom-text-200",children:"Select the project to import the issues to."})]}),(0,l.jsx)("div",{className:"col-span-12 sm:col-span-4",children:a&&(0,l.jsx)(T.Qr,{control:n,name:"project",render:e=>{var t;let{field:{value:s,onChange:n}}=e;return(0,l.jsx)(d.RO,{value:s,label:s?null===(t=i(s))||void 0===t?void 0:t.name:(0,l.jsx)("span",{className:"text-custom-text-200",children:"Select Project"}),onChange:n,options:o,optionsClassName:"w-full"})}})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-12 gap-4 sm:gap-16",children:[(0,l.jsxs)("div",{className:"col-span-12 sm:col-span-8",children:[(0,l.jsx)("h4",{className:"font-semibold",children:"Sync Issues"}),(0,l.jsx)("p",{className:"text-xs text-custom-text-200",children:"Set whether you want to sync the issues or not."})]}),(0,l.jsx)("div",{className:"col-span-12 sm:col-span-4",children:(0,l.jsx)(T.Qr,{control:n,name:"sync",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(d.Zh,{value:t,onChange:()=>s(!t)})}})})]})]}),(0,l.jsxs)("div",{className:"mt-6 flex items-center justify-end gap-2",children:[(0,l.jsx)(d.zx,{variant:"neutral-primary",onClick:()=>t("import-configure"),children:"Back"}),(0,l.jsx)(d.zx,{variant:"primary",onClick:()=>t("repo-details"),disabled:!r("github")||!r("project"),children:"Next"})]})]})}),M=e=>{let{handleStepChange:t,users:s,setUsers:n,watch:r}=e,a=s.filter(e=>!1!==e.import&&""===e.email).length>0;return(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-2 grid grid-cols-3 gap-2 text-sm font-medium",children:[(0,l.jsx)("div",{className:"text-custom-text-200",children:"Name"}),(0,l.jsx)("div",{className:"text-custom-text-200",children:"Import as..."}),(0,l.jsxs)("div",{className:"text-right",children:[s.filter(e=>!1!==e.import).length," users selected"]})]}),(0,l.jsx)("div",{className:"space-y-2",children:r("collaborators").map((e,t)=>(0,l.jsx)(en,{collaborator:e,index:t,users:s,setUsers:n},e.id))})]}),(0,l.jsxs)("div",{className:"mt-6 flex items-center justify-end gap-2",children:[(0,l.jsx)(d.zx,{variant:"neutral-primary",onClick:()=>t("repo-details"),children:"Back"}),(0,l.jsx)(d.zx,{variant:"primary",onClick:()=>t("import-confirm"),disabled:a,children:"Next"})]})]})},z=new C.Sz,L=e=>{let{selectedRepo:t,handleStepChange:s,setUsers:i,setValue:o}=e,{workspaceSlug:c}=(0,r.useRouter)().query,{data:m}=(0,a.ZP)(c&&t?(0,u.xL)(c,t.name):null,c&&t?()=>z.getGithubRepoInfo(c,{owner:t.owner.login,repo:t.name}):null);return(0,n.useEffect)(()=>{m&&(o("collaborators",m.collaborators),i(m.collaborators.map(e=>({username:e.login,import:"map",email:""}))))},[m,i,o]),(0,l.jsxs)("div",{className:"mt-6",children:[m?m.issue_count>0?(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-medium",children:"Repository Details"}),(0,l.jsx)("div",{className:"text-sm text-custom-text-200",children:"Import completed. We have found:"})]}),(0,l.jsxs)("div",{className:"mt-4 flex gap-16",children:[(0,l.jsxs)("div",{className:"flex-shrink-0 text-center",children:[(0,l.jsx)("p",{className:"text-3xl font-bold",children:m.issue_count}),(0,l.jsx)("h6",{className:"text-sm text-custom-text-200",children:"Issues"})]}),(0,l.jsxs)("div",{className:"flex-shrink-0 text-center",children:[(0,l.jsx)("p",{className:"text-3xl font-bold",children:m.labels}),(0,l.jsx)("h6",{className:"text-sm text-custom-text-200",children:"Labels"})]}),(0,l.jsxs)("div",{className:"flex-shrink-0 text-center",children:[(0,l.jsx)("p",{className:"text-3xl font-bold",children:m.collaborators.length}),(0,l.jsx)("h6",{className:"text-sm text-custom-text-200",children:"Users"})]})]})]}):(0,l.jsx)("div",{children:(0,l.jsxs)("h5",{children:["We didn","'","t find any issue in this repository."]})}):(0,l.jsx)(d.aN,{children:(0,l.jsx)(d.aN.Item,{height:"70px"})}),(0,l.jsxs)("div",{className:"mt-6 flex items-center justify-end gap-2",children:[(0,l.jsx)(d.zx,{variant:"neutral-primary",onClick:()=>s("import-data"),children:"Back"}),(0,l.jsx)(d.zx,{variant:"primary",onClick:()=>s("import-users"),disabled:!m||0===m.issue_count,children:"Next"})]})]})};var Z=s(79894),q=s.n(Z),B=s(38330),U=s(18904),V=s(58645),W=s(1759),K=s(84976);let Y={github:null,project:null,sync:!1},J=[{title:"Configure",key:"import-configure",icon:B.Z},{title:"Import Data",key:"import-data",icon:U.Z},{title:"Issues",key:"repo-details",icon:V.Z},{title:"Users",key:"import-users",icon:d.Ti},{title:"Confirm",key:"import-confirm",icon:W.Z}],H=new C.Vo,Q=new C.Sz,G=()=>{let[e,t]=(0,n.useState)({state:"import-configure"}),[s,i]=(0,n.useState)([]),o=(0,r.useRouter)(),{workspaceSlug:c,provider:m}=o.query,{handleSubmit:h,control:p,setValue:x,watch:f}=(0,T.cI)({defaultValues:Y}),{data:v}=(0,a.ZP)(u.pC,()=>H.getAppIntegrationsList()),{data:g}=(0,a.ZP)(c?(0,u.De)(c):null,c?()=>H.getWorkspaceIntegrationsList(c):null),j=()=>J.findIndex(t=>(null==t?void 0:t.key)===(null==e?void 0:e.state)),y=e=>{t(t=>({...t,state:e}))},w=v&&v.length>0&&v.find(e=>e.provider===m),N=w&&(null==g?void 0:g.find(e=>e.integration_detail.id===w.id)),k=async e=>{if(!e.github||!e.project)return;let t={metadata:{owner:e.github.owner.login,name:e.github.name,repository_id:e.github.id,url:e.github.html_url},data:{users:s},config:{sync:e.sync},project_id:e.project};await Q.createGithubServiceImport(c,t).then(()=>{o.push("/".concat(c,"/settings/imports")),(0,a.JG)((0,u.sX)(c))}).catch(()=>(0,d.fz)({type:d.do.ERROR,title:"Error!",message:"Import was unsuccessful. Please try again."}))};return(0,l.jsx)("form",{onSubmit:h(k),children:(0,l.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,l.jsx)(q(),{href:"/".concat(c,"/settings/imports"),children:(0,l.jsxs)("span",{className:"inline-flex cursor-pointer items-center gap-2 text-sm font-medium text-custom-text-200 hover:text-custom-text-100",children:[(0,l.jsx)(K.Z,{className:"h-3 w-3"}),(0,l.jsx)("div",{children:"Cancel import & go back"})]})}),(0,l.jsxs)("div",{className:"space-y-4 rounded-[10px] border border-custom-border-200 bg-custom-background-100 p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"h-10 w-10 flex-shrink-0",children:(0,l.jsx)(b(),{src:S.Z,alt:"GithubLogo"})}),(0,l.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:J.map((e,t)=>(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border ".concat(t<=j()?"border-custom-primary bg-custom-primary ".concat(t===j()?"border-opacity-100 bg-opacity-100":"border-opacity-80 bg-opacity-80"):"border-custom-border-200"),children:(0,l.jsx)(e.icon,{className:"h-5 w-5 ".concat(t<=j()?"text-white":"text-custom-text-400")})}),t<J.length-1&&(0,l.jsx)("div",{className:"border-b px-7 ".concat(t<=j()-1?"border-custom-primary":"border-custom-border-200"),children:" "},t)]},e.key))})]}),(0,l.jsx)("div",{className:"relative w-full space-y-4",children:(0,l.jsxs)("div",{className:"w-full",children:[(null==e?void 0:e.state)==="import-configure"&&(0,l.jsx)(F,{handleStepChange:y,provider:m,appIntegrations:v,workspaceIntegrations:g}),(null==e?void 0:e.state)==="import-data"&&(0,l.jsx)(D,{handleStepChange:y,integration:N,control:p,watch:f}),(null==e?void 0:e.state)==="repo-details"&&(0,l.jsx)(L,{selectedRepo:f("github"),handleStepChange:y,setUsers:i,setValue:x}),(null==e?void 0:e.state)==="import-users"&&(0,l.jsx)(M,{handleStepChange:y,users:s,setUsers:i,watch:f}),(null==e?void 0:e.state)==="import-confirm"&&(0,l.jsx)(O,{handleStepChange:y,watch:f})]})})]})]})})};var $=s(13411);let X=new(s(12447)).Y4,ee=e=>{var t;let{integration:s,value:n,label:a,onChange:i,characterLimit:o=25}=e,{workspaceSlug:c}=(0,r.useRouter)().query,u=async e=>await X.getGithubRepositories(e),{data:m,size:h,setSize:p,isValidating:x}=(0,$.ZP)(e=>{if(c&&s)return"".concat("https://api.plane.so","/api/workspaces/").concat(c,"/workspace-integrations/").concat(s.id,"/github-repositories/?page=").concat(++e)},u),f=(null!=m?m:[]).map(e=>e.repositories).flat();f=f.filter(e=>null==e?void 0:e.id);let v=m&&m.length>0?m[0].total_count:0,g=null!==(t=f.map(e=>({value:e.id,query:e.full_name,content:(0,l.jsx)("p",{children:(0,A.aF)(e.full_name,o)})})))&&void 0!==t?t:[];return f.length<1?null:(0,l.jsx)(d.RO,{value:n,options:g,onChange:e=>{i(f.find(t=>t.id===e))},label:a,footerOption:(0,l.jsx)(l.Fragment,{children:f&&g.length<v&&(0,l.jsx)("button",{type:"button",className:"w-full p-1 text-center text-[0.6rem] text-custom-text-200 hover:bg-custom-background-80",onClick:()=>p(h+1),disabled:x,children:x?"Loading...":"Click to load more..."})}),optionsClassName:"w-full"})};var et=s(16933);let es=[{key:"map",label:"Map to existing"},{key:"invite",label:"Invite by email"},{key:!1,label:"Do not import"}],el=new et.A,en=e=>{var t;let{collaborator:s,index:n,users:i,setUsers:o}=e,{workspaceSlug:c}=(0,r.useRouter)().query,{data:m}=(0,a.ZP)(c?(0,u.YW)(c.toString()):null,c?()=>el.fetchWorkspaceMembers(c.toString()):null),h=null==m?void 0:m.map(e=>{var t,s,n,r,a,i;if(null==e?void 0:e.member)return{value:null===(t=e.member)||void 0===t?void 0:t.display_name,query:null!==(i=null===(s=e.member)||void 0===s?void 0:s.display_name)&&void 0!==i?i:"",content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.qE,{name:null==e?void 0:null===(n=e.member)||void 0===n?void 0:n.display_name,src:null==e?void 0:null===(r=e.member)||void 0===r?void 0:r.avatar}),null===(a=e.member)||void 0===a?void 0:a.display_name]})}}).filter(e=>!!e);return(0,l.jsxs)("div",{className:"grid grid-cols-3 items-center gap-2 rounded-md bg-custom-background-80 px-2 py-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"relative h-8 w-8 flex-shrink-0 rounded",children:(0,l.jsx)("img",{src:s.avatar_url,className:"absolute left-0 top-0 h-full w-full rounded object-cover",alt:"".concat(s.login," GitHub user")})}),(0,l.jsx)("p",{className:"text-sm",children:s.login})]}),(0,l.jsx)("div",{children:(0,l.jsx)(d.AP,{value:i[n].import,label:(0,l.jsx)("div",{className:"text-xs",children:null===(t=es.find(e=>e.key===i[n].import))||void 0===t?void 0:t.label}),onChange:e=>{let t=[...i];t[n].import=e,t[n].email="",o(t)},optionsClassName:"w-full",noChevron:!0,children:es.map(e=>(0,l.jsx)(d.AP.Option,{value:e.key,children:(0,l.jsx)("div",{children:e.label})},e.label))})}),"invite"===i[n].import&&(0,l.jsx)(d.II,{id:"email",type:"email",name:"userEmail".concat(n),value:i[n].email,onChange:e=>{let t=[...i];t[n].email=e.target.value,o(t)},placeholder:"Enter email of the user",className:"w-full py-1 text-xs"}),"map"===i[n].import&&m&&(0,l.jsx)(d.RO,{value:i[n].email,label:""!==i[n].email?i[n].email:"Select user from project",options:h,onChange:e=>{let t=[...i];t[n].email=e,o(t)},optionsClassName:"w-full"})]})};var er=s(50188);let ea=[{title:"Configure",key:"import-configure",icon:B.Z},{title:"Import Data",key:"display-import-data",icon:V.Z},{title:"Users",key:"import-users",icon:d.Ti},{title:"Confirm",key:"import-confirmation",icon:W.Z}],ei=new C.ig,eo=()=>{let[e,t]=(0,n.useState)({state:"import-configure"}),[s,i]=(0,n.useState)(null),o=(0,r.useRouter)(),{workspaceSlug:c}=o.query,m=(0,T.cI)({defaultValues:ef,mode:"all",reValidateMode:"onChange"}),h=m.formState.isValid,p=async e=>{c&&await ei.createJiraImporter(c.toString(),e).then(()=>{(0,a.JG)((0,u.sX)(c.toString())),o.push("/".concat(c,"/settings/imports"))}).catch(e=>{console.error(e)})},x=()=>ea.findIndex(t=>(null==t?void 0:t.key)===(null==e?void 0:e.state));return(0,l.jsxs)("div",{className:"mt-4 flex h-full flex-col space-y-2",children:[(0,l.jsx)(q(),{href:"/".concat(c,"/settings/imports"),children:(0,l.jsxs)("span",{className:"inline-flex cursor-pointer items-center gap-2 text-sm font-medium text-custom-text-200 hover:text-custom-text-100",children:[(0,l.jsx)("div",{children:(0,l.jsx)(K.Z,{className:"h-3 w-3"})}),(0,l.jsx)("div",{children:"Cancel import & go back"})]})}),(0,l.jsxs)("div",{className:"flex h-full flex-col space-y-4 rounded-[10px] border border-custom-border-200 bg-custom-background-100 p-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"h-10 w-10 flex-shrink-0",children:(0,l.jsx)(b(),{src:er.Z,alt:"jira logo"})}),(0,l.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:ea.map((e,r)=>(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)("button",{type:"button",onClick:()=>{t({state:e.key})},disabled:r>x()+1||!!(r===x()+1&&s),className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border border-custom-border-200 ".concat(r<=x()?"border-custom-primary bg-custom-primary ".concat(r===x()?"border-opacity-100 bg-opacity-100":"border-opacity-80 bg-opacity-80"):"border-custom-border-200"),children:(0,l.jsx)(e.icon,{className:"h-5 w-5 ".concat(r<=x()?"text-white":"text-custom-text-400")})}),r<ea.length-1&&(0,l.jsx)("div",{className:"border-b px-7 ".concat(r<=x()-1?"border-custom-primary":"border-custom-border-200"),children:" "},r)]},e.key))})]}),(0,l.jsx)("div",{className:"relative h-full w-full pt-6",children:(0,l.jsx)(T.RV,{...m,children:(0,l.jsxs)("form",{className:"flex h-full w-full flex-col",children:[(0,l.jsxs)("div",{className:"h-full w-full overflow-y-auto",children:["import-configure"===e.state&&(0,l.jsx)(ed,{}),"display-import-data"===e.state&&(0,l.jsx)(em,{setDisableTopBarAfter:i,setCurrentStep:t}),(null==e?void 0:e.state)==="import-users"&&(0,l.jsx)(ep,{}),(null==e?void 0:e.state)==="import-confirmation"&&(0,l.jsx)(ex,{})]}),(0,l.jsxs)("div",{className:"-mx-4 mt-4 flex justify-end gap-4 border-t border-custom-border-200 p-4 pb-0",children:[(null==e?void 0:e.state)!=="import-configure"&&(0,l.jsx)(d.zx,{variant:"neutral-primary",onClick:()=>{var s;let l=ea.findIndex(t=>(null==t?void 0:t.key)===(null==e?void 0:e.state));t({state:null===(s=ea[l-1])||void 0===s?void 0:s.key})},children:"Back"}),(0,l.jsx)(d.zx,{variant:"primary",disabled:s===(null==e?void 0:e.state)||!h||m.formState.isSubmitting,onClick:()=>{let s=ea.findIndex(t=>(null==t?void 0:t.key)===(null==e?void 0:e.state));if(s===ea.length-1)m.handleSubmit(p)();else{var l;t({state:null===(l=ea[s+1])||void 0===l?void 0:l.key})}},children:(null==e?void 0:e.state)==="import-confirmation"?"Confirm & Import":"Next"})]})]})})})]})]})};var ec=s(47542);let ed=(0,g.Pi)(()=>{var e,t,s,n;let{commandPalette:r}=(0,w.IX)(),{setTrackElement:a}=(0,w.DN)(),{workspaceProjectIds:i,getProjectById:o}=(0,w.PY)(),{control:c,formState:{errors:u}}=(0,T.Gc)();return(0,l.jsxs)("div",{className:"h-full w-full space-y-8 overflow-y-auto",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-10 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)("h3",{className:"font-semibold",children:"Jira Personal Access Token"}),(0,l.jsxs)("p",{className:"text-sm text-custom-text-200",children:["Get to know your access token by navigating to"," ",(0,l.jsx)(q(),{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noreferrer",children:(0,l.jsx)("span",{className:"text-custom-primary underline",children:"Atlassian Settings"})})]})]}),(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)(T.Qr,{control:c,name:"metadata.api_token",rules:{required:"Please enter your personal access token."},render:e=>{var t;let{field:{value:s,onChange:n,ref:r}}=e;return(0,l.jsx)(d.II,{id:"metadata.api_token",type:"text",value:s,onChange:n,ref:r,hasError:!!(null===(t=u.metadata)||void 0===t?void 0:t.api_token),placeholder:"XXXXXXXX",className:"w-full",autoComplete:"off"})}}),(null===(e=u.metadata)||void 0===e?void 0:e.api_token)&&(0,l.jsx)("p",{className:"text-red-500 text-xs",children:u.metadata.api_token.message})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-10 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)("h3",{className:"font-semibold",children:"Jira Project Key"}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"If XXX-123 is your issue, then enter XXX"})]}),(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)(T.Qr,{control:c,name:"metadata.project_key",rules:{required:"Please enter your project key."},render:e=>{var t;let{field:{value:s,onChange:n,ref:r}}=e;return(0,l.jsx)(d.II,{id:"metadata.project_key",type:"text",value:s,onChange:n,ref:r,hasError:!!(null===(t=u.metadata)||void 0===t?void 0:t.project_key),placeholder:"LIN",className:"w-full"})}}),(null===(t=u.metadata)||void 0===t?void 0:t.project_key)&&(0,l.jsx)("p",{className:"text-red-500 text-xs",children:u.metadata.project_key.message})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-10 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)("h3",{className:"font-semibold",children:"Jira Email Address"}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Enter the Email account that you use in Jira account"})]}),(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)(T.Qr,{control:c,name:"metadata.email",rules:{required:"Please enter email address.",validate:e=>(0,A.zL)(e)||"Please enter a valid email address"},render:e=>{var t;let{field:{value:s,onChange:n,ref:r}}=e;return(0,l.jsx)(d.II,{id:"metadata.email",type:"email",value:s,onChange:n,ref:r,hasError:!!(null===(t=u.metadata)||void 0===t?void 0:t.email),placeholder:"name@company.com",className:"w-full"})}}),(null===(s=u.metadata)||void 0===s?void 0:s.email)&&(0,l.jsx)("p",{className:"text-red-500 text-xs",children:u.metadata.email.message})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-10 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)("h3",{className:"font-semibold",children:"Jira Installation or Cloud Host Name"}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Enter your companies cloud host name"})]}),(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)(T.Qr,{control:c,name:"metadata.cloud_hostname",rules:{required:"Please enter your cloud host name.",validate:e=>!/^https?:\/\//.test(e)||"Hostname should not begin with http:// or https://"},render:e=>{var t;let{field:{value:s,onChange:n,ref:r}}=e;return(0,l.jsx)(d.II,{id:"metadata.cloud_hostname",value:s,onChange:n,ref:r,hasError:!!(null===(t=u.metadata)||void 0===t?void 0:t.cloud_hostname),placeholder:"my-company.atlassian.net",className:"w-full"})}}),(null===(n=u.metadata)||void 0===n?void 0:n.cloud_hostname)&&(0,l.jsx)("p",{className:"text-red-500 text-xs",children:u.metadata.cloud_hostname.message})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-10 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)("h3",{className:"font-semibold",children:"Import to project"}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Select which project you want to import to."})]}),(0,l.jsx)("div",{className:"col-span-1",children:(0,l.jsx)(T.Qr,{control:c,name:"project_id",rules:{required:"Please select a project."},render:e=>{var t;let{field:{value:s,onChange:n}}=e;return(0,l.jsxs)(d.AP,{value:s,input:!0,onChange:n,label:(0,l.jsx)("span",{children:s&&""!==s.trim()?null===(t=o(s))||void 0===t?void 0:t.name:(0,l.jsx)("span",{className:"text-custom-text-200",children:"Select a project"})}),optionsClassName:"w-full",children:[i&&i.length>0?i.map(e=>{let t=o(e);if(t)return(0,l.jsx)(d.AP.Option,{value:e,children:t.name},e)}):(0,l.jsx)("div",{className:"flex cursor-pointer select-none items-center space-x-2 truncate rounded px-1 py-1.5 text-custom-text-200",children:(0,l.jsxs)("p",{children:["You don","'","t have any project. Please create a project first."]})}),(0,l.jsx)("div",{children:(0,l.jsxs)("button",{type:"button",onClick:()=>{a("Jira import detail page"),r.toggleCreateProjectModal(!0)},className:"flex cursor-pointer select-none items-center space-x-2 truncate rounded px-1 py-1.5 text-custom-text-200",children:[(0,l.jsx)(ec.Z,{className:"h-4 w-4 text-custom-text-200"}),(0,l.jsx)("span",{children:"Create new project"})]})})]})}})})]})]})}),eu=new C.ig,em=e=>{var t,s,i,o,c,m,h,p,x;let{setCurrentStep:f,setDisableTopBarAfter:v}=e,{watch:g,setValue:j,control:b,formState:{errors:y}}=(0,T.Gc)(),{workspaceSlug:w}=(0,r.useRouter)().query,N={api_token:g("metadata.api_token"),project_key:g("metadata.project_key"),email:g("metadata.email"),cloud_hostname:g("metadata.cloud_hostname")},{data:k,error:C}=(0,a.ZP)(!w||(null===(t=y.metadata)||void 0===t?void 0:t.api_token)||(null===(s=y.metadata)||void 0===s?void 0:s.project_key)||(null===(i=y.metadata)||void 0===i?void 0:i.email)||(null===(o=y.metadata)||void 0===o?void 0:o.cloud_hostname)?null:(0,u.cE)(w.toString(),N),!w||(null===(c=y.metadata)||void 0===c?void 0:c.api_token)||(null===(m=y.metadata)||void 0===m?void 0:m.project_key)||(null===(h=y.metadata)||void 0===h?void 0:h.email)||(null===(p=y.metadata)||void 0===p?void 0:p.cloud_hostname)?null:()=>eu.getJiraProjectInfo(w.toString(),N));return((0,n.useEffect)(()=>{var e;k&&(j("data.total_issues",k.issues),j("data.total_labels",k.labels),j("data.users",null===(e=k.users)||void 0===e?void 0:e.map(e=>({email:e.emailAddress,import:!1,username:e.displayName}))),j("data.total_states",k.states),j("data.total_modules",k.modules))},[k,j]),(0,n.useEffect)(()=>{C?v("display-import-data"):v(null)},[C,v]),(0,n.useEffect)(()=>{k||C?C||v(null):v("display-import-data")},[k,C,v]),k||C)?C?(0,l.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,l.jsxs)("p",{className:"text-sm text-custom-text-200",children:["Something went wrong. Please"," ",(0,l.jsx)("button",{onClick:()=>f({state:"import-configure"}),type:"button",className:"inline text-custom-primary underline",children:"go back"})," ","and check your Jira project details."]})}):(0,l.jsxs)("div",{className:"h-full w-full space-y-10 overflow-y-auto",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-10 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)("h3",{className:"font-semibold",children:"Import Data"}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Import Completed. We have found:"})]}),(0,l.jsxs)("div",{className:"col-span-1 flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"mb-2 text-lg font-semibold",children:null==k?void 0:k.issues}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Issues"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"mb-2 text-lg font-semibold",children:null==k?void 0:k.states}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"States"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"mb-2 text-lg font-semibold",children:null==k?void 0:k.modules}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Modules"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"mb-2 text-lg font-semibold",children:null==k?void 0:k.labels}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Labels"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"mb-2 text-lg font-semibold",children:null==k?void 0:null===(x=k.users)||void 0===x?void 0:x.length}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Users"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-10 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)("h3",{className:"font-semibold",children:"Import Epics"}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Import epics as modules"})]}),(0,l.jsx)("div",{className:"col-span-1",children:(0,l.jsx)(T.Qr,{control:b,name:"config.epics_to_modules",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(d.Zh,{onChange:s,value:t})}})})]})]}):(0,l.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,l.jsx)(d.$j,{})})},eh=new et.A,ep=()=>{var e;let{workspaceSlug:t}=(0,r.useRouter)().query,{control:s,watch:n,formState:{errors:i}}=(0,T.Gc)(),{fields:o}=(0,T.Dq)({control:s,name:"data.users"}),{data:c}=(0,a.ZP)(t?(0,u.YW)(null!==(e=null==t?void 0:t.toString())&&void 0!==e?e:""):null,t?()=>{var e;return eh.fetchWorkspaceMembers(null!==(e=null==t?void 0:t.toString())&&void 0!==e?e:"")}:null),m=null==c?void 0:c.map(e=>{var t;if(null==e?void 0:e.member)return{value:e.member.email,query:null!==(t=e.member.display_name)&&void 0!==t?t:"",content:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.qE,{name:null==e?void 0:e.member.display_name,src:null==e?void 0:e.member.avatar}),e.member.display_name]})}}).filter(e=>!!e);return(0,l.jsxs)("div",{className:"h-full w-full space-y-10 divide-y-2 divide-custom-border-200 overflow-y-auto",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-10 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"col-span-1",children:[(0,l.jsx)("h3",{className:"font-semibold",children:"Users"}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Update, invite or choose not to invite assignee"})]}),(0,l.jsx)("div",{className:"col-span-1",children:(0,l.jsx)(T.Qr,{control:s,name:"data.invite_users",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(d.Zh,{onChange:s,value:t})}})})]}),n("data.invite_users")&&(0,l.jsxs)("div",{className:"pt-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsx)("div",{className:"col-span-1 text-sm text-custom-text-200",children:"Name"}),(0,l.jsx)("div",{className:"col-span-1 text-sm text-custom-text-200",children:"Import as"})]}),(0,l.jsx)("div",{className:"mt-5 space-y-3",children:o.map((e,t)=>(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsx)("div",{className:"col-span-1",children:(0,l.jsx)("p",{children:e.username})}),(0,l.jsx)("div",{className:"col-span-1",children:(0,l.jsx)(T.Qr,{control:s,name:"data.users.".concat(t,".import"),render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsxs)(d.AP,{input:!0,value:t,onChange:s,optionsClassName:"w-full",label:(0,l.jsx)("span",{className:"capitalize",children:t||"Ignore"}),children:[(0,l.jsx)(d.AP.Option,{value:"invite",children:"Invite by email"}),(0,l.jsx)(d.AP.Option,{value:"map",children:"Map to existing"}),(0,l.jsx)(d.AP.Option,{value:!1,children:"Do not import"})]})}})}),(0,l.jsxs)("div",{className:"col-span-1",children:["invite"===n("data.users.".concat(t,".import"))&&(0,l.jsx)(T.Qr,{control:s,name:"data.users.".concat(t,".email"),rules:{required:"This field is required"},render:e=>{var s,n,r;let{field:{value:a,onChange:o,ref:c}}=e;return(0,l.jsx)(d.II,{id:"data.users.".concat(t,".email"),name:"data.users.".concat(t,".email"),type:"text",value:a,onChange:o,ref:c,hasError:!!(null===(r=i.data)||void 0===r?void 0:null===(n=r.users)||void 0===n?void 0:null===(s=n[t])||void 0===s?void 0:s.email),className:"w-full"})}}),"map"===n("data.users.".concat(t,".import"))&&(0,l.jsx)(T.Qr,{control:s,name:"data.users.".concat(t,".email"),render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(d.RO,{value:t,input:!0,label:""!==t?t:"Select user from project",options:m,onChange:s,optionsClassName:"w-full"})}})]})]},"".concat(e.email,"-").concat(e.username)))})]})]})},ex=()=>{let{watch:e}=(0,T.Gc)();return(0,l.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-10 md:grid-cols-2",children:[(0,l.jsx)("div",{className:"col-span-2",children:(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Confirm"})}),(0,l.jsx)("div",{className:"col-span-1",children:(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Migrating"})}),(0,l.jsxs)("div",{className:"col-span-1 flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"mb-2 text-lg font-semibold",children:e("data.total_issues")}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Issues"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"mb-2 text-lg font-semibold",children:e("data.total_states")}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"States"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"mb-2 text-lg font-semibold",children:e("data.total_modules")}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Modules"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"mb-2 text-lg font-semibold",children:e("data.total_labels")}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Labels"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"mb-2 text-lg font-semibold",children:e("data.users").filter(e=>e.import).length}),(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"User"})]})]})]})})},ef={metadata:{cloud_hostname:"",api_token:"",project_key:"",email:""},config:{epics_to_modules:!1},data:{users:[],invite_users:!0,total_issues:0,total_labels:0,total_modules:0,total_states:0},project_id:""},ev=new(s(40923)).z,eg=(0,g.Pi)(e=>{let{integration:t}=e,{config:{envConfig:s}}=(0,w.IX)(),[i,o]=(0,n.useState)(!1),[c,m]=(0,n.useState)(null),{workspaceSlug:h,projectId:p}=(0,r.useRouter)().query,{startAuth:x}=N({provider:"slackChannel",stateParams:t.id,github_app_name:(null==s?void 0:s.github_client_id)||"",slack_client_id:(null==s?void 0:s.slack_client_id)||""}),{data:f}=(0,a.ZP)(h&&p&&t.id?(0,u.IK)(h,p):null,()=>h&&p&&t.id?ev.getSlackChannelDetail(h,p,t.id):null);(0,n.useEffect)(()=>{if(p&&f&&f.length>0){let e=f.find(e=>e.project===p);e&&(m(()=>e),o(!0))}},[f,p]);let v=async()=>{h&&p&&0!==f.length&&((0,a.JG)((0,u.IK)(null==h?void 0:h.toString(),null==p?void 0:p.toString()),e=>{if(e)return e.id!==t.id}).then(()=>{o(!1),m(null)}),ev.removeSlackChannel(h,p,t.id,null==c?void 0:c.id).catch(e=>console.error(e)))},g=async()=>{await x()};return(0,l.jsx)(l.Fragment,{children:f?(0,l.jsx)("button",{type:"button",className:"relative inline-flex h-4 w-6 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent bg-gray-700 transition-colors duration-200 ease-in-out focus:outline-none",role:"switch","aria-checked":!0,onClick:()=>{i?v():g()},children:(0,l.jsx)("span",{"aria-hidden":"true",className:"inline-block h-2 w-2 transform self-center rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ".concat(i?"translate-x-3":"translate-x-0")})}):(0,l.jsx)(d.aN,{children:(0,l.jsx)(d.aN.Item,{height:"35px",width:"150px"})})})})},31543:function(e,t,s){s.d(t,{j:function(){return h}});var l=s(24246),n=s(27378),r=s(66726),a=s.n(r),i=s(50649),o=s(88039),c=s(25449),d=s(16925),u=s(85409),m=s(10634);let h=(0,i.Pi)(e=>{var t;let{containerClassName:s,workspaceSlug:r,projectId:i,issueId:h,disabled:p,swrIssueDescription:x,initialValue:f,issueOperations:v,setIsSubmitting:g,placeholder:j}=e,{handleSubmit:b,reset:y,control:w}=(0,o.cI)({defaultValues:{description_html:f}}),[N,k]=(0,n.useState)({id:h,description_html:f}),C=(0,n.useCallback)(async e=>{var t;await v.update(r,i,h,{description_html:null!==(t=e.description_html)&&void 0!==t?t:"<p></p>"})},[r,i,h,v]),{getWorkspaceBySlug:S}=(0,m.cF)(),_=null===(t=S(r))||void 0===t?void 0:t.id;(0,n.useEffect)(()=>{h&&(y({id:h,description_html:""===f?"<p></p>":f}),k({id:h,description_html:""===f?"<p></p>":f}))},[f,h,y]);let I=(0,n.useCallback)(a()(async()=>{b(C)().finally(()=>g("submitted"))},1500),[b,h]);return(0,l.jsx)(l.Fragment,{children:N.description_html?(0,l.jsx)(o.Qr,{name:"description_html",control:w,render:e=>{var t,n;let{field:{onChange:a}}=e;return p?(0,l.jsx)(d.hh,{initialValue:null!==(n=N.description_html)&&void 0!==n?n:"",containerClassName:s}):(0,l.jsx)(d.LD,{id:h,initialValue:null!==(t=N.description_html)&&void 0!==t?t:"<p></p>",value:null!=x?x:null,workspaceSlug:r,workspaceId:_,projectId:i,dragDropEnabled:!0,onChange:(e,t)=>{g("submitting"),a(t),I()},placeholder:j||((e,t)=>(0,u.cG)(e,t)),containerClassName:s})}}):(0,l.jsx)(c.aN,{children:(0,l.jsx)(c.aN.Item,{height:"150px"})})})})},68114:function(e,t,s){s.d(t,{Iyz:function(){return es.Iy},LnW:function(){return es.Ln},zgM:function(){return es.zg},v4D:function(){return es.v4},ePR:function(){return es.eP},lx$:function(){return es.lx},oVA:function(){return es.oV},Ok:function(){return es.Ok},Rlr:function(){return es.Rl},sR5:function(){return es.sR},doF:function(){return es.do},WyS:function(){return tm},TMo:function(){return es.TM},Tu3:function(){return es.Tu},IxC:function(){return es.Ix},YBb:function(){return es.YB},kM0:function(){return tx},JKi:function(){return es.JK},ccE:function(){return es.cc},vlV:function(){return es.vl},m0y:function(){return es.m0},Hbl:function(){return es.Hb},oqf:function(){return es.oq},Tdk:function(){return es.Td},VCE:function(){return es.VC},wES:function(){return es.wE},qkP:function(){return es.qk},Slh:function(){return es.Sl},Aod:function(){return es.Ao},TUF:function(){return eh},vlH:function(){return ee},bqx:function(){return es.bq},C0u:function(){return es.C0},ZRF:function(){return es.ZR},B7_:function(){return es.B7},JWn:function(){return es.JW},TsF:function(){return es.Ts},dWL:function(){return es.dW},jNT:function(){return es.jN},rKc:function(){return et},hvF:function(){return es.hv},e3T:function(){return es.e3},Npw:function(){return es.Np},aIs:function(){return es.aI},Fdm:function(){return es.Fd},KGn:function(){return es.KG},D8r:function(){return es.D8},n1O:function(){return es.n1},YHs:function(){return es.YH},eBn:function(){return es.eB},Epc:function(){return es.Ep},$F:function(){return es.$F},iLy:function(){return es.iL},f2:function(){return es.f2},XZH:function(){return es.XZ},sRr:function(){return es.ZC},xB8:function(){return es.xB},dGX:function(){return es.dG},M2_:function(){return es.M2},jVv:function(){return es.jV},ln$:function(){return es.ln},uKd:function(){return es.uK},y_u:function(){return es.y_},lqY:function(){return es.lq},WlD:function(){return es.Wl},Koj:function(){return es.Ko},yz7:function(){return es.yz},J3d:function(){return ef.J3},em:function(){return ef.em},T4S:function(){return _},qRX:function(){return I},aSx:function(){return k},Flk:function(){return C},aTZ:function(){return es.aT},dPY:function(){return ef.dP},BJF:function(){return ef.BJ},zKH:function(){return eY},ji:function(){return el.j},UN3:function(){return tc},b5H:function(){return es.b5},JP6:function(){return es.JP},WK7:function(){return ev},DtO:function(){return eL},wPB:function(){return eX},nW6:function(){return e0},Kyp:function(){return td.Ky},ko_:function(){return td.ko},Joz:function(){return eW.J},r5l:function(){return e1.r},PBC:function(){return ti},N6_:function(){return en.N},y2U:function(){return ex},tzh:function(){return td.tz},vEg:function(){return es.vE},RXO:function(){return es.RX},ZxZ:function(){return es.Zx},PSe:function(){return es.PS},LnB:function(){return es.vn},c9j:function(){return es.c9},Wr2:function(){return es.Wr},yvv:function(){return es.yv},E_y:function(){return es.E_},PFz:function(){return es.PF},SUg:function(){return es.SU},xn4:function(){return es.xn},Xbm:function(){return es.Xb},IF1:function(){return es.IF},dwI:function(){return em},Nph:function(){return td.Np},$GQ:function(){return td.$G},SCJ:function(){return td.SC},s4m:function(){return es.s4},ATT:function(){return es.AT},eSk:function(){return es.eS},Si1:function(){return es.Si},naC:function(){return es.n},$EI:function(){return es.$E},fTy:function(){return es.fT},YQC:function(){return es.YQ},ZUr:function(){return es.ZU},WNn:function(){return es.WN},NHz:function(){return es.NH},qfU:function(){return es.qf},m$2:function(){return es.m$},cTm:function(){return es.cT},Chv:function(){return es.Ch},L7G:function(){return es.L7},R1o:function(){return es.R1}});var l=s(24246),n=s(50649),r=s(79894),a=s.n(r),i=s(93965),o=s(82558),c=s(25449),d=s(9405);let u=e=>{let t=new Date().getTime(),s=h(e),l=s.length>80?s.substring(0,80):s,n=m(e);return"".concat(l,"-").concat(t,".").concat(n)},m=e=>e.slice((e.lastIndexOf(".")-1>>>0)+2),h=e=>{let t=e.lastIndexOf(".");return e.substring(0,t)},p=e=>e<1048576?Math.round(e/1024)+" KB":Math.round(e/1048576)+" MB";var x=s(74273),f=s(10712),v=s(10634),g=s(18894);let j=(0,n.Pi)(e=>{var t,s;let{attachmentId:n,handleAttachmentOperations:r,disabled:u}=e,{getUserDetails:j}=(0,v.Kb)(),{attachment:{getAttachmentById:b},isDeleteAttachmentModalOpen:y,toggleDeleteAttachmentModal:w}=(0,v.p1)(),N=n?b(n):void 0,{isMobile:k}=(0,g.L)();return N?(0,l.jsxs)(l.Fragment,{children:[y===N.id&&(0,l.jsx)(_,{isOpen:!!y,onClose:()=>w(null),handleAttachmentOperations:r,data:N}),(0,l.jsxs)("div",{className:"flex h-[60px] items-center justify-between gap-1 rounded-md border-[2px] border-custom-border-200 bg-custom-background-100 px-4 py-2 text-sm",children:[(0,l.jsx)(a(),{href:N.asset,target:"_blank",rel:"noopener noreferrer",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"h-7 w-7",children:(0,d.LP)(m(N.asset))}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.u,{tooltipContent:h(N.attributes.name),isMobile:k,children:(0,l.jsx)("span",{className:"text-sm",children:(0,f.aF)("".concat(h(N.attributes.name)),10)})}),(0,l.jsx)(c.u,{isMobile:k,tooltipContent:"".concat(null!==(s=null===(t=j(N.updated_by))||void 0===t?void 0:t.display_name)&&void 0!==s?s:""," uploaded on ").concat((0,x.ot)(N.updated_at)),children:(0,l.jsx)("span",{children:(0,l.jsx)(i.Z,{className:"h-3 w-3"})})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 text-xs text-custom-text-200",children:[(0,l.jsx)("span",{children:m(N.asset).toUpperCase()}),(0,l.jsx)("span",{children:p(N.attributes.size)})]})]})]})}),!u&&(0,l.jsx)("button",{type:"button",onClick:()=>w(N.id),children:(0,l.jsx)(o.Z,{className:"h-4 w-4 text-custom-text-200 hover:text-custom-text-100"})})]})]}):(0,l.jsx)(l.Fragment,{})});var b=s(27378),y=s(43659),w=s(44833),N=s(60583);let k=(0,y.Pi)(e=>{var t,s;let{workspaceSlug:n,disabled:r=!1,handleAttachmentOperations:a}=e,{config:{envConfig:i}}=(0,v.IX)(),[o,c]=(0,b.useState)(!1),d=(0,b.useCallback)(e=>{let t=e[0];if(!t||!n)return;let s=new File([t],u(t.name),{type:t.type}),l=new FormData;l.append("asset",s),l.append("attributes",JSON.stringify({name:s.name,size:s.size})),c(!0),a.create(l).finally(()=>c(!1))},[a,n]),{getRootProps:m,getInputProps:h,isDragActive:p,isDragReject:x,fileRejections:f}=(0,w.uI)({onDrop:d,maxSize:null!==(t=null==i?void 0:i.file_size_limit)&&void 0!==t?t:N.T,multiple:!1,disabled:o||r}),g=null!==(s=null==i?void 0:i.file_size_limit)&&void 0!==s?s:N.T,j=f.length>0?"Invalid file type or size (max ".concat(g/1024/1024," MB)"):null;return(0,l.jsxs)("div",{...m(),className:"flex h-[60px] items-center justify-center rounded-md border-2 border-dashed bg-custom-primary/5 px-4 text-xs text-custom-primary ".concat(p?"border-custom-primary bg-custom-primary/10":"border-custom-border-200"," ").concat(x?"bg-red-100":""," ").concat(r?"cursor-not-allowed":"cursor-pointer"),children:[(0,l.jsx)("input",{...h()}),(0,l.jsx)("span",{className:"flex items-center gap-2",children:p?(0,l.jsx)("p",{children:"Drop here..."}):j?(0,l.jsx)("p",{className:"text-center text-red-500",children:j}):o?(0,l.jsx)("p",{className:"text-center",children:"Uploading..."}):(0,l.jsx)("p",{className:"text-center",children:"Click or drag a file here"})})]})}),C=(0,y.Pi)(e=>{let{issueId:t,handleAttachmentOperations:s,disabled:n}=e,{attachment:{getAttachmentsByIssueId:r}}=(0,v.p1)(),a=r(t);return a?(0,l.jsx)(l.Fragment,{children:null==a?void 0:a.map(e=>(0,l.jsx)(j,{attachmentId:e,disabled:n,handleAttachmentOperations:s},e))}):(0,l.jsx)(l.Fragment,{})});var S=s(23258);let _=e=>{let{isOpen:t,onClose:s,data:n,handleAttachmentOperations:r}=e,[a,i]=(0,b.useState)(!1),o=()=>{s(),i(!1)},c=async e=>{i(!0),r.remove(e).finally(()=>o())};return(0,l.jsx)(S.qv,{handleClose:o,handleSubmit:()=>c(n.id),isDeleting:a,isOpen:t,title:"Delete attachment",content:(0,l.jsxs)(l.Fragment,{children:["Are you sure you want to delete attachment-"," ",(0,l.jsx)("span",{className:"font-bold",children:h(n.attributes.name)}),"? This attachment will be permanently removed. This action cannot be undone."]})})},I=e=>{let{workspaceSlug:t,projectId:s,issueId:n,disabled:r=!1}=e,{createAttachment:a,removeAttachment:i}=(0,v.p1)(),{captureIssueEvent:o}=(0,v.DN)(),d=(0,b.useMemo)(()=>({create:async e=>{try{if(!t||!s||!n)throw Error("Missing required fields");let l=a(t,s,n,e);(0,c.uW)(l,{loading:"Uploading attachment...",success:{title:"Attachment uploaded",message:()=>"The attachment has been successfully uploaded"},error:{title:"Attachment not uploaded",message:()=>"The attachment could not be uploaded"}});let r=await l;o({eventName:"Issue attachment added",payload:{id:n,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:"attachment",change_details:r.id}})}catch(e){o({eventName:"Issue attachment added",payload:{id:n,state:"FAILED",element:"Issue detail page"}})}},remove:async e=>{try{if(!t||!s||!n)throw Error("Missing required fields");await i(t,s,n,e),(0,c.fz)({message:"The attachment has been successfully removed",type:c.do.SUCCESS,title:"Attachment removed"}),o({eventName:"Issue attachment deleted",payload:{id:n,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:"attachment",change_details:""}})}catch(e){o({eventName:"Issue attachment deleted",payload:{id:n,state:"FAILED",element:"Issue detail page"},updates:{changed_property:"attachment",change_details:""}}),(0,c.fz)({message:"The Attachment could not be removed",type:c.do.ERROR,title:"Attachment not removed"})}}}),[o,t,s,n,a,i]);return(0,l.jsxs)("div",{className:"relative py-3 space-y-3",children:[(0,l.jsx)("h3",{className:"text-lg",children:"Attachments"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4",children:[(0,l.jsx)(k,{workspaceSlug:t,disabled:r,handleAttachmentOperations:d}),(0,l.jsx)(C,{issueId:n,disabled:r,handleAttachmentOperations:d})]})]})};var E=s(90104),P=s.n(E),R=s(86677),F=s(88039),O=s(31920),T=s(34202),A=s(36738),D=s(20141),M=s(30800),z=s(56030),L=s(85409),Z=s(26313);let q=()=>{let{fetchProjectStates:e}=(0,v.eD)(),{project:{fetchProjectMembers:t}}=(0,v.Kb)(),{fetchProjectLabels:s}=(0,v.NP)(),{fetchAllCycles:l}=(0,v.nv)(),{fetchModules:n}=(0,v.b7)(),{fetchProjectEstimates:r}=(0,v.ZT)(),a=async(t,s)=>{t&&s&&await e(t.toString(),s.toString())},i=async(e,s)=>{e&&s&&await t(e.toString(),s.toString())},o=async(e,t)=>{e&&t&&await s(e.toString(),t.toString())},c=async(e,t)=>{e&&t&&await l(e.toString(),t.toString())},d=async(e,t)=>{e&&t&&await n(e.toString(),t.toString())},u=async(e,t)=>{e&&t&&await r(e.toString(),t.toString())};return{fetchAll:async(e,t)=>{e&&t&&(await a(e,t),await i(e,t),await o(e,t),await c(e,t),await d(e,t),await u(e,t))},fetchStates:a,fetchMembers:i,fetchLabels:o,fetchCycles:c,fetchModules:d,fetchEstimates:u}};var B=s(82992);let U={project_id:"",name:"",description_html:"",estimate_point:null,state_id:"",parent_id:null,priority:"none",assignee_ids:[],label_ids:[],cycle_id:null,module_ids:null,start_date:null,target_date:null},V=new B.Y,W=["name","description_html","feeling_lucky","ai_assistant","state_id","priority","assignee_ids","label_ids","start_date","target_date","cycle_id","module_ids","estimate_point","parent_id","create_more","discard_button","draft_button","submit_button","project_id","remove_parent"],K=e=>W.findIndex(t=>t===e)+1,Y=(0,y.Pi)(e=>{var t,s;let{data:n,issueTitleRef:r,onChange:a,onClose:i,onSubmit:d,projectId:u,isCreateMoreToggleEnabled:m,onCreateMoreToggleChange:h,isDraft:p}=e,[f,g]=(0,b.useState)(!1),[j,y]=(0,b.useState)(!1),[w,N]=(0,b.useState)(null),[k,C]=(0,b.useState)(!1),[_,I]=(0,b.useState)(!1),E=(0,b.useRef)(null),{workspaceSlug:P}=(0,R.useRouter)().query,B=null===(t=(0,v.cF)().getWorkspaceBySlug(P))||void 0===t?void 0:t.id,{config:{envConfig:W},router:{projectId:Y}}=(0,v.IX)(),{getProjectById:J}=(0,v.PY)(),{areEstimatesEnabledForProject:H}=(0,v.ZT)(),{issue:{getIssueById:Q}}=(0,v.p1)(),{fetchCycles:G}=q(),{formState:{errors:$,isDirty:X,isSubmitting:ee,dirtyFields:et},handleSubmit:es,reset:el,watch:en,control:er,getValues:ea,setValue:ei}=(0,F.cI)({defaultValues:{...U,project_id:u,...n},reValidateMode:"onChange"}),eo=en("project_id");(0,b.useEffect)(()=>{if(X){let e=ea();el({...U,project_id:eo,name:e.name,description_html:e.description_html,priority:e.priority,start_date:e.start_date,target_date:e.target_date,parent_id:e.parent_id})}eo&&Y!==eo&&G(P,eo)},[eo]),(0,b.useEffect)(()=>{(null==n?void 0:n.description_html)&&ei("description_html",null==n?void 0:n.description_html)},[null==n?void 0:n.description_html]);let ec=en("name"),ed=async function(e){var t,s,l;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=(null==n?void 0:n.id)?{...(0,L.s5)(e,et),project_id:ea("project_id"),id:n.id,description_html:null!==(s=e.description_html)&&void 0!==s?s:"<p></p>"}:e;e.hasOwnProperty("is_draft")&&(a.is_draft=e.is_draft),await d(a,r),C(!1),el({...U,...m?{...n}:{},project_id:ea("project_id"),description_html:null!==(l=null==n?void 0:n.description_html)&&void 0!==l?l:"<p></p>"}),null==E||null===(t=E.current)||void 0===t||t.clearEditor()},eu=async e=>{var t;P&&eo&&(null===(t=E.current)||void 0===t||t.setEditorValueAtCursorPosition(e))},eh=async()=>{P&&eo&&(I(!0),V.createGptTask(P.toString(),eo,{prompt:ec,task:"Generate a proper description for this issue."}).then(e=>{""===e.response?(0,c.fz)({type:c.do.ERROR,title:"Error!",message:"Issue title isn't informative enough to generate the description. Please try with a different title."}):eu(e.response_html)}).catch(e=>{var t;let s=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.error;429===e.status?(0,c.fz)({type:c.do.ERROR,title:"Error!",message:s||"You have reached the maximum number of requests of 50 requests per month per user."}):(0,c.fz)({type:c.do.ERROR,title:"Error!",message:s||"Some error occurred. Please try again."})}).finally(()=>I(!1)))},ep=()=>{a&&(X&&(en("name")||en("description_html"))?a(en()):a(null))},ex=en("start_date"),ef=en("target_date"),ev=(0,x._3)(ex);null==ev||ev.setDate(ev.getDate());let eg=(0,x._3)(ef);null==eg||eg.setDate(eg.getDate());let ej=J(eo);return(0,b.useEffect)(()=>{let e=en("parent_id")||void 0;if(!e||e===(null==w?void 0:w.id)||w)return;let t=Q(e);if(!t)return;let s=J(t.project_id);s&&N({id:t.id,name:t.name,project_id:t.project_id,project__identifier:s.identifier,project__name:s.name,sequence_id:t.sequence_id})},[en,Q,J,w]),(0,l.jsxs)(l.Fragment,{children:[eo&&(0,l.jsx)(z.Pe,{isOpen:f,handleClose:()=>g(!1),projectId:eo,onSuccess:e=>{ei("label_ids",[...en("label_ids"),e.id]),ep()}}),(0,l.jsxs)("form",{onSubmit:es(e=>ed(e)),children:[(0,l.jsxs)("div",{className:"space-y-5 p-5",children:[(0,l.jsxs)("div",{className:"flex items-center gap-x-3",children:[!(null==n?void 0:n.id)&&(0,l.jsx)(F.Qr,{control:er,name:"project_id",rules:{required:!0},render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(A.MB,{value:t,onChange:e=>{s(e),ep()},buttonVariant:"border-with-text",renderCondition:e=>(0,Z.Fn)(e),tabIndex:K("project_id")})})}}),(0,l.jsxs)("h3",{className:"text-xl font-medium text-custom-text-200",children:[(null==n?void 0:n.id)?"Update":"Create"," Issue"]})]}),en("parent_id")&&w&&(0,l.jsx)(F.Qr,{control:er,name:"parent_id",render:e=>{let{field:{onChange:t}}=e;return(0,l.jsx)("div",{className:"flex w-min items-center gap-2 whitespace-nowrap rounded bg-custom-background-90 p-2 text-xs",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"block h-1.5 w-1.5 rounded-full",style:{backgroundColor:w.state__color}}),(0,l.jsxs)("span",{className:"flex-shrink-0 text-custom-text-200",children:[w.project__identifier,"-",w.sequence_id]}),(0,l.jsx)("span",{className:"truncate font-medium",children:w.name.substring(0,50)}),(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>{t(null),ep(),N(null)},tabIndex:K("remove_parent"),children:(0,l.jsx)(o.Z,{className:"h-3 w-3 cursor-pointer"})})]})})}}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)(F.Qr,{control:er,name:"name",rules:{required:"Title is required",maxLength:{value:255,message:"Title should be less than 255 characters"}},render:e=>{let{field:{value:t,onChange:s,ref:n}}=e;return(0,l.jsx)(c.II,{id:"name",name:"name",type:"text",value:t,onChange:e=>{s(e.target.value),ep()},ref:r||n,hasError:!!$.name,placeholder:"Title",className:"w-full text-base",tabIndex:K("name"),autoFocus:!0})}}),(0,l.jsx)("span",{className:"text-xs text-red-500",children:null==$?void 0:null===(s=$.name)||void 0===s?void 0:s.message})]}),(0,l.jsx)("div",{className:"relative",children:(null==n?void 0:n.description_html)===void 0?(0,l.jsxs)(c.aN,{className:"min-h-[7rem] space-y-2 overflow-hidden rounded-md border border-custom-border-200 p-2 py-2",children:[(0,l.jsx)(c.aN.Item,{width:"100%",height:"26px"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.aN.Item,{width:"26px",height:"26px"}),(0,l.jsx)(c.aN.Item,{width:"400px",height:"26px"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.aN.Item,{width:"26px",height:"26px"}),(0,l.jsx)(c.aN.Item,{width:"400px",height:"26px"})]}),(0,l.jsx)(c.aN.Item,{width:"80%",height:"26px"}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsx)(c.aN.Item,{width:"50%",height:"26px"})}),(0,l.jsxs)("div",{className:"border-0.5 absolute bottom-3.5 right-3.5 z-10 flex items-center gap-2",children:[(0,l.jsx)(c.aN.Item,{width:"100px",height:"26px"}),(0,l.jsx)(c.aN.Item,{width:"50px",height:"26px"})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"border-0.5 absolute bottom-3.5 right-3.5 z-10 flex items-center gap-2",children:[ec&&""!==ec.trim()&&(null==W?void 0:W.has_openai_configured)&&(0,l.jsx)("button",{type:"button",className:"flex items-center gap-1 rounded bg-custom-background-90 px-1.5 py-1 text-xs ".concat(_?"cursor-wait":""),onClick:eh,disabled:_,tabIndex:K("feeling_lucky"),children:_?"Generating response":(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(O.Z,{className:"h-3.5 w-3.5"}),"I","'","m feeling lucky"]})}),(null==W?void 0:W.has_openai_configured)&&(0,l.jsx)(S.TM,{isOpen:k,projectId:eo,handleClose:()=>{C(e=>!e),el(ea())},onResponse:e=>{eu(e)},placement:"top-end",button:(0,l.jsxs)("button",{type:"button",className:"flex items-center gap-1 rounded px-1.5 py-1 text-xs hover:bg-custom-background-90",onClick:()=>C(e=>!e),tabIndex:K("ai_assistant"),children:[(0,l.jsx)(O.Z,{className:"h-4 w-4"}),"AI"]})})]}),(0,l.jsx)(F.Qr,{name:"description_html",control:er,render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(D.L,{initialValue:t,value:n.description_html,workspaceSlug:null==P?void 0:P.toString(),workspaceId:B,projectId:eo,onChange:(e,t)=>{s(t),ep()},ref:E,tabIndex:K("description_html"),placeholder:L.cG,containerClassName:"border-[0.5px] border-custom-border-200 py-3 min-h-[150px]"})}})]})}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,l.jsx)(F.Qr,{control:er,name:"state_id",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(A.sb,{value:t,onChange:e=>{s(e),ep()},projectId:eo,buttonVariant:"border-with-text",tabIndex:K("state_id")})})}}),(0,l.jsx)(F.Qr,{control:er,name:"priority",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(A.Iw,{value:t,onChange:e=>{s(e),ep()},buttonVariant:"border-with-text",tabIndex:K("priority")})})}}),(0,l.jsx)(F.Qr,{control:er,name:"assignee_ids",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(A.Yp,{projectId:eo,value:t,onChange:e=>{s(e),ep()},buttonVariant:(null==t?void 0:t.length)>0?"transparent-without-text":"border-with-text",buttonClassName:(null==t?void 0:t.length)>0?"hover:bg-transparent":"",placeholder:"Assignees",multiple:!0,tabIndex:K("assignee_ids")})})}}),(0,l.jsx)(F.Qr,{control:er,name:"label_ids",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(M.p,{setIsOpen:g,value:t,onChange:e=>{s(e),ep()},projectId:eo,tabIndex:K("label_ids")})})}}),(0,l.jsx)(F.Qr,{control:er,name:"start_date",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(A.qp,{value:t,onChange:e=>s(e?(0,x.ss)(e):null),buttonVariant:"border-with-text",maxDate:null!=eg?eg:void 0,placeholder:"Start date",tabIndex:K("start_date")})})}}),(0,l.jsx)(F.Qr,{control:er,name:"target_date",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(A.qp,{value:t,onChange:e=>s(e?(0,x.ss)(e):null),buttonVariant:"border-with-text",minDate:null!=ev?ev:void 0,placeholder:"Due date",tabIndex:K("target_date")})})}}),(null==ej?void 0:ej.cycle_view)&&(0,l.jsx)(F.Qr,{control:er,name:"cycle_id",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(A._X,{projectId:eo,onChange:e=>{s(e),ep()},placeholder:"Cycle",value:t,buttonVariant:"border-with-text",tabIndex:K("cycle_id")})})}}),(null==ej?void 0:ej.module_view)&&P&&(0,l.jsx)(F.Qr,{control:er,name:"module_ids",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(A.xL,{projectId:eo,value:null!=t?t:[],onChange:e=>{s(e),ep()},placeholder:"Modules",buttonVariant:"border-with-text",tabIndex:K("module_ids"),multiple:!0,showCount:!0})})}}),H(eo)&&(0,l.jsx)(F.Qr,{control:er,name:"estimate_point",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(A.ym,{value:t,onChange:e=>{s(e),ep()},projectId:eo,buttonVariant:"border-with-text",tabIndex:K("estimate_point"),placeholder:"Estimate"})})}}),en("parent_id")?(0,l.jsx)(c.fR,{customButton:(0,l.jsxs)("button",{type:"button",className:"flex cursor-pointer items-center justify-between gap-1 rounded border-[0.5px] border-custom-border-300 px-2 py-1.5 text-xs hover:bg-custom-background-80",children:[(0,l.jsx)(T.Z,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"whitespace-nowrap",children:w&&"".concat(w.project__identifier,"-").concat(w.sequence_id)})]}),placement:"bottom-start",tabIndex:K("parent_id"),children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.fR.MenuItem,{className:"!p-1",onClick:()=>y(!0),children:"Change parent issue"}),(0,l.jsx)(F.Qr,{control:er,name:"parent_id",render:e=>{let{field:{onChange:t}}=e;return(0,l.jsx)(c.fR.MenuItem,{className:"!p-1",onClick:()=>{t(null),ep()},children:"Remove parent issue"})}})]})}):(0,l.jsxs)("button",{type:"button",className:"flex cursor-pointer items-center justify-between gap-1 rounded border-[0.5px] border-custom-border-300 px-2 py-1.5 text-xs hover:bg-custom-background-80",onClick:()=>y(!0),children:[(0,l.jsx)(T.Z,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"whitespace-nowrap",children:"Add parent"})]}),(0,l.jsx)(F.Qr,{control:er,name:"parent_id",render:e=>{let{field:{onChange:t}}=e;return(0,l.jsx)(em,{isOpen:j,handleClose:()=>y(!1),onChange:e=>{t(e.id),ep(),N(e)},projectId:eo,issueId:p?void 0:null==n?void 0:n.id})}})]})]})]}),(0,l.jsxs)("div",{className:"px-5 py-4 flex items-center justify-between gap-2 border-t-[0.5px] border-custom-border-200",children:[(0,l.jsx)("div",{children:!(null==n?void 0:n.id)&&(0,l.jsxs)("div",{className:"inline-flex items-center gap-1.5 cursor-pointer",onClick:()=>h(!m),onKeyDown:e=>{"Enter"===e.key&&h(!m)},tabIndex:K("create_more"),role:"button",children:[(0,l.jsx)(c.Zh,{value:m,onChange:()=>{},size:"sm"}),(0,l.jsx)("span",{className:"text-xs",children:"Create more"})]})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.zx,{variant:"neutral-primary",size:"sm",onClick:i,tabIndex:K("discard_button"),children:"Discard"}),p&&(0,l.jsx)(l.Fragment,{children:(null==n?void 0:n.id)?(0,l.jsx)(c.zx,{variant:"neutral-primary",size:"sm",loading:ee,onClick:es(e=>ed({...e,is_draft:!1})),tabIndex:K("draft_button"),children:ee?"Moving":"Move from draft"}):(0,l.jsx)(c.zx,{variant:"neutral-primary",size:"sm",loading:ee,onClick:es(e=>ed(e,!0)),tabIndex:K("draft_button"),children:ee?"Saving":"Save as draft"})}),(0,l.jsx)(c.zx,{variant:"primary",type:"submit",size:"sm",loading:ee,tabIndex:p?K("submit_button"):K("draft_button"),children:(null==n?void 0:n.id)?ee?"Updating":"Update Issue":ee?"Creating":"Create Issue"})]})]})]})]})}),J=new(s(4225)).__,H=(0,y.Pi)(e=>{let{changesMade:t,data:s,issueTitleRef:n,onChange:r,onClose:a,onSubmit:i,projectId:o,isCreateMoreToggleEnabled:d,onCreateMoreToggleChange:u,isDraft:m}=e,[h,p]=(0,b.useState)(!1),x=(0,R.useRouter)(),{workspaceSlug:g}=x.query,{captureIssueEvent:j}=(0,v.DN)(),y=async()=>{var e,s;if(!t||!g||!o)return;let l={...t,name:(null==t?void 0:t.name)&&(null==t?void 0:null===(e=t.name)||void 0===e?void 0:e.trim())!==""?null===(s=t.name)||void 0===s?void 0:s.trim():"Untitled"};await J.createDraftIssue(g.toString(),o.toString(),l).then(e=>{(0,c.fz)({type:c.do.SUCCESS,title:"Success!",message:"Draft Issue created successfully."}),j({eventName:"Draft issue created",payload:{...e,state:"SUCCESS"},path:x.asPath}),r(null),p(!1),a(!1)}).catch(()=>{(0,c.fz)({type:c.do.ERROR,title:"Error!",message:"Issue could not be created. Please try again."}),j({eventName:"Draft issue created",payload:{...l,state:"FAILED"},path:x.asPath})})};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eh,{isOpen:h,handleClose:()=>p(!1),onConfirm:y,onDiscard:()=>{r(null),p(!1),a(!1)}}),(0,l.jsx)(Y,{isCreateMoreToggleEnabled:d,onCreateMoreToggleChange:u,data:s,issueTitleRef:n,onChange:r,onClose:()=>{(null==s?void 0:s.id)?(a(!1),p(!1)):t?(Object.entries(t).forEach(e=>{let[s,l]=e;(null==l||""===l)&&delete t[s],"object"==typeof l&&P()(l)&&delete t[s],Array.isArray(l)&&0===l.length&&delete t[s],"project_id"===s&&delete t.project_id,"priority"===s&&l&&"none"===l&&delete t.priority,"description_html"===s&&t.description_html&&(0,f.dn)(t.description_html)&&delete t.description_html}),P()(t)?(a(!1),p(!1)):p(!0)):(a(!1),p(!1))},onSubmit:i,projectId:o,isDraft:m})]})});var Q=s(865),G=s(93997),$=s(76926),X=s(15108);let ee=(0,y.Pi)(e=>{let{data:t,isOpen:s,onClose:n,onSubmit:r,withDraftIssueWrapper:a=!0,storeType:i=G.rS.PROJECT,isDraft:o=!1}=e,d=(0,b.useRef)(null),[u,m]=(0,b.useState)(null),[h,p]=(0,b.useState)(!1),[x,f]=(0,b.useState)(null),[g,j]=(0,b.useState)(void 0),{captureIssueEvent:y}=(0,v.DN)(),{router:{workspaceSlug:w,projectId:N,cycleId:k,moduleId:C}}=(0,v.IX)(),{workspaceProjectIds:_}=(0,v.PY)(),{fetchCycleDetails:I}=(0,v.nv)(),{fetchModuleDetails:E}=(0,v.b7)(),{issues:P}=(0,v.gk)(G.rS.MODULE),{issues:F}=(0,v.gk)(G.rS.CYCLE),{issues:O}=(0,v.gk)(G.rS.DRAFT),{fetchIssue:T}=(0,v.p1)(),A=(0,R.useRouter)(),{storedValue:D,setValue:M}=(0,X.Z)("draftedIssue",{}),{createIssue:z,updateIssue:L}=(0,$.C)(i),Z=async e=>{if(j(void 0),!w)return;if(!N||void 0===e){j((null==t?void 0:t.description_html)||"<p></p>");return}let s=await T(w,N,e,o?"DRAFT":"DEFAULT");s&&j((null==s?void 0:s.description_html)||"<p></p>")};(0,b.useEffect)(()=>{if(s&&Z(null==t?void 0:t.id),!s){f(null);return}if(t&&t.project_id){f(t.project_id);return}return _&&_.length>0&&!x&&f(null!=N?N:null==_?void 0:_[0]),()=>j(void 0)},[t,N,s,x]);let q=async(e,t)=>{w&&x&&(await F.addIssueToCycle(w,e.project_id,t,[e.id]),I(w,x,t))},B=async(e,t)=>{w&&x&&(await P.addModulesToIssue(w,x,e.id,t),t.forEach(e=>E(w,x,e)))},U=e=>{p(e)},V=e=>{if(u&&e){let e=D||{};w&&M(e={...e,[w]:u})}f(null),n()},W=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(w&&e.project_id)try{let l=t?await O.createIssue(w,e.project_id,e):z&&await z(e.project_id,e);if(!l)throw Error();if(e.cycle_id&&""!==e.cycle_id&&i!==G.rS.CYCLE&&await q(l,e.cycle_id),e.module_ids&&e.module_ids.length>0&&i!==G.rS.MODULE&&await B(l,e.module_ids),(0,c.fz)({type:c.do.SUCCESS,title:"Success!",message:"Issue created successfully."}),y({eventName:Q.lc,payload:{...l,state:"SUCCESS"},path:A.asPath}),h||V(),h){var s;d&&(null==d||null===(s=d.current)||void 0===s||s.focus()),j("<p></p>"),m(null)}return l}catch(t){(0,c.fz)({type:c.do.ERROR,title:"Error!",message:"Issue could not be created. Please try again."}),y({eventName:Q.lc,payload:{...e,state:"FAILED"},path:A.asPath})}},K=async e=>{if(w&&e.project_id&&(null==t?void 0:t.id))try{o?await O.updateIssue(w,e.project_id,t.id,e):L&&await L(e.project_id,t.id,e),(0,c.fz)({type:c.do.SUCCESS,title:"Success!",message:"Issue updated successfully."}),y({eventName:Q.C6,payload:{...e,issueId:t.id,state:"SUCCESS"},path:A.asPath}),V()}catch(t){(0,c.fz)({type:c.do.ERROR,title:"Error!",message:"Issue could not be updated. Please try again."}),y({eventName:Q.C6,payload:{...e,state:"FAILED"},path:A.asPath})}},J=async function(e){let s,l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];w&&e.project_id&&i&&void 0!=(s=(null==t?void 0:t.id)?await K(e):await W(e,l))&&r&&await r(s)};return _&&0!==_.length&&x?(0,l.jsx)(S.QU,{isOpen:s,handleClose:()=>V(!0),position:S.fM.TOP,width:S.j4.XXXXL,children:a?(0,l.jsx)(H,{changesMade:u,data:{...t,description_html:g,cycle_id:(null==t?void 0:t.cycle_id)?null==t?void 0:t.cycle_id:k||null,module_ids:(null==t?void 0:t.module_ids)?null==t?void 0:t.module_ids:C?[C]:null},issueTitleRef:d,onChange:e=>m(e),onClose:V,onSubmit:J,projectId:x,isCreateMoreToggleEnabled:h,onCreateMoreToggleChange:U,isDraft:o}):(0,l.jsx)(Y,{issueTitleRef:d,data:{...t,description_html:g,cycle_id:(null==t?void 0:t.cycle_id)?null==t?void 0:t.cycle_id:k||null,module_ids:(null==t?void 0:t.module_ids)?null==t?void 0:t.module_ids:C?[C]:null},onClose:()=>V(!1),isCreateMoreToggleEnabled:h,onCreateMoreToggleChange:U,onSubmit:J,projectId:x,isDraft:o})}):null}),et=e=>{let{dataId:t,data:s,isOpen:n,handleClose:r,onSubmit:a}=e,[i,o]=(0,b.useState)(!1),{issueMap:d}=(0,v.gk)(),{getProjectById:u}=(0,v.PY)();if((0,b.useEffect)(()=>{o(!1)},[n]),!t&&!s)return null;let m=s||d[t],h=u(null==m?void 0:m.project_id),p=()=>{o(!1),r()},x=async()=>{o(!0),a&&await a().then(()=>{p()}).catch(()=>{(0,c.fz)({title:"Error",type:c.do.ERROR,message:"Failed to delete issue"})}).finally(()=>o(!1))};return(0,l.jsx)(S.qv,{handleClose:p,handleSubmit:x,isDeleting:i,isOpen:n,title:"Delete Issue",content:(0,l.jsxs)(l.Fragment,{children:["Are you sure you want to delete issue"," ",(0,l.jsxs)("span",{className:"break-words font-medium text-custom-text-100",children:[null==h?void 0:h.identifier,"-",null==m?void 0:m.sequence_id]}),"","? All of the data related to the issue will be permanently removed. This action cannot be undone."]})})};var es=s(96861),el=s(31543),en=s(79360),er=s(81630),ea=s(59100),ei=s(30335),eo=s(15455),ec=s(66778),ed=s(65758);let eu=new(s(12447)).Y4,em=e=>{let{isOpen:t,handleClose:s,value:n,onChange:r,projectId:a,issueId:i}=e,[o,d]=(0,b.useState)(!1),[u,m]=(0,b.useState)(""),[h,p]=(0,b.useState)([]),[x,f]=(0,b.useState)(!1),[v,j]=(0,b.useState)(!1),{isMobile:y}=(0,g.L)(),w=(0,ed.Z)(u,500),{workspaceSlug:N}=(0,R.useRouter)().query,k=()=>{s(),m(""),j(!1)};return(0,b.useEffect)(()=>{t&&N&&a&&(f(!0),d(!0),eu.projectIssuesSearch(N,a,{search:w,parent:!0,issue_id:i,workspace_search:v}).then(e=>p(e)).finally(()=>{f(!1),d(!1)}))},[w,t,i,v,a,N]),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(ei.u.Root,{show:t,as:b.Fragment,afterLeave:()=>m(""),appear:!0,children:(0,l.jsxs)(eo.V,{as:"div",className:"relative z-20",onClose:k,children:[(0,l.jsx)(ei.u.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-20 overflow-y-auto p-4 sm:p-6 md:p-20",children:(0,l.jsx)(ei.u.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,l.jsx)(eo.V.Panel,{className:"relative mx-auto max-w-2xl transform rounded-lg bg-custom-background-100 shadow-custom-shadow-md transition-all",children:(0,l.jsxs)(ec.h,{value:n,onChange:e=>{r(e),k()},children:[(0,l.jsxs)("div",{className:"relative m-1",children:[(0,l.jsx)(er.Z,{className:"pointer-events-none absolute left-4 top-3.5 h-5 w-5 text-custom-text-100 text-opacity-40","aria-hidden":"true"}),(0,l.jsx)(ec.h.Input,{className:"h-12 w-full border-0 bg-transparent pl-11 pr-4 text-custom-text-100 outline-none placeholder:text-custom-text-400 focus:ring-0 sm:text-sm",placeholder:"Type to search...",value:u,onChange:e=>m(e.target.value),displayValue:()=>""})]}),(0,l.jsx)("div",{className:"flex p-2 sm:justify-end",children:(0,l.jsx)(c.u,{tooltipContent:"Toggle workspace level search",isMobile:y,children:(0,l.jsxs)("div",{className:"flex flex-shrink-0 cursor-pointer items-center gap-1 text-xs ".concat(v?"text-custom-text-100":"text-custom-text-200"),children:[(0,l.jsx)(c.Zh,{value:v,onChange:()=>j(e=>!e),label:"Workspace level"}),(0,l.jsx)("button",{type:"button",onClick:()=>j(e=>!e),className:"flex-shrink-0",children:"Workspace Level"})]})})}),(0,l.jsxs)(ec.h.Options,{static:!0,className:"max-h-80 scroll-py-2 overflow-y-auto vertical-scrollbar scrollbar-md",children:[""!==u&&(0,l.jsxs)("h5",{className:"mx-2 text-[0.825rem] text-custom-text-200",children:["Search results for"," ",(0,l.jsxs)("span",{className:"text-custom-text-100",children:['"',u,'"']})," ","in project:"]}),x||o?(0,l.jsxs)(c.aN,{className:"space-y-3 p-3",children:[(0,l.jsx)(c.aN.Item,{height:"40px"}),(0,l.jsx)(c.aN.Item,{height:"40px"}),(0,l.jsx)(c.aN.Item,{height:"40px"}),(0,l.jsx)(c.aN.Item,{height:"40px"})]}):(0,l.jsx)(l.Fragment,{children:0===h.length?(0,l.jsx)(S.Gq,{debouncedSearchTerm:w,isSearching:x,issues:h,searchTerm:u}):(0,l.jsx)("ul",{className:"text-sm ".concat(h.length>0?"p-2":""),children:h.map(e=>(0,l.jsxs)(ec.h.Option,{value:e,className:e=>{let{active:t,selected:s}=e;return"group flex w-full cursor-pointer select-none items-center justify-between gap-2 rounded-md px-3 py-2 text-custom-text-200 ".concat(t?"bg-custom-background-80 text-custom-text-100":""," ").concat(s?"text-custom-text-100":"")},children:[(0,l.jsxs)("div",{className:"flex flex-grow items-center gap-2 truncate",children:[(0,l.jsx)("span",{className:"block h-1.5 w-1.5 flex-shrink-0 rounded-full",style:{backgroundColor:e.state__color}}),(0,l.jsxs)("span",{className:"flex-shrink-0 text-xs",children:[e.project__identifier,"-",e.sequence_id]})," ",(0,l.jsx)("span",{className:"truncate",children:e.name})]}),(0,l.jsx)("a",{href:"/".concat(N,"/projects/").concat(e.project_id,"/issues/").concat(e.id),target:"_blank",className:"z-1 relative hidden flex-shrink-0 text-custom-text-200 hover:text-custom-text-100 group-hover:block",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,l.jsx)(ea.Z,{className:"h-4 w-4"})})]},e.id))})})]})]})})})})]})})})},eh=e=>{let{isOpen:t,handleClose:s,onDiscard:n,onConfirm:r}=e,[a,i]=(0,b.useState)(!1),o=async()=>{i(!0),await r(),i(!1)};return(0,l.jsx)(ei.u.Root,{show:t,as:b.Fragment,children:(0,l.jsxs)(eo.V,{as:"div",className:"relative z-20",onClose:s,children:[(0,l.jsx)(ei.u.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,l.jsx)("div",{className:"my-10 flex items-center justify-center p-4 text-center sm:p-0 md:my-32",children:(0,l.jsx)(ei.u.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,l.jsxs)(eo.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-[40rem]",children:[(0,l.jsx)("div",{className:"px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:(0,l.jsx)("div",{className:"sm:flex sm:items-start",children:(0,l.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:text-left",children:[(0,l.jsx)(eo.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-custom-text-100",children:"Draft Issue"}),(0,l.jsx)("div",{className:"mt-2",children:(0,l.jsx)("p",{className:"text-sm text-custom-text-200",children:"Would you like to save this issue in drafts?"})})]})})}),(0,l.jsxs)("div",{className:"flex justify-between gap-2 p-4 sm:px-6",children:[(0,l.jsx)("div",{children:(0,l.jsx)(c.zx,{variant:"neutral-primary",size:"sm",onClick:n,children:"Discard"})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.zx,{variant:"neutral-primary",size:"sm",onClick:()=>{s(),i(!1)},children:"Cancel"}),(0,l.jsx)(c.zx,{variant:"primary",size:"sm",onClick:o,loading:a,children:a?"Saving":"Save draft"})]})]})]})})})})]})})};var ep=s(19823);let ex=(0,n.Pi)(e=>{var t;let{isSubmitting:s,issueDetail:n}=e,{getProjectById:r}=(0,v.PY)();return(0,l.jsxs)(l.Fragment,{children:[n&&(0,l.jsxs)("h4",{className:"mr-4 text-lg font-medium text-custom-text-300",children:[null===(t=r(n.project_id))||void 0===t?void 0:t.identifier,"-",n.sequence_id]}),(0,l.jsxs)("div",{className:"flex items-center gap-x-2 transition-all duration-300 ".concat("saved"===s?"fade-out":"fade-in"),children:["submitted"!==s&&"saved"!==s&&(0,l.jsx)(ep.Z,{className:"h-4 w-4 stroke-custom-text-300"}),(0,l.jsx)("span",{className:"text-sm text-custom-text-300",children:"submitting"===s?"Saving...":"Saved"})]})]})});var ef=s(4062);let ev=(0,y.Pi)(e=>{var t;let{workspaceSlug:s,projectId:n,issueId:r,disabled:a=!1,isInboxIssue:i=!1,onLabelUpdate:o}=e,{updateIssue:d}=(0,v.p1)(),{createLabel:u}=(0,v.NP)(),{issue:{getIssueById:m}}=(0,v.p1)(),{getIssueInboxByIssueId:h}=(0,v.wN)(),p=i?null===(t=h(r))||void 0===t?void 0:t.issue:m(r),x=(0,b.useMemo)(()=>({updateIssue:async(e,t,s,l)=>{try{o?o(l.label_ids||[]):await d(e,t,s,l)}catch(e){(0,c.fz)({title:"Error!",type:c.do.ERROR,message:"Issue update failed"})}},createLabel:async(e,t,s)=>{try{let l=await u(e,t,s);return i||(0,c.fz)({title:"Success!",type:c.do.SUCCESS,message:"Label created successfully"}),l}catch(e){return(0,c.fz)({title:"Error!",type:c.do.ERROR,message:"Label creation failed"}),e}}}),[d,u,o]);return(0,l.jsxs)("div",{className:"relative flex flex-wrap items-center gap-1",children:[(0,l.jsx)(ej,{workspaceSlug:s,projectId:n,issueId:r,values:(null==p?void 0:p.label_ids)||[],labelOperations:x,disabled:a}),!a&&(0,l.jsx)(eP,{workspaceSlug:s,projectId:n,issueId:r,values:(null==p?void 0:p.label_ids)||[],labelOperations:x}),!a&&(0,l.jsx)(eS,{workspaceSlug:s,projectId:n,issueId:r,values:(null==p?void 0:p.label_ids)||[],labelOperations:x})]})}),eg=e=>{var t;let{workspaceSlug:s,projectId:n,issueId:r,labelId:a,values:i,labelOperations:c,disabled:d}=e,{getLabelById:u}=(0,v.NP)(),m=u(a),h=async()=>{if(i&&!d){let e=i.filter(e=>e!==a);await c.updateIssue(s,n,r,{label_ids:e})}};return m?(0,l.jsxs)("div",{className:"transition-all relative flex items-center gap-1 truncate border border-custom-border-100 rounded-full text-xs p-0.5 px-1 group ".concat(d?"cursor-not-allowed":"cursor-pointer hover:border-red-500/50 hover:bg-red-500/20"," "),onClick:h,children:[(0,l.jsx)("div",{className:"rounded-full h-2 w-2 flex-shrink-0",style:{backgroundColor:null!==(t=m.color)&&void 0!==t?t:"#000000"}}),(0,l.jsx)("div",{className:"truncate",children:m.name}),!d&&(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(o.Z,{className:"transition-all h-2.5 w-2.5 group-hover:text-red-500"})})]},a):(0,l.jsx)(l.Fragment,{})},ej=(0,n.Pi)(e=>{let{workspaceSlug:t,projectId:s,issueId:n,values:r,labelOperations:a,disabled:i}=e,o=r||void 0;return n&&o?(0,l.jsx)(l.Fragment,{children:o.map(e=>(0,l.jsx)(eg,{workspaceSlug:t,projectId:s,issueId:n,labelId:e,values:o,labelOperations:a,disabled:i},e))}):(0,l.jsx)(l.Fragment,{})});var eb=s(36547),ey=s(69570),ew=s(47542),eN=s(7419),ek=s(30640);let eC={name:"",color:"#ff0000"},eS=e=>{let{workspaceSlug:t,projectId:s,issueId:n,values:r,labelOperations:a,disabled:i=!1}=e,[d,u]=(0,b.useState)(!1),m=()=>u(!d),[h,p]=(0,b.useState)(null),[x,f]=(0,b.useState)(null),{handleSubmit:v,formState:{errors:g,isSubmitting:j},reset:y,control:w,setFocus:N}=(0,F.cI)({defaultValues:eC}),{styles:k,attributes:C}=(0,ey.D)(h,x,{placement:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]});(0,b.useEffect)(()=>{d&&(N("name"),y())},[d,y,N]);let S=async e=>{if(t&&s&&!j)try{let l=await a.createLabel(t,s,e),i=[...r||[],l.id];await a.updateIssue(t,s,n,{label_ids:i}),m(),y(eC)}catch(e){(0,c.fz)({title:"Error!",type:c.do.ERROR,message:"Label creation failed. Please try again sometime later."})}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"relative flex flex-shrink-0 cursor-pointer items-center gap-1 rounded-full border border-custom-border-100 p-0.5 px-2 text-xs text-custom-text-300 transition-all hover:bg-custom-background-90 hover:text-custom-text-200",onClick:m,children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:d?(0,l.jsx)(o.Z,{className:"h-2.5 w-2.5"}):(0,l.jsx)(ew.Z,{className:"h-2.5 w-2.5"})}),(0,l.jsx)("div",{className:"flex-shrink-0",children:d?"Cancel":"New"})]}),d&&(0,l.jsxs)("form",{className:"relative flex items-center gap-x-2",onSubmit:v(S),children:[(0,l.jsx)("div",{children:(0,l.jsx)(F.Qr,{name:"color",control:w,render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(ek.J,{children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ek.J.Button,{as:b.Fragment,children:(0,l.jsx)("button",{type:"button",ref:p,className:"grid place-items-center outline-none",children:t&&(null==t?void 0:t.trim())!==""&&(0,l.jsx)("span",{className:"h-6 w-6 rounded",style:{backgroundColor:null!=t?t:"black"}})})}),(0,l.jsx)(ek.J.Panel,{className:"fixed z-10",children:(0,l.jsx)("div",{className:"p-2 max-w-xs sm:px-0",ref:f,style:k.popper,...C.popper,children:(0,l.jsx)(eb.e8,{triangle:"hide",color:t,onChange:e=>s(e.hex)})})})]})})}})}),(0,l.jsx)(F.Qr,{control:w,name:"name",rules:{required:"This is required"},render:e=>{let{field:{value:t,onChange:s,ref:n}}=e;return(0,l.jsx)(c.II,{id:"name",name:"name",type:"text",value:null!=t?t:"",onChange:s,ref:n,hasError:!!g.name,placeholder:"Title",className:"w-full",disabled:j})}}),(0,l.jsx)("button",{type:"button",className:"grid place-items-center rounded bg-red-500 p-1.5",onClick:()=>u(!1),disabled:i,children:(0,l.jsx)(o.Z,{className:"h-4 w-4 text-white"})}),(0,l.jsx)("button",{type:"submit",className:"grid place-items-center rounded bg-green-500 p-1.5",disabled:j,children:j?(0,l.jsx)(eN.Z,{className:"spin h-4 w-4 text-white"}):(0,l.jsx)(ew.Z,{className:"h-4 w-4 text-white"})})]})]})};var e_=s(77970),eI=s(1759);let eE=(0,y.Pi)(e=>{let{workspaceSlug:t,projectId:s,issueId:n,values:r,onSelect:a}=e,{fetchProjectLabels:i,getProjectLabels:o}=(0,v.NP)(),[c,d]=(0,b.useState)(null),[u,m]=(0,b.useState)(null),[h,p]=(0,b.useState)(!1),[x,f]=(0,b.useState)(""),g=o(s),j=()=>{p(!0),!g&&t&&s&&i(t,s).then(()=>p(!1))},y=(null!=g?g:[]).map(e=>({value:e.id,query:e.name,content:(0,l.jsxs)("div",{className:"flex items-center justify-start gap-2 overflow-hidden",children:[(0,l.jsx)("span",{className:"h-2.5 w-2.5 flex-shrink-0 rounded-full",style:{backgroundColor:e.color}}),(0,l.jsx)("div",{className:"line-clamp-1 inline-block truncate",children:e.name})]})})),w=""===x?y:null==y?void 0:y.filter(e=>e.query.toLowerCase().includes(x.toLowerCase())),{styles:N,attributes:k}=(0,ey.D)(c,u,{placement:"bottom-end",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),C=(0,l.jsxs)("div",{className:"relative flex flex-shrink-0 cursor-pointer items-center gap-1 rounded-full border border-custom-border-100 p-0.5 px-2 py-0.5 text-xs text-custom-text-300 transition-all hover:bg-custom-background-90 hover:text-custom-text-200",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(e_.Z,{className:"h-2.5 w-2.5"})}),(0,l.jsx)("div",{className:"flex-shrink-0",children:"Select Label"})]});return n&&r?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(ec.h,{as:"div",className:"w-auto max-w-full flex-shrink-0 text-left",value:null!=r?r:[],onChange:e=>a(e),multiple:!0,children:[(0,l.jsx)(ec.h.Button,{as:b.Fragment,children:(0,l.jsx)("button",{ref:d,type:"button",className:"cursor-pointer rounded",onClick:()=>!g&&j(),children:C})}),(0,l.jsx)(ec.h.Options,{className:"fixed z-10",children:(0,l.jsxs)("div",{className:"z-10 my-1 w-48 whitespace-nowrap rounded border border-custom-border-300 bg-custom-background-100 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none",ref:m,style:N.popper,...k.popper,children:[(0,l.jsx)("div",{className:"px-2",children:(0,l.jsxs)("div",{className:"flex w-full items-center justify-start rounded border border-custom-border-200 bg-custom-background-90 px-2",children:[(0,l.jsx)(er.Z,{className:"h-3.5 w-3.5 text-custom-text-300"}),(0,l.jsx)(ec.h.Input,{className:"w-full bg-transparent px-2 py-1 text-xs text-custom-text-200 placeholder:text-custom-text-400 focus:outline-none",value:x,onChange:e=>f(e.target.value),placeholder:"Search",displayValue:e=>null==e?void 0:e.name,onKeyDown:e=>{""!==x&&"Escape"===e.key&&(e.stopPropagation(),f(""))}})]})}),(0,l.jsx)("div",{className:"vertical-scrollbar scrollbar-sm mt-2 max-h-48 space-y-1 overflow-y-scroll px-2 pr-0",children:h?(0,l.jsx)("p",{className:"text-center text-custom-text-200",children:"Loading..."}):w.length>0?w.map(e=>(0,l.jsx)(ec.h.Option,{value:e.value,className:e=>{let{selected:t}=e;return"flex cursor-pointer select-none items-center justify-between gap-2 truncate rounded px-1 py-1.5 hover:bg-custom-background-80 ".concat(t?"text-custom-text-100":"text-custom-text-200")},children:t=>{let{selected:s}=t;return(0,l.jsxs)(l.Fragment,{children:[e.content,s&&(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(eI.Z,{className:"h-3.5 w-3.5"})})]})}},e.value)):(0,l.jsx)("span",{className:"flex items-center gap-2 p-1",children:(0,l.jsx)("p",{className:"text-left text-custom-text-200 ",children:"No matching results"})})})]})})]})}):(0,l.jsx)(l.Fragment,{})}),eP=e=>{let{workspaceSlug:t,projectId:s,issueId:n,values:r,labelOperations:a}=e,i=async e=>{await a.updateIssue(t,s,n,{label_ids:e})};return(0,l.jsx)(eE,{workspaceSlug:t,projectId:s,issueId:n,values:r,onSelect:i})},eR={title:"",url:""},eF=e=>{let{isModalOpen:t,handleModal:s,linkOperations:n,preloadedData:r}=e,{formState:{errors:a,isSubmitting:i},handleSubmit:o,control:d,reset:u}=(0,F.cI)({defaultValues:eR}),m=()=>{s(!1);let e=setTimeout(()=>{u(r||eR),clearTimeout(e)},500)},h=async e=>{e&&e.id?await n.update(e.id,{title:e.title,url:e.url}):await n.create({title:e.title,url:e.url}),m()};return(0,b.useEffect)(()=>{u({...eR,...r})},[r,u]),(0,l.jsx)(ei.u.Root,{show:t,as:b.Fragment,children:(0,l.jsxs)(eo.V,{as:"div",className:"relative z-20",onClose:m,children:[(0,l.jsx)(ei.u.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,l.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center sm:p-0",children:(0,l.jsx)(ei.u.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,l.jsx)(eo.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 px-5 py-8 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-full sm:max-w-2xl sm:p-6",children:(0,l.jsxs)("form",{onSubmit:o(h),children:[(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"space-y-5",children:[(0,l.jsx)(eo.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-custom-text-100",children:(null==r?void 0:r.id)?"Update Link":"Add Link"}),(0,l.jsxs)("div",{className:"mt-2 space-y-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"url",className:"mb-2 text-custom-text-200",children:"URL"}),(0,l.jsx)(F.Qr,{control:d,name:"url",rules:{required:"URL is required"},render:e=>{let{field:{value:t,onChange:s,ref:n}}=e;return(0,l.jsx)(c.II,{id:"url",name:"url",type:"url",value:t,onChange:s,ref:n,hasError:!!a.url,placeholder:"https://...",pattern:"^(https?://).*",className:"w-full"})}})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"title",className:"mb-2 text-custom-text-200",children:"Title (optional)"}),(0,l.jsx)(F.Qr,{control:d,name:"title",render:e=>{let{field:{value:t,onChange:s,ref:n}}=e;return(0,l.jsx)(c.II,{id:"title",name:"title",type:"text",value:t,onChange:s,ref:n,hasError:!!a.title,placeholder:"Enter title",className:"w-full"})}})]})]})]})}),(0,l.jsxs)("div",{className:"mt-5 flex justify-end gap-2",children:[(0,l.jsx)(c.zx,{variant:"neutral-primary",size:"sm",onClick:m,children:"Cancel"}),(0,l.jsx)(c.zx,{variant:"primary",size:"sm",type:"submit",loading:i,children:(null==r?void 0:r.id)?i?"Updating Link...":"Update Link":i?"Adding Link...":"Add Link"})]})]})})})})})]})})};var eO=s(3515),eT=s(62468),eA=s(37969),eD=s(54129);let eM=e=>{let{linkId:t,linkOperations:s,isNotAllowed:n}=e,{toggleIssueLinkModal:r,link:{getLinkById:a}}=(0,v.p1)(),{getUserDetails:i}=(0,v.Kb)(),[o,d]=(0,b.useState)(!1),u=e=>{r(e),d(e)},{isMobile:m}=(0,g.L)(),h=a(t);if(!h)return(0,l.jsx)(l.Fragment,{});let p=i(h.created_by_id);return(0,l.jsxs)("div",{children:[(0,l.jsx)(eF,{isModalOpen:o,handleModal:u,linkOperations:s,preloadedData:h}),(0,l.jsxs)("div",{className:"relative flex flex-col rounded-md bg-custom-background-90 p-2.5",children:[(0,l.jsxs)("div",{className:"flex w-full cursor-pointer items-start justify-between gap-2",onClick:()=>{(0,f.TE)(h.url),(0,c.fz)({type:c.do.SUCCESS,title:"Link copied!",message:"Link copied to clipboard"})},children:[(0,l.jsxs)("div",{className:"flex items-start gap-2 truncate",children:[(0,l.jsx)("span",{className:"py-1",children:(0,l.jsx)(eO.Z,{className:"h-3 w-3 flex-shrink-0"})}),(0,l.jsx)(c.u,{tooltipContent:h.title&&""!==h.title?h.title:h.url,isMobile:m,children:(0,l.jsx)("span",{className:"truncate text-xs",children:h.title&&""!==h.title?h.title:h.url})})]}),!n&&(0,l.jsxs)("div",{className:"z-[1] flex flex-shrink-0 items-center gap-2",children:[(0,l.jsx)("button",{type:"button",className:"flex items-center justify-center p-1 hover:bg-custom-background-80",onClick:e=>{e.preventDefault(),e.stopPropagation(),u(!0)},children:(0,l.jsx)(eT.Z,{className:"h-3 w-3 stroke-[1.5] text-custom-text-200"})}),(0,l.jsx)("a",{href:h.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center p-1 hover:bg-custom-background-80",children:(0,l.jsx)(eA.Z,{className:"h-3 w-3 stroke-[1.5] text-custom-text-200"})}),(0,l.jsx)("button",{type:"button",className:"flex items-center justify-center p-1 hover:bg-custom-background-80",onClick:e=>{e.preventDefault(),e.stopPropagation(),s.remove(h.id)},children:(0,l.jsx)(eD.Z,{className:"h-3 w-3"})})]})]}),(0,l.jsx)("div",{className:"px-5",children:(0,l.jsxs)("p",{className:"mt-0.5 stroke-[1.5] text-xs text-custom-text-300",children:["Added ",(0,x.KI)(h.created_at),(0,l.jsx)("br",{}),p&&(0,l.jsxs)(l.Fragment,{children:["by ",(null==p?void 0:p.is_bot)?(null==p?void 0:p.first_name)+" Bot":null==p?void 0:p.display_name]})]})})]})]},t)},ez=(0,y.Pi)(e=>{let{issueId:t,linkOperations:s}=e,{link:{getLinksByIssueId:n}}=(0,v.p1)(),{membership:{currentProjectRole:r}}=(0,v.aF)(),a=n(t);return a?(0,l.jsx)("div",{className:"space-y-2",children:a&&a.length>0&&a.map(e=>(0,l.jsx)(eM,{linkId:e,linkOperations:s,isNotAllowed:5===r||10===r},e))}):(0,l.jsx)(l.Fragment,{})}),eL=e=>{let{workspaceSlug:t,projectId:s,issueId:n,disabled:r=!1}=e,{toggleIssueLinkModal:a,createLink:i,updateLink:o,removeLink:d}=(0,v.p1)(),[u,m]=(0,b.useState)(!1),h=(0,b.useCallback)(e=>{a(e),m(e)},[a]),p=(0,b.useMemo)(()=>({create:async e=>{try{if(!t||!s||!n)throw Error("Missing required fields");await i(t,s,n,e),(0,c.fz)({message:"The link has been successfully created",type:c.do.SUCCESS,title:"Link created"}),h(!1)}catch(e){(0,c.fz)({message:"The link could not be created",type:c.do.ERROR,title:"Link not created"})}},update:async(e,l)=>{try{if(!t||!s||!n)throw Error("Missing required fields");await o(t,s,n,e,l),(0,c.fz)({message:"The link has been successfully updated",type:c.do.SUCCESS,title:"Link updated"}),h(!1)}catch(e){(0,c.fz)({message:"The link could not be updated",type:c.do.ERROR,title:"Link not updated"})}},remove:async e=>{try{if(!t||!s||!n)throw Error("Missing required fields");await d(t,s,n,e),(0,c.fz)({message:"The link has been successfully removed",type:c.do.SUCCESS,title:"Link removed"}),h(!1)}catch(e){(0,c.fz)({message:"The link could not be removed",type:c.do.ERROR,title:"Link not removed"})}}}),[t,s,n,i,o,d,h]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eF,{isModalOpen:u,handleModal:h,linkOperations:p}),(0,l.jsxs)("div",{className:"py-1 text-xs",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsx)("h4",{children:"Links"}),!r&&(0,l.jsx)("button",{type:"button",className:"grid h-7 w-7 place-items-center rounded p-1 outline-none duration-300 hover:bg-custom-background-90 ".concat(r?"cursor-not-allowed":"cursor-pointer"),onClick:()=>h(!0),disabled:r,children:(0,l.jsx)(ew.Z,{className:"h-4 w-4"})})]}),(0,l.jsx)("div",{children:(0,l.jsx)(ez,{issueId:n,linkOperations:p})})]})]})};var eZ=s(45579),eq=s(30201);let eB=e=>{let{issueId:t}=e,{getProjectById:s}=(0,v.PY)(),{peekIssue:n,issue:{getIssueById:r}}=(0,v.p1)(),i=t&&r(t)||void 0;if(!i)return(0,l.jsx)(l.Fragment,{});let o=i.project_id&&s(i.project_id)||void 0;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(c.fR.MenuItem,{children:(0,l.jsxs)(a(),{href:"/".concat(null==n?void 0:n.workspaceSlug,"/projects/").concat(null==i?void 0:i.project_id,"/issues/").concat(i.id),className:"flex items-center gap-2 py-2",children:[(0,l.jsx)(c.uQ,{className:"h-4 w-4"}),null==o?void 0:o.identifier,"-",i.sequence_id]})},i.id)})},eU=e=>{let{currentIssue:t,parentIssue:s}=e,{peekIssue:n,fetchSubIssues:r,subIssues:{subIssuesByIssueId:a}}=(0,v.p1)(),{isLoading:i}=(0,eq.ZP)(n&&s&&s.project_id?"ISSUE_PARENT_CHILD_ISSUES_".concat(null==n?void 0:n.workspaceSlug,"_").concat(s.project_id,"_").concat(s.id):null,n&&s&&s.project_id?()=>r(null==n?void 0:n.workspaceSlug,s.project_id,s.id):null),o=s&&a(s.id)||void 0;return(0,l.jsx)("div",{children:i?(0,l.jsx)("div",{className:"flex items-center gap-2 whitespace-nowrap px-1 py-1 text-left text-xs text-custom-text-200",children:"Loading"}):o&&o.length>0?o.map(e=>t.id!=e&&(0,l.jsx)(eB,{issueId:e},e)):(0,l.jsx)("div",{className:"flex items-center gap-2 whitespace-nowrap px-1 py-1 text-left text-xs text-custom-text-200",children:"No sibling issues"})})},eV=(0,n.Pi)(e=>{var t,s,n;let{workspaceSlug:r,projectId:i,issueId:o,issue:d,issueOperations:u}=e,{issueMap:m}=(0,v.gk)(),{getProjectById:h}=(0,v.PY)(),{getProjectStates:p}=(0,v.eD)(),x=(null==m?void 0:m[d.parent_id||""])||void 0,f=null===(t=p(null==x?void 0:x.project_id))||void 0===t?void 0:t.find(e=>(null==e?void 0:e.id)===(null==x?void 0:x.state_id)),g=(null==f?void 0:f.color)||void 0;return x?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"mb-5 flex w-min items-center gap-3 whitespace-nowrap rounded-md border border-custom-border-300 bg-custom-background-80 px-2.5 py-1 text-xs",children:[(0,l.jsx)(a(),{href:"/".concat(r,"/projects/").concat(null==x?void 0:x.project_id,"/issues/").concat(x.id),children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,l.jsx)("span",{className:"block h-2 w-2 rounded-full",style:{backgroundColor:g}}),(0,l.jsxs)("span",{className:"flex-shrink-0 text-custom-text-200",children:[null===(s=h(x.project_id))||void 0===s?void 0:s.identifier,"-",null==x?void 0:x.sequence_id]})]}),(0,l.jsx)("span",{className:"truncate text-custom-text-100",children:(null!==(n=null==x?void 0:x.name)&&void 0!==n?n:"").substring(0,50)})]})}),(0,l.jsxs)(c.fR,{ellipsis:!0,optionsClassName:"p-1.5",children:[(0,l.jsx)("div",{className:"border-b border-custom-border-300 text-xs font-medium text-custom-text-200",children:"Sibling issues"}),(0,l.jsx)(eU,{currentIssue:d,parentIssue:x}),(0,l.jsxs)(c.fR.MenuItem,{onClick:()=>u.update(r,i,o,{parent_id:null}),className:"flex items-center gap-2 py-2 text-red-500",children:[(0,l.jsx)(eZ.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:" Remove Parent Issue"})]})]})]})}):(0,l.jsx)(l.Fragment,{})});var eW=s(78518),eK=s(6780);let eY=(0,y.Pi)(e=>{var t;let{className:s="",workspaceSlug:n,projectId:r,issueId:a,issueOperations:i,disabled:o=!1}=e,[c,d]=(0,b.useState)(!1),{issue:{getIssueById:u}}=(0,v.p1)(),m=u(a),h=async e=>{var t,s,l;m&&m.cycle_id!==e&&(d(!0),e?await (null===(t=i.addCycleToIssue)||void 0===t?void 0:t.call(i,n,r,e,a)):await (null===(s=i.removeIssueFromCycle)||void 0===s?void 0:s.call(i,n,r,null!==(l=m.cycle_id)&&void 0!==l?l:"",a)),d(!1))};return(0,l.jsx)("div",{className:(0,eK.cn)("flex h-full items-center gap-1",s),children:(0,l.jsx)(A._X,{value:null!==(t=null==m?void 0:m.cycle_id)&&void 0!==t?t:null,onChange:h,projectId:r,disabled:o||c,buttonVariant:"transparent-with-text",className:"group w-full",buttonContainerClassName:"w-full text-left",buttonClassName:"text-sm justify-between  ".concat((null==m?void 0:m.cycle_id)?"":"text-custom-text-400"),placeholder:"No cycle",hideIcon:!0,dropdownArrow:!0,dropdownArrowClassName:"h-3.5 w-3.5 hidden group-hover:inline"})})});var eJ=s(83114),eH=s(94938);let eQ=(0,y.Pi)(e=>{let{workspaceSlug:t,projectId:s,issueId:n,issueOperations:r,isEditable:a,isArchived:i,swrIssueDetails:o}=e,[d,u]=(0,b.useState)("saved"),{currentUser:m}=(0,v.aF)(),{projectStates:h}=(0,v.eD)(),{issue:{getIssueById:p}}=(0,v.p1)(),{setShowAlert:x}=(0,eJ.Z)("submitting"===d);(0,b.useEffect)(()=>{"submitted"===d?(x(!1),setTimeout(async()=>u("saved"),2e3)):"submitting"===d&&x(!0)},[d,x,u]);let f=n?p(n):void 0;if(!f)return(0,l.jsx)(l.Fragment,{});let g=null==h?void 0:h.find(e=>e.id===f.state_id);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"rounded-lg space-y-4 pl-3",children:[f.parent_id&&(0,l.jsx)(eV,{workspaceSlug:t,projectId:s,issueId:n,issue:f,issueOperations:r}),(0,l.jsxs)("div",{className:"mb-2.5 flex items-center",children:[g&&(0,l.jsx)(c.b_,{className:"mr-3 h-4 w-4",stateGroup:g.group,color:g.color}),(0,l.jsx)(ex,{isSubmitting:d,issueDetail:f})]}),(0,l.jsx)(en.N,{workspaceSlug:t,projectId:f.project_id,issueId:f.id,isSubmitting:d,setIsSubmitting:e=>u(e),issueOperations:r,disabled:!a,value:f.name,containerClassName:"-ml-3"}),(0,l.jsx)(el.j,{swrIssueDescription:null==o?void 0:o.description_html,workspaceSlug:t,projectId:f.project_id,issueId:f.id,initialValue:f.description_html,disabled:!a,issueOperations:r,setIsSubmitting:e=>u(e),containerClassName:"-ml-3 !mb-6 border-none"}),m&&(0,l.jsx)(eW.J,{workspaceSlug:t,projectId:s,issueId:n,currentUser:m,disabled:i}),m&&(0,l.jsx)(eH.P,{workspaceSlug:t,projectId:s,parentIssueId:n,currentUser:m,disabled:!a})]}),(0,l.jsx)("div",{className:"pl-3",children:(0,l.jsx)(I,{workspaceSlug:t,projectId:s,issueId:n,disabled:!a})}),(0,l.jsx)("div",{className:"pl-3",children:(0,l.jsx)(ef.J3,{workspaceSlug:t,projectId:s,issueId:n,disabled:i})})]})});var eG=s(20098),e$=s.n(eG);let eX=(0,y.Pi)(e=>{var t,s;let{className:n="",workspaceSlug:r,projectId:a,issueId:i,issueOperations:o,disabled:c=!1}=e,[d,u]=(0,b.useState)(!1),{issue:{getIssueById:m}}=(0,v.p1)(),h=m(i),p=async e=>{var t,s;if(!h||!h.module_ids)return;u(!0);let l=e$()(h.module_ids,e),n=[],c=[];for(let e of l)h.module_ids.includes(e)?c.push(e):n.push(e);c.length>0&&await (null===(t=o.removeModulesFromIssue)||void 0===t?void 0:t.call(o,r,a,i,c)),n.length>0&&await (null===(s=o.addModulesToIssue)||void 0===s?void 0:s.call(o,r,a,i,n)),u(!1)};return(0,l.jsx)("div",{className:(0,eK.cn)("flex h-full items-center gap-1",n),children:(0,l.jsx)(A.xL,{projectId:a,value:null!==(s=null==h?void 0:h.module_ids)&&void 0!==s?s:[],onChange:p,placeholder:"No module",disabled:c||d,className:"group h-full w-full",buttonContainerClassName:"w-full",buttonClassName:"min-h-8 text-sm justify-between ".concat((null==h?void 0:null===(t=h.module_ids)||void 0===t?void 0:t.length)?"":"text-custom-text-400"),buttonVariant:"transparent-with-text",hideIcon:!0,dropdownArrow:!0,dropdownArrowClassName:"h-3.5 w-3.5 hidden group-hover:inline",multiple:!0})})}),e0=(0,y.Pi)(e=>{let{className:t="",disabled:s=!1,issueId:n,issueOperations:r,projectId:i,workspaceSlug:d}=e,{getProjectById:u}=(0,v.PY)(),{issue:{getIssueById:m}}=(0,v.p1)(),{isParentIssueModalOpen:h,toggleParentIssueModal:p,removeSubIssue:x,subIssues:{setSubIssueHelpers:f}}=(0,v.p1)(),j=m(n),b=(null==j?void 0:j.parent_id)?m(j.parent_id):void 0,y=b&&b.project_id?u(b.project_id):void 0,{isMobile:w}=(0,g.L)(),N=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{await r.update(d,i,n,{parent_id:e}),await r.fetch(d,i,n),p(n)}catch(e){console.error("something went wrong while fetching the issue")}},k=async(e,t,s,l)=>{try{f(s,"issue_loader",l),await x(e,t,s,l),f(s,"issue_loader",l)}catch(e){(0,c.fz)({type:c.do.ERROR,title:"Error!",message:"Something went wrong"})}};return j?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(em,{projectId:i,issueId:n,isOpen:h===n,handleClose:()=>p(null),onChange:e=>N(null==e?void 0:e.id)}),(0,l.jsxs)("button",{type:"button",className:(0,eK.cn)("group flex items-center justify-between gap-2 px-2 py-0.5 rounded outline-none",{"cursor-not-allowed":s,"hover:bg-custom-background-80":!s,"bg-custom-background-80":h},t),onClick:()=>p(j.id),disabled:s,children:[j.parent_id&&b?(0,l.jsxs)("div",{className:"flex items-center gap-1 bg-green-500/20 text-green-700 rounded px-1.5 py-1",children:[(0,l.jsx)(c.u,{tooltipHeading:"Title",tooltipContent:b.name,isMobile:w,children:(0,l.jsxs)(a(),{href:"/".concat(d,"/projects/").concat(i,"/issues/").concat(null==b?void 0:b.id),target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium",onClick:e=>e.stopPropagation(),children:[null==y?void 0:y.identifier,"-",b.sequence_id]})}),!s&&(0,l.jsx)(c.u,{tooltipContent:"Remove",position:"bottom",isMobile:w,children:(0,l.jsx)("span",{onClick:e=>{e.preventDefault(),e.stopPropagation(),k(d,i,b.id,n)},children:(0,l.jsx)(o.Z,{className:"h-2.5 w-2.5 text-custom-text-300 hover:text-red-500"})})})]}):(0,l.jsx)("span",{className:"text-sm text-custom-text-400",children:"Add parent issue"}),!s&&(0,l.jsx)("span",{className:(0,eK.cn)("p-1 flex-shrink-0 opacity-0 group-hover:opacity-100",{"text-custom-text-400":!j.parent_id&&!b}),children:(0,l.jsx)(eT.Z,{className:"h-2.5 w-2.5 flex-shrink-0"})})]})]}):(0,l.jsx)(l.Fragment,{})});var e1=s(81436),e2=s(78593),e5=s(51374),e3=s(46987),e4=s(49743),e8=s(41256),e6=s(21219),e7=s(73470),e9=s(25262),te=s(50811),tt=s(14820),ts=s(52934),tl=s(30644),tn=s.n(tl),tr=s(52747),ta=s(44893);let ti=(0,y.Pi)(e=>{let{workspaceSlug:t,projectId:s,issueId:n}=e,{subscription:{getSubscriptionByIssueId:r},createSubscription:a,removeSubscription:i}=(0,v.p1)(),[o,d]=(0,b.useState)(!1),u=r(n),m=async()=>{d(!0);try{u?await i(t,s,n):await a(t,s,n),(0,c.fz)({type:c.do.SUCCESS,title:"Success!",message:"Issue ".concat(u?"unsubscribed":"subscribed"," successfully.!")}),d(!1)}catch(e){d(!1),(0,c.fz)({type:c.do.ERROR,title:"Error!",message:"Something went wrong. Please try again later."})}};return tn()(u)?(0,l.jsx)(c.aN,{children:(0,l.jsx)(c.aN.Item,{width:"106px",height:"28px"})}):(0,l.jsx)("div",{children:(0,l.jsx)(c.zx,{size:"sm",prependIcon:u?(0,l.jsx)(tr.Z,{}):(0,l.jsx)(ta.Z,{className:"h-3 w-3"}),variant:"outline-primary",className:"hover:!bg-custom-primary-100/20",onClick:m,children:o?(0,l.jsx)("span",{children:(0,l.jsx)("span",{className:"hidden sm:block",children:"Loading..."})}):u?(0,l.jsx)("div",{className:"hidden sm:block",children:"Unsubscribe"}):(0,l.jsx)("div",{className:"hidden sm:block",children:"Subscribe"})})})}),to=(0,y.Pi)(e=>{var t,s,n,r,a,i;let{workspaceSlug:o,projectId:d,issueId:u,issueOperations:m,is_archived:h,isEditable:p}=e,[j,y]=(0,b.useState)(!1),[w,N]=(0,b.useState)(!1),k=(0,R.useRouter)(),{getProjectById:C}=(0,v.PY)(),{currentUser:S}=(0,v.aF)(),{areEstimatesEnabledForCurrentProject:_}=(0,v.ZT)(),{issue:{getIssueById:I}}=(0,v.p1)(),{getStateById:E}=(0,v.eD)(),{isMobile:P}=(0,g.L)(),F=I(u);if(!F)return(0,l.jsx)(l.Fragment,{});let O=async()=>{await m.remove(o,d,u),k.push("/".concat(o,"/projects/").concat(d,"/issues"))},D=async()=>{m.archive&&(await m.archive(o,d,u),k.push("/".concat(o,"/projects/").concat(d,"/archives/issues/").concat(F.id)))},M=C(F.project_id),z=E(F.state_id),Z=!h&&m.archive&&p,q=!!z&&[ts.q.completed.key,ts.q.cancelled.key].includes(null==z?void 0:z.group),B=F.start_date?(0,x._3)(F.start_date):null;null==B||B.setDate(B.getDate());let U=F.target_date?(0,x._3)(F.target_date):null;return null==U||U.setDate(U.getDate()),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(et,{handleClose:()=>y(!1),isOpen:j,data:F,onSubmit:O}),(0,l.jsx)(tm,{isOpen:w,handleClose:()=>N(!1),data:F,onSubmit:D}),(0,l.jsxs)("div",{className:"flex h-full w-full flex-col divide-y-2 divide-custom-border-200 overflow-hidden",children:[(0,l.jsx)("div",{className:"flex items-center justify-end px-5 pb-3",children:(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[S&&!h&&(0,l.jsx)(ti,{workspaceSlug:o,projectId:d,issueId:u}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2.5 text-custom-text-300",children:[(0,l.jsx)(c.u,{tooltipContent:"Copy link",isMobile:P,children:(0,l.jsx)("button",{type:"button",className:"grid h-5 w-5 place-items-center rounded hover:text-custom-text-200 focus:outline-none focus:ring-2 focus:ring-custom-primary",onClick:()=>{let e=window.location.origin?window.location.origin:"";(0,f.TE)("".concat(e,"/").concat(o,"/projects/").concat(d,"/issues/").concat(F.id)).then(()=>{(0,c.fz)({type:c.do.SUCCESS,title:"Link Copied!",message:"Issue link copied to clipboard."})})},children:(0,l.jsx)(eO.Z,{className:"h-4 w-4"})})}),Z&&(0,l.jsx)(c.u,{isMobile:P,tooltipContent:q?"Archive":"Only completed or canceled issues can be archived",children:(0,l.jsx)("button",{type:"button",className:(0,eK.cn)("grid h-5 w-5 place-items-center rounded focus:outline-none focus:ring-2 focus:ring-custom-primary",{"hover:text-custom-text-200":q,"cursor-not-allowed text-custom-text-400":!q}),onClick:()=>{q&&N(!0)},children:(0,l.jsx)(c.rK,{className:"h-4 w-4"})})}),p&&(0,l.jsx)(c.u,{tooltipContent:"Delete",isMobile:P,children:(0,l.jsx)("button",{type:"button",className:"grid h-5 w-5 place-items-center rounded hover:text-custom-text-200 focus:outline-none focus:ring-2 focus:ring-custom-primary",onClick:()=>y(!0),children:(0,l.jsx)(eD.Z,{className:"h-4 w-4"})})})]})]})}),(0,l.jsxs)("div",{className:"h-full w-full overflow-y-auto px-6",children:[(0,l.jsx)("h5",{className:"mt-6 text-sm font-medium",children:"Properties"}),(0,l.jsxs)("div",{className:"mb-2 mt-3 space-y-2.5 ".concat(p?"":"opacity-60"),children:[(0,l.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 items-center gap-1 text-sm text-custom-text-300",children:[(0,l.jsx)(c.go,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"State"})]}),(0,l.jsx)(A.sb,{value:null!==(n=null==F?void 0:F.state_id)&&void 0!==n?n:void 0,onChange:e=>m.update(o,d,u,{state_id:e}),projectId:null!==(r=null==d?void 0:d.toString())&&void 0!==r?r:"",disabled:!p,buttonVariant:"transparent-with-text",className:"group w-3/5 flex-grow",buttonContainerClassName:"w-full text-left",buttonClassName:"text-sm",dropdownArrow:!0,dropdownArrowClassName:"h-3.5 w-3.5 hidden group-hover:inline"})]}),(0,l.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 items-center gap-1 text-sm text-custom-text-300",children:[(0,l.jsx)(c.Ti,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Assignees"})]}),(0,l.jsx)(A.Yp,{value:null!==(a=null==F?void 0:F.assignee_ids)&&void 0!==a?a:void 0,onChange:e=>m.update(o,d,u,{assignee_ids:e}),disabled:!p,projectId:null!==(i=null==d?void 0:d.toString())&&void 0!==i?i:"",placeholder:"Add assignees",multiple:!0,buttonVariant:(null==F?void 0:null===(t=F.assignee_ids)||void 0===t?void 0:t.length)>1?"transparent-without-text":"transparent-with-text",className:"group w-3/5 flex-grow",buttonContainerClassName:"w-full text-left",buttonClassName:"text-sm justify-between ".concat((null==F?void 0:F.assignee_ids.length)>0?"":"text-custom-text-400"),hideIcon:(null===(s=F.assignee_ids)||void 0===s?void 0:s.length)===0,dropdownArrow:!0,dropdownArrowClassName:"h-3.5 w-3.5 hidden group-hover:inline"})]}),(0,l.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 items-center gap-1 text-sm text-custom-text-300",children:[(0,l.jsx)(e4.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Priority"})]}),(0,l.jsx)(A.Iw,{value:(null==F?void 0:F.priority)||void 0,onChange:e=>m.update(o,d,u,{priority:e}),disabled:!p,buttonVariant:"border-with-text",className:"w-3/5 flex-grow rounded px-2 hover:bg-custom-background-80",buttonContainerClassName:"w-full text-left",buttonClassName:"w-min h-auto whitespace-nowrap"})]}),(0,l.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 items-center gap-1 text-sm text-custom-text-300",children:[(0,l.jsx)(e8.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Start date"})]}),(0,l.jsx)(A.qp,{placeholder:"Add start date",value:F.start_date,onChange:e=>m.update(o,d,u,{start_date:e?(0,x.ss)(e):null}),maxDate:null!=U?U:void 0,disabled:!p,buttonVariant:"transparent-with-text",className:"group w-3/5 flex-grow",buttonContainerClassName:"w-full text-left",buttonClassName:"text-sm ".concat((null==F?void 0:F.start_date)?"":"text-custom-text-400"),hideIcon:!0,clearIconClassName:"h-3 w-3 hidden group-hover:inline"})]}),(0,l.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 items-center gap-1 text-sm text-custom-text-300",children:[(0,l.jsx)(e6.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Due date"})]}),(0,l.jsx)(A.qp,{placeholder:"Add due date",value:F.target_date,onChange:e=>m.update(o,d,u,{target_date:e?(0,x.ss)(e):null}),minDate:null!=B?B:void 0,disabled:!p,buttonVariant:"transparent-with-text",className:"group w-3/5 flex-grow",buttonContainerClassName:"w-full text-left",buttonClassName:(0,eK.cn)("text-sm",{"text-custom-text-400":!F.target_date,"text-red-500":(0,L.QU)(F.target_date,null==z?void 0:z.group)}),hideIcon:!0,clearIconClassName:"h-3 w-3 hidden group-hover:inline !text-custom-text-100"})]}),_&&(0,l.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 items-center gap-1 text-sm text-custom-text-300",children:[(0,l.jsx)(e7.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Estimate"})]}),(0,l.jsx)(A.ym,{value:(null==F?void 0:F.estimate_point)!==null?F.estimate_point:null,onChange:e=>m.update(o,d,u,{estimate_point:e}),projectId:d,disabled:!p,buttonVariant:"transparent-with-text",className:"group w-3/5 flex-grow",buttonContainerClassName:"w-full text-left",buttonClassName:"text-sm ".concat((null==F?void 0:F.estimate_point)!==null?"":"text-custom-text-400"),placeholder:"None",hideIcon:!0,dropdownArrow:!0,dropdownArrowClassName:"h-3.5 w-3.5 hidden group-hover:inline"})]}),(null==M?void 0:M.module_view)&&(0,l.jsxs)("div",{className:"flex min-h-8 gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 gap-1 pt-2 text-sm text-custom-text-300",children:[(0,l.jsx)(c.kB,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Module"})]}),(0,l.jsx)(eX,{className:"w-3/5 flex-grow",workspaceSlug:o,projectId:d,issueId:u,issueOperations:m,disabled:!p})]}),(null==M?void 0:M.cycle_view)&&(0,l.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 items-center gap-1 text-sm text-custom-text-300",children:[(0,l.jsx)(c.sI,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Cycle"})]}),(0,l.jsx)(eY,{className:"w-3/5 flex-grow",workspaceSlug:o,projectId:d,issueId:u,issueOperations:m,disabled:!p})]}),(0,l.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 items-center gap-1 text-sm text-custom-text-300",children:[(0,l.jsx)(T.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Parent"})]}),(0,l.jsx)(e0,{className:"h-full w-3/5 flex-grow",workspaceSlug:o,projectId:d,issueId:u,issueOperations:m,disabled:!p})]}),(0,l.jsxs)("div",{className:"flex min-h-8 gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 gap-1 pt-2 text-sm text-custom-text-300",children:[(0,l.jsx)(c.vx,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Relates to"})]}),(0,l.jsx)(e1.r,{className:"h-full min-h-8 w-3/5 flex-grow",workspaceSlug:o,projectId:d,issueId:u,relationKey:"relates_to",disabled:!p})]}),(0,l.jsxs)("div",{className:"flex min-h-8 gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 gap-1 pt-2 text-sm text-custom-text-300",children:[(0,l.jsx)(e9.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Blocking"})]}),(0,l.jsx)(e1.r,{className:"h-full min-h-8 w-3/5 flex-grow",workspaceSlug:o,projectId:d,issueId:u,relationKey:"blocking",disabled:!p})]}),(0,l.jsxs)("div",{className:"flex min-h-8 gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 gap-1 pt-2 text-sm text-custom-text-300",children:[(0,l.jsx)(te.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Blocked by"})]}),(0,l.jsx)(e1.r,{className:"h-full min-h-8 w-3/5 flex-grow",workspaceSlug:o,projectId:d,issueId:u,relationKey:"blocked_by",disabled:!p})]}),(0,l.jsxs)("div",{className:"flex min-h-8 gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 gap-1 pt-2 text-sm text-custom-text-300",children:[(0,l.jsx)(tt.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Duplicate of"})]}),(0,l.jsx)(e1.r,{className:"h-full min-h-8 w-3/5 flex-grow",workspaceSlug:o,projectId:d,issueId:u,relationKey:"duplicate",disabled:!p})]}),(0,l.jsxs)("div",{className:"flex min-h-8 gap-2",children:[(0,l.jsxs)("div",{className:"flex w-2/5 flex-shrink-0 gap-1 pt-2 text-sm text-custom-text-300",children:[(0,l.jsx)(e_.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Labels"})]}),(0,l.jsx)("div",{className:"h-full min-h-8 w-3/5 flex-grow",children:(0,l.jsx)(ev,{workspaceSlug:o,projectId:d,issueId:u,disabled:!p})})]})]}),(0,l.jsx)(eL,{workspaceSlug:o,projectId:d,issueId:u,disabled:!p})]})]})]})}),tc=(0,n.Pi)(e=>{var t;let{workspaceSlug:s,projectId:n,issueId:r,swrIssueDetails:a,is_archived:i=!1}=e,o=(0,R.useRouter)(),{issue:{getIssueById:d},fetchIssue:u,updateIssue:m,removeIssue:h,archiveIssue:p,addCycleToIssue:x,addIssueToCycle:f,removeIssueFromCycle:g,addModulesToIssue:j,removeIssueFromModule:y,removeModulesFromIssue:w}=(0,v.p1)(),{issues:{removeIssue:N}}=(0,v.gk)(G.rS.ARCHIVED),{captureIssueEvent:k}=(0,v.DN)(),{membership:{currentProjectRole:C}}=(0,v.aF)(),{theme:S}=(0,v.IX)(),_=(0,b.useMemo)(()=>({fetch:async(e,t,s)=>{try{await u(e,t,s)}catch(e){console.error("Error fetching the parent issue")}},update:async(e,t,s,l)=>{try{await m(e,t,s,l),k({eventName:Q.C6,payload:{...l,issueId:s,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:Object.keys(l).join(","),change_details:Object.values(l).join(",")},path:o.asPath})}catch(e){k({eventName:Q.C6,payload:{state:"FAILED",element:"Issue detail page"},updates:{changed_property:Object.keys(l).join(","),change_details:Object.values(l).join(",")},path:o.asPath}),(0,c.fz)({title:"Error!",type:c.do.ERROR,message:"Issue update failed"})}},remove:async(e,t,s)=>{try{i?await N(e,t,s):await h(e,t,s),(0,c.fz)({title:"Success!",type:c.do.SUCCESS,message:"Issue deleted successfully"}),k({eventName:Q.IO,payload:{id:s,state:"SUCCESS",element:"Issue detail page"},path:o.asPath})}catch(e){(0,c.fz)({title:"Error!",type:c.do.ERROR,message:"Issue delete failed"}),k({eventName:Q.IO,payload:{id:s,state:"FAILED",element:"Issue detail page"},path:o.asPath})}},archive:async(e,t,s)=>{try{await p(e,t,s),k({eventName:Q._E,payload:{id:s,state:"SUCCESS",element:"Issue details page"},path:o.asPath})}catch(e){k({eventName:Q._E,payload:{id:s,state:"FAILED",element:"Issue details page"},path:o.asPath})}},addCycleToIssue:async(e,t,s,l)=>{try{await x(e,t,s,l),k({eventName:Q.C6,payload:{issueId:l,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:"cycle_id",change_details:s},path:o.asPath})}catch(e){(0,c.fz)({type:c.do.ERROR,title:"Error!",message:"Issue could not be added to the cycle. Please try again."}),k({eventName:Q.C6,payload:{state:"FAILED",element:"Issue detail page"},updates:{changed_property:"cycle_id",change_details:s},path:o.asPath})}},addIssueToCycle:async(e,t,s,l)=>{try{await f(e,t,s,l),k({eventName:Q.C6,payload:{...l,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:"cycle_id",change_details:s},path:o.asPath})}catch(e){(0,c.fz)({type:c.do.ERROR,title:"Error!",message:"Issue could not be added to the cycle. Please try again."}),k({eventName:Q.C6,payload:{state:"FAILED",element:"Issue detail page"},updates:{changed_property:"cycle_id",change_details:s},path:o.asPath})}},removeIssueFromCycle:async(e,t,s,l)=>{try{let n=g(e,t,s,l);(0,c.uW)(n,{loading:"Removing issue from the cycle...",success:{title:"Success!",message:()=>"Issue removed from the cycle successfully."},error:{title:"Error!",message:()=>"Issue could not be removed from the cycle. Please try again."}}),await n,k({eventName:Q.C6,payload:{issueId:l,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:"cycle_id",change_details:""},path:o.asPath})}catch(e){k({eventName:Q.C6,payload:{state:"FAILED",element:"Issue detail page"},updates:{changed_property:"cycle_id",change_details:""},path:o.asPath})}},addModulesToIssue:async(e,t,s,l)=>{try{let n=await j(e,t,s,l);k({eventName:Q.C6,payload:{...n,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:"module_id",change_details:l},path:o.asPath})}catch(e){(0,c.fz)({type:c.do.ERROR,title:"Error!",message:"Issue could not be added to the module. Please try again."}),k({eventName:Q.C6,payload:{id:s,state:"FAILED",element:"Issue detail page"},updates:{changed_property:"module_id",change_details:l},path:o.asPath})}},removeIssueFromModule:async(e,t,s,l)=>{try{let n=y(e,t,s,l);(0,c.uW)(n,{loading:"Removing issue from the module...",success:{title:"Success!",message:()=>"Issue removed from the module successfully."},error:{title:"Error!",message:()=>"Issue could not be removed from the module. Please try again."}}),await n,k({eventName:Q.C6,payload:{id:l,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:"module_id",change_details:""},path:o.asPath})}catch(e){k({eventName:Q.C6,payload:{id:l,state:"FAILED",element:"Issue detail page"},updates:{changed_property:"module_id",change_details:""},path:o.asPath})}},removeModulesFromIssue:async(e,t,s,l)=>{let n=w(e,t,s,l);(0,c.uW)(n,{loading:"Removing module from issue...",success:{title:"Success!",message:()=>"Module removed from issue successfully"},error:{title:"Error!",message:()=>"Module remove from issue failed"}}),await n}}),[i,u,m,h,p,N,f,g,j,y,w,k,o.asPath]),I=d(r),E=!!C&&C>=e5.MC.MEMBER;return(0,l.jsxs)(l.Fragment,{children:[I?(0,l.jsxs)("div",{className:"flex h-full w-full overflow-hidden",children:[(0,l.jsx)("div",{className:"max-w-2/3 h-full w-full space-y-5 divide-y-2 divide-custom-border-200 overflow-y-auto px-6 py-5",children:(0,l.jsx)(eQ,{workspaceSlug:s,swrIssueDetails:a,projectId:n,issueId:r,issueOperations:_,isEditable:!i&&E,isArchived:i})}),(0,l.jsx)("div",{className:"fixed right-0 z-[5] h-full w-full min-w-[300px] overflow-hidden border-l border-custom-border-200 bg-custom-sidebar-background-100 py-5 sm:w-1/2 md:relative md:w-1/3 lg:min-w-80 xl:min-w-96",style:S.issueDetailSidebarCollapsed?{right:"-".concat((null===(t=window)||void 0===t?void 0:t.innerWidth)||0,"px")}:{},children:(0,l.jsx)(to,{workspaceSlug:s,projectId:n,issueId:r,issueOperations:_,is_archived:i,isEditable:!i&&E})})]}):(0,l.jsx)(e2.ub,{image:e3.Z,title:"Issue does not exist",description:"The issue you are looking for does not exist, has been archived, or has been deleted.",primaryButton:{text:"View other issues",onClick:()=>o.push("/".concat(s,"/projects/").concat(n,"/issues"))}}),(0,l.jsx)(td.Ky,{})]})});var td=s(32246),tu=s(81309);let tm=e=>{let{dataId:t,data:s,isOpen:n,handleClose:r,onSubmit:a}=e,[i,o]=(0,b.useState)(!1),{getProjectById:d}=(0,v.PY)(),{issueMap:u}=(0,tu.g)();if(!t&&!s)return null;let m=s||u[t],h=d(m.project_id),p=()=>{o(!1),r()},x=async()=>{a&&(o(!0),await a().then(()=>{(0,c.fz)({type:c.do.SUCCESS,title:"Archive success",message:"Your archives can be found in project archives."}),p()}).catch(()=>(0,c.fz)({type:c.do.ERROR,title:"Error!",message:"Issue could not be archived. Please try again."})).finally(()=>o(!1)))};return(0,l.jsx)(ei.u.Root,{show:n,as:b.Fragment,children:(0,l.jsxs)(eo.V,{as:"div",className:"relative z-20",onClose:p,children:[(0,l.jsx)(ei.u.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,l.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,l.jsx)(ei.u.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,l.jsx)(eo.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-full sm:max-w-lg",children:(0,l.jsxs)("div",{className:"px-5 py-4",children:[(0,l.jsxs)("h3",{className:"text-xl font-medium 2xl:text-2xl",children:["Archive issue ",null==h?void 0:h.identifier," ",m.sequence_id]}),(0,l.jsx)("p",{className:"mt-3 text-sm text-custom-text-200",children:"Are you sure you want to archive the issue? All your archived issues can be restored later."}),(0,l.jsxs)("div",{className:"mt-3 flex justify-end gap-2",children:[(0,l.jsx)(c.zx,{variant:"neutral-primary",size:"sm",onClick:p,children:"Cancel"}),(0,l.jsx)(c.zx,{size:"sm",tabIndex:1,onClick:x,loading:i,children:i?"Archiving":"Archive"})]})]})})})})})]})})};var th=s(42903),tp=s(1422);let tx=(0,y.Pi)(()=>{var e;let{workspaceSlug:t,projectId:s}=(0,R.useRouter)().query,{currentProjectDetails:n}=(0,v.PY)(),{issuesFilter:{issueFilters:r,updateFilters:a}}=(0,v.gk)(G.rS.ARCHIVED),{projectStates:i}=(0,v.eD)(),{projectLabels:o}=(0,v.NP)(),{project:{projectMemberIds:c}}=(0,v.Kb)(),d="list",u=0!==(0,tp.w)(null!==(e=null==r?void 0:r.filters)&&void 0!==e?e:{});return(0,l.jsxs)("div",{className:"group relative flex border-b border-custom-border-200",children:[(0,l.jsx)("div",{className:"flex w-full items-center overflow-x-auto px-4 gap-2 horizontal-scrollbar scrollbar-sm",children:(0,l.jsx)(th.o,{})}),(0,l.jsxs)("div",{className:"flex items-center gap-2 px-8",children:[(0,l.jsx)(es.lq,{title:"Filters",placement:"bottom-end",isFiltersApplied:u,children:(0,l.jsx)(es.dG,{filters:(null==r?void 0:r.filters)||{},handleFiltersUpdate:(e,l)=>{var n,i,o,c;if(!t||!s)return;let d=null!==(i=null==r?void 0:null===(n=r.filters)||void 0===n?void 0:n[e])&&void 0!==i?i:[];Array.isArray(l)?l.forEach(e=>{d.includes(e)||d.push(e)}):(null==r?void 0:null===(c=r.filters)||void 0===c?void 0:null===(o=c[e])||void 0===o?void 0:o.includes(l))?d.splice(d.indexOf(l),1):d.push(l),a(t.toString(),s.toString(),G.gc.FILTERS,{[e]:d})},layoutDisplayFiltersOptions:d?G.BI.archived_issues[d]:void 0,labels:o,memberIds:null!=c?c:void 0,states:i})}),(0,l.jsx)(es.lq,{title:"Display",placement:"bottom-end",children:(0,l.jsx)(es.hv,{displayFilters:(null==r?void 0:r.displayFilters)||{},displayProperties:(null==r?void 0:r.displayProperties)||{},handleDisplayFiltersUpdate:e=>{t&&s&&a(t.toString(),s.toString(),G.gc.DISPLAY_FILTERS,{...null==r?void 0:r.displayFilters,...e})},handleDisplayPropertiesUpdate:e=>{t&&s&&a(t.toString(),s.toString(),G.gc.DISPLAY_PROPERTIES,e)},layoutDisplayFiltersOptions:d?G.BI.issues[d]:void 0,cycleViewDisabled:!(null==n?void 0:n.cycle_view),moduleViewDisabled:!(null==n?void 0:n.module_view)})})]})]})})},4062:function(e,t,s){s.d(t,{J3:function(){return m},em:function(){return ep},dP:function(){return ef},BJ:function(){return ej}});var l=s(24246),n=s(27378),r=s(43659),a=s(48854),i=s(94743),o=s(25449),c=s(68114),d=s(10634);let u=[{key:"comments",title:"Comments",icon:a.Z},{key:"all",title:"All activity",icon:i.Z}],m=(0,r.Pi)(e=>{let{workspaceSlug:t,projectId:s,issueId:r,disabled:a=!1}=e,{createComment:i,updateComment:m,removeComment:h}=(0,d.p1)(),{getProjectById:p}=(0,d.PY)(),[x,f]=(0,n.useState)("comments"),v=(0,n.useMemo)(()=>({createComment:async e=>{try{if(!t||!s||!r)throw Error("Missing fields");await i(t,s,r,e),(0,o.fz)({title:"Success!",type:o.do.SUCCESS,message:"Comment created successfully."})}catch(e){(0,o.fz)({title:"Error!",type:o.do.ERROR,message:"Comment creation failed. Please try again later."})}},updateComment:async(e,l)=>{try{if(!t||!s||!r)throw Error("Missing fields");await m(t,s,r,e,l),(0,o.fz)({title:"Success!",type:o.do.SUCCESS,message:"Comment updated successfully."})}catch(e){(0,o.fz)({title:"Error!",type:o.do.ERROR,message:"Comment update failed. Please try again later."})}},removeComment:async e=>{try{if(!t||!s||!r)throw Error("Missing fields");await h(t,s,r,e),(0,o.fz)({title:"Success!",type:o.do.SUCCESS,message:"Comment removed successfully."})}catch(e){(0,o.fz)({title:"Error!",type:o.do.ERROR,message:"Comment remove failed. Please try again later."})}}}),[t,s,r,i,m,h]),g=p(s);return g?(0,l.jsxs)("div",{className:"space-y-3 pt-3",children:[(0,l.jsx)("div",{className:"text-lg text-custom-text-100",children:"Activity"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("div",{className:"relative flex items-center gap-1",children:u.map(e=>(0,l.jsxs)("div",{className:"relative flex items-center px-2 py-1.5 gap-1 cursor-pointer transition-all rounded \n            ".concat(e.key===x?"text-custom-text-100 bg-custom-background-80":"text-custom-text-200 hover:bg-custom-background-80"),onClick:()=>f(e.key),children:[(0,l.jsx)("div",{className:"flex-shrink-0 w-4 h-4 flex justify-center items-center",children:(0,l.jsx)(e.icon,{className:"w-3 h-3"})}),(0,l.jsx)("div",{className:"text-sm",children:e.title})]},e.key))}),(0,l.jsx)("div",{className:"min-h-[200px]",children:"all"===x?(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)(c.em,{projectId:s,workspaceSlug:t,issueId:r,activityOperations:v,showAccessSpecifier:g.is_deployed,disabled:a}),!a&&(0,l.jsx)(c.dPY,{issueId:r,projectId:s,workspaceSlug:t,activityOperations:v,showAccessSpecifier:g.is_deployed})]}):(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)(c.BJF,{projectId:s,workspaceSlug:t,issueId:r,activityOperations:v,showAccessSpecifier:g.is_deployed,disabled:a}),!a&&(0,l.jsx)(c.dPY,{issueId:r,projectId:s,workspaceSlug:t,activityOperations:v,showAccessSpecifier:g.is_deployed})]})})]})]}):(0,l.jsx)(l.Fragment,{})});var h=s(50649);let p=(0,h.Pi)(e=>{let{activityId:t,ends:s}=e,{activity:{getActivityById:n}}=(0,d.p1)(),r=n(t);return r?(0,l.jsx)(W,{activityId:t,icon:(0,l.jsx)(o.uQ,{width:12,height:12,color:"#6b7280","aria-hidden":"true"}),ends:s,children:(0,l.jsx)(l.Fragment,{children:"created"===r.verb?" created the issue.":" deleted an issue."})}):(0,l.jsx)(l.Fragment,{})});var x=s(71561);let f=(0,h.Pi)(e=>{let{activityId:t,ends:s}=e,{activity:{getActivityById:n}}=(0,d.p1)(),r=n(t);return r?(0,l.jsx)(W,{icon:(0,l.jsx)(x.Z,{size:14,color:"#6b7280","aria-hidden":"true"}),activityId:t,ends:s,children:(0,l.jsxs)(l.Fragment,{children:["set the name to ",r.new_value,"."]})}):(0,l.jsx)(l.Fragment,{})}),v=(0,h.Pi)(e=>{let{activityId:t,showIssue:s=!0,ends:n}=e,{activity:{getActivityById:r}}=(0,d.p1)();return r(t)?(0,l.jsx)(W,{icon:(0,l.jsx)(x.Z,{size:14,color:"#6b7280","aria-hidden":"true"}),activityId:t,ends:n,children:(0,l.jsxs)(l.Fragment,{children:["updated the description",s?" of ":"",s&&(0,l.jsx)(H,{activityId:t}),"."]})}):(0,l.jsx)(l.Fragment,{})}),g=(0,h.Pi)(e=>{let{activityId:t,showIssue:s=!0,ends:n}=e,{activity:{getActivityById:r}}=(0,d.p1)(),a=r(t);return a?(0,l.jsx)(W,{icon:(0,l.jsx)(o.go,{className:"h-4 w-4 flex-shrink-0"}),activityId:t,ends:n,children:(0,l.jsxs)(l.Fragment,{children:["set the state to ",(0,l.jsx)("span",{className:"font-medium text-custom-text-100",children:a.new_value}),s?" for ":"",s&&(0,l.jsx)(H,{activityId:t}),"."]})}):(0,l.jsx)(l.Fragment,{})}),j=(0,h.Pi)(e=>{var t,s;let{activityId:n,ends:r,showIssue:a=!0}=e,{activity:{getActivityById:i}}=(0,d.p1)(),c=i(n);return c?(0,l.jsx)(W,{icon:(0,l.jsx)(o.Ti,{className:"h-4 w-4 flex-shrink-0"}),activityId:n,ends:r,children:(0,l.jsxs)(l.Fragment,{children:[""===c.old_value?"added a new assignee ":"removed the assignee ",(0,l.jsx)("a",{href:"/".concat(null===(t=c.workspace_detail)||void 0===t?void 0:t.slug,"/profile/").concat(null!==(s=c.new_identifier)&&void 0!==s?s:c.old_identifier),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center font-medium text-custom-text-100 hover:underline capitalize",children:c.new_value&&""!==c.new_value?c.new_value:c.old_value}),a&&(""===c.old_value?" to ":" from "),a&&(0,l.jsx)(H,{activityId:n}),"."]})}):(0,l.jsx)(l.Fragment,{})});var b=s(49743);let y=(0,h.Pi)(e=>{let{activityId:t,showIssue:s=!0,ends:n}=e,{activity:{getActivityById:r}}=(0,d.p1)(),a=r(t);return a?(0,l.jsx)(W,{icon:(0,l.jsx)(b.Z,{size:14,color:"#6b7280","aria-hidden":"true"}),activityId:t,ends:n,children:(0,l.jsxs)(l.Fragment,{children:["set the priority to ",(0,l.jsx)("span",{className:"font-medium text-custom-text-100",children:a.new_value}),s?" for ":"",s&&(0,l.jsx)(H,{activityId:t}),"."]})}):(0,l.jsx)(l.Fragment,{})});var w=s(73470);let N=(0,h.Pi)(e=>{let{activityId:t,showIssue:s=!0,ends:n}=e,{activity:{getActivityById:r}}=(0,d.p1)(),{areEstimatesEnabledForCurrentProject:a,getEstimatePointValue:i}=(0,d.ZT)(),o=r(t);if(!o)return(0,l.jsx)(l.Fragment,{});let c=i(Number(o.new_value),null),u=Number(o.new_value)+1;return(0,l.jsx)(W,{icon:(0,l.jsx)(w.Z,{size:14,color:"#6b7280","aria-hidden":"true"}),activityId:t,ends:n,children:(0,l.jsxs)(l.Fragment,{children:[o.new_value?"set the estimate point to ":"removed the estimate point ",o.new_value&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("span",{className:"font-medium text-custom-text-100",children:a?c:"".concat(u," ").concat(u>1?"points":"point")})}),s&&(o.new_value?" to ":" from "),s&&(0,l.jsx)(H,{activityId:t}),"."]})})});var k=s(34202);let C=(0,h.Pi)(e=>{let{activityId:t,showIssue:s=!0,ends:n}=e,{activity:{getActivityById:r}}=(0,d.p1)(),a=r(t);return a?(0,l.jsx)(W,{icon:(0,l.jsx)(k.Z,{size:14,color:"#6b7280","aria-hidden":"true"}),activityId:t,ends:n,children:(0,l.jsxs)(l.Fragment,{children:[a.new_value?"set the parent to ":"removed the parent ",a.new_value?(0,l.jsx)("span",{className:"font-medium text-custom-text-100",children:a.new_value}):(0,l.jsx)("span",{className:"font-medium text-custom-text-100",children:a.old_value}),s&&(a.new_value?" for ":" from "),s&&(0,l.jsx)(H,{activityId:t}),"."]})}):(0,l.jsx)(l.Fragment,{})});var S=s(81436);let _=(0,h.Pi)(e=>{let{activityId:t,ends:s}=e,{activity:{getActivityById:n}}=(0,d.p1)(),r=n(t);return r?(0,l.jsx)(W,{icon:r.field?S.Q[r.field].icon(14):(0,l.jsx)(l.Fragment,{}),activityId:t,ends:s,children:(0,l.jsxs)(l.Fragment,{children:["blocking"===r.field&&(""===r.old_value?"marked this issue is blocking issue ":"removed the blocking issue "),"blocked_by"===r.field&&(""===r.old_value?"marked this issue is being blocked by ":"removed this issue being blocked by issue "),"duplicate"===r.field&&(""===r.old_value?"marked this issue as duplicate of ":"removed this issue as a duplicate of "),"relates_to"===r.field&&(""===r.old_value?"marked that this issue relates to ":"removed the relation from "),""===r.old_value?(0,l.jsxs)("span",{className:"font-medium text-custom-text-100",children:[r.new_value,"."]}):(0,l.jsxs)("span",{className:"font-medium text-custom-text-100",children:[r.old_value,"."]})]})}):(0,l.jsx)(l.Fragment,{})});var I=s(17480),E=s(74273);let P=(0,h.Pi)(e=>{let{activityId:t,showIssue:s=!0,ends:n}=e,{activity:{getActivityById:r}}=(0,d.p1)(),a=r(t);return a?(0,l.jsx)(W,{icon:(0,l.jsx)(I.Z,{size:14,color:"#6b7280","aria-hidden":"true"}),activityId:t,ends:n,children:(0,l.jsxs)(l.Fragment,{children:[a.new_value?"set the start date to ":"removed the start date ",a.new_value&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("span",{className:"font-medium text-custom-text-100",children:(0,E.ot)(a.new_value)})}),s&&(a.new_value?" for ":" from "),s&&(0,l.jsx)(H,{activityId:t}),"."]})}):(0,l.jsx)(l.Fragment,{})}),R=(0,h.Pi)(e=>{let{activityId:t,showIssue:s=!0,ends:n}=e,{activity:{getActivityById:r}}=(0,d.p1)(),a=r(t);return a?(0,l.jsx)(W,{icon:(0,l.jsx)(I.Z,{size:14,color:"#6b7280","aria-hidden":"true"}),activityId:t,ends:n,children:(0,l.jsxs)(l.Fragment,{children:[a.new_value?"set the due date to ":"removed the due date ",a.new_value&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("span",{className:"font-medium text-custom-text-100",children:(0,E.ot)(a.new_value)})}),s&&(a.new_value?" for ":" from "),s&&(0,l.jsx)(H,{activityId:t}),"."]})}):(0,l.jsx)(l.Fragment,{})}),F=(0,h.Pi)(e=>{var t,s,n;let{activityId:r,ends:a}=e,{activity:{getActivityById:i}}=(0,d.p1)(),c=i(r);return c?(0,l.jsx)(W,{icon:(0,l.jsx)(o.sI,{className:"h-4 w-4 flex-shrink-0 text-[#6b7280]"}),activityId:r,ends:a,children:(0,l.jsx)(l.Fragment,{children:"created"===c.verb?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"added this issue to the cycle "}),(0,l.jsx)("a",{href:"/".concat(null===(t=c.workspace_detail)||void 0===t?void 0:t.slug,"/projects/").concat(c.project,"/cycles/").concat(c.new_identifier),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 truncate font-medium text-custom-text-100 hover:underline",children:(0,l.jsx)("span",{className:"truncate",children:c.new_value})})]}):"updated"===c.verb?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"set the cycle to "}),(0,l.jsx)("a",{href:"/".concat(null===(s=c.workspace_detail)||void 0===s?void 0:s.slug,"/projects/").concat(c.project,"/cycles/").concat(c.new_identifier),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 truncate font-medium text-custom-text-100 hover:underline",children:(0,l.jsxs)("span",{className:"truncate",children:[" ",c.new_value]})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"removed the issue from the cycle "}),(0,l.jsx)("a",{href:"/".concat(null===(n=c.workspace_detail)||void 0===n?void 0:n.slug,"/projects/").concat(c.project,"/cycles/").concat(c.old_identifier),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 truncate font-medium text-custom-text-100 hover:underline",children:(0,l.jsxs)("span",{className:"truncate",children:[" ",c.new_value]})})]})})}):(0,l.jsx)(l.Fragment,{})}),O=(0,h.Pi)(e=>{var t,s,n;let{activityId:r,ends:a}=e,{activity:{getActivityById:i}}=(0,d.p1)(),c=i(r);return c?(0,l.jsx)(W,{icon:(0,l.jsx)(o.kB,{className:"h-4 w-4 flex-shrink-0 text-[#6b7280]"}),activityId:r,ends:a,children:(0,l.jsx)(l.Fragment,{children:"created"===c.verb?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"added this issue to the module "}),(0,l.jsx)("a",{href:"/".concat(null===(t=c.workspace_detail)||void 0===t?void 0:t.slug,"/projects/").concat(c.project,"/modules/").concat(c.new_identifier),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 truncate font-medium text-custom-text-100 hover:underline",children:(0,l.jsx)("span",{className:"truncate",children:c.new_value})})]}):"updated"===c.verb?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"set the module to "}),(0,l.jsx)("a",{href:"/".concat(null===(s=c.workspace_detail)||void 0===s?void 0:s.slug,"/projects/").concat(c.project,"/modules/").concat(c.new_identifier),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 truncate font-medium text-custom-text-100 hover:underline",children:(0,l.jsxs)("span",{className:"truncate",children:[" ",c.new_value]})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"removed the issue from the module "}),(0,l.jsx)("a",{href:"/".concat(null===(n=c.workspace_detail)||void 0===n?void 0:n.slug,"/projects/").concat(c.project,"/modules/").concat(c.old_identifier),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 truncate font-medium text-custom-text-100 hover:underline",children:(0,l.jsxs)("span",{className:"truncate",children:[" ",c.old_value]})})]})})}):(0,l.jsx)(l.Fragment,{})});var T=s(77970);let A=(0,h.Pi)(e=>{var t,s,n,r;let{activityId:a,showIssue:i=!0,ends:o}=e,{activity:{getActivityById:c}}=(0,d.p1)(),{projectLabels:u}=(0,d.NP)(),m=c(a);return m?(0,l.jsx)(W,{icon:(0,l.jsx)(T.Z,{size:14,color:"#6b7280","aria-hidden":"true"}),activityId:a,ends:o,children:(0,l.jsxs)(l.Fragment,{children:[""===m.old_value?"added a new label ":"removed the label ",""===m.old_value?(0,l.jsxs)("span",{className:"inline-flex w-min items-center gap-2 truncate whitespace-nowrap rounded-full border border-custom-border-300 px-2 py-0.5 text-xs",children:[(0,l.jsx)("span",{className:"h-1.5 w-1.5 flex-shrink-0 rounded-full",style:{backgroundColor:null!==(n=null==u?void 0:null===(t=u.find(e=>e.id===m.new_identifier))||void 0===t?void 0:t.color)&&void 0!==n?n:"#000000"},"aria-hidden":"true"}),(0,l.jsx)("span",{className:"flex-shrink truncate font-medium text-custom-text-100",children:m.new_value})]}):(0,l.jsxs)("span",{className:"inline-flex w-min items-center gap-2 truncate whitespace-nowrap rounded-full border border-custom-border-300 px-2 py-0.5 text-xs",children:[(0,l.jsx)("span",{className:"h-1.5 w-1.5 flex-shrink-0 rounded-full",style:{backgroundColor:null!==(r=null==u?void 0:null===(s=u.find(e=>e.id===m.old_identifier))||void 0===s?void 0:s.color)&&void 0!==r?r:"#000000"},"aria-hidden":"true"}),(0,l.jsx)("span",{className:"flex-shrink truncate font-medium text-custom-text-100",children:m.old_value})]}),i&&(""===m.old_value?" to ":" from "),i&&(0,l.jsx)(H,{activityId:a})]})}):(0,l.jsx)(l.Fragment,{})}),D=(0,h.Pi)(e=>{let{activityId:t,showIssue:s=!1,ends:n}=e,{activity:{getActivityById:r}}=(0,d.p1)(),a=r(t);return a?(0,l.jsx)(W,{icon:(0,l.jsx)(x.Z,{size:14,color:"#6b7280","aria-hidden":"true"}),activityId:t,ends:n,children:(0,l.jsxs)(l.Fragment,{children:["created"===a.verb?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"added this "}),(0,l.jsx)("a",{href:"".concat(a.new_value),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 font-medium text-custom-text-100 hover:underline",children:"link"})]}):"updated"===a.verb?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"updated the "}),(0,l.jsx)("a",{href:"".concat(a.old_value),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 font-medium text-custom-text-100 hover:underline",children:"link"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:"removed this "}),(0,l.jsx)("a",{href:"".concat(a.old_value),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 font-medium text-custom-text-100 hover:underline",children:"link"})]}),s&&("created"===a.verb?" to ":" from "),s&&(0,l.jsx)(H,{activityId:t}),"."]})}):(0,l.jsx)(l.Fragment,{})});var M=s(95232);let z=(0,h.Pi)(e=>{let{activityId:t,showIssue:s=!0,ends:n}=e,{activity:{getActivityById:r}}=(0,d.p1)(),a=r(t);return a?(0,l.jsx)(W,{icon:(0,l.jsx)(M.Z,{size:14,color:"#6b7280","aria-hidden":"true"}),activityId:t,ends:n,children:(0,l.jsxs)(l.Fragment,{children:["created"===a.verb?"uploaded a new ":"removed an attachment","created"===a.verb&&(0,l.jsx)("a",{href:"".concat(a.new_value),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 font-medium text-custom-text-100 hover:underline",children:"attachment"}),s&&("created"===a.verb?" to ":" from "),s&&(0,l.jsx)(H,{activityId:t}),"."]})}):(0,l.jsx)(l.Fragment,{})});var L=s(87042);let Z=(0,h.Pi)(e=>{let{activityId:t,ends:s}=e,{activity:{getActivityById:n}}=(0,d.p1)(),r=n(t);return r?(0,l.jsxs)(W,{icon:"restore"===r.new_value?(0,l.jsx)(L.Z,{className:"h-3.5 w-3.5",color:"#6b7280","aria-hidden":"true"}):(0,l.jsx)(o.rK,{className:"h-3.5 w-3.5",color:"#6b7280","aria-hidden":"true"}),activityId:t,ends:s,customUserName:"archive"===r.new_value?"Plane":void 0,children:["restore"===r.new_value?"restored the issue":"archived the issue","."]}):(0,l.jsx)(l.Fragment,{})});var q=s(27943);let B=(0,h.Pi)(e=>{let{activityId:t,ends:s}=e,{activity:{getActivityById:n}}=(0,d.p1)(),r=n(t);return r?(0,l.jsx)(W,{icon:(0,l.jsx)(q.Z,{className:"h-4 w-4 flex-shrink-0"}),activityId:t,ends:s,children:(0,l.jsx)(l.Fragment,{children:(()=>{switch(null==r?void 0:r.verb){case"-1":return"declined this issue from inbox.";case"0":return"snoozed this issue.";case"1":return"accepted this issue from inbox.";case"2":return"declined this issue from inbox by marking a duplicate issue.";default:return"updated inbox issue status."}})()})}):(0,l.jsx)(l.Fragment,{})});var U=s(14466),V=s(18894);let W=e=>{let{icon:t,activityId:s,ends:n,children:r,customUserName:a}=e,{activity:{getActivityById:i}}=(0,d.p1)(),c=i(s),{isMobile:u}=(0,V.L)();return c?(0,l.jsxs)("div",{className:"relative flex items-center gap-3 text-xs ".concat("top"===n?"pb-2":"bottom"===n?"pt-2":"py-2"),children:[(0,l.jsx)("div",{className:"absolute left-[13px] top-0 bottom-0 w-0.5 bg-custom-background-80","aria-hidden":!0}),(0,l.jsx)("div",{className:"flex-shrink-0 ring-6 w-7 h-7 rounded-full overflow-hidden flex justify-center items-center z-[4] bg-custom-background-80 text-custom-text-200",children:t||(0,l.jsx)(U.Z,{className:"w-3.5 h-3.5"})}),(0,l.jsxs)("div",{className:"w-full text-custom-text-200",children:[(0,l.jsx)(J,{activityId:s,customUserName:a}),(0,l.jsxs)("span",{children:[" ",r," "]}),(0,l.jsx)("span",{children:(0,l.jsx)(o.u,{isMobile:u,tooltipContent:"".concat((0,E.ot)(c.created_at),", ").concat((0,E.bX)(c.created_at)),children:(0,l.jsxs)("span",{className:"whitespace-nowrap",children:[" ",(0,E.KI)(c.created_at)]})})})]})]}):(0,l.jsx)(l.Fragment,{})};var K=s(79894),Y=s.n(K);let J=e=>{var t,s,n;let{activityId:r,customUserName:a}=e,{activity:{getActivityById:i}}=(0,d.p1)(),o=i(r);return o?(0,l.jsx)(l.Fragment,{children:a?(0,l.jsx)("span",{className:"text-custom-text-100 font-medium",children:a}):(0,l.jsx)(Y(),{href:"/".concat(null==o?void 0:null===(t=o.workspace_detail)||void 0===t?void 0:t.slug,"/profile/").concat(null==o?void 0:null===(s=o.actor_detail)||void 0===s?void 0:s.id),className:"hover:underline text-custom-text-100 font-medium",children:null===(n=o.actor_detail)||void 0===n?void 0:n.display_name})}):(0,l.jsx)(l.Fragment,{})},H=e=>{var t,s;let{activityId:n}=e,{activity:{getActivityById:r}}=(0,d.p1)(),{isMobile:a}=(0,V.L)(),i=r(n);return i?(0,l.jsx)(o.u,{tooltipContent:i.issue_detail?i.issue_detail.name:"This issue has been deleted",isMobile:a,children:(0,l.jsxs)("a",{"aria-disabled":null===i.issue,href:"".concat(i.issue_detail?"/".concat(null===(t=i.workspace_detail)||void 0===t?void 0:t.slug,"/projects/").concat(i.project,"/issues/").concat(i.issue):"#"),target:null===i.issue?"_self":"_blank",rel:null===i.issue?"":"noopener noreferrer",className:"inline-flex items-center gap-1 font-medium text-custom-text-100 hover:underline",children:[i.issue_detail?"".concat(i.project_detail.identifier,"-").concat(i.issue_detail.sequence_id):"Issue"," ",(0,l.jsx)("span",{className:"font-normal",children:null===(s=i.issue_detail)||void 0===s?void 0:s.name})]})}):(0,l.jsx)(l.Fragment,{})},Q=(0,r.Pi)(e=>{var t;let{activityId:s,ends:n}=e,{activity:{getActivityById:r}}=(0,d.p1)(),a={activityId:s,ends:n},i=null===(t=r(s))||void 0===t?void 0:t.field;switch(i){case null:return(0,l.jsx)(p,{...a});case"state":return(0,l.jsx)(g,{...a,showIssue:!1});case"name":return(0,l.jsx)(f,{...a});case"description":return(0,l.jsx)(v,{...a,showIssue:!1});case"assignees":return(0,l.jsx)(j,{...a,showIssue:!1});case"priority":return(0,l.jsx)(y,{...a,showIssue:!1});case"estimate_point":return(0,l.jsx)(N,{...a,showIssue:!1});case"parent":return(0,l.jsx)(C,{...a,showIssue:!1});case["blocking","blocked_by","duplicate","relates_to"].find(e=>e===i):return(0,l.jsx)(_,{...a});case"start_date":return(0,l.jsx)(P,{...a,showIssue:!1});case"target_date":return(0,l.jsx)(R,{...a,showIssue:!1});case"cycles":return(0,l.jsx)(F,{...a});case"modules":return(0,l.jsx)(O,{...a});case"labels":return(0,l.jsx)(A,{...a,showIssue:!1});case"link":return(0,l.jsx)(D,{...a,showIssue:!1});case"attachment":return(0,l.jsx)(z,{...a,showIssue:!1});case"archived_at":return(0,l.jsx)(Z,{...a});case"inbox":return(0,l.jsx)(B,{...a});default:return(0,l.jsx)(l.Fragment,{})}});var G=s(88039),$=s(62468),X=s(80372),ee=s(85997),et=s(54129),es=s(1759),el=s(82558),en=s(16925),er=s(93997),ea=s(10712),ei=s(6780),eo=s(20673),ec=s(85409),ed=s(75311);let eu=(0,r.Pi)(e=>{let{workspaceSlug:t,projectId:s,commentId:r,currentUser:a,disabled:i=!1}=e,{commentReaction:{getCommentReactionsByCommentId:c,commentReactionsByUser:u,getCommentReactionById:m},createCommentReaction:h,removeCommentReaction:p}=(0,d.p1)(),{getUserDetails:x}=(0,d.Kb)(),f=c(r),v=u(r,a.id).map(e=>e.reaction),g=(0,n.useMemo)(()=>({create:async e=>{try{if(!t||!s||!r)throw Error("Missing fields");await h(t,s,r,e),(0,o.fz)({title:"Success!",type:o.do.SUCCESS,message:"Reaction created successfully"})}catch(e){(0,o.fz)({title:"Error!",type:o.do.ERROR,message:"Reaction creation failed"})}},remove:async e=>{try{if(!t||!s||!r||!(null==a?void 0:a.id))throw Error("Missing fields");p(t,s,r,e,a.id),(0,o.fz)({title:"Success!",type:o.do.SUCCESS,message:"Reaction removed successfully"})}catch(e){(0,o.fz)({title:"Error!",type:o.do.ERROR,message:"Reaction remove failed"})}},react:async e=>{v.includes(e)?await g.remove(e):await g.create(e)}}),[t,s,r,a,h,p,v]),j=e=>{let t=((null==f?void 0:f[e])||[]).map(e=>{var t;let s=m(e);return s?null===(t=x(s.actor))||void 0===t?void 0:t.display_name:null}).filter(e=>!!e);return(0,ec.jn)(t)};return(0,l.jsxs)("div",{className:"mt-4 relative flex items-center gap-1.5",children:[!i&&(0,l.jsx)(ed.j,{size:"md",position:"top",value:v,onSelect:g.react}),f&&Object.keys(f||{}).map(e=>{var t;return(null===(t=f[e])||void 0===t?void 0:t.length)>0&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(o.u,{tooltipContent:j(e),children:(0,l.jsxs)("button",{type:"button",onClick:()=>!i&&g.react(e),className:(0,ei.cn)("flex h-full items-center gap-1 rounded-md px-2 py-1 text-sm text-custom-text-100",v.includes(e)?"bg-custom-primary-100/10":"bg-custom-background-80",{"cursor-not-allowed":i}),children:[(0,l.jsx)("span",{children:(0,eo.O1)(e)}),(0,l.jsxs)("span",{className:v.includes(e)?"text-custom-primary-100":"",children:[(f||{})[e].length," "]})]},e)})})})]})}),em=e=>{let{commentId:t,ends:s,quickActions:n,children:r}=e,{comment:{getCommentById:i}}=(0,d.p1)(),o=i(t);return o?(0,l.jsxs)("div",{className:"relative flex gap-3 ".concat("top"===s?"pb-2":"bottom"===s?"pt-2":"py-2"),children:[(0,l.jsx)("div",{className:"absolute left-[13px] top-0 bottom-0 w-0.5 bg-custom-background-80","aria-hidden":!0}),(0,l.jsxs)("div",{className:"flex-shrink-0 relative w-7 h-7 rounded-full flex justify-center items-center z-10 bg-gray-500 text-white border border-white uppercase font-medium",children:[o.actor_detail.avatar&&""!==o.actor_detail.avatar?(0,l.jsx)("img",{src:o.actor_detail.avatar,alt:o.actor_detail.is_bot?o.actor_detail.first_name+" Bot":o.actor_detail.display_name,height:30,width:30,className:"grid h-7 w-7 place-items-center rounded-full border-2 border-custom-border-200"}):(0,l.jsx)(l.Fragment,{children:o.actor_detail.is_bot?o.actor_detail.first_name.charAt(0):o.actor_detail.display_name.charAt(0)}),(0,l.jsx)("div",{className:"absolute top-2 left-4 w-5 h-5 rounded-full overflow-hidden flex justify-center items-center bg-custom-background-80",children:(0,l.jsx)(a.Z,{className:"w-3 h-3",color:"#6b7280"})})]}),(0,l.jsxs)("div",{className:"w-full relative flex ",children:[(0,l.jsxs)("div",{className:"w-full space-y-1",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs capitalize",children:o.actor_detail.is_bot?o.actor_detail.first_name+" Bot":o.actor_detail.display_name}),(0,l.jsxs)("div",{className:"text-xs text-custom-text-200",children:["commented ",(0,E.KI)(o.created_at)]})]}),(0,l.jsx)("div",{children:r})]}),(0,l.jsx)("div",{className:"flex-shrink-0 ",children:n})]})]}):(0,l.jsx)(l.Fragment,{})},eh=e=>{var t,s,r,a,i,c,u;let{workspaceSlug:m,projectId:h,commentId:p,activityOperations:x,ends:f,showAccessSpecifier:v=!1,disabled:g=!1}=e,{comment:{getCommentById:j}}=(0,d.p1)(),{currentUser:b}=(0,d.aF)(),y=(0,n.useRef)(null),w=(0,n.useRef)(null),[N,k]=(0,n.useState)(!1),C=j(p),S=null===(t=(0,d.cF)().getWorkspaceBySlug(null==C?void 0:null===(s=C.workspace_detail)||void 0===s?void 0:s.slug))||void 0===t?void 0:t.id,{formState:{isSubmitting:_},handleSubmit:I,setFocus:E,watch:P,setValue:R}=(0,G.cI)({defaultValues:{comment_html:null==C?void 0:C.comment_html}}),F=e=>{var t,s,l,n;!_&&C&&(k(!1),x.updateComment(C.id,e),null===(t=y.current)||void 0===t||t.setEditorValue(null!==(l=null==e?void 0:e.comment_html)&&void 0!==l?l:"<p></p>"),null===(s=w.current)||void 0===s||s.setEditorValue(null!==(n=null==e?void 0:e.comment_html)&&void 0!==n?n:"<p></p>"))};(0,n.useEffect)(()=>{N&&E("comment_html")},[N,E]);let O=""===P("comment_html")||(null===(r=P("comment_html"))||void 0===r?void 0:r.trim())===""||"<p></p>"===P("comment_html")||(0,ea.dn)(null!==(i=P("comment_html"))&&void 0!==i?i:"");return C&&b?(0,l.jsx)(em,{commentId:p,quickActions:(0,l.jsx)(l.Fragment,{children:!g&&(null==b?void 0:b.id)===C.actor&&(0,l.jsxs)(o.fR,{ellipsis:!0,children:[(0,l.jsxs)(o.fR.MenuItem,{onClick:()=>k(!0),className:"flex items-center gap-1",children:[(0,l.jsx)($.Z,{className:"h-3 w-3"}),"Edit comment"]}),v&&(0,l.jsx)(l.Fragment,{children:"INTERNAL"===C.access?(0,l.jsxs)(o.fR.MenuItem,{onClick:()=>x.updateComment(C.id,{access:er.Es.EXTERNAL}),className:"flex items-center gap-1",children:[(0,l.jsx)(X.Z,{className:"h-3 w-3"}),"Switch to public comment"]}):(0,l.jsxs)(o.fR.MenuItem,{onClick:()=>x.updateComment(C.id,{access:er.Es.INTERNAL}),className:"flex items-center gap-1",children:[(0,l.jsx)(ee.Z,{className:"h-3 w-3"}),"Switch to private comment"]})}),(0,l.jsxs)(o.fR.MenuItem,{onClick:()=>x.removeComment(C.id),className:"flex items-center gap-1",children:[(0,l.jsx)(et.Z,{className:"h-3 w-3"}),"Delete comment"]})]})}),ends:f,children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("form",{className:"flex-col gap-2 ".concat(N?"flex":"hidden"),children:[(0,l.jsx)("div",{onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||O||I(F)(e)},children:(0,l.jsx)(en.d6,{workspaceId:S,projectId:h,workspaceSlug:m,ref:y,initialValue:null!==(c=P("comment_html"))&&void 0!==c?c:"",value:null,onChange:(e,t)=>R("comment_html",t),showSubmitButton:!1})}),(0,l.jsxs)("div",{className:"flex gap-1 self-end",children:[(0,l.jsx)("button",{type:"button",onClick:I(F),disabled:_||O,className:"group rounded border border-green-500 bg-green-500/20 p-2 shadow-md duration-300  ".concat(O?"cursor-not-allowed bg-gray-200":"hover:bg-green-500"),children:(0,l.jsx)(es.Z,{className:"h-3 w-3 text-green-500 duration-300 ".concat(O?"text-black":"group-hover:text-white")})}),(0,l.jsx)("button",{type:"button",className:"group rounded border border-red-500 bg-red-500/20 p-2 shadow-md duration-300 hover:bg-red-500",onClick:()=>k(!1),children:(0,l.jsx)(el.Z,{className:"h-3 w-3 text-red-500 duration-300 group-hover:text-white"})})]})]}),(0,l.jsxs)("div",{className:"relative ".concat(N?"hidden":""),children:[v&&(0,l.jsx)("div",{className:"absolute right-2.5 top-2.5 z-[1] text-custom-text-300",children:C.access===er.Es.INTERNAL?(0,l.jsx)(ee.Z,{className:"h-3 w-3"}):(0,l.jsx)(X.Z,{className:"h-3 w-3"})}),(0,l.jsx)(en.WH,{ref:w,initialValue:null!==(u=C.comment_html)&&void 0!==u?u:""}),(0,l.jsx)(eu,{workspaceSlug:m,projectId:null==C?void 0:null===(a=C.project_detail)||void 0===a?void 0:a.id,commentId:C.id,currentUser:b,disabled:g})]})]})}):(0,l.jsx)(l.Fragment,{})},ep=(0,r.Pi)(e=>{let{workspaceSlug:t,issueId:s,activityOperations:n,showAccessSpecifier:r,projectId:a,disabled:i}=e,{activity:{getActivityCommentByIssueId:o}}=(0,d.p1)(),c=o(s);return!c||c&&c.length<=0?(0,l.jsx)(l.Fragment,{}):(0,l.jsx)("div",{children:c.map((e,s)=>"COMMENT"===e.activity_type?(0,l.jsx)(eh,{projectId:a,workspaceSlug:t,commentId:e.id,activityOperations:n,ends:0===s?"top":s===c.length-1?"bottom":void 0,showAccessSpecifier:r,disabled:i},e.id):"ACTIVITY"===e.activity_type?(0,l.jsx)(Q,{activityId:e.id,ends:0===s?"top":s===c.length-1?"bottom":void 0}):(0,l.jsx)(l.Fragment,{}))})});var ex=s(9533);let ef=e=>{var t;let{workspaceSlug:s,projectId:r,issueId:a,activityOperations:i,showAccessSpecifier:o=!1}=e,c=(0,n.useRef)(null),u=null===(t=(0,d.cF)().getWorkspaceBySlug(s))||void 0===t?void 0:t.id,{handleSubmit:m,control:h,watch:p,formState:{isSubmitting:x},reset:f}=(0,G.cI)({defaultValues:{comment_html:"<p></p>"}}),v=async e=>await i.createComment(e).finally(()=>{var e;f({comment_html:"<p></p>"}),null===(e=c.current)||void 0===e||e.clearEditor()}),g=p("comment_html"),j=(null==g?void 0:g.trim())===""||"<p></p>"===g||(0,ea.dn)(null!=g?g:"")&&!(null==g?void 0:g.includes("mention-component"));return(0,l.jsx)("div",{onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||j||x||m(v)(e)},children:(0,l.jsx)(G.Qr,{name:"access",control:h,render:e=>{let{field:{onChange:t,value:n}}=e;return(0,l.jsx)(G.Qr,{name:"comment_html",control:h,render:e=>{let{field:{value:i,onChange:d}}=e;return(0,l.jsx)(ex.d,{workspaceId:u,id:"add_comment_"+a,value:"<p></p>",projectId:r,workspaceSlug:s,onEnterKeyPress:e=>{j||x||m(v)(e)},ref:c,initialValue:null!=i?i:"<p></p>",containerClassName:"min-h-[35px]",onChange:(e,t)=>d(t),accessSpecifier:null!=n?n:er.Es.INTERNAL,handleAccessChange:t,showAccessSpecifier:o,isSubmitting:x})}})}})})};var ev=s(74371),eg=s(70540);let ej=(0,r.Pi)(e=>{let{workspaceSlug:t,projectId:s,issueId:n,activityOperations:r,showAccessSpecifier:a,disabled:i}=e,{comment:{getCommentsByIssueId:o}}=(0,d.p1)(),c=o(n);return c?(0,l.jsx)("div",{children:c.length>0?c.map((e,n)=>(0,l.jsx)(eh,{projectId:s,workspaceSlug:t,commentId:e,ends:0===n?"top":n===c.length-1?"bottom":void 0,activityOperations:r,showAccessSpecifier:a,disabled:i},e)):(0,l.jsx)("div",{className:"flex items-center justify-center py-9",children:(0,l.jsx)(ev.ub,{type:eg.C.ISSUE_COMMENT_EMPTY_STATE,layout:"screen-simple"})})}):(0,l.jsx)(l.Fragment,{})})},78518:function(e,t,s){s.d(t,{J:function(){return m}});var l=s(75311),n=s(24246),r=s(27378),a=s(43659),i=s(25449),o=s(6780),c=s(20673),d=s(85409),u=s(10634);let m=(0,a.Pi)(e=>{let{workspaceSlug:t,projectId:s,issueId:a,currentUser:m,disabled:h=!1}=e,{reaction:{getReactionsByIssueId:p,reactionsByUser:x,getReactionById:f},createReaction:v,removeReaction:g}=(0,u.p1)(),{getUserDetails:j}=(0,u.Kb)(),b=p(a),y=x(a,m.id).map(e=>e.reaction),w=(0,r.useMemo)(()=>({create:async e=>{try{if(!t||!s||!a)throw Error("Missing fields");await v(t,s,a,e),(0,i.fz)({title:"Success!",type:i.do.SUCCESS,message:"Reaction created successfully"})}catch(e){(0,i.fz)({title:"Error!",type:i.do.ERROR,message:"Reaction creation failed"})}},remove:async e=>{try{if(!t||!s||!a||!(null==m?void 0:m.id))throw Error("Missing fields");await g(t,s,a,e,m.id),(0,i.fz)({title:"Success!",type:i.do.SUCCESS,message:"Reaction removed successfully"})}catch(e){(0,i.fz)({title:"Error!",type:i.do.ERROR,message:"Reaction remove failed"})}},react:async e=>{y.includes(e)?await w.remove(e):await w.create(e)}}),[t,s,a,m,v,g,y]),N=e=>{let t=((null==b?void 0:b[e])||[]).map(e=>{var t;let s=f(e);return s?null===(t=j(s.actor))||void 0===t?void 0:t.display_name:null}).filter(e=>!!e);return(0,d.jn)(t)};return(0,n.jsxs)("div",{className:"mt-4 relative flex items-center gap-1.5",children:[!h&&(0,n.jsx)(l.j,{size:"md",position:"top",value:y,onSelect:w.react}),b&&Object.keys(b||{}).map(e=>{var t;return(null===(t=b[e])||void 0===t?void 0:t.length)>0&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(i.u,{tooltipContent:N(e),children:(0,n.jsxs)("button",{type:"button",onClick:()=>!h&&w.react(e),className:(0,o.cn)("flex h-full items-center gap-1 rounded-md px-2 py-1 text-sm text-custom-text-100",y.includes(e)?"bg-custom-primary-100/10":"bg-custom-background-80",{"cursor-not-allowed":h}),children:[(0,n.jsx)("span",{children:(0,c.O1)(e)}),(0,n.jsxs)("span",{className:y.includes(e)?"text-custom-primary-100":"",children:[(b||{})[e].length," "]})]},e)})})})]})})},75311:function(e,t,s){s.d(t,{j:function(){return d}});var l=s(24246),n=s(27378),r=s(5163),a=s(30640),i=s(30335),o=s(20673);let c=["128077","128078","128516","128165","128533","129505","9992","128064"],d=e=>{let{onSelect:t,position:s,size:d}=e;return(0,l.jsx)(a.J,{className:"relative",children:e=>{let{open:u,close:m}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.J.Button,{className:"".concat(u?"":"text-opacity-90"," group inline-flex items-center rounded-md bg-custom-background-80 focus:outline-none"),children:(0,l.jsx)("span",{className:"flex items-center justify-center rounded-md px-2 ".concat("sm"===d?"h-6 w-6":"md"===d?"h-7 w-7":"h-8 w-8"),children:(0,l.jsx)(r.Z,{className:"h-3.5 w-3.5 text-custom-text-100"})})}),(0,l.jsx)(i.u,{as:n.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,l.jsx)(a.J.Panel,{className:"absolute -left-2 z-10 bg-custom-sidebar-background-100 ".concat("top"===s?"-top-12":"-bottom-12"),children:(0,l.jsx)("div",{className:"rounded-md border border-custom-border-200 bg-custom-sidebar-background-100 p-1 shadow-custom-shadow-sm",children:(0,l.jsx)("div",{className:"flex gap-x-1",children:c.map(e=>(0,l.jsx)("button",{type:"button",onClick:()=>{t(e),m()},className:"flex select-none items-center justify-between rounded-md p-1 text-sm hover:bg-custom-sidebar-background-90",children:(0,o.O1)(e)},e))})})})})]})}})}},81436:function(e,t,s){s.d(t,{Q:function(){return v},r:function(){return g}});var l=s(24246);s(27378);var n=s(43659),r=s(79894),a=s.n(r),i=s(25262),o=s(50811),c=s(14820),d=s(82558),u=s(62468),m=s(25449),h=s(23258),p=s(6780),x=s(10634),f=s(18894);let v={relates_to:{className:"bg-custom-background-80 text-custom-text-200",icon:e=>(0,l.jsx)(m.vx,{height:e,width:e}),placeholder:"Add related issues"},blocking:{className:"bg-yellow-500/20 text-yellow-700",icon:e=>(0,l.jsx)(i.Z,{size:e}),placeholder:"None"},blocked_by:{className:"bg-red-500/20 text-red-700",icon:e=>(0,l.jsx)(o.Z,{size:e}),placeholder:"None"},duplicate:{className:"bg-custom-background-80 text-custom-text-200",icon:e=>(0,l.jsx)(c.Z,{size:e}),placeholder:"None"}},g=(0,n.Pi)(e=>{let{className:t="",workspaceSlug:s,projectId:n,issueId:r,relationKey:i,disabled:o=!1}=e,{getProjectById:c}=(0,x.PY)(),{createRelation:g,removeRelation:j,relation:{getRelationByIssueIdRelationType:b},isRelationModalOpen:y,toggleRelationModal:w}=(0,x.p1)(),{issueMap:N}=(0,x.gk)(),{isMobile:k}=(0,f.L)(),C=b(r,i),S=async e=>{if(0===e.length){(0,m.fz)({type:m.do.ERROR,title:"Error!",message:"Please select at least one issue."});return}await g(s,n,r,i,e.map(e=>e.id)),w(null,null)};if(!C)return null;let _=(null==y?void 0:y.relationType)===i&&(null==y?void 0:y.issueId)===r;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.H2,{workspaceSlug:s,projectId:n,isOpen:_,handleClose:()=>w(null,null),searchParams:{issue_relation:!0,issue_id:r},handleOnSubmit:S,workspaceLevelToggle:!0}),(0,l.jsx)("button",{type:"button",className:(0,p.cn)("group flex items-center gap-2 rounded px-2 py-0.5 outline-none",{"cursor-not-allowed":o,"hover:bg-custom-background-80":!o,"bg-custom-background-80":_},t),onClick:()=>w(r,i),disabled:o,children:(0,l.jsxs)("div",{className:"flex w-full items-start justify-between",children:[C.length>0?(0,l.jsx)("div",{className:"flex flex-wrap items-center gap-2 py-0.5",children:C.map(e=>{let t=N[e];if(!t)return;let u=c(t.project_id);return(0,l.jsxs)("div",{className:"group flex items-center gap-1 rounded px-1.5 pb-1 pt-1 leading-3 hover:bg-custom-background-90 ".concat(v[i].className),children:[(0,l.jsx)(m.u,{tooltipHeading:"Title",tooltipContent:t.name,isMobile:k,children:(0,l.jsx)(a(),{href:"/".concat(s,"/projects/").concat(null==u?void 0:u.id,"/issues/").concat(t.id),target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium",onClick:e=>e.stopPropagation(),children:"".concat(null==u?void 0:u.identifier,"-").concat(null==t?void 0:t.sequence_id)})}),!o&&(0,l.jsx)(m.u,{tooltipContent:"Remove",position:"bottom",isMobile:k,children:(0,l.jsx)("span",{onClick:t=>{t.preventDefault(),t.stopPropagation(),j(s,n,r,i,e)},children:(0,l.jsx)(d.Z,{className:"h-2.5 w-2.5 text-custom-text-300 hover:text-red-500"})})})]},e)})}):(0,l.jsx)("span",{className:"text-sm text-custom-text-400",children:v[i].placeholder}),!o&&(0,l.jsx)("span",{className:(0,p.cn)("flex-shrink-0 p-1 opacity-0 group-hover:opacity-100",{"text-custom-text-400":0===C.length}),children:(0,l.jsx)(u.Z,{className:"h-2.5 w-2.5 flex-shrink-0"})})]})})]})})},46479:function(e,t,s){s.d(t,{ZR:function(){return p},yv:function(){return j},eS:function(){return _},q6:function(){return S},Si:function(){return C},WN:function(){return y}});var l=s(24246),n=s(27378),r=s(90104),a=s.n(r),i=s(43659),o=s(25449),c=s(23258),d=s(74371),u=s(70540),m=s(93997),h=s(10634);let p=(0,i.Pi)(e=>{var t,s;let{workspaceSlug:r,projectId:i,cycleId:p,activeLayout:x,handleClearAllFilters:f,isEmptyFilters:v=!1}=e,[g,j]=(0,n.useState)(!1),{getCycleById:b}=(0,h.nv)(),{issues:y}=(0,h.gk)(m.rS.CYCLE),{commandPalette:{toggleCreateIssueModal:w}}=(0,h.IX)(),{setTrackElement:N}=(0,h.DN)(),k=p?b(p.toString()):void 0,C=async e=>{if(!r||!i||!p)return;let t=e.map(e=>e.id);await y.addIssueToCycle(r.toString(),i,p.toString(),t).then(()=>(0,o.fz)({type:o.do.SUCCESS,title:"Success!",message:"Issues added to the cycle successfully."})).catch(()=>(0,o.fz)({type:o.do.ERROR,title:"Error!",message:"Selected issues could not be added to the cycle. Please try again."}))},S=!a()(null!==(s=null==k?void 0:k.progress_snapshot)&&void 0!==s?s:{})||(null==k?void 0:null===(t=k.status)||void 0===t?void 0:t.toLowerCase())==="completed",_=S?u.C.PROJECT_CYCLE_COMPLETED_NO_ISSUES:v?u.C.PROJECT_EMPTY_FILTER:u.C.PROJECT_CYCLE_NO_ISSUES;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.H2,{workspaceSlug:r,projectId:i,isOpen:g,handleClose:()=>j(!1),searchParams:{cycle:!0},handleOnSubmit:C}),(0,l.jsx)("div",{className:"grid h-full w-full place-items-center",children:(0,l.jsx)(d.ub,{type:_,additionalPath:S?void 0:null!=x?x:"list",size:v?"lg":"sm",primaryButtonOnClick:S||v?void 0:()=>{N("Cycle issue empty state"),w(!0,m.rS.CYCLE)},secondaryButtonOnClick:!S&&v?f:()=>j(!0)})})]})});var x=s(47542),f=s(78593),v=s(46987),g=s(41719);(0,i.Pi)(()=>{let{commandPalette:{toggleCreateIssueModal:e,toggleCreateProjectModal:t}}=(0,h.IX)(),{setTrackElement:s}=(0,h.DN)(),{workspaceProjectIds:n}=(0,h.PY)();return(0,l.jsx)("div",{className:"grid h-full w-full place-items-center",children:n&&(null==n?void 0:n.length)!==0?(0,l.jsx)(f.ub,{title:"View issues will appear here",description:"Issues help you track individual pieces of work. With Issues, keep track of what's going on, who is working on it, and what's done.",image:v.Z,primaryButton:{text:"New issue",icon:(0,l.jsx)(x.Z,{className:"h-3 w-3",strokeWidth:2}),onClick:()=>{s("All issues empty state"),e(!0)}}}):(0,l.jsx)(f.ub,{image:g.Z,title:"No projects yet",description:"Get started by creating your first project",primaryButton:{icon:(0,l.jsx)(x.Z,{className:"h-4 w-4"}),text:"New Project",onClick:()=>{s("All issues empty state"),t(!0)}}})})});let j=(0,i.Pi)(e=>{let{workspaceSlug:t,projectId:s,moduleId:r,activeLayout:a,handleClearAllFilters:i,isEmptyFilters:p=!1}=e,[x,f]=(0,n.useState)(!1),{issues:v}=(0,h.gk)(m.rS.MODULE),{commandPalette:{toggleCreateIssueModal:g}}=(0,h.IX)(),{setTrackElement:j}=(0,h.DN)(),b=async e=>{if(!t||!s||!r)return;let l=e.map(e=>e.id);await v.addIssuesToModule(t.toString(),null==s?void 0:s.toString(),r.toString(),l).then(()=>(0,o.fz)({type:o.do.SUCCESS,title:"Success!",message:"Issues added to the module successfully."})).catch(()=>(0,o.fz)({type:o.do.ERROR,title:"Error!",message:"Selected issues could not be added to the module. Please try again."}))},y=p?u.C.PROJECT_EMPTY_FILTER:u.C.PROJECT_MODULE_ISSUES;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.H2,{workspaceSlug:t,projectId:s,isOpen:x,handleClose:()=>f(!1),searchParams:{module:void 0!=r?r.toString():""},handleOnSubmit:b}),(0,l.jsx)("div",{className:"grid h-full w-full place-items-center",children:(0,l.jsx)(d.ub,{type:y,additionalPath:null!=a?a:"list",primaryButtonOnClick:p?void 0:()=>{j("Module issue empty state"),g(!0,m.rS.MODULE)},secondaryButtonOnClick:p?i:()=>f(!0)})})]})});var b=s(51374);let y=(0,i.Pi)(()=>{let{commandPalette:e}=(0,h.IX)(),{setTrackElement:t}=(0,h.DN)(),{membership:{currentProjectRole:s}}=(0,h.aF)(),n=!!s&&s>=b.MC.MEMBER;return(0,l.jsx)("div",{className:"grid h-full w-full place-items-center",children:(0,l.jsx)(f.ub,{title:"View issues will appear here",description:"Issues help you track individual pieces of work. With Issues, keep track of what's going on, who is working on it, and what's done.",image:v.Z,primaryButton:n?{text:"New issue",icon:(0,l.jsx)(x.Z,{className:"h-3 w-3",strokeWidth:2}),onClick:()=>{t("View issue empty state"),e.toggleCreateIssueModal(!0,m.rS.PROJECT_VIEW)}}:void 0})})});var w=s(36417),N=s.n(w),k=s(86677);let C=(0,i.Pi)(()=>{var e,t,s;let{workspaceSlug:n,projectId:r}=(0,k.useRouter)().query,{commandPalette:a}=(0,h.IX)(),{setTrackElement:i}=(0,h.DN)(),{issuesFilter:o}=(0,h.gk)(m.rS.PROJECT),c=null==o?void 0:null===(e=o.issueFilters)||void 0===e?void 0:e.filters,p=null==o?void 0:null===(s=o.issueFilters)||void 0===s?void 0:null===(t=s.displayFilters)||void 0===t?void 0:t.layout,x=N()(Object.fromEntries(Object.entries(null!=c?c:{}).filter(e=>{let[,t]=e;return t&&Array.isArray(t)&&t.length>0}))),f=x>0?u.C.PROJECT_EMPTY_FILTER:u.C.PROJECT_NO_ISSUES;return(0,l.jsx)("div",{className:"relative h-full w-full overflow-y-auto",children:(0,l.jsx)(d.ub,{type:f,additionalPath:x>0?null!=p?p:"list":void 0,size:x>0?"lg":"sm",primaryButtonOnClick:x>0?void 0:()=>{i("Project issue empty state"),a.toggleCreateIssueModal(!0,m.rS.PROJECT)},secondaryButtonOnClick:x>0?()=>{if(!n||!r)return;let e={};Object.keys(null!=c?c:{}).forEach(t=>{e[t]=[]}),o.updateFilters(n.toString(),r.toString(),m.gc.FILTERS,{...e})}:void 0})})}),S=(0,i.Pi)(()=>{var e,t,s;let{workspaceSlug:n,projectId:r}=(0,k.useRouter)().query,{issuesFilter:a}=(0,h.gk)(m.rS.DRAFT),i=null==a?void 0:null===(e=a.issueFilters)||void 0===e?void 0:e.filters,o=null==a?void 0:null===(s=a.issueFilters)||void 0===s?void 0:null===(t=s.displayFilters)||void 0===t?void 0:t.layout,c=N()(Object.fromEntries(Object.entries(null!=i?i:{}).filter(e=>{let[,t]=e;return t&&Array.isArray(t)&&t.length>0}))),p=c>0?u.C.PROJECT_DRAFT_EMPTY_FILTER:u.C.PROJECT_DRAFT_NO_ISSUES;return(0,l.jsx)("div",{className:"relative h-full w-full overflow-y-auto",children:(0,l.jsx)(d.ub,{type:p,additionalPath:c>0?null!=o?o:"list":void 0,size:c>0?"lg":"sm",secondaryButtonOnClick:c>0?()=>{if(!n||!r)return;let e={};Object.keys(null!=i?i:{}).forEach(t=>{e[t]=[]}),a.updateFilters(n.toString(),r.toString(),m.gc.FILTERS,{...e})}:void 0})})}),_=(0,i.Pi)(()=>{var e,t,s;let{workspaceSlug:n,projectId:r}=(0,k.useRouter)().query,{issuesFilter:a}=(0,h.gk)(m.rS.ARCHIVED),i=null==a?void 0:null===(e=a.issueFilters)||void 0===e?void 0:e.filters,o=null==a?void 0:null===(s=a.issueFilters)||void 0===s?void 0:null===(t=s.displayFilters)||void 0===t?void 0:t.layout,c=N()(Object.fromEntries(Object.entries(null!=i?i:{}).filter(e=>{let[,t]=e;return t&&Array.isArray(t)&&t.length>0}))),p=c>0?u.C.PROJECT_ARCHIVED_EMPTY_FILTER:u.C.PROJECT_ARCHIVED_NO_ISSUES;return(0,l.jsx)("div",{className:"relative h-full w-full overflow-y-auto",children:(0,l.jsx)(d.ub,{type:p,additionalPath:c>0?null!=o?o:"list":void 0,primaryButtonLink:c>0?void 0:"/".concat(n,"/projects/").concat(r,"/settings/automations"),secondaryButtonOnClick:c>0?()=>{if(!n||!r)return;let e={};Object.keys(null!=i?i:{}).forEach(t=>{e[t]=[]}),a.updateFilters(n.toString(),r.toString(),m.gc.FILTERS,{...e})}:void 0})})})},96861:function(e,t,s){s.d(t,{Iy:function(){return eU},Ln:function(){return eS},zg:function(){return ev},v4:function(){return eb},eP:function(){return ey},lx:function(){return ew},oV:function(){return eC},Ok:function(){return eN},Rl:function(){return ek},sR:function(){return e_},do:function(){return eI},TM:function(){return eu},Tu:function(){return eL},Ix:function(){return eH},YB:function(){return eP.YB},JK:function(){return tf},cc:function(){return tv},vl:function(){return tg},m0:function(){return tw},Hb:function(){return tb},oq:function(){return tj},Td:function(){return tp},VC:function(){return tn},wE:function(){return ti},qk:function(){return t_},Sl:function(){return tN},Ao:function(){return tk},bq:function(){return $},C0:function(){return tu},ZR:function(){return eE.ZR},B7:function(){return tF},JW:function(){return eP.JW},Ts:function(){return tL.Ts},TR:function(){return eM},dW:function(){return eW},jN:function(){return sb},hv:function(){return i},e3:function(){return eP.e3},Np:function(){return w},aI:function(){return k},Fd:function(){return Z},KG:function(){return m},D8:function(){return h},n1:function(){return p},YH:function(){return u},eB:function(){return x},Ep:function(){return P},$F:function(){return N},iL:function(){return q},f2:function(){return J},XZ:function(){return f},ZC:function(){return R},xB:function(){return O},dG:function(){return _},M2:function(){return D},jV:function(){return L},ln:function(){return z},uK:function(){return v},y_:function(){return B},lq:function(){return K},Wl:function(){return tM},Ko:function(){return tA},yz:function(){return er},aT:function(){return e5},b5:function(){return tI},JP:function(){return tE},vE:function(){return tL.vE},RX:function(){return tL.RX},Zx:function(){return Q},PS:function(){return eY},vn:function(){return tt},c9:function(){return ea},Wr:function(){return tm},yv:function(){return eE.yv},E_:function(){return tD},PF:function(){return eP.PF},SU:function(){return tL.SU},xn:function(){return eA},Xb:function(){return eK},IF:function(){return sy},s4:function(){return ep},AT:function(){return ed},eS:function(){return eE.eS},Si:function(){return eE.Si},n:function(){return eP.n},$E:function(){return eF},fT:function(){return sw},YQ:function(){return ei},ZU:function(){return th},WN:function(){return eE.WN},NH:function(){return tz},qf:function(){return tL.qf},m$:function(){return ez},cT:function(){return eJ},Ch:function(){return sN},L7:function(){return sI},R1:function(){return sS},HB:function(){return sg}});var l=s(24246),n=s(27378),r=s(43659),a=s(68114);let i=(0,r.Pi)(e=>{var t,s,n,r,i;let{displayFilters:o,displayProperties:c,handleDisplayFiltersUpdate:d,handleDisplayPropertiesUpdate:u,layoutDisplayFiltersOptions:m,ignoreGroupedFilters:h=[],cycleViewDisabled:p=!1,moduleViewDisabled:x=!1}=e,f=e=>{var t;return Object.keys(null!==(t=null==m?void 0:m.display_filters)&&void 0!==t?t:{}).includes(e)},v=[];return p&&h.push("cycle"),x&&h.push("module"),(0,l.jsxs)("div",{className:"vertical-scrollbar scrollbar-sm relative h-full w-full divide-y divide-custom-border-200 overflow-hidden overflow-y-auto px-2.5",children:[(null==m?void 0:m.display_properties)&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.KGn,{displayProperties:c,handleUpdate:u,cycleViewDisabled:p,moduleViewDisabled:x})}),f("group_by")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.n1O,{displayFilters:o,groupByOptions:null!==(t=null==m?void 0:m.display_filters.group_by)&&void 0!==t?t:[],handleUpdate:e=>d({group_by:e}),ignoreGroupedFilters:[...h,...v]})}),f("sub_group_by")&&(null==o?void 0:o.group_by)!==null&&(null==o?void 0:o.layout)==="kanban"&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.uKd,{displayFilters:o,handleUpdate:e=>d({sub_group_by:e}),subGroupByOptions:null!==(s=null==m?void 0:m.display_filters.sub_group_by)&&void 0!==s?s:[],ignoreGroupedFilters:[...h,...v]})}),f("order_by")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.XZH,{selectedOrderBy:null==o?void 0:o.order_by,handleUpdate:e=>d({order_by:e}),orderByOptions:null!==(n=null==m?void 0:m.display_filters.order_by)&&void 0!==n?n:[]})}),f("type")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.eBn,{selectedIssueType:null==o?void 0:o.type,handleUpdate:e=>d({type:e})})}),(null==m?void 0:m.extra_options.access)&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.D8r,{selectedExtraOptions:{show_empty_groups:null===(r=null==o?void 0:o.show_empty_groups)||void 0===r||r,sub_issue:null===(i=null==o?void 0:o.sub_issue)||void 0===i||i},handleUpdate:(e,t)=>d({[e]:t}),enabledExtraOptions:null==m?void 0:m.extra_options.values})})]})});var o=s(93997),c=s(18927),d=s(65709);let u=e=>{let{title:t,isPreviewEnabled:s,handleIsPreviewEnabled:n}=e;return(0,l.jsxs)("div",{className:"sticky top-0 flex items-center justify-between gap-2 bg-custom-background-100",children:[(0,l.jsx)("div",{className:"flex-grow truncate text-xs font-medium text-custom-text-400",children:t}),(0,l.jsx)("button",{type:"button",className:"grid h-5 w-5 flex-shrink-0 place-items-center rounded hover:bg-custom-background-80",onClick:n,children:s?(0,l.jsx)(c.Z,{size:14}):(0,l.jsx)(d.Z,{size:14})})]})},m=(0,r.Pi)(e=>{let{displayProperties:t,handleUpdate:s,cycleViewDisabled:r=!1,moduleViewDisabled:a=!1}=e,[i,c]=n.useState(!0),d=o.Hj.filter(e=>(!r||"cycle"!==e.key)&&(!a||"modules"!==e.key));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(u,{title:"Display Properties",isPreviewEnabled:i,handleIsPreviewEnabled:()=>c(!i)}),i&&(0,l.jsx)("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:d.map(e=>(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("button",{type:"button",className:"rounded border px-2 py-0.5 text-xs transition-all ".concat((null==t?void 0:t[e.key])?"border-custom-primary-100 bg-custom-primary-100 text-white":"border-custom-border-200 hover:bg-custom-background-80"),onClick:()=>s({[e.key]:!(null==t?void 0:t[e.key])}),children:e.title},e.key)}))})]})}),h=(0,r.Pi)(e=>{let{selectedExtraOptions:t,handleUpdate:s,enabledExtraOptions:n}=e,r=e=>n.includes(e);return(0,l.jsx)("div",{children:o.ir.map(e=>r(e.key)?(0,l.jsx)(a.f2,{isChecked:null!=t&&!!t[e.key],onClick:()=>s(e.key,!(null==t?void 0:t[e.key])),title:e.title},e.key):null)})}),p=(0,r.Pi)(e=>{var t,s;let{displayFilters:r,groupByOptions:i,handleUpdate:c,ignoreGroupedFilters:d}=e,[u,m]=(0,n.useState)(!0),h=null!==(t=null==r?void 0:r.group_by)&&void 0!==t?t:null,p=null!==(s=null==r?void 0:r.sub_group_by)&&void 0!==s?s:null;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Group by",isPreviewEnabled:u,handleIsPreviewEnabled:()=>m(!u)}),u&&(0,l.jsx)("div",{children:o.e5.filter(e=>i.includes(e.key)).map(e=>(null==r?void 0:r.layout)==="kanban"&&null!==p&&e.key===p||d.includes(null==e?void 0:e.key)?null:(0,l.jsx)(a.f2,{isChecked:h===(null==e?void 0:e.key),onClick:()=>c(e.key),title:e.title,multiple:!1},null==e?void 0:e.key))})]})}),x=(0,r.Pi)(e=>{let{selectedIssueType:t,handleUpdate:s}=e,[r,i]=n.useState(!0),c=null!=t?t:null;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Issue Type",isPreviewEnabled:r,handleIsPreviewEnabled:()=>i(!r)}),r&&(0,l.jsx)("div",{children:o.iE.map(e=>(0,l.jsx)(a.f2,{isChecked:c===(null==e?void 0:e.key),onClick:()=>s(null==e?void 0:e.key),title:e.title,multiple:!1},null==e?void 0:e.key))})]})}),f=(0,r.Pi)(e=>{let{selectedOrderBy:t,handleUpdate:s,orderByOptions:r}=e,[i,c]=(0,n.useState)(!0),d=null!=t?t:"-created_at";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Order by",isPreviewEnabled:i,handleIsPreviewEnabled:()=>c(!i)}),i&&(0,l.jsx)("div",{children:o.Wf.filter(e=>r.includes(e.key)).map(e=>(0,l.jsx)(a.f2,{isChecked:d===(null==e?void 0:e.key),onClick:()=>s(e.key),title:e.title,multiple:!1},null==e?void 0:e.key))})]})}),v=(0,r.Pi)(e=>{var t,s;let{displayFilters:r,handleUpdate:i,subGroupByOptions:c,ignoreGroupedFilters:d}=e,[u,m]=(0,n.useState)(!0),h=null!==(t=r.group_by)&&void 0!==t?t:null,p=null!==(s=r.sub_group_by)&&void 0!==s?s:null;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Sub-group by",isPreviewEnabled:u,handleIsPreviewEnabled:()=>m(!u)}),u&&(0,l.jsx)("div",{children:o.e5.filter(e=>c.includes(e.key)).map(e=>null!==h&&e.key===h||d.includes(null==e?void 0:e.key)?null:(0,l.jsx)(a.f2,{isChecked:p===(null==e?void 0:e.key),onClick:()=>i(e.key),title:e.title,multiple:!1},null==e?void 0:e.key))})]})});var g=s(95099),j=s.n(g),b=s(25449),y=s(10634);let w=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,memberIds:i,searchQuery:o}=e,[c,d]=(0,n.useState)(5),[u,m]=(0,n.useState)(!0),{getUserDetails:h}=(0,y.Kb)(),{currentUser:p}=(0,y.aF)(),x=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,f=(0,n.useMemo)(()=>{let e=(i||[]).filter(e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase().includes(o.toLowerCase())});return j()(e,[e=>!(null!=s?s:[]).includes(e),e=>e!==(null==p?void 0:p.id),e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase()}])},[o]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Assignee".concat(x>0?" (".concat(x,")"):""),isPreviewEnabled:u,handleIsPreviewEnabled:()=>m(!u)}),u&&(0,l.jsx)("div",{children:f?f.length>0?(0,l.jsxs)(l.Fragment,{children:[f.slice(0,c).map(e=>{let t=h(e);return t?(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(t.id),onClick:()=>r(t.id),icon:(0,l.jsx)(b.qE,{name:t.display_name,src:t.avatar,showTooltip:!1,size:"md"}),title:(null==p?void 0:p.id)===t.id?"You":null==t?void 0:t.display_name},"assignees-".concat(t.id)):null}),f.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{f&&(c===f.length?d(5):d(f.length))},children:c===f.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(b.aN,{className:"space-y-2",children:[(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"})]})})]})}),N=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,memberIds:i,searchQuery:o}=e,[c,d]=(0,n.useState)(5),[u,m]=(0,n.useState)(!0),{getUserDetails:h}=(0,y.Kb)(),{currentUser:p}=(0,y.aF)(),x=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,f=(0,n.useMemo)(()=>{let e=(i||[]).filter(e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase().includes(o.toLowerCase())});return j()(e,[e=>!(null!=s?s:[]).includes(e),e=>e!==(null==p?void 0:p.id),e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase()}])},[o]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Mention".concat(x>0?" (".concat(x,")"):""),isPreviewEnabled:u,handleIsPreviewEnabled:()=>m(!u)}),u&&(0,l.jsx)("div",{children:f?f.length>0?(0,l.jsxs)(l.Fragment,{children:[f.slice(0,c).map(e=>{let t=h(e);return t?(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(t.id),onClick:()=>r(t.id),icon:(0,l.jsx)(b.qE,{name:null==t?void 0:t.display_name,src:null==t?void 0:t.avatar,showTooltip:!1,size:"md"}),title:(null==p?void 0:p.id)===t.id?"You":null==t?void 0:t.display_name},"mentions-".concat(t.id)):null}),f.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{f&&(c===f.length?d(5):d(f.length))},children:c===f.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(b.aN,{className:"space-y-2",children:[(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"})]})})]})}),k=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,memberIds:i,searchQuery:o}=e,[c,d]=(0,n.useState)(5),[u,m]=(0,n.useState)(!0),{getUserDetails:h}=(0,y.Kb)(),{currentUser:p}=(0,y.aF)(),x=(0,n.useMemo)(()=>{let e=(i||[]).filter(e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase().includes(o.toLowerCase())});return j()(e,[e=>!(null!=s?s:[]).includes(e),e=>e!==(null==p?void 0:p.id),e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase()}])},[o]),f=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Created by".concat(f>0?" (".concat(f,")"):""),isPreviewEnabled:u,handleIsPreviewEnabled:()=>m(!u)}),u&&(0,l.jsx)("div",{children:x?x.length>0?(0,l.jsxs)(l.Fragment,{children:[x.slice(0,c).map(e=>{let t=h(e);return t?(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(t.id),onClick:()=>r(t.id),icon:(0,l.jsx)(b.qE,{name:t.display_name,src:t.avatar,size:"md"}),title:(null==p?void 0:p.id)===t.id?"You":null==t?void 0:t.display_name},"created-by-".concat(t.id)):null}),x.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{x&&(c===x.length?d(5):d(x.length))},children:c===x.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(b.aN,{className:"space-y-2",children:[(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"})]})})]})});var C=s(81630),S=s(82558);let _=(0,r.Pi)(e=>{var t,s,r,i,o,c,d,u,m,h,p,x;let{filters:f,handleFiltersUpdate:v,layoutDisplayFiltersOptions:g,labels:j,memberIds:b,states:w,cycleViewDisabled:N=!1,moduleViewDisabled:k=!1}=e,{router:{moduleId:_,cycleId:I}}=(0,y.IX)(),[E,P]=(0,n.useState)(""),R=e=>null==g?void 0:g.filters.includes(e);return(0,l.jsxs)("div",{className:"flex h-full w-full flex-col overflow-hidden",children:[(0,l.jsx)("div",{className:"bg-custom-background-100 p-2.5 pb-0",children:(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border-[0.5px] border-custom-border-200 bg-custom-background-90 px-1.5 py-1 text-xs",children:[(0,l.jsx)(C.Z,{className:"text-custom-text-400",size:12,strokeWidth:2}),(0,l.jsx)("input",{type:"text",className:"w-full bg-custom-background-90 outline-none placeholder:text-custom-text-400",placeholder:"Search",value:E,onChange:e=>P(e.target.value),autoFocus:!0}),""!==E&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>P(""),children:(0,l.jsx)(S.Z,{className:"text-custom-text-300",size:12,strokeWidth:2})})]})}),(0,l.jsxs)("div",{className:"h-full w-full divide-y divide-custom-border-200 overflow-y-auto px-2.5 vertical-scrollbar scrollbar-sm",children:[R("priority")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.sRr,{appliedFilters:null!==(t=f.priority)&&void 0!==t?t:null,handleUpdate:e=>v("priority",e),searchQuery:E})}),R("state_group")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.ln$,{appliedFilters:null!==(s=f.state_group)&&void 0!==s?s:null,handleUpdate:e=>v("state_group",e),searchQuery:E})}),R("state")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.jVv,{appliedFilters:null!==(r=f.state)&&void 0!==r?r:null,handleUpdate:e=>v("state",e),searchQuery:E,states:w})}),R("assignees")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.Npw,{appliedFilters:null!==(i=f.assignees)&&void 0!==i?i:null,handleUpdate:e=>v("assignees",e),memberIds:b,searchQuery:E})}),R("cycle")&&!I&&!N&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.Fdm,{appliedFilters:null!==(o=f.cycle)&&void 0!==o?o:null,handleUpdate:e=>v("cycle",e),searchQuery:E})}),R("module")&&!_&&!k&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.iLy,{appliedFilters:null!==(c=f.module)&&void 0!==c?c:null,handleUpdate:e=>v("module",e),searchQuery:E})}),R("mentions")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.$F,{appliedFilters:null!==(d=f.mentions)&&void 0!==d?d:null,handleUpdate:e=>v("mentions",e),memberIds:b,searchQuery:E})}),R("created_by")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.aIs,{appliedFilters:null!==(u=f.created_by)&&void 0!==u?u:null,handleUpdate:e=>v("created_by",e),memberIds:b,searchQuery:E})}),R("labels")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.Epc,{appliedFilters:null!==(m=f.labels)&&void 0!==m?m:null,handleUpdate:e=>v("labels",e),labels:j,searchQuery:E})}),R("project")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.xB8,{appliedFilters:null!==(h=f.project)&&void 0!==h?h:null,handleUpdate:e=>v("project",e),searchQuery:E})}),R("start_date")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.M2_,{appliedFilters:null!==(p=f.start_date)&&void 0!==p?p:null,handleUpdate:e=>v("start_date",e),searchQuery:E})}),R("target_date")&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(a.y_u,{appliedFilters:null!==(x=f.target_date)&&void 0!==x?x:null,handleUpdate:e=>v("target_date",e),searchQuery:E})})]})]})});var I=s(50649);let E=e=>{let{color:t}=e;return(0,l.jsx)("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:t}})},P=(0,I.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,labels:i,searchQuery:o}=e,[c,d]=(0,n.useState)(5),[u,m]=(0,n.useState)(!0),h=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,p=(0,n.useMemo)(()=>{let e=(i||[]).filter(e=>e.name.toLowerCase().includes(o.toLowerCase()));return j()(e,[e=>!(null!=s?s:[]).includes(e.id),e=>e.name.toLowerCase()])},[o]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Label".concat(h>0?" (".concat(h,")"):""),isPreviewEnabled:u,handleIsPreviewEnabled:()=>m(!u)}),u&&(0,l.jsx)("div",{children:p?p.length>0?(0,l.jsxs)(l.Fragment,{children:[p.slice(0,c).map(e=>(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(null==e?void 0:e.id),onClick:()=>r(null==e?void 0:e.id),icon:(0,l.jsx)(E,{color:e.color}),title:e.name},null==e?void 0:e.id)),p.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{p&&(c===p.length?d(5):d(p.length))},children:c===p.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(b.aN,{className:"space-y-2",children:[(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"})]})})]})}),R=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,searchQuery:i}=e,[c,d]=(0,n.useState)(!0),u=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,m=o.Ku.filter(e=>e.key.includes(i.toLowerCase()));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Priority".concat(u>0?" (".concat(u,")"):""),isPreviewEnabled:c,handleIsPreviewEnabled:()=>d(!c)}),c&&(0,l.jsx)("div",{children:m.length>0?m.map(e=>(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(e.key),onClick:()=>r(e.key),icon:(0,l.jsx)(b.bJ,{priority:e.key,className:"h-3.5 w-3.5"}),title:e.title},e.key)):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})});var F=s(91256);let O=(0,I.Pi)(e=>{var t,s;let{appliedFilters:r,handleUpdate:i,searchQuery:o}=e,[c,d]=(0,n.useState)(5),[u,m]=(0,n.useState)(!0),{getProjectById:h,workspaceProjectIds:p}=(0,y.PY)(),x=null!==(t=null==p?void 0:p.map(e=>h(e)))&&void 0!==t?t:null,f=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,v=(0,n.useMemo)(()=>{let e=(x||[]).filter(e=>e.name.toLowerCase().includes(o.toLowerCase()));return j()(e,[e=>!(null!=r?r:[]).includes(e.id),e=>e.name.toLowerCase()])},[o]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Project".concat(f>0?" (".concat(f,")"):""),isPreviewEnabled:u,handleIsPreviewEnabled:()=>m(!u)}),u&&(0,l.jsx)("div",{children:v?v.length>0?(0,l.jsxs)(l.Fragment,{children:[v.slice(0,c).map(e=>(0,l.jsx)(a.f2,{isChecked:null!=r&&!!r.includes(e.id),onClick:()=>i(e.id),icon:(0,l.jsx)("span",{className:"grid place-items-center flex-shrink-0 h-4 w-4",children:(0,l.jsx)(F.h0,{logo:e.logo_props,className:"text-sm"})}),title:e.name},"project-".concat(e.id))),v.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{v&&(c===v.length?d(5):d(v.length))},children:c===v.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(b.aN,{className:"space-y-2",children:[(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"})]})})]})});var T=s(23258),A=s(60801);let D=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,searchQuery:i}=e,[o,c]=(0,n.useState)(!0),[d,u]=(0,n.useState)(!1),m=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,h=A.UC.filter(e=>e.name.toLowerCase().includes(i.toLowerCase())),p=()=>((null==s?void 0:s.filter(e=>e.includes("-")))||[]).length>0;return(0,l.jsxs)(l.Fragment,{children:[d&&(0,l.jsx)(T.iF,{handleClose:()=>u(!1),isOpen:d,onSelect:e=>r(e),title:"Start date"}),(0,l.jsx)(a.YHs,{title:"Start date".concat(m>0?" (".concat(m,")"):""),isPreviewEnabled:o,handleIsPreviewEnabled:()=>c(!o)}),o&&(0,l.jsx)("div",{children:h.length>0?(0,l.jsxs)(l.Fragment,{children:[h.map(e=>(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(e.value),onClick:()=>r(e.value),title:e.name,multiple:!0},e.value)),(0,l.jsx)(a.f2,{isChecked:p(),onClick:()=>{p()?r((null==s?void 0:s.filter(e=>e.includes("-")))||[]):u(!0)},title:"Custom",multiple:!0})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})});var M=s(52934);let z=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,searchQuery:i}=e,[o,c]=(0,n.useState)(5),[d,u]=(0,n.useState)(!0),m=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,h=Object.values(M.q).filter(e=>e.key.includes(i.toLowerCase()));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"State group".concat(m>0?" (".concat(m,")"):""),isPreviewEnabled:d,handleIsPreviewEnabled:()=>u(!d)}),d&&(0,l.jsx)("div",{children:h.length>0?(0,l.jsxs)(l.Fragment,{children:[h.slice(0,o).map(e=>(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(e.key),onClick:()=>r(e.key),icon:(0,l.jsx)(b.b_,{stateGroup:e.key}),title:e.label},e.key)),h.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{h&&(o===h.length?c(5):c(h.length))},children:o===h.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})}),L=(0,I.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,searchQuery:i,states:o}=e,[c,d]=(0,n.useState)(5),[u,m]=(0,n.useState)(!0),h=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,p=(0,n.useMemo)(()=>{let e=(null!=o?o:[]).filter(e=>e.name.toLowerCase().includes(i.toLowerCase()));return j()(e,[e=>!(null!=s?s:[]).includes(e.id)])},[i]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"State".concat(h>0?" (".concat(h,")"):""),isPreviewEnabled:u,handleIsPreviewEnabled:()=>m(!u)}),u&&(0,l.jsx)("div",{children:p?p.length>0?(0,l.jsxs)(l.Fragment,{children:[p.slice(0,c).map(e=>(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(e.id),onClick:()=>r(e.id),icon:(0,l.jsx)(b.b_,{stateGroup:e.group,color:e.color}),title:e.name},e.id)),p.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{p&&(c===p.length?d(5):d(p.length))},children:c===p.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(b.aN,{className:"space-y-2",children:[(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"})]})})]})}),Z=(0,I.Pi)(e=>{var t,s;let{appliedFilters:r,handleUpdate:i,searchQuery:o}=e,{router:{projectId:c}}=(0,y.IX)(),{getCycleById:d,getProjectCycleIds:u}=(0,y.nv)(),[m,h]=(0,n.useState)(5),[p,x]=(0,n.useState)(!0),f=c?u(c):void 0,v=null!==(t=null==f?void 0:f.map(e=>d(e)))&&void 0!==t?t:null,g=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,w=(0,n.useMemo)(()=>{let e=(v||[]).filter(e=>e.name.toLowerCase().includes(o.toLowerCase()));return j()(e,[e=>!(null==r?void 0:r.includes(e.id)),e=>e.name.toLowerCase()])},[o]),N=e=>e?e.toLocaleLowerCase():"draft";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Cycle ".concat(g>0?" (".concat(g,")"):""),isPreviewEnabled:p,handleIsPreviewEnabled:()=>x(!p)}),p&&(0,l.jsx)("div",{children:w?w.length>0?(0,l.jsxs)(l.Fragment,{children:[w.slice(0,m).map(e=>(0,l.jsx)(a.f2,{isChecked:null!=r&&!!r.includes(e.id),onClick:()=>i(e.id),icon:(0,l.jsx)(b.Y7,{cycleGroup:N(null==e?void 0:e.status),className:"h-3.5 w-3.5 flex-shrink-0"}),title:e.name,activePulse:"current"===N(null==e?void 0:e.status)},e.id)),w.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{w&&(m===w.length?h(5):h(w.length))},children:m===w.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(b.aN,{className:"space-y-2",children:[(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"})]})})]})}),q=(0,I.Pi)(e=>{var t,s;let{appliedFilters:r,handleUpdate:i,searchQuery:o}=e,{router:{projectId:c}}=(0,y.IX)(),{getModuleById:d,getProjectModuleIds:u}=(0,y.b7)(),[m,h]=(0,n.useState)(5),[p,x]=(0,n.useState)(!0),f=c?u(c):void 0,v=null!==(t=null==f?void 0:f.map(e=>d(e)))&&void 0!==t?t:null,g=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,w=(0,n.useMemo)(()=>{let e=(v||[]).filter(e=>e.name.toLowerCase().includes(o.toLowerCase()));return j()(e,[e=>!(null==r?void 0:r.includes(e.id)),e=>e.name.toLowerCase()])},[o]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Module ".concat(g>0?" (".concat(g,")"):""),isPreviewEnabled:p,handleIsPreviewEnabled:()=>x(!p)}),p&&(0,l.jsx)("div",{children:w?w.length>0?(0,l.jsxs)(l.Fragment,{children:[w.slice(0,m).map(e=>(0,l.jsx)(a.f2,{isChecked:null!=r&&!!r.includes(e.id),onClick:()=>i(e.id),icon:(0,l.jsx)(b.kB,{className:"h-3 w-3 flex-shrink-0"}),title:e.name},e.id)),w.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{w&&(m===w.length?h(5):h(w.length))},children:m===w.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(b.aN,{className:"space-y-2",children:[(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"}),(0,l.jsx)(b.aN.Item,{height:"20px"})]})})]})}),B=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,searchQuery:i}=e,[o,c]=(0,n.useState)(!0),[d,u]=(0,n.useState)(!1),m=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,h=A.UC.filter(e=>e.name.toLowerCase().includes(i.toLowerCase())),p=()=>((null==s?void 0:s.filter(e=>e.includes("-")))||[]).length>0;return(0,l.jsxs)(l.Fragment,{children:[d&&(0,l.jsx)(T.iF,{handleClose:()=>u(!1),isOpen:d,onSelect:e=>r(e),title:"Due date"}),(0,l.jsx)(a.YHs,{title:"Target date".concat(m>0?" (".concat(m,")"):""),isPreviewEnabled:o,handleIsPreviewEnabled:()=>c(!o)}),o&&(0,l.jsx)("div",{children:h.length>0?(0,l.jsxs)(l.Fragment,{children:[h.map(e=>(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(e.value),onClick:()=>r(e.value),title:e.name,multiple:!0},e.value)),(0,l.jsx)(a.f2,{isChecked:p(),onClick:()=>{p()?r((null==s?void 0:s.filter(e=>e.includes("-")))||[]):u(!0)},title:"Custom",multiple:!0})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})});var U=s(69570),V=s(30640),W=s(30335);let K=e=>{let{children:t,icon:s,title:r="Dropdown",placement:a,disabled:i=!1,tabIndex:o,menuButton:d,isFiltersApplied:u=!1}=e,[m,h]=(0,n.useState)(null),[p,x]=(0,n.useState)(null),{styles:f,attributes:v}=(0,U.D)(m,p,{placement:null!=a?a:"auto"});return(0,l.jsx)(V.J,{as:"div",children:e=>{let{open:a}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(V.J.Button,{as:n.Fragment,children:d?(0,l.jsx)("button",{role:"button",ref:h,children:d}):(0,l.jsx)(b.zx,{disabled:i,ref:h,variant:"neutral-primary",size:"sm",prependIcon:s,appendIcon:(0,l.jsx)(c.Z,{className:"transition-all ".concat(a?"":"rotate-180"),size:14,strokeWidth:2}),tabIndex:o,className:"relative",children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"".concat(a?"text-custom-text-100":"text-custom-text-200"),children:(0,l.jsx)("span",{children:r})}),u&&(0,l.jsx)("span",{className:"absolute h-2 w-2 -right-0.5 -top-0.5 bg-custom-primary-100 rounded-full"})]})})}),(0,l.jsx)(W.u,{as:n.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,l.jsx)(V.J.Panel,{className:"fixed z-10",children:(0,l.jsx)("div",{className:"overflow-hidden rounded border border-custom-border-200 bg-custom-background-100 shadow-custom-shadow-rg my-1",ref:x,style:f.popper,...v.popper,children:(0,l.jsx)("div",{className:"flex max-h-[30rem] lg:max-h-[37.5rem] w-[18.75rem] flex-col overflow-hidden",children:t})})})})]})}})};var Y=s(1759);let J=e=>{let{icon:t,isChecked:s,multiple:n=!0,onClick:r,title:a,activePulse:i=!1}=e;return(0,l.jsxs)("button",{type:"button",className:"flex w-full items-center gap-2 rounded p-1.5 hover:bg-custom-background-80",onClick:r,children:[(0,l.jsx)("div",{className:"grid h-3 w-3 flex-shrink-0 place-items-center border bg-custom-background-90 ".concat(s?"border-custom-primary-100 bg-custom-primary-100 text-white":"border-custom-border-300"," ").concat(n?"rounded-sm":"rounded-full"),children:s&&(0,l.jsx)(Y.Z,{size:10,strokeWidth:3})}),(0,l.jsxs)("div",{className:"flex items-center gap-2 truncate",children:[t&&(0,l.jsx)("div",{className:"grid w-5 flex-shrink-0 place-items-center",children:t}),(0,l.jsx)("div",{className:"flex-grow truncate text-xs text-custom-text-200",children:a})]}),i&&(0,l.jsx)("div",{className:"flex-shrink-0 text-xs w-2 h-2 rounded-full bg-custom-primary-100 animate-pulse ml-auto"})]})};var H=s(18894);let Q=e=>{let{layouts:t,onChange:s,selectedLayout:n}=e,{isMobile:r}=(0,H.L)();return(0,l.jsx)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1",children:o.u2.filter(e=>t.includes(e.key)).map(e=>(0,l.jsx)(b.u,{tooltipContent:e.title,isMobile:r,children:(0,l.jsx)("button",{type:"button",className:"group grid h-[22px] w-7 place-items-center overflow-hidden rounded transition-all hover:bg-custom-background-100 ".concat(n==e.key?"bg-custom-background-100 shadow-custom-shadow-2xs":""),onClick:()=>s(e.key),children:(0,l.jsx)(e.icon,{size:14,strokeWidth:2,className:"h-3.5 w-3.5 ".concat(n==e.key?"text-custom-text-100":"text-custom-text-200")})})},e.key))})};var G=s(86677);let $=(0,r.Pi)(()=>{let{workspaceSlug:e,projectId:t,cycleId:s}=(0,G.useRouter)().query,{issuesFilter:{issueFilters:n,updateFilters:r}}=(0,y.gk)(o.rS.CYCLE),{projectLabels:i}=(0,y.NP)(),{projectStates:c}=(0,y.eD)(),d=null==n?void 0:n.filters,u={};return(Object.entries(null!=d?d:{}).forEach(e=>{let[t,s]=e;s&&(Array.isArray(s)&&0===s.length||(u[t]=s))}),0!==Object.keys(u).length&&e&&t)?(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 gap-2.5",children:[(0,l.jsx)(a.v4D,{appliedFilters:u,handleClearAllFilters:()=>{if(!e||!t||!s)return;let l={};Object.keys(null!=d?d:{}).forEach(e=>{l[e]=[]}),r(e.toString(),t.toString(),o.gc.FILTERS,{...l},s.toString())},handleRemoveFilter:(l,a)=>{var i,c;if(!e||!t||!s)return;if(!a){r(e.toString(),t.toString(),o.gc.FILTERS,{[l]:null},s.toString());return}let d=null!==(c=null==n?void 0:null===(i=n.filters)||void 0===i?void 0:i[l])&&void 0!==c?c:[];d=d.filter(e=>e!==a),r(e.toString(),t.toString(),o.gc.FILTERS,{[l]:d},s.toString())},labels:null!=i?i:[],states:c}),(0,l.jsx)(a.L7G,{workspaceSlug:e.toString(),projectId:t.toString(),filterParams:u})]}):null});var X=s(90104),ee=s.n(X),et=s(56141),es=s.n(et),el=s(865),en=s(93116);let er=(0,r.Pi)(e=>{var t,s;let n;let{globalViewId:r}=e,{workspaceSlug:i}=(0,G.useRouter)().query,{issuesFilter:{filters:c,updateFilters:d}}=(0,y.gk)(o.rS.GLOBAL),{workspaceLabels:u}=(0,y.NP)(),{globalViewMap:m,updateGlobalView:h}=(0,y.Vz)(),{captureEvent:p}=(0,y.DN)(),{membership:{currentWorkspaceRole:x}}=(0,y.aF)(),f=null==c?void 0:null===(t=c[r])||void 0===t?void 0:t.filters,v=m[r];Object.entries(null!=f?f:{}).forEach(e=>{let[t,s]=e;s&&(Array.isArray(s)&&0===s.length||(n||(n={}),n[t]=s))});let g=es()(null!=n?n:{},null!==(s=null==v?void 0:v.filters)&&void 0!==s?s:{}),j=!!x&&x>=en.fp.MEMBER,w=en.F5.map(e=>e.key).includes(r);return ee()(n)&&g?null:(0,l.jsxs)("div",{className:"flex items-start justify-between gap-4 p-4",children:[(0,l.jsx)(a.v4D,{labels:null!=u?u:void 0,appliedFilters:null!=n?n:{},handleClearAllFilters:()=>{if(!i||!r)return;let e={};Object.keys(null!=f?f:{}).forEach(t=>{e[t]=[]}),d(i.toString(),void 0,o.gc.FILTERS,{...e},r.toString())},handleRemoveFilter:(e,t)=>{var s;if(!i||!r)return;if(!t){d(i.toString(),void 0,o.gc.FILTERS,{[e]:null},r.toString());return}let l=null!==(s=null==f?void 0:f[e])&&void 0!==s?s:[];l=l.filter(e=>e!==t),d(i.toString(),void 0,o.gc.FILTERS,{[e]:l},r.toString())},alwaysAllowEditing:!0}),!w&&!g&&j&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{}),(0,l.jsx)(b.zx,{variant:"primary",onClick:()=>{i&&r&&h(i.toString(),r.toString(),{filters:{...null!=n?n:{}}}).then(e=>{e&&p(el.sZ,{view_id:e.id,applied_filters:e.filters,state:"SUCCESS",element:"Spreadsheet view"})})},children:"Update view"})]})]})}),ea=(0,r.Pi)(()=>{let{workspaceSlug:e,projectId:t,moduleId:s}=(0,G.useRouter)().query,{issuesFilter:{issueFilters:n,updateFilters:r}}=(0,y.gk)(o.rS.MODULE),{projectLabels:i}=(0,y.NP)(),{projectStates:c}=(0,y.eD)(),d=null==n?void 0:n.filters,u={};return(Object.entries(null!=d?d:{}).forEach(e=>{let[t,s]=e;s&&(Array.isArray(s)&&0===s.length||(u[t]=s))}),e&&t&&0!==Object.keys(u).length)?(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 gap-2.5",children:[(0,l.jsx)(a.v4D,{appliedFilters:u,handleClearAllFilters:()=>{if(!e||!t||!s)return;let l={};Object.keys(null!=d?d:{}).forEach(e=>{l[e]=[]}),r(e.toString(),t.toString(),o.gc.FILTERS,{...l},s.toString())},handleRemoveFilter:(l,a)=>{var i,c;if(!e||!t||!s)return;if(!a){r(e.toString(),t.toString(),o.gc.FILTERS,{[l]:null},s.toString());return}let d=null!==(c=null==n?void 0:null===(i=n.filters)||void 0===i?void 0:i[l])&&void 0!==c?c:[];d=d.filter(e=>e!==a),r(e.toString(),t.toString(),o.gc.FILTERS,{[l]:d},s.toString())},labels:null!=i?i:[],states:c}),(0,l.jsx)(a.L7G,{workspaceSlug:e.toString(),projectId:t.toString(),filterParams:u})]}):null}),ei=(0,r.Pi)(()=>{var e;let t;let{workspaceSlug:s,projectId:n,viewId:r}=(0,G.useRouter)().query,{issuesFilter:{issueFilters:i,updateFilters:c}}=(0,y.gk)(o.rS.PROJECT_VIEW),{projectLabels:d}=(0,y.NP)(),{projectStates:u}=(0,y.eD)(),{viewMap:m,updateView:h}=(0,y.QJ)(),p=r?m[r.toString()]:null,x=null==i?void 0:i.filters;Object.entries(null!=x?x:{}).forEach(e=>{let[s,l]=e;l&&(Array.isArray(l)&&0===l.length||(t||(t={}),t[s]=l))});let f=es()(null!=t?t:{},null!==(e=null==p?void 0:p.filters)&&void 0!==e?e:{});return ee()(t)&&f?null:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4 p-4",children:[(0,l.jsx)(a.v4D,{appliedFilters:null!=t?t:{},handleClearAllFilters:()=>{if(!s||!n||!r)return;let e={};Object.keys(null!=x?x:{}).forEach(t=>{e[t]=[]}),c(s.toString(),n.toString(),o.gc.FILTERS,{...e},r.toString())},handleRemoveFilter:(e,t)=>{var l,a;if(!s||!n||!r)return;if(!t){c(s.toString(),n.toString(),o.gc.FILTERS,{[e]:null},r.toString());return}let d=null!==(a=null==i?void 0:null===(l=i.filters)||void 0===l?void 0:l[e])&&void 0!==a?a:[];d=d.filter(e=>e!==t),c(s.toString(),n.toString(),o.gc.FILTERS,{[e]:d},r.toString())},labels:null!=d?d:[],states:u,alwaysAllowEditing:!0}),!f&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{}),(0,l.jsx)("div",{className:"flex flex-shrink-0 items-center justify-center",children:(0,l.jsx)(b.zx,{variant:"primary",size:"sm",onClick:()=>{s&&n&&r&&p&&h(s.toString(),n.toString(),r.toString(),{filters:{...null!=t?t:{}}})},children:"Update view"})})]})]})});var eo=s(51374),ec=s(81309);let ed=(0,r.Pi)(()=>{let{workspaceSlug:e,projectId:t}=(0,G.useRouter)().query,{projectLabels:s}=(0,y.NP)(),{issuesFilter:{issueFilters:n,updateFilters:r}}=(0,ec.g)(o.rS.PROJECT),{membership:{currentProjectRole:i}}=(0,y.aF)(),{projectStates:c}=(0,y.eD)(),d=!!i&&i>=eo.MC.MEMBER,u=null==n?void 0:n.filters,m={};return(Object.entries(null!=u?u:{}).forEach(e=>{let[t,s]=e;s&&(Array.isArray(s)&&0===s.length||(m[t]=s))}),0===Object.keys(m).length)?null:(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 gap-2.5",children:[(0,l.jsx)(a.v4D,{appliedFilters:m,handleClearAllFilters:()=>{if(!e||!t)return;let s={};Object.keys(null!=u?u:{}).forEach(e=>{s[e]=[]}),r(e.toString(),t.toString(),o.gc.FILTERS,{...s})},handleRemoveFilter:(s,l)=>{var a,i;if(!e||!t)return;if(!l){r(e.toString(),t.toString(),o.gc.FILTERS,{[s]:null});return}let c=null!==(i=null==n?void 0:null===(a=n.filters)||void 0===a?void 0:a[s])&&void 0!==i?i:[];c=c.filter(e=>e!==l),r(e.toString(),t.toString(),o.gc.FILTERS,{[s]:c})},labels:null!=s?s:[],states:c}),d&&(0,l.jsx)(a.L7G,{workspaceSlug:e,projectId:t,filterParams:m})]})}),eu=(0,r.Pi)(()=>{let{workspaceSlug:e,projectId:t}=(0,G.useRouter)().query,{issuesFilter:{issueFilters:s,updateFilters:n}}=(0,y.gk)(o.rS.ARCHIVED),{projectLabels:r}=(0,y.NP)(),{projectStates:i}=(0,y.eD)(),c=null==s?void 0:s.filters,d={};return(Object.entries(null!=c?c:{}).forEach(e=>{let[t,s]=e;s&&(Array.isArray(s)&&0===s.length||(d[t]=s))}),0===Object.keys(d).length)?null:(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 gap-2.5",children:[(0,l.jsx)(a.v4D,{appliedFilters:d,handleClearAllFilters:()=>{if(!e||!t)return;let s={};Object.keys(null!=c?c:{}).forEach(e=>{s[e]=[]}),n(e.toString(),t.toString(),o.gc.FILTERS,{...s})},handleRemoveFilter:(l,r)=>{var a,i;if(!e||!t)return;if(!r){n(e.toString(),t.toString(),o.gc.FILTERS,{[l]:null});return}let c=null!==(i=null==s?void 0:null===(a=s.filters)||void 0===a?void 0:a[l])&&void 0!==i?i:[];c=c.filter(e=>e!==r),n(e.toString(),t.toString(),o.gc.FILTERS,{[l]:c})},labels:null!=r?r:[],states:i}),(0,l.jsx)(a.L7G,{workspaceSlug:e,projectId:t,filterParams:d})]})});var em=s(30201);let eh=e=>{let{fetchWorkspaceLabels:t}=(0,y.NP)(),{fetchWorkspaceStates:s}=(0,y.eD)(),{fetchWorkspaceEstimates:l}=(0,y.ZT)(),{fetchWorkspaceModules:n}=(0,y.b7)(),{fetchWorkspaceCycles:r}=(0,y.nv)();(0,em.ZP)(e?"WORKSPACE_MODULES_".concat(e):null,e?()=>n(e.toString()):null,{revalidateIfStale:!1,revalidateOnFocus:!1}),(0,em.ZP)(e?"WORKSPACE_CYCLES_".concat(e):null,e?()=>r(e.toString()):null,{revalidateIfStale:!1,revalidateOnFocus:!1}),(0,em.ZP)(e?"WORKSPACE_LABELS_".concat(e):null,e?()=>t(e.toString()):null,{revalidateIfStale:!1,revalidateOnFocus:!1}),(0,em.ZP)(e?"WORKSPACE_STATES_".concat(e):null,e?()=>s(e.toString()):null,{revalidateIfStale:!1,revalidateOnFocus:!1}),(0,em.ZP)(e?"WORKSPACE_ESTIMATES_".concat(e):null,e?()=>l(e.toString()):null,{revalidateIfStale:!1,revalidateOnFocus:!1})},ep=(0,r.Pi)(()=>{let{workspaceSlug:e,userId:t}=(0,G.useRouter)().query;eh(e);let{issuesFilter:{issueFilters:s,updateFilters:n}}=(0,y.gk)(o.rS.PROFILE),{workspaceLabels:r}=(0,y.NP)(),i=null==s?void 0:s.filters,c={};return(Object.entries(null!=i?i:{}).forEach(e=>{let[t,s]=e;s&&(Array.isArray(s)&&0===s.length||(c[t]=s))}),0===Object.keys(c).length)?null:(0,l.jsx)("div",{className:"p-4",children:(0,l.jsx)(a.v4D,{appliedFilters:c,handleClearAllFilters:()=>{if(!e||!t)return;let s={};Object.keys(null!=i?i:{}).forEach(e=>{s[e]=[]}),n(e.toString(),void 0,o.gc.FILTERS,{...s},t.toString())},handleRemoveFilter:(l,r)=>{var a,i;if(!e||!t)return;if(!r){n(e.toString(),void 0,o.gc.FILTERS,{[l]:null},t.toString());return}let c=null!==(i=null==s?void 0:null===(a=s.filters)||void 0===a?void 0:a[l])&&void 0!==i?i:[];c=c.filter(e=>e!==r),n(e.toString(),void 0,o.gc.FILTERS,{[l]:c},t.toString())},labels:null!=r?r:[],states:[]})})});var ex=s(74273),ef=s(10712);let ev=(0,r.Pi)(e=>{let{handleRemove:t,values:s}=e,n=e=>{let t="",s=A.UC.find(t=>t.value===e);if(s)t=s.name;else{let s=e.split(";");if(2===s.length){let[e,l]=s;t="".concat((0,ef.fm)(l)," ").concat((0,ex.ot)(e))}}return t};return(0,l.jsx)(l.Fragment,{children:s.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)("span",{className:"normal-case",children:n(e)}),(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(S.Z,{size:10,strokeWidth:2})})]},e))})}),eg=["assignees","mentions","created_by","subscriber"],ej=["start_date","target_date"],eb=(0,r.Pi)(e=>{let{appliedFilters:t,handleClearAllFilters:s,handleRemoveFilter:n,labels:r,states:i,alwaysAllowEditing:o}=e,{router:{moduleId:c,cycleId:d}}=(0,y.IX)(),{membership:{currentProjectRole:u}}=(0,y.aF)();if(!t||0===Object.keys(t).length)return null;let m=o||u&&u>=eo.MC.MEMBER;return(0,l.jsxs)("div",{className:"flex flex-wrap items-stretch gap-2 bg-custom-background-100 truncate",children:[Object.entries(t).map(e=>{let[t,s]=e;if(s&&(!Array.isArray(s)||0!==s.length))return(0,l.jsx)("div",{className:"flex flex-wrap items-center gap-2 rounded-md border border-custom-border-200 px-2 py-1 capitalize truncate",children:(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5 truncate",children:[(0,l.jsx)("span",{className:"text-xs text-custom-text-300",children:(0,ef.y2)(t)}),eg.includes(t)&&(0,l.jsx)(a.lx$,{editable:m,handleRemove:e=>n(t,e),values:s}),ej.includes(t)&&(0,l.jsx)(a.zgM,{handleRemove:e=>n(t,e),values:s}),"labels"===t&&(0,l.jsx)(a.ePR,{editable:m,handleRemove:e=>n("labels",e),labels:r,values:s}),"priority"===t&&(0,l.jsx)(a.Ok,{editable:m,handleRemove:e=>n("priority",e),values:s}),"state"===t&&i&&(0,l.jsx)(a.sR5,{editable:m,handleRemove:e=>n("state",e),states:i,values:s}),"state_group"===t&&(0,l.jsx)(a.doF,{handleRemove:e=>n("state_group",e),values:s}),"project"===t&&(0,l.jsx)(a.Rlr,{editable:m,handleRemove:e=>n("project",e),values:s}),"cycle"===t&&!d&&(0,l.jsx)(a.LnW,{editable:m,handleRemove:e=>n("cycle",e),values:s}),"module"===t&&!c&&(0,l.jsx)(a.oVA,{editable:m,handleRemove:e=>n("module",e),values:s}),m&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>n(t,null),children:(0,l.jsx)(S.Z,{size:12,strokeWidth:2})})]})},t)}),m&&(0,l.jsxs)("button",{type:"button",onClick:s,className:"flex items-center gap-2 flex-shrink-0 rounded-md border border-custom-border-200 px-2 py-1 text-xs text-custom-text-300 hover:text-custom-text-200",children:["Clear all",(0,l.jsx)(S.Z,{size:12,strokeWidth:2})]})]})}),ey=(0,r.Pi)(e=>{let{handleRemove:t,labels:s,values:n,editable:r}=e;return(0,l.jsx)(l.Fragment,{children:n.map(e=>{let n=null==s?void 0:s.find(t=>t.id===e);return n?(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)("span",{className:"h-1.5 w-1.5 rounded-full",style:{backgroundColor:n.color}}),(0,l.jsx)("span",{className:"normal-case",children:n.name}),r&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(S.Z,{size:10,strokeWidth:2})})]},e):null})})}),ew=(0,r.Pi)(e=>{let{handleRemove:t,values:s,editable:n}=e,{workspace:{getWorkspaceMemberDetails:r}}=(0,y.Kb)();return(0,l.jsx)(l.Fragment,{children:s.map(e=>{var s;let a=null===(s=r(e))||void 0===s?void 0:s.member;return a?(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)(b.qE,{name:a.display_name,src:a.avatar,showTooltip:!1}),(0,l.jsx)("span",{className:"normal-case",children:a.display_name}),n&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(S.Z,{size:10,strokeWidth:2})})]},e):null})})}),eN=(0,r.Pi)(e=>{let{handleRemove:t,values:s,editable:n}=e;return(0,l.jsx)(l.Fragment,{children:s.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)(b.bJ,{priority:e,className:"h-3 w-3"}),e,n&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(S.Z,{size:10,strokeWidth:2})})]},e))})}),ek=(0,r.Pi)(e=>{let{handleRemove:t,values:s,editable:n}=e,{projectMap:r}=(0,y.PY)();return(0,l.jsx)(l.Fragment,{children:s.map(e=>{var s;let a=null!==(s=null==r?void 0:r[e])&&void 0!==s?s:null;return a?(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)("span",{className:"grid place-items-center flex-shrink-0 h-4 w-4",children:(0,l.jsx)(F.h0,{logo:a.logo_props,className:"text-sm"})}),(0,l.jsx)("span",{className:"normal-case",children:a.name}),n&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(S.Z,{size:10,strokeWidth:2})})]},e):null})})}),eC=(0,r.Pi)(e=>{let{handleRemove:t,values:s,editable:n}=e,{getModuleById:r}=(0,y.b7)();return(0,l.jsx)(l.Fragment,{children:s.map(e=>{var s;let a=null!==(s=r(e))&&void 0!==s?s:null;return a?(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs truncate",children:[(0,l.jsx)(b.kB,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"normal-case truncate",children:a.name}),n&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(S.Z,{size:10,strokeWidth:2})})]},e):null})})}),eS=(0,r.Pi)(e=>{let{handleRemove:t,values:s,editable:n}=e,{getCycleById:r}=(0,y.nv)();return(0,l.jsx)(l.Fragment,{children:s.map(e=>{var s;let a=null!==(s=r(e))&&void 0!==s?s:null;if(!a)return null;let i=(null==a?void 0:a.status)?null==a?void 0:a.status.toLocaleLowerCase():"draft";return(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs truncate",children:[(0,l.jsx)(b.Y7,{cycleGroup:i,className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{className:"normal-case truncate",children:a.name}),n&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(S.Z,{size:10,strokeWidth:2})})]},e)})})}),e_=(0,r.Pi)(e=>{let{handleRemove:t,states:s,values:n,editable:r}=e;return(0,l.jsx)(l.Fragment,{children:n.map(e=>{let n=null==s?void 0:s.find(t=>t.id===e);return n?(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)(b.b_,{color:n.color,stateGroup:n.group,height:"12px",width:"12px"}),n.name,r&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(S.Z,{size:10,strokeWidth:2})})]},e):null})})}),eI=(0,r.Pi)(e=>{let{handleRemove:t,values:s}=e;return(0,l.jsx)(l.Fragment,{children:s.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)(b.b_,{stateGroup:e,height:"12px",width:"12px"}),e,(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(S.Z,{size:10,strokeWidth:2})})]},e))})});var eE=s(46479),eP=s(12404),eR=s(92775);let eF=(0,r.Pi)(()=>{var e,t,s;let{workspaceSlug:r,projectId:i}=(0,G.useRouter)().query,{issues:c,issuesFilter:d}=(0,y.gk)(o.rS.PROJECT);(0,em.ZP)(r&&i?"PROJECT_ISSUES_".concat(r,"_").concat(i):null,async()=>{r&&i&&(await (null==d?void 0:d.fetchFilters(r.toString(),i.toString())),await (null==c?void 0:c.fetchIssues(r.toString(),i.toString(),(null==c?void 0:c.groupedIssueIds)?"mutation":"init-loader")))},{revalidateIfStale:!1,revalidateOnFocus:!1});let u=null==d?void 0:null===(t=d.issueFilters)||void 0===t?void 0:null===(e=t.displayFilters)||void 0===e?void 0:e.layout;return r&&i?(null==c?void 0:c.loader)!=="init-loader"&&(null==c?void 0:c.groupedIssueIds)?(0,l.jsxs)("div",{className:"relative flex h-full w-full flex-col overflow-hidden",children:[(0,l.jsx)(a.ATT,{}),(null==c?void 0:null===(s=c.groupedIssueIds)||void 0===s?void 0:s.length)===0?(0,l.jsx)(a.Si1,{}):(0,l.jsxs)(n.Fragment,{children:[(0,l.jsxs)("div",{className:"relative h-full w-full overflow-auto bg-custom-background-90",children:[(null==c?void 0:c.loader)==="mutation"&&(0,l.jsx)("div",{className:"fixed w-[40px] h-[40px] z-50 right-[20px] top-[70px] flex justify-center items-center bg-custom-background-80 shadow-sm rounded",children:(0,l.jsx)(b.$j,{className:"w-4 h-4"})}),"list"===u?(0,l.jsx)(a.PSe,{}):"kanban"===u?(0,l.jsx)(a.vEg,{}):"calendar"===u?(0,l.jsx)(a.Tdk,{}):"gantt_chart"===u?(0,l.jsx)(a.WlD,{}):"spreadsheet"===u?(0,l.jsx)(a.fTy,{}):null]}),(0,l.jsx)(a.Kyp,{})]})]}):(0,l.jsx)(l.Fragment,{children:u&&(0,l.jsx)(eR.Xj,{layout:u})}):(0,l.jsx)(l.Fragment,{})});var eO=s(36417),eT=s.n(eO);let eA=(0,r.Pi)(()=>{var e,t,s,r;let{workspaceSlug:i,projectId:c,moduleId:d}=(0,G.useRouter)().query,{issues:u,issuesFilter:m}=(0,y.gk)(o.rS.MODULE);(0,em.ZP)(i&&c&&d?"MODULE_ISSUES_".concat(i.toString(),"_").concat(c.toString(),"_").concat(d.toString()):null,async()=>{i&&c&&d&&(await (null==m?void 0:m.fetchFilters(i.toString(),c.toString(),d.toString())),await (null==u?void 0:u.fetchIssues(i.toString(),c.toString(),(null==u?void 0:u.groupedIssueIds)?"mutation":"init-loader",d.toString())))},{revalidateIfStale:!1,revalidateOnFocus:!1});let h=null==m?void 0:null===(e=m.issueFilters)||void 0===e?void 0:e.filters,p=eT()(Object.fromEntries(Object.entries(null!=h?h:{}).filter(e=>{let[,t]=e;return t&&Array.isArray(t)&&t.length>0})));if(!i||!c||!d)return(0,l.jsx)(l.Fragment,{});let x=(null==m?void 0:null===(s=m.issueFilters)||void 0===s?void 0:null===(t=s.displayFilters)||void 0===t?void 0:t.layout)||void 0;return(null==u?void 0:u.loader)!=="init-loader"&&(null==u?void 0:u.groupedIssueIds)?(0,l.jsxs)("div",{className:"relative flex h-full w-full flex-col overflow-hidden",children:[(0,l.jsx)(a.c9j,{}),(null==u?void 0:null===(r=u.groupedIssueIds)||void 0===r?void 0:r.length)===0?(0,l.jsx)("div",{className:"relative h-full w-full overflow-y-auto",children:(0,l.jsx)(a.yvv,{workspaceSlug:i.toString(),projectId:c.toString(),moduleId:d.toString(),activeLayout:x,handleClearAllFilters:()=>{if(!i||!c||!d)return;let e={};Object.keys(null!=h?h:{}).forEach(t=>{e[t]=[]}),m.updateFilters(i.toString(),c.toString(),o.gc.FILTERS,{...e},d.toString())},isEmptyFilters:p>0})}):(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)("div",{className:"h-full w-full overflow-auto",children:"list"===x?(0,l.jsx)(a.Xbm,{}):"kanban"===x?(0,l.jsx)(a.SUg,{}):"calendar"===x?(0,l.jsx)(a.Wr2,{}):"gantt_chart"===x?(0,l.jsx)(a.E_y,{}):"spreadsheet"===x?(0,l.jsx)(a.IF1,{}):null}),(0,l.jsx)(a.Kyp,{})]})]}):(0,l.jsx)(l.Fragment,{children:x&&(0,l.jsx)(eR.Xj,{layout:x})})});var eD=s(40240);let eM=(0,r.Pi)(()=>{var e,t,s,r,i,c,d;let{workspaceSlug:u,projectId:m,cycleId:h}=(0,G.useRouter)().query,{issues:p,issuesFilter:x}=(0,y.gk)(o.rS.CYCLE),{getCycleById:f}=(0,y.nv)(),[v,g]=(0,n.useState)(!1);(0,em.ZP)(u&&m&&h?"CYCLE_ISSUES_".concat(u.toString(),"_").concat(m.toString(),"_").concat(h.toString()):null,async()=>{u&&m&&h&&(await (null==x?void 0:x.fetchFilters(u.toString(),m.toString(),h.toString())),await (null==p?void 0:p.fetchIssues(u.toString(),m.toString(),(null==p?void 0:p.groupedIssueIds)?"mutation":"init-loader",h.toString())))},{revalidateIfStale:!1,revalidateOnFocus:!1});let j=null==x?void 0:null===(t=x.issueFilters)||void 0===t?void 0:null===(e=t.displayFilters)||void 0===e?void 0:e.layout,b=h?f(h.toString()):void 0,w=null!==(c=null==b?void 0:null===(s=b.status)||void 0===s?void 0:s.toLocaleLowerCase())&&void 0!==c?c:"draft",N=null==x?void 0:null===(r=x.issueFilters)||void 0===r?void 0:r.filters,k=eT()(Object.fromEntries(Object.entries(null!=N?N:{}).filter(e=>{let[,t]=e;return t&&Array.isArray(t)&&t.length>0})));return u&&m&&h?(null==p?void 0:p.loader)!=="init-loader"&&(null==p?void 0:p.groupedIssueIds)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eD.IT,{handleClose:()=>g(!1),isOpen:v}),(0,l.jsxs)("div",{className:"relative flex h-full w-full flex-col overflow-hidden",children:["completed"===w&&(0,l.jsx)(eD.$6,{handleClick:()=>g(!0),disabled:!ee()(null==b?void 0:b.progress_snapshot)}),(0,l.jsx)(a.bqx,{}),(null==p?void 0:null===(i=p.groupedIssueIds)||void 0===i?void 0:i.length)===0?(0,l.jsx)("div",{className:"relative h-full w-full overflow-y-auto",children:(0,l.jsx)(a.ZRF,{workspaceSlug:u.toString(),projectId:m.toString(),cycleId:h.toString(),activeLayout:j,handleClearAllFilters:()=>{if(!u||!m||!h)return;let e={};Object.keys(null!=N?N:{}).forEach(t=>{e[t]=[]}),x.updateFilters(u.toString(),m.toString(),o.gc.FILTERS,{...e},h.toString())},isEmptyFilters:k>0})}):(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)("div",{className:"h-full w-full overflow-auto",children:"list"===j?(0,l.jsx)(a.dWL,{}):"kanban"===j?(0,l.jsx)(a.TsF,{}):"calendar"===j?(0,l.jsx)(a.C0u,{}):"gantt_chart"===j?(0,l.jsx)(a.B7_,{}):"spreadsheet"===j?(0,l.jsx)(a.jNT,{}):null}),(0,l.jsx)(a.Kyp,{})]})]})]}):(0,l.jsx)(l.Fragment,{children:j&&(0,l.jsx)(eR.Xj,{layout:j})}):(0,l.jsx)(l.Fragment,{})}),ez=(0,r.Pi)(()=>{var e,t,s;let{workspaceSlug:r,projectId:i,viewId:c}=(0,G.useRouter)().query,{issues:d,issuesFilter:u}=(0,y.gk)(o.rS.PROJECT_VIEW);(0,em.ZP)(r&&i&&c?"PROJECT_VIEW_ISSUES_".concat(r,"_").concat(i,"_").concat(c):null,async()=>{r&&i&&c&&(await (null==u?void 0:u.fetchFilters(r.toString(),i.toString(),c.toString())),await (null==d?void 0:d.fetchIssues(r.toString(),i.toString(),(null==d?void 0:d.groupedIssueIds)?"mutation":"init-loader",c.toString())))},{revalidateIfStale:!1,revalidateOnFocus:!1});let m=null==u?void 0:null===(t=u.issueFilters)||void 0===t?void 0:null===(e=t.displayFilters)||void 0===e?void 0:e.layout;return r&&i&&c?(null==d?void 0:d.loader)!=="init-loader"&&(null==d?void 0:d.groupedIssueIds)?(0,l.jsxs)("div",{className:"relative flex h-full w-full flex-col overflow-hidden",children:[(0,l.jsx)(a.YQC,{}),(null==d?void 0:null===(s=d.groupedIssueIds)||void 0===s?void 0:s.length)===0?(0,l.jsx)("div",{className:"relative h-full w-full overflow-y-auto",children:(0,l.jsx)(a.WNn,{})}):(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)("div",{className:"relative h-full w-full overflow-auto",children:"list"===m?(0,l.jsx)(a.cTm,{}):"kanban"===m?(0,l.jsx)(a.qfU,{}):"calendar"===m?(0,l.jsx)(a.ZUr,{}):"gantt_chart"===m?(0,l.jsx)(a.NHz,{}):"spreadsheet"===m?(0,l.jsx)(a.Chv,{}):null}),(0,l.jsx)(a.Kyp,{})]})]}):(0,l.jsx)(l.Fragment,{children:m&&(0,l.jsx)(eR.Xj,{layout:m})}):(0,l.jsx)(l.Fragment,{})}),eL=(0,r.Pi)(()=>{var e;let{workspaceSlug:t,projectId:s}=(0,G.useRouter)().query,{issues:r,issuesFilter:i}=(0,y.gk)(o.rS.ARCHIVED);return((0,em.ZP)(t&&s?"ARCHIVED_ISSUES_".concat(t.toString(),"_").concat(s.toString()):null,async()=>{t&&s&&(await (null==i?void 0:i.fetchFilters(t.toString(),s.toString())),await (null==r?void 0:r.fetchIssues(t.toString(),s.toString(),(null==r?void 0:r.groupedIssueIds)?"mutation":"init-loader")))},{revalidateIfStale:!1,revalidateOnFocus:!1}),(null==r?void 0:r.loader)!=="init-loader"&&(null==r?void 0:r.groupedIssueIds))?t&&s?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.TMo,{}),(null==r?void 0:null===(e=r.groupedIssueIds)||void 0===e?void 0:e.length)===0?(0,l.jsx)("div",{className:"relative h-full w-full overflow-y-auto",children:(0,l.jsx)(a.eSk,{})}):(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)("div",{className:"relative h-full w-full overflow-auto",children:(0,l.jsx)(a.IxC,{})}),(0,l.jsx)(a.Kyp,{is_archived:!0})]})]}):(0,l.jsx)(l.Fragment,{}):(0,l.jsx)(eR.Rg,{})});s(30582);var eZ=s(74371),eq=s(70540),eB=s(76926);let eU=(0,r.Pi)(()=>{var e,t;let{workspaceSlug:s,globalViewId:r,...i}=(0,G.useRouter)().query;eh(s);let{commandPalette:c}=(0,y.IX)(),{issuesFilter:{filters:d,fetchFilters:u,updateFilters:m},issues:{loader:h,groupedIssueIds:p,fetchIssues:x}}=(0,y.gk)(o.rS.GLOBAL),{updateIssue:f,removeIssue:v,archiveIssue:g}=(0,eB.C)(o.rS.GLOBAL),{dataViewId:j,issueIds:b}=p,{membership:{currentWorkspaceAllProjectsRole:w}}=(0,y.aF)(),{fetchAllGlobalViews:N}=(0,y.Vz)(),{workspaceProjectIds:k}=(0,y.PY)(),{setTrackElement:C}=(0,y.DN)(),S=["all-issues","assigned","created","subscribed"].includes(p.dataViewId)?p.dataViewId:"custom-view",_=()=>{if(s&&r&&["all-issues","assigned","created","subscribed"].includes(r.toString())){let e={};Object.keys(i).forEach(t=>{var s;let l=(null===(s=i[t])||void 0===s?void 0:s.toString())||void 0;o.BI.my_issues.spreadsheet.filters.includes(t)&&t&&l&&(e={...e,[t]:l.split(",")})}),ee()(i)||m(s.toString(),void 0,o.gc.FILTERS,e,r.toString())}};(0,em.ZP)(s?"WORKSPACE_GLOBAL_VIEWS_".concat(s):null,async()=>{s&&await N(s.toString())},{revalidateIfStale:!1,revalidateOnFocus:!1}),(0,em.ZP)(s&&r?"WORKSPACE_GLOBAL_VIEW_ISSUES_".concat(s,"_").concat(r):null,async()=>{s&&r&&(await N(s.toString()),await u(s.toString(),r.toString()),await x(s.toString(),r.toString(),b?"mutation":"init-loader"),_())},{revalidateIfStale:!1,revalidateOnFocus:!1});let I=(0,n.useCallback)(e=>{if(!e)return!1;let t=w&&w[e];return!!t&&t>=eo.MC.MEMBER},[w]),E=r?null==d?void 0:d[r.toString()]:void 0,P=(0,n.useCallback)(e=>{s&&r&&m(s.toString(),void 0,o.gc.DISPLAY_FILTERS,{...e},r.toString())},[m,s,r]),R=(0,n.useCallback)(e=>{let{issue:t,parentRef:s,customActionButton:n,placement:r,portalElement:a}=e;return(0,l.jsx)(eP.C7,{parentRef:s,customActionButton:n,issue:t,handleDelete:async()=>v(t.project_id,t.id),handleUpdate:async e=>f&&f(t.project_id,t.id,e),handleArchive:async()=>g&&g(t.project_id,t.id),portalElement:a,readOnly:!I(t.project_id),placements:r})},[I,v,f,g]);if("init-loader"===h||!r||r!==j||!b)return(0,l.jsx)(eR.hP,{});let F=(null!=k?k:[]).length>0?"workspace-".concat(S):eq.C.WORKSPACE_NO_PROJECTS;return(0,l.jsx)("div",{className:"relative flex h-full w-full flex-col overflow-hidden",children:(0,l.jsxs)("div",{className:"relative h-full w-full flex flex-col",children:[(0,l.jsx)(a.yz7,{globalViewId:r}),0===b.length?(0,l.jsx)(eZ.ub,{type:F,size:"sm",primaryButtonOnClick:(null!=k?k:[]).length>0?"custom-view"!==S&&"subscribed"!==S?()=>{C("All issues empty state"),c.toggleCreateIssueModal(!0,o.rS.PROJECT)}:void 0:()=>{C("All issues empty state"),c.toggleCreateProjectModal(!0)}}):(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(sg,{displayProperties:null!==(e=null==E?void 0:E.displayProperties)&&void 0!==e?e:{},displayFilters:null!==(t=null==E?void 0:E.displayFilters)&&void 0!==t?t:{},handleDisplayFilterUpdate:P,issueIds:b,quickActions:R,updateIssue:f,canEditProperties:I,viewId:r,isWorkspaceLevel:!0}),(0,l.jsx)(a.Kyp,{})]})]})})});var eV=s(76143);let eW=(0,r.Pi)(()=>{let{workspaceSlug:e,projectId:t,cycleId:s}=(0,G.useRouter)().query,{issues:r}=(0,y.gk)(o.rS.CYCLE),{currentProjectCompletedCycleIds:i}=(0,y.nv)(),{membership:{currentProjectRole:c}}=(0,y.aF)(),d=!!s&&!!i&&i.includes(s.toString()),u=!!c&&c>=eo.MC.MEMBER,m=(0,n.useCallback)(()=>!d&&u,[d,u]),h=(0,n.useCallback)(l=>{if(!e||!t||!s)throw Error();return r.addIssueToCycle(e.toString(),t.toString(),s.toString(),l)},[null==r?void 0:r.addIssueToCycle,e,t,s]);return(0,l.jsx)(eV.v,{QuickActions:a.JWn,viewId:null==s?void 0:s.toString(),storeType:o.rS.CYCLE,addIssuesToView:h,canEditPropertiesBasedOnProject:m,isCompletedCycle:d})}),eK=(0,r.Pi)(()=>{let{workspaceSlug:e,projectId:t,moduleId:s}=(0,G.useRouter)().query,{issues:n}=(0,y.gk)(o.rS.MODULE);return(0,l.jsx)(eV.v,{QuickActions:a.PFz,viewId:null==s?void 0:s.toString(),storeType:o.rS.MODULE,addIssuesToView:l=>{if(!e||!t||!s)throw Error();return n.addIssuesToModule(e.toString(),t.toString(),s.toString(),l)}})});s(95919);let eY=(0,r.Pi)(()=>{let{workspaceSlug:e,projectId:t}=(0,G.useRouter)().query;return e&&t?(0,l.jsx)(eV.v,{QuickActions:a.naC,storeType:o.rS.PROJECT}):null}),eJ=(0,r.Pi)(()=>{let{workspaceSlug:e,projectId:t,viewId:s}=(0,G.useRouter)().query;return e&&t?(0,l.jsx)(eV.v,{QuickActions:eP.n,storeType:o.rS.PROJECT_VIEW,viewId:null==s?void 0:s.toString()}):null}),eH=(0,r.Pi)(()=>(0,l.jsx)(eV.v,{QuickActions:a.YBb,storeType:o.rS.ARCHIVED,canEditPropertiesBasedOnProject:()=>!1}));var eQ=s(89001);let eG=(0,I.Pi)(e=>{let{issueIds:t,issueId:s,issuesMap:r,updateIssue:a,quickActions:i,canEditProperties:o,displayProperties:c,nestingLevel:d,spacingLeft:u=14,containerRef:m}=e,[h,p]=(0,n.useState)(!1),{subIssues:x}=(0,y.p1)();if(!s)return null;let f=x.subIssuesByIssueId(s);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eQ.Z,{defaultHeight:"3rem",root:m,classNames:"relative border-b border-b-custom-border-200 last:border-b-transparent",changingReference:t,children:(0,l.jsx)(e2,{issueId:s,issuesMap:r,updateIssue:a,quickActions:i,canEditProperties:o,displayProperties:c,isExpanded:h,setExpanded:p,nestingLevel:d,spacingLeft:u})},"".concat(s)),h&&f&&f.length>0&&f.map(e=>(0,l.jsx)(eG,{issueIds:t,issueId:e,issuesMap:r,updateIssue:a,quickActions:i,canEditProperties:o,displayProperties:c,nestingLevel:d+1,spacingLeft:u+((null==c?void 0:c.key)?19:0),containerRef:m},"".concat(e)))]})});var e$=s(78543),eX=s(80314),e0=s(17764),e1=s(6780);let e2=(0,r.Pi)(e=>{let{issuesMap:t,issueId:s,updateIssue:r,quickActions:a,displayProperties:i,canEditProperties:o,nestingLevel:c,spacingLeft:d=14,isExpanded:u,setExpanded:m}=e,h=(0,n.useRef)(null),{router:{workspaceSlug:p}}=(0,y.IX)(),{getProjectIdentifierById:x}=(0,y.PY)(),{getIsIssuePeeked:f,setPeekIssue:v,subIssues:g}=(0,y.p1)(),j=e=>p&&e&&e.project_id&&e.id&&!f(e.id)&&v({workspaceSlug:p,projectId:e.project_id,issueId:e.id}),w=t[s],{isMobile:N}=(0,H.L)();if(!w)return null;let k=o(w.project_id),C=x(w.project_id);return(0,l.jsxs)("div",{ref:h,className:(0,e1.cn)("min-h-[52px] relative flex flex-col md:flex-row md:items-center gap-3 bg-custom-background-100 p-3 pl-8 text-sm",{"border border-custom-primary-70 hover:border-custom-primary-70":f(w.id),"last:border-b-transparent":!f(w.id)}),children:[(0,l.jsxs)("div",{className:"flex w-full truncate",style:w.parent_id&&0!==c?{paddingLeft:"".concat(d,"px")}:{},children:[(0,l.jsxs)("div",{className:"flex flex-grow items-center gap-3 truncate",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,l.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:w.sub_issues_count>0&&(0,l.jsx)("button",{className:"flex items-center justify-center h-5 w-5 cursor-pointer rounded-sm text-custom-text-400  hover:text-custom-text-300",onClick:e=>{e.stopPropagation(),e.preventDefault(),c>=3?j(w):m(e=>(!e&&p&&w&&g.fetchSubIssues(p.toString(),w.project_id,w.id),!e))},children:(0,l.jsx)(e$.Z,{className:"h-4 w-4 ".concat(u?"rotate-90":"")})})}),i&&(null==i?void 0:i.key)&&(0,l.jsxs)("div",{className:"flex-shrink-0 text-xs font-medium text-custom-text-300",children:[C,"-",w.sequence_id]}),(null==w?void 0:w.tempId)!==void 0&&(0,l.jsx)("div",{className:"absolute left-0 top-0 z-[99999] h-full w-full animate-pulse bg-custom-background-100/20"})]}),(null==w?void 0:w.is_draft)?(0,l.jsx)(b.u,{tooltipContent:w.name,isMobile:N,children:(0,l.jsx)("p",{className:"truncate",children:w.name})}):(0,l.jsx)(b.Ug,{id:"issue-".concat(w.id),href:"/".concat(p,"/projects/").concat(w.project_id,"/").concat(w.archived_at?"archives/":"","issues/").concat(w.id),target:"_blank",onClick:()=>j(w),className:"w-full truncate cursor-pointer text-sm text-custom-text-100",disabled:!!(null==w?void 0:w.tempId),children:(0,l.jsx)(b.u,{tooltipContent:w.name,isMobile:N,children:(0,l.jsx)("p",{className:"truncate",children:w.name})})})]}),!(null==w?void 0:w.tempId)&&(0,l.jsx)("div",{className:"block md:hidden border border-custom-border-300 rounded ",children:a({issue:w,parentRef:h})})]}),(0,l.jsx)("div",{className:"flex flex-shrink-0 items-center gap-2",children:(null==w?void 0:w.tempId)?(0,l.jsx)("div",{className:"h-4 w-4",children:(0,l.jsx)(b.$j,{className:"h-4 w-4"})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e0.j,{className:"relative flex flex-wrap md:flex-grow md:flex-shrink-0 items-center gap-2 whitespace-nowrap",issue:w,isReadOnly:!k,updateIssue:r,displayProperties:i,activeLayout:"List"}),(0,l.jsx)("div",{className:"hidden md:block",children:a({issue:w,parentRef:h})})]})})]})}),e5=e=>{let{issueIds:t,issuesMap:s,updateIssue:n,quickActions:r,displayProperties:a,canEditProperties:i,containerRef:o}=e;return(0,l.jsx)("div",{className:"relative h-full w-full",children:t&&t.length>0?t.map(e=>(0,l.jsx)(eG,{issueIds:t,issueId:e,issuesMap:s,updateIssue:n,quickActions:r,canEditProperties:i,displayProperties:a,nestingLevel:0,spacingLeft:0,containerRef:o},"".concat(e))):(0,l.jsx)("div",{className:"bg-custom-background-100 p-3 text-sm text-custom-text-400",children:"No issues"})})};var e3=s(88039),e4=s(47542),e8=s(85409),e6=s(38758),e7=s(42683);let e9=e=>{var t;let{formKey:s,register:r,setFocus:a,projectDetail:i}=e;return(0,n.useEffect)(()=>{a(s)},[s,a]),(0,l.jsxs)("div",{className:"flex w-full items-center gap-3",children:[(0,l.jsx)("div",{className:"text-xs font-medium text-custom-text-400",children:null!==(t=null==i?void 0:i.identifier)&&void 0!==t?t:"..."}),(0,l.jsx)("input",{type:"text",autoComplete:"off",placeholder:"Issue Title",...r(s,{required:"Issue title is required."}),className:"w-full rounded-md bg-transparent px-2 py-3 text-sm font-medium leading-5 text-custom-text-200 outline-none"})]})},te={name:""},tt=(0,r.Pi)(e=>{var t;let{prePopulatedData:s,quickAddCallback:r,viewId:a}=e,i=(0,G.useRouter)(),{workspaceSlug:o,projectId:c}=i.query,{getProjectById:d}=(0,y.PY)(),{captureIssueEvent:u}=(0,y.DN)(),m=c&&d(c.toString())||void 0,h=(0,n.useRef)(null),[p,x]=(0,n.useState)(!1),f=()=>x(!1);(0,e6.Z)("Escape",f),(0,e7.Z)(h,f);let{reset:v,handleSubmit:g,setFocus:j,register:w,formState:{errors:N,isSubmitting:k}}=(0,e3.cI)({defaultValues:te});(0,n.useEffect)(()=>{p||v({...te})},[p,v]);let C=async e=>{if(k||!o||!c)return;v({...te});let t=(0,e8.vd)(c.toString(),{...null!=s?s:{},...e});if(r){let e=r(o.toString(),c.toString(),{...t},a);(0,b.uW)(e,{loading:"Adding issue...",success:{title:"Success!",message:()=>"Issue created successfully."},error:{title:"Error!",message:e=>(null==e?void 0:e.message)||"Some error occurred. Please try again."}}),await e.then(e=>{u({eventName:el.lc,payload:{...e,state:"SUCCESS",element:"List quick add"},path:i.asPath})}).catch(()=>{u({eventName:el.lc,payload:{...t,state:"FAILED",element:"List quick add"},path:i.asPath})})}};return(0,l.jsx)("div",{className:"border-b border-t border-custom-border-200 bg-custom-background-100 ".concat(N&&(null==N?void 0:N.name)&&(null==N?void 0:null===(t=N.name)||void 0===t?void 0:t.message)?"border-red-500 bg-red-500/10":""),children:p?(0,l.jsxs)("div",{className:"shadow-custom-shadow-sm",children:[(0,l.jsx)("form",{ref:h,onSubmit:g(C),className:"flex w-full items-center gap-x-3 border-[0.5px] border-t-0 border-custom-border-100 bg-custom-background-100 px-3",children:(0,l.jsx)(e9,{formKey:"name",register:w,setFocus:j,projectDetail:null!=m?m:null})}),(0,l.jsx)("div",{className:"px-3 py-2 text-xs italic text-custom-text-200",children:"Press 'Enter' to add another issue"})]}):(0,l.jsxs)("div",{className:"flex w-full cursor-pointer items-center gap-2 p-3 py-3 text-custom-primary-100",onClick:()=>x(!0),children:[(0,l.jsx)(e4.Z,{className:"h-3.5 w-3.5 stroke-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-custom-primary-100",children:"New Issue"})]})})});var ts=s(65894),tl=s(34220);let tn=(0,r.Pi)(e=>{var t,s,r,a;let{issuesFilterStore:i}=e,o=(0,y.XU)(),c=null!==(a=null===(r=i.issueFilters)||void 0===r?void 0:null===(s=r.displayFilters)||void 0===s?void 0:null===(t=s.calendar)||void 0===t?void 0:t.layout)&&void 0!==a?a:"month",[d,u]=(0,n.useState)(null),[m,h]=(0,n.useState)(null),{styles:p,attributes:x}=(0,U.D)(d,m,{placement:"auto",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),{activeMonthDate:f}=o.calendarFilters,v=e=>{o.updateCalendarFilters({activeMonthDate:e})};return(0,l.jsxs)(V.J,{className:"relative",children:[(0,l.jsx)(V.J.Button,{as:n.Fragment,children:(0,l.jsx)("button",{type:"button",ref:u,className:"text-xl font-semibold outline-none",disabled:"week"===c,children:"month"===c?"".concat(tl.fW[f.getMonth()+1].title," ").concat(f.getFullYear()):(()=>{let e=o.allDaysOfActiveWeek;if(!e)return"Week view";let t=Object.keys(e),s=(0,ex._3)(t[0]),l=(0,ex._3)(t[t.length-1]);return s&&l?s.getMonth()===l.getMonth()&&s.getFullYear()===l.getFullYear()?"".concat(tl.fW[s.getMonth()+1].title," ").concat(s.getFullYear()):s.getFullYear()!==l.getFullYear()?"".concat(tl.fW[s.getMonth()+1].shortTitle," ").concat(s.getFullYear()," - ").concat(tl.fW[l.getMonth()+1].shortTitle," ").concat(l.getFullYear()):"".concat(tl.fW[s.getMonth()+1].shortTitle," - ").concat(tl.fW[l.getMonth()+1].shortTitle," ").concat(l.getFullYear()):"Week view"})()})}),(0,l.jsx)(W.u,{as:n.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,l.jsx)(V.J.Panel,{className:"fixed z-50",children:(0,l.jsxs)("div",{ref:h,style:p.popper,...x.popper,className:"w-56 divide-y divide-custom-border-200 rounded border border-custom-border-200 bg-custom-background-100 p-3 shadow-custom-shadow-rg",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 pb-3",children:[(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>{v(new Date(f.getFullYear()-1,f.getMonth(),1))},children:(0,l.jsx)(ts.Z,{size:14})}),(0,l.jsx)("span",{className:"text-xs",children:f.getFullYear()}),(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>{v(new Date(f.getFullYear()+1,f.getMonth(),1))},children:(0,l.jsx)(e$.Z,{size:14})})]}),(0,l.jsx)("div",{className:"grid grid-cols-4 items-stretch justify-items-stretch gap-4 pt-3",children:Object.values(tl.fW).map((e,t)=>(0,l.jsx)("button",{type:"button",className:"rounded py-0.5 text-xs hover:bg-custom-background-80",onClick:()=>{v(new Date(f.getFullYear(),t,1))},children:e.shortTitle},e.shortTitle))})]})})})]})});var tr=s(12248),ta=s(45530);let ti=(0,r.Pi)(e=>{var t,s,r,a,i,d,u,m;let{issuesFilterStore:h,updateFilters:p}=e,{projectId:x}=(0,G.useRouter)().query,f=(0,y.XU)(),[v]=(0,ta.Z)(),[g,j]=(0,n.useState)(null),[w,N]=(0,n.useState)(null),{styles:k,attributes:C}=(0,U.D)(g,w,{placement:"auto",modifiers:[{name:"preventOverflow",options:{padding:12}}]}),S=null!==(u=null===(r=h.issueFilters)||void 0===r?void 0:null===(s=r.displayFilters)||void 0===s?void 0:null===(t=s.calendar)||void 0===t?void 0:t.layout)&&void 0!==u?u:"month",_=null!==(m=null===(d=h.issueFilters)||void 0===d?void 0:null===(i=d.displayFilters)||void 0===i?void 0:null===(a=i.calendar)||void 0===a?void 0:a.show_weekends)&&void 0!==m&&m,I=(e,t)=>{var s,l;x&&p&&(p(x.toString(),o.gc.DISPLAY_FILTERS,{calendar:{...null===(l=h.issueFilters)||void 0===l?void 0:null===(s=l.displayFilters)||void 0===s?void 0:s.calendar,layout:e}}),f.updateCalendarPayload("month"===e?f.calendarFilters.activeMonthDate:f.calendarFilters.activeWeekDate),v<=768&&t())},E=()=>{var e,t,s,l,n,r;let a=null!==(r=null===(s=h.issueFilters)||void 0===s?void 0:null===(t=s.displayFilters)||void 0===t?void 0:null===(e=t.calendar)||void 0===e?void 0:e.show_weekends)&&void 0!==r&&r;x&&p&&p(x.toString(),o.gc.DISPLAY_FILTERS,{calendar:{...null===(n=h.issueFilters)||void 0===n?void 0:null===(l=n.displayFilters)||void 0===l?void 0:l.calendar,show_weekends:!a}})};return(0,l.jsx)(V.J,{className:"relative flex items-center",children:e=>{let{open:t,close:s}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(V.J.Button,{as:n.Fragment,children:(0,l.jsxs)("button",{type:"button",ref:j,children:[(0,l.jsxs)("div",{className:"hidden md:flex items-center gap-1.5 rounded bg-custom-background-80 px-2.5 py-1 text-xs outline-none hover:bg-custom-background-80 ".concat(t?"text-custom-text-100":"text-custom-text-200"),children:[(0,l.jsx)("div",{className:"font-medium",children:"Options"}),(0,l.jsx)("div",{className:"flex h-3.5 w-3.5 items-center justify-center transition-all ".concat(t?"":"rotate-180"),children:(0,l.jsx)(c.Z,{width:12,strokeWidth:2})})]}),(0,l.jsx)("div",{className:"md:hidden",children:(0,l.jsx)(tr.Z,{className:"h-4 text-custom-text-200",strokeWidth:2})})]})}),(0,l.jsx)(W.u,{as:n.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,l.jsx)(V.J.Panel,{className:"fixed z-50",children:(0,l.jsx)("div",{ref:N,style:k.popper,...C.popper,className:"absolute right-0 z-10 mt-1 min-w-[12rem] overflow-hidden rounded border border-custom-border-200 bg-custom-background-100 p-1 shadow-custom-shadow-sm",children:(0,l.jsxs)("div",{children:[Object.entries(tl.oW).map(e=>{let[t,n]=e;return(0,l.jsxs)("button",{type:"button",className:"flex w-full items-center justify-between gap-2 rounded px-1 py-1.5 text-left text-xs hover:bg-custom-background-80",onClick:()=>I(n.key,s),children:[n.title,S===t&&(0,l.jsx)(Y.Z,{size:12,strokeWidth:2})]},t)}),(0,l.jsxs)("button",{type:"button",className:"flex w-full items-center justify-between gap-2 rounded px-1 py-1.5 text-left text-xs hover:bg-custom-background-80",onClick:E,children:["Show weekends",(0,l.jsx)(b.Zh,{value:_,onChange:()=>{v<=768&&s()}})]})]})})})})]})}})});var to=s(54533);let tc=async(e,t,s,l,n,r,a)=>{if(!n||!r||!s||!l||!a)return;let i=(null==e?void 0:e.droppableId)||null,o=(null==t?void 0:t.droppableId)||null;if(s&&l&&i&&o&&i!==o&&i!=o){let[t]=(r[i]||[]).splice(e.index,1),s=n[t],c={id:null==s?void 0:s.id,target_date:o};return await a(l,c.id,c)}},td=(0,r.Pi)(e=>{var t,s,n,r,i;let{QuickActions:o,storeType:c,addIssuesToView:d,viewId:u,isCompletedCycle:m=!1}=e,{workspaceSlug:h,projectId:p}=(0,G.useRouter)().query,{membership:{currentProjectRole:x}}=(0,y.aF)(),{issues:f,issuesFilter:v,issueMap:g}=(0,y.gk)(c),{updateIssue:j,removeIssue:w,removeIssueFromView:N,archiveIssue:k,restoreIssue:C,updateFilters:S}=(0,eB.C)(c),_=!!x&&x>=eo.MC.MEMBER,I=null===(t=v.issueFilters)||void 0===t?void 0:t.displayFilters,E=null!==(r=f.groupedIssueIds)&&void 0!==r?r:{},P=async e=>{e&&e.destination&&e.destination.droppableId!==e.source.droppableId&&tc&&await tc(e.source,e.destination,null==h?void 0:h.toString(),null==p?void 0:p.toString(),g,E,j).catch(e=>{var t;(0,b.fz)({title:"Error!",type:b.do.ERROR,message:null!==(t=null==e?void 0:e.detail)&&void 0!==t?t:"Failed to perform this action"})})};return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"h-full w-full overflow-hidden bg-custom-background-100 pt-4",children:(0,l.jsx)(to.Z5,{onDragEnd:P,children:(0,l.jsx)(a.JKi,{issuesFilterStore:v,issues:g,groupedIssueIds:E,layout:null==I?void 0:null===(s=I.calendar)||void 0===s?void 0:s.layout,showWeekends:null!==(i=null==I?void 0:null===(n=I.calendar)||void 0===n?void 0:n.show_weekends)&&void 0!==i&&i,quickActions:e=>{let{issue:t,parentRef:s,customActionButton:n,placement:r}=e;return(0,l.jsx)(o,{parentRef:s,customActionButton:n,issue:t,handleDelete:async()=>w(t.project_id,t.id),handleUpdate:async e=>j&&j(t.project_id,t.id,e),handleRemoveFromView:async()=>N&&N(t.project_id,t.id),handleArchive:async()=>k&&k(t.project_id,t.id),handleRestore:async()=>C&&C(t.project_id,t.id),readOnly:!_||m,placements:r})},addIssuesToView:d,quickAddCallback:f.quickAddIssue,viewId:u,readOnly:!_||m,updateFilters:S})})})})}),tu=(0,r.Pi)(()=>{let{currentProjectCompletedCycleIds:e}=(0,y.nv)(),{workspaceSlug:t,projectId:s,cycleId:r}=(0,G.useRouter)().query,{issues:i}=(0,y.gk)(o.rS.CYCLE);if(!r)return null;let c=!!r&&!!e&&e.includes(r.toString()),d=(0,n.useCallback)(e=>{if(!t||!s||!r)throw Error();return i.addIssueToCycle(t.toString(),s.toString(),r.toString(),e)},[null==i?void 0:i.addIssueToCycle,t,s,r]);return(0,l.jsx)(td,{QuickActions:a.JWn,addIssuesToView:d,viewId:r.toString(),isCompletedCycle:c,storeType:o.rS.CYCLE})}),tm=(0,r.Pi)(()=>{let{workspaceSlug:e,projectId:t,moduleId:s}=(0,G.useRouter)().query,{issues:r}=(0,y.gk)(o.rS.MODULE);if(!s)return null;let i=(0,n.useCallback)(l=>{if(!e||!t||!s)throw Error();return r.addIssuesToModule(e.toString(),t.toString(),s.toString(),l)},[null==r?void 0:r.addIssuesToModule,e,t,s]);return(0,l.jsx)(td,{QuickActions:a.PFz,storeType:o.rS.MODULE,addIssuesToView:i,viewId:s.toString()})}),th=(0,r.Pi)(()=>{let{viewId:e}=(0,G.useRouter)().query;return(0,l.jsx)(td,{QuickActions:a.naC,viewId:null==e?void 0:e.toString(),storeType:o.rS.PROJECT_VIEW})}),tp=(0,r.Pi)(()=>(0,l.jsx)(td,{QuickActions:a.naC,storeType:o.rS.PROJECT}));var tx=s(2981);let tf=(0,r.Pi)(e=>{var t;let{issuesFilterStore:s,issues:r,groupedIssueIds:i,layout:c,showWeekends:d,quickActions:u,quickAddCallback:m,addIssuesToView:h,viewId:p,updateFilters:x,readOnly:f=!1}=e,[v,g]=(0,n.useState)(new Date),{issues:{viewFlags:j}}=(0,y.gk)(o.rS.PROJECT),w=(0,tx.X)(),{membership:{currentProjectRole:N}}=(0,y.aF)(),[k]=(0,ta.Z)(),{enableIssueCreation:C}=j||{},S=!!N&&N>=eo.MC.MEMBER,_=w.calendarPayload,I=w.allWeeksOfActiveMonth,E=null!==(t=(0,ex.ss)(v))&&void 0!==t?t:void 0;if(!_||!E)return(0,l.jsx)("div",{className:"grid h-full w-full place-items-center",children:(0,l.jsx)(b.$j,{})});let P=i?i[E]:null;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex h-full w-full flex-col overflow-hidden",children:[(0,l.jsx)(a.vlV,{setSelectedDate:g,issuesFilterStore:s,updateFilters:x}),(0,l.jsxs)("div",{className:(0,e1.cn)("flex md:h-full w-full flex-col overflow-y-auto",{"vertical-scrollbar scrollbar-lg":k>768}),children:[(0,l.jsx)(a.Aod,{isLoading:!r,showWeekends:d}),(0,l.jsxs)("div",{className:"h-full w-full",children:["month"===c&&(0,l.jsx)("div",{className:"grid h-full w-full grid-cols-1 divide-y-[0.5px] divide-custom-border-200",children:I&&Object.values(I).map((e,t)=>(0,l.jsx)(a.Slh,{selectedDate:v,setSelectedDate:g,issuesFilterStore:s,week:e,issues:r,groupedIssueIds:i,enableQuickIssueCreate:!0,disableIssueCreation:!C||!S,quickActions:u,quickAddCallback:m,addIssuesToView:h,viewId:p,readOnly:f},t))}),"week"===c&&(0,l.jsx)(a.Slh,{selectedDate:v,setSelectedDate:g,issuesFilterStore:s,week:w.allDaysOfActiveWeek,issues:r,groupedIssueIds:i,enableQuickIssueCreate:!0,disableIssueCreation:!C||!S,quickActions:u,quickAddCallback:m,addIssuesToView:h,viewId:p,readOnly:f})]}),(0,l.jsxs)("div",{className:"md:hidden",children:[(0,l.jsx)("p",{className:"p-4 text-xl font-semibold",children:"".concat(v.getDate()," ").concat(tl.fW[v.getMonth()+1].title,", ").concat(v.getFullYear())}),(0,l.jsx)(a.oqf,{date:v,issues:r,issueIdList:P,quickActions:u,enableQuickIssueCreate:!0,disableIssueCreation:!C||!S,quickAddCallback:m,addIssuesToView:h,viewId:p,readOnly:f,isDragDisabled:!0,isMobileView:!0})]})]})]})})}),tv=(0,r.Pi)(e=>{var t,s,n,r,i;let{issuesFilterStore:o,date:c,issues:d,groupedIssueIds:u,quickActions:m,enableQuickIssueCreate:h,disableIssueCreation:p,quickAddCallback:x,addIssuesToView:f,viewId:v,readOnly:g=!1,selectedDate:j,setSelectedDate:b}=e,y=null!==(r=null==o?void 0:null===(n=o.issueFilters)||void 0===n?void 0:null===(s=n.displayFilters)||void 0===s?void 0:null===(t=s.calendar)||void 0===t?void 0:t.layout)&&void 0!==r?r:"month",w=(0,ex.ss)(c.date);if(!w)return null;let N=u?u[w]:null,k=null!==(i=null==N?void 0:N.length)&&void 0!==i?i:0,C=c.date.toDateString()===new Date().toDateString(),S=c.date.toDateString()==j.toDateString();return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"group relative flex h-full w-full flex-col bg-custom-background-90",children:[(0,l.jsxs)("div",{className:"hidden md:flex items-center justify-end flex-shrink-0 px-2 py-1.5 text-right text-xs ".concat("month"===y?c.is_current_month?"font-medium":"text-custom-text-300":"font-medium"," ").concat(0===c.date.getDay()||6===c.date.getDay()?"bg-custom-background-90":"bg-custom-background-100"," "),children:[1===c.date.getDate()&&tl.fW[c.date.getMonth()+1].shortTitle+" ",C?(0,l.jsx)("span",{className:"flex items-center justify-center h-5 w-5 rounded-full bg-custom-primary-100 text-white",children:c.date.getDate()}):(0,l.jsx)(l.Fragment,{children:c.date.getDate()})]}),(0,l.jsx)("div",{className:"h-full w-full hidden md:block",children:(0,l.jsx)(to.bK,{droppableId:w,isDropDisabled:g,children:(e,t)=>(0,l.jsxs)("div",{className:"h-full w-full select-none ".concat(t.isDraggingOver||0===c.date.getDay()||6===c.date.getDay()?"bg-custom-background-90":"bg-custom-background-100"," ").concat("month"===y?"min-h-[5rem]":""),...e.droppableProps,ref:e.innerRef,children:[(0,l.jsx)(a.oqf,{date:c.date,issues:d,issueIdList:N,quickActions:m,isDragDisabled:g,addIssuesToView:f,disableIssueCreation:p,enableQuickIssueCreate:h,quickAddCallback:x,viewId:v,readOnly:g}),e.placeholder]})})}),(0,l.jsxs)("div",{onClick:()=>b(c.date),className:(0,e1.cn)("text-sm py-2.5 h-full w-full font-medium mx-auto flex flex-col justify-start items-center md:hidden cursor-pointer",{"bg-custom-background-100":0!==c.date.getDay()&&6!==c.date.getDay()}),children:[(0,l.jsx)("div",{className:(0,e1.cn)("h-6 w-6  rounded-full flex items-center justify-center ",{"bg-custom-primary-100 text-white":S,"bg-custom-primary-100/10 text-custom-primary-100 ":C&&!S}),children:c.date.getDate()}),k>0&&(0,l.jsx)("div",{className:"flex flex-shrink-0 h-1.5 w-1.5 bg-custom-primary-100 rounded mt-1"})]})]})})}),tg=(0,r.Pi)(e=>{var t,s,n,r;let{issuesFilterStore:i,updateFilters:o,setSelectedDate:c}=e,d=(0,tx.X)(),u=null!==(r=null===(n=i.issueFilters)||void 0===n?void 0:null===(s=n.displayFilters)||void 0===s?void 0:null===(t=s.calendar)||void 0===t?void 0:t.layout)&&void 0!==r?r:"month",{activeMonthDate:m,activeWeekDate:h}=d.calendarFilters;return(0,l.jsxs)("div",{className:"mb-4 flex items-center justify-between gap-2 px-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>{if("month"===u){let e=new Date(0===m.getMonth()?m.getFullYear()-1:m.getFullYear(),0===m.getMonth()?11:m.getMonth()-1,1);d.updateCalendarFilters({activeMonthDate:e})}else{let e=new Date(h.getFullYear(),h.getMonth(),h.getDate()-7);d.updateCalendarFilters({activeWeekDate:e})}},children:(0,l.jsx)(ts.Z,{size:16,strokeWidth:2})}),(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>{if("month"===u){let e=new Date(11===m.getMonth()?m.getFullYear()+1:m.getFullYear(),(m.getMonth()+1)%12,1);d.updateCalendarFilters({activeMonthDate:e})}else{let e=new Date(h.getFullYear(),h.getMonth(),h.getDate()+7);d.updateCalendarFilters({activeWeekDate:e})}},children:(0,l.jsx)(e$.Z,{size:16,strokeWidth:2})}),(0,l.jsx)(a.VCE,{issuesFilterStore:i})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,l.jsx)("button",{type:"button",className:"rounded bg-custom-background-80 px-2.5 py-1 text-xs font-medium text-custom-text-200 hover:text-custom-text-100",onClick:()=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1);d.updateCalendarFilters({activeMonthDate:t,activeWeekDate:e}),c(e)},children:"Today"}),(0,l.jsx)(a.wES,{issuesFilterStore:i,updateFilters:o})]})]})}),tj=(0,r.Pi)(e=>{var t;let{date:s,issues:r,issueIdList:i,quickActions:o,isDragDisabled:c=!1,enableQuickIssueCreate:d,disableIssueCreation:u,quickAddCallback:m,addIssuesToView:h,viewId:p,readOnly:x,isMobileView:f=!1}=e,[v,g]=(0,n.useState)(!1),j=(0,ex.ss)(s),b=null!==(t=null==i?void 0:i.length)&&void 0!==t?t:0;return j?(0,l.jsxs)(l.Fragment,{children:[null==i?void 0:i.slice(0,v||f?i.length:4).map((e,t)=>f?(0,l.jsx)(a.Hbl,{issues:r,issueId:e,quickActions:o},e):(0,l.jsx)(to._l,{draggableId:e,index:t,isDragDisabled:c,children:(t,s)=>(0,l.jsx)("div",{className:"relative cursor-pointer p-1 px-2",...t.draggableProps,...t.dragHandleProps,ref:t.innerRef,children:(0,l.jsx)(a.Hbl,{issues:r,issueId:e,quickActions:o,isDragging:s.isDragging})})},e)),d&&!u&&!x&&(0,l.jsx)("div",{className:"px-1 md:px-2 py-1 border-custom-border-200 border-b md:border-none",children:(0,l.jsx)(a.qkP,{formKey:"target_date",groupId:j,prePopulatedData:{target_date:j},quickAddCallback:m,addIssuesToView:h,viewId:p,onOpen:()=>g(!0)})}),b>4&&(0,l.jsx)("div",{className:"hidden md:flex items-center px-2.5 py-1",children:(0,l.jsx)("button",{type:"button",className:"w-min whitespace-nowrap rounded text-xs px-1.5 py-1 text-custom-text-400 font-medium  hover:bg-custom-background-80 hover:text-custom-text-300",onClick:()=>g(!v),children:v?"Hide":b-4+" more"})})]}):null}),tb=e=>{let{issues:t,issueId:s,quickActions:n,isDragging:r}=e;if(!(null==t?void 0:t[s]))return null;let i=null==t?void 0:t[s];return(0,l.jsx)(a.m0y,{isDragging:r,issue:i,quickActions:n})};var ty=s(67522);let tw=(0,I.Pi)(e=>{var t,s,r;let{issue:a,quickActions:i,isDragging:o=!1}=e,[c,d]=(0,n.useState)(!1),u=(0,n.useRef)(null),m=(0,n.useRef)(null),{router:{workspaceSlug:h,projectId:p}}=(0,y.IX)(),{getProjectIdentifierById:x}=(0,y.PY)(),{getProjectStates:f}=(0,y.eD)(),{getIsIssuePeeked:v,setPeekIssue:g}=(0,y.p1)(),{isMobile:j}=(0,H.L)(),w=(null===(s=f(null==a?void 0:a.project_id))||void 0===s?void 0:null===(t=s.find(e=>(null==e?void 0:e.id)==(null==a?void 0:a.state_id)))||void 0===t?void 0:t.color)||"",N=e=>h&&e&&e.project_id&&e.id&&!v(e.id)&&g({workspaceSlug:h,projectId:e.project_id,issueId:e.id});(0,e7.Z)(m,()=>d(!1));let k=(0,l.jsx)("div",{ref:m,className:"w-full cursor-pointer rounded p-1 text-custom-sidebar-text-400 hover:bg-custom-background-80 ".concat(c?"bg-custom-background-80 text-custom-text-100":"text-custom-text-200"),onClick:()=>d(!c),children:(0,l.jsx)(ty.Z,{className:"h-3.5 w-3.5"})}),C=(null==m?void 0:m.current)&&(null==m?void 0:null===(r=m.current)||void 0===r?void 0:r.getBoundingClientRect().bottom)<window.innerHeight-220;return(0,l.jsx)(b.Ug,{id:"issue-".concat(a.id),href:"/".concat(h,"/projects/").concat(p,"/issues/").concat(a.id),target:"_blank",onClick:()=>N(a),className:"w-full cursor-pointer text-sm text-custom-text-100",disabled:!!(null==a?void 0:a.tempId),children:(0,l.jsxs)(l.Fragment,{children:[(null==a?void 0:a.tempId)!==void 0&&(0,l.jsx)("div",{className:"absolute left-0 top-0 z-[99999] h-full w-full animate-pulse bg-custom-background-100/20"}),(0,l.jsxs)("div",{ref:u,className:(0,e1.cn)("group/calendar-block flex h-10 md:h-8 w-full items-center justify-between gap-1.5 rounded border-b md:border-[0.5px] border-custom-border-200 hover:border-custom-border-400 md:px-1 px-4 py-1.5 ",{"bg-custom-background-90 shadow-custom-shadow-rg border-custom-primary-100":o,"bg-custom-background-100 hover:bg-custom-background-90":!o,"border border-custom-primary-70 hover:border-custom-primary-70":v(a.id)}),children:[(0,l.jsxs)("div",{className:"flex h-full items-center gap-1.5 truncate",children:[(0,l.jsx)("span",{className:"h-full w-0.5 flex-shrink-0 rounded",style:{backgroundColor:w}}),(0,l.jsxs)("div",{className:"flex-shrink-0 text-sm md:text-xs text-custom-text-300",children:[x(null==a?void 0:a.project_id),"-",a.sequence_id]}),(0,l.jsx)(b.u,{tooltipContent:a.name,isMobile:j,children:(0,l.jsx)("div",{className:"truncate text-sm font-medium md:font-normal md:text-xs",children:a.name})})]}),(0,l.jsx)("div",{className:"flex-shrink-0 md:hidden h-5 w-5 group-hover/calendar-block:block ".concat(c?"!block":""),onClick:e=>{e.preventDefault(),e.stopPropagation()},children:i({issue:a,parentRef:u,customActionButton:k,placement:C?"bottom-end":"top-end"})})]})]})})}),tN=(0,r.Pi)(e=>{var t,s,n,r,i,o,c,d;let{issuesFilterStore:u,issues:m,groupedIssueIds:h,week:p,quickActions:x,enableQuickIssueCreate:f,disableIssueCreation:v,quickAddCallback:g,addIssuesToView:j,viewId:b,readOnly:y=!1,selectedDate:w,setSelectedDate:N}=e,k=null!==(c=null==u?void 0:null===(n=u.issueFilters)||void 0===n?void 0:null===(s=n.displayFilters)||void 0===s?void 0:null===(t=s.calendar)||void 0===t?void 0:t.layout)&&void 0!==c?c:"month",C=null!==(d=null==u?void 0:null===(o=u.issueFilters)||void 0===o?void 0:null===(i=o.displayFilters)||void 0===i?void 0:null===(r=i.calendar)||void 0===r?void 0:r.show_weekends)&&void 0!==d&&d;return p?(0,l.jsx)("div",{className:"grid md:divide-x-[0.5px] divide-custom-border-200 ".concat(C?"grid-cols-7":"grid-cols-5"," ").concat("month"===k?"":"h-full"),children:Object.values(p).map(e=>C||0!==e.date.getDay()&&6!==e.date.getDay()?(0,l.jsx)(a.ccE,{selectedDate:w,setSelectedDate:N,issuesFilterStore:u,date:e,issues:m,groupedIssueIds:h,quickActions:x,enableQuickIssueCreate:f,disableIssueCreation:v,quickAddCallback:g,addIssuesToView:j,viewId:b,readOnly:y},(0,ex.ss)(e.date)):null)}):null}),tk=(0,r.Pi)(e=>{let{isLoading:t,showWeekends:s}=e;return(0,l.jsxs)("div",{className:"relative sticky top-0 z-[1] grid md:divide-x-[0.5px] divide-custom-border-200 text-sm font-medium ".concat(s?"grid-cols-7":"grid-cols-5"),children:[t&&(0,l.jsx)("div",{className:"absolute h-[1.5px] w-3/4 animate-[bar-loader_2s_linear_infinite] bg-custom-primary-100"}),Object.values(tl.eS).map(e=>s||"Sat"!==e.shortTitle&&"Sun"!==e.shortTitle?(0,l.jsx)("div",{className:"flex h-11 items-center justify-center md:justify-end bg-custom-background-90 px-4",children:e.shortTitle},e.shortTitle):null)]})}),tC={name:""},tS=e=>{var t;let{register:s,setFocus:r,projectDetails:a}=e;return(0,n.useEffect)(()=>{r("name")},[r]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h4",{className:"text-sm md:text-xs leading-5 text-custom-text-400",children:null!==(t=null==a?void 0:a.identifier)&&void 0!==t?t:"..."}),(0,l.jsx)("input",{type:"text",autoComplete:"off",placeholder:"Issue Title",...s("name",{required:"Issue title is required."}),className:"w-full rounded-md bg-transparent py-1.5 pr-2 text-sm md:text-xs font-medium leading-5 text-custom-text-200 outline-none"})]})},t_=(0,r.Pi)(e=>{let{formKey:t,prePopulatedData:s,quickAddCallback:r,addIssuesToView:a,viewId:i,onOpen:o}=e,c=(0,G.useRouter)(),{workspaceSlug:d,projectId:u,moduleId:m}=c.query,{getProjectById:h}=(0,y.PY)(),{captureIssueEvent:p}=(0,y.DN)(),{updateIssue:x}=(0,y.p1)(),f=(0,n.useRef)(null),[v,g]=(0,n.useState)(!1),[j,w]=(0,n.useState)(!1),[N,k]=(0,n.useState)(!1),C=u?h(u.toString()):null,S=a?m?{module:m.toString(),target_date:"none"}:{cycle:!0,target_date:"none"}:{target_date:"none"},{reset:_,handleSubmit:I,register:E,setFocus:P,formState:{errors:R,isSubmitting:F}}=(0,e3.cI)({defaultValues:tC}),O=()=>{g(!1)};(0,e6.Z)("Escape",O),(0,e7.Z)(f,O),(0,n.useEffect)(()=>{v||_({...tC})},[v,_]),(0,n.useEffect)(()=>{R&&Object.keys(R).forEach(e=>{var t;let s=R[e];(0,b.fz)({type:b.do.ERROR,title:"Error!",message:(null==s?void 0:null===(t=s.message)||void 0===t?void 0:t.toString())||"Some error occurred. Please try again."})})},[R]);let A=async e=>{if(F||!d||!u)return;_({...tC});let t=(0,e8.vd)(u.toString(),{...null!=s?s:{},...e});if(r){let e=r(d.toString(),u.toString(),{...t},i);(0,b.uW)(e,{loading:"Adding issue...",success:{title:"Success!",message:()=>"Issue created successfully."},error:{title:"Error!",message:e=>(null==e?void 0:e.message)||"Some error occurred. Please try again."}}),await e.then(e=>{p({eventName:el.lc,payload:{...e,state:"SUCCESS",element:"Calendar quick add"},path:c.asPath})}).catch(()=>{p({eventName:el.lc,payload:{...t,state:"FAILED",element:"Calendar quick add"},path:c.asPath})})}},D=async e=>{if(!d||!u)return;let t=e.map(e=>e.id);try{await Promise.all(e.map(e=>x(d.toString(),u.toString(),e.id,null!=s?s:{}))),a&&await a(t)}catch(e){(0,b.fz)({type:b.do.ERROR,title:"Error!",message:"Something went wrong. Please try again."})}};return(0,l.jsxs)(l.Fragment,{children:[d&&u&&(0,l.jsx)(T.H2,{workspaceSlug:d.toString(),projectId:u.toString(),isOpen:N,handleClose:()=>k(!1),searchParams:S,handleOnSubmit:D}),v&&(0,l.jsx)("div",{ref:f,className:"z-20 w-full transition-all ".concat(v?"scale-100 opacity-100":"pointer-events-none scale-95 opacity-0"),children:(0,l.jsx)("form",{onSubmit:I(A),className:"z-50 flex w-full items-center gap-x-2 rounded md:border-[0.5px] border-custom-border-200 bg-custom-background-100 px-2 md:shadow-custom-shadow-2xs transition-opacity",children:(0,l.jsx)(tS,{formKey:t,register:E,setFocus:P,projectDetails:C})})}),!v&&(0,l.jsx)("div",{className:(0,e1.cn)("md:opacity-0 rounded md:border-[0.5px] border-custom-border-200 md:group-hover:opacity-100",{block:j}),children:(0,l.jsxs)(b.fR,{placement:"bottom-start",menuButtonOnClick:()=>w(!0),onMenuClose:()=>w(!1),className:"w-full",customButtonClassName:"w-full",customButton:(0,l.jsxs)("div",{className:"flex w-full items-center gap-x-[6px] rounded-md px-2 py-1.5 text-custom-primary-100",children:[(0,l.jsx)(e4.Z,{className:"h-3.5 w-3.5 stroke-2 flex-shrink-0"}),(0,l.jsx)("span",{className:"text-sm font-medium flex-shrink-0 text-custom-primary-100",children:"New Issue"})]}),children:[(0,l.jsx)(b.fR.MenuItem,{onClick:()=>{g(!0),o&&o()},children:"New Issue"}),(0,l.jsx)(b.fR.MenuItem,{onClick:()=>{k(!0)},children:"Add existing issue"})]})})]})}),tI=(0,I.Pi)(e=>{var t,s,n;let{issueId:r}=e,{router:{workspaceSlug:a}}=(0,y.IX)(),{getProjectStates:i}=(0,y.eD)(),{issue:{getIssueById:o},getIsIssuePeeked:c,setPeekIssue:d}=(0,y.p1)(),u=o(r),m=u&&(null===(t=i(null==u?void 0:u.project_id))||void 0===t?void 0:t.find(e=>(null==e?void 0:e.id)==(null==u?void 0:u.state_id))),{isMobile:h}=(0,H.L)();return(0,l.jsxs)("div",{id:"issue-".concat(r),className:"relative flex h-full w-full cursor-pointer items-center rounded",style:{backgroundColor:null==m?void 0:m.color},onClick:()=>a&&u&&!u.tempId&&!c(u.id)&&d({workspaceSlug:a,projectId:u.project_id,issueId:u.id}),children:[(0,l.jsx)("div",{className:"absolute left-0 top-0 h-full w-full bg-custom-background-100/50"}),(0,l.jsx)(b.u,{isMobile:h,tooltipContent:(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("h5",{children:null==u?void 0:u.name}),(0,l.jsxs)("div",{children:[(0,ex.ot)(null!==(s=null==u?void 0:u.start_date)&&void 0!==s?s:"")," to"," ",(0,ex.ot)(null!==(n=null==u?void 0:u.target_date)&&void 0!==n?n:"")]})]}),position:"top-left",children:(0,l.jsx)("div",{className:"relative w-full truncate px-2.5 py-1 text-sm text-custom-text-100 overflow-hidden",children:null==u?void 0:u.name})})]})}),tE=(0,I.Pi)(e=>{let{issueId:t}=e,{getStateById:s}=(0,y.eD)(),{getProjectIdentifierById:n}=(0,y.PY)(),{router:{workspaceSlug:r}}=(0,y.IX)(),{issue:{getIssueById:a},setPeekIssue:i}=(0,y.p1)(),o=a(t),c=o&&n(null==o?void 0:o.project_id),d=o&&s(null==o?void 0:o.state_id),{isMobile:u}=(0,H.L)();return(0,l.jsx)(b.Ug,{href:"/".concat(r,"/projects/").concat(null==o?void 0:o.project_id,"/issues/").concat(null==o?void 0:o.id),target:"_blank",onClick:()=>r&&o&&i({workspaceSlug:r,projectId:o.project_id,issueId:o.id}),className:"w-full line-clamp-1 cursor-pointer text-sm text-custom-text-100",disabled:!!(null==o?void 0:o.tempId),children:(0,l.jsxs)("div",{className:"relative flex h-full w-full cursor-pointer items-center gap-2",children:[d&&(0,l.jsx)(b.b_,{stateGroup:null==d?void 0:d.group,color:null==d?void 0:d.color}),(0,l.jsxs)("div",{className:"flex-shrink-0 text-xs text-custom-text-300",children:[c," ",null==o?void 0:o.sequence_id]}),(0,l.jsx)(b.u,{tooltipContent:null==o?void 0:o.name,isMobile:u,children:(0,l.jsx)("span",{className:"flex-grow truncate text-sm font-medium",children:null==o?void 0:o.name})})]})})});var tP=s(95633);let tR=(0,r.Pi)(e=>{var t,s;let{viewId:n,storeType:r}=e,{workspaceSlug:i}=(0,G.useRouter)().query,{issues:o,issuesFilter:c}=(0,y.gk)(r),{updateIssue:d}=(0,eB.C)(r),{membership:{currentProjectRole:u}}=(0,y.aF)(),{issueMap:m}=(0,y.gk)(),h=null===(t=c.issueFilters)||void 0===t?void 0:t.displayFilters,p=null!==(s=o.groupedIssueIds)&&void 0!==s?s:[],{enableIssueCreation:x}=(null==o?void 0:o.viewFlags)||{},f=p.map(e=>null==m?void 0:m[e]),v=async(e,t)=>{if(!i)return;let s={...t};t.sort_order&&(s.sort_order=t.sort_order.newSortOrder),d&&await d(e.project_id,e.id,s)},g=!!u&&u>=eo.MC.MEMBER;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"h-full w-full",children:(0,l.jsx)(tP.TB,{border:!1,title:"Issues",loaderTitle:"Issues",blocks:o?(0,e8.Ws)(f):null,blockUpdateHandler:v,blockToRender:e=>(0,l.jsx)(a.b5H,{issueId:e.id}),sidebarToRender:e=>(0,l.jsx)(tP.AN,{...e,showAllBlocks:!0}),enableBlockLeftResize:g,enableBlockRightResize:g,enableBlockMove:g,enableReorder:(null==h?void 0:h.order_by)==="sort_order"&&g,enableAddBlock:g,quickAdd:x&&g?(0,l.jsx)(a.Koj,{quickAddCallback:o.quickAddIssue,viewId:n}):void 0,showAllBlocks:!0})})})}),tF=(0,r.Pi)(()=>{let{cycleId:e}=(0,G.useRouter)().query;return(0,l.jsx)(tR,{viewId:null==e?void 0:e.toString(),storeType:o.rS.CYCLE})}),tO=e=>{var t;let{formKey:s,register:r,setFocus:a,projectDetail:i}=e;return(0,n.useEffect)(()=>{a(s)},[s,a]),(0,l.jsxs)("div",{className:"flex w-full items-center gap-3",children:[(0,l.jsx)("div",{className:"text-xs font-medium text-custom-text-400",children:null!==(t=null==i?void 0:i.identifier)&&void 0!==t?t:"..."}),(0,l.jsx)("input",{type:"text",autoComplete:"off",placeholder:"Issue Title",...r(s,{required:"Issue title is required."}),className:"w-full rounded-md bg-transparent px-2 py-3 text-sm font-medium leading-5 text-custom-text-200 outline-none"})]})},tT={name:""},tA=(0,r.Pi)(e=>{var t;let{prePopulatedData:s,quickAddCallback:r,viewId:a}=e,i=(0,G.useRouter)(),{workspaceSlug:o,projectId:c}=i.query,{getProjectById:d}=(0,y.PY)(),{captureIssueEvent:u}=(0,y.DN)(),m=c&&d(c.toString())||void 0,h=(0,n.useRef)(null),[p,x]=(0,n.useState)(!1),f=()=>x(!1);(0,e6.Z)("Escape",f),(0,e7.Z)(h,f);let{reset:v,handleSubmit:g,setFocus:j,register:w,formState:{errors:N,isSubmitting:k}}=(0,e3.cI)({defaultValues:tT});(0,n.useEffect)(()=>{p||v({...tT})},[p,v]);let C=async e=>{if(k||!o||!c)return;v({...tT});let t=new Date;t.setDate(t.getDate()+1);let l=(0,e8.vd)(c.toString(),{...null!=s?s:{},...e,start_date:(0,ex.ss)(new Date),target_date:(0,ex.ss)(t)});if(r){let e=r(o.toString(),c.toString(),{...l},a);(0,b.uW)(e,{loading:"Adding issue...",success:{title:"Success!",message:()=>"Issue created successfully."},error:{title:"Error!",message:e=>(null==e?void 0:e.message)||"Some error occurred. Please try again."}}),await e.then(e=>{u({eventName:el.lc,payload:{...e,state:"SUCCESS",element:"Gantt quick add"},path:i.asPath})}).catch(()=>{u({eventName:el.lc,payload:{...l,state:"FAILED",element:"Gantt quick add"},path:i.asPath})})}};return(0,l.jsx)(l.Fragment,{children:p?(0,l.jsx)("div",{className:(0,e1.cn)("sticky bottom-0 z-[1] bg-custom-background-100",{"border border-red-500/20 bg-red-500/10":N&&(null==N?void 0:N.name)&&(null==N?void 0:null===(t=N.name)||void 0===t?void 0:t.message)}),children:(0,l.jsxs)("div",{className:"shadow-custom-shadow-sm",children:[(0,l.jsx)("form",{ref:h,onSubmit:g(C),className:"flex w-full items-center gap-x-3 border-[0.5px] border-custom-border-100 bg-custom-background-100 px-3",children:(0,l.jsx)(tO,{formKey:"name",register:w,setFocus:j,projectDetail:null!=m?m:null})}),(0,l.jsx)("div",{className:"px-3 py-2 text-xs italic text-custom-text-200",children:"Press 'Enter' to add another issue"})]})}):(0,l.jsxs)("button",{type:"button",className:"sticky bottom-0 z-[1] flex w-full cursor-pointer items-center gap-2 border-t-[1px] border-custom-border-200 bg-custom-background-100 px-3 pt-2 text-custom-primary-100",onClick:()=>x(!0),children:[(0,l.jsx)(e4.Z,{className:"h-3.5 w-3.5 stroke-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-custom-primary-100",children:"New Issue"})]})})}),tD=(0,r.Pi)(()=>{let{moduleId:e}=(0,G.useRouter)().query;return(0,l.jsx)(tR,{viewId:null==e?void 0:e.toString(),storeType:o.rS.MODULE})}),tM=(0,r.Pi)(()=>(0,l.jsx)(tR,{storeType:o.rS.PROJECT})),tz=(0,r.Pi)(()=>{let{viewId:e}=(0,G.useRouter)().query;return(0,l.jsx)(tR,{viewId:null==e?void 0:e.toString(),storeType:o.rS.PROJECT_VIEW})});var tL=s(27905),tZ=s(36738);let tq=(0,r.Pi)(e=>{var t;let{issue:s,onChange:n,disabled:r,onClose:a}=e;return(0,l.jsx)("div",{className:"h-11 border-b-[0.5px] border-custom-border-200",children:(0,l.jsx)(tZ.Yp,{value:null!==(t=null==s?void 0:s.assignee_ids)&&void 0!==t?t:[],onChange:e=>{n(s,{assignee_ids:e},{changed_property:"assignees",change_details:e})},projectId:null==s?void 0:s.project_id,disabled:r,multiple:!0,placeholder:"Assignees",buttonVariant:(null==s?void 0:s.assignee_ids)&&s.assignee_ids.length>0?"transparent-without-text":"transparent-with-text",buttonClassName:"text-left",buttonContainerClassName:"w-full",onClose:a})})}),tB=(0,r.Pi)(e=>{let{issue:t}=e;return(0,l.jsxs)("div",{className:"flex h-11 w-full items-center px-2.5 py-1 text-xs border-b-[0.5px] border-custom-border-200 hover:bg-custom-background-80",children:[null==t?void 0:t.attachment_count," ",(null==t?void 0:t.attachment_count)===1?"attachment":"attachments"]})}),tU=(0,r.Pi)(e=>{let{issue:t}=e;return(0,l.jsx)("div",{className:"flex h-11 w-full items-center justify-center text-xs border-b-[0.5px] border-custom-border-200 hover:bg-custom-background-80",children:(0,ex.ot)(t.created_at)})});var tV=s(21219);let tW=(0,r.Pi)(e=>{let{issue:t,onChange:s,disabled:n,onClose:r}=e,{getStateById:a}=(0,y.eD)(),i=a(t.state_id);return(0,l.jsx)("div",{className:"h-11 border-b-[0.5px] border-custom-border-200",children:(0,l.jsx)(tZ.qp,{value:t.target_date,minDate:(0,ex._3)(t.start_date),onChange:e=>{let l=e?(0,ex.ss)(e):null;s(t,{target_date:l},{changed_property:"target_date",change_details:l})},disabled:n,placeholder:"Due date",icon:(0,l.jsx)(tV.Z,{className:"h-3 w-3 flex-shrink-0"}),buttonVariant:"transparent-with-text",buttonContainerClassName:"w-full",buttonClassName:(0,e1.cn)("rounded-none text-left",{"text-red-500":(0,e8.QU)(t.target_date,null==i?void 0:i.group)}),clearIconClassName:"!text-custom-text-100",onClose:r})})}),tK=(0,r.Pi)(e=>{let{issue:t,onChange:s,disabled:n,onClose:r}=e;return(0,l.jsx)("div",{className:"h-11 border-b-[0.5px] border-custom-border-200",children:(0,l.jsx)(tZ.ym,{value:t.estimate_point,onChange:e=>s(t,{estimate_point:e},{changed_property:"estimate_point",change_details:e}),placeholder:"Estimate",projectId:t.project_id,disabled:n,buttonVariant:"transparent-with-text",buttonClassName:"rounded-none text-left",buttonContainerClassName:"w-full",onClose:r})})}),tY=(0,r.Pi)(e=>{var t,s;let{issue:n,onChange:r,disabled:a,onClose:i}=e,{labelMap:o}=(0,y.NP)(),c=(null==n?void 0:null===(t=n.label_ids)||void 0===t?void 0:t.map(e=>o[e]))||[];return(0,l.jsx)(eX.Y,{projectId:null!==(s=n.project_id)&&void 0!==s?s:null,value:n.label_ids,defaultOptions:c,onChange:e=>r(n,{label_ids:e},{changed_property:"labels",change_details:e}),className:"h-11 w-full border-b-[0.5px] border-custom-border-200 hover:bg-custom-background-80",buttonClassName:"px-2.5 h-full",hideDropdownArrow:!0,maxRender:1,disabled:a,placeholderText:"Select labels",onClose:i})}),tJ=(0,r.Pi)(e=>{let{issue:t}=e;return(0,l.jsxs)("div",{className:"flex h-11 w-full items-center px-2.5 py-1 text-xs border-b-[0.5px] border-custom-border-200 hover:bg-custom-background-80",children:[null==t?void 0:t.link_count," ",(null==t?void 0:t.link_count)===1?"link":"links"]})}),tH=(0,r.Pi)(e=>{let{issue:t,onChange:s,disabled:n,onClose:r}=e;return(0,l.jsx)("div",{className:"h-11 border-b-[0.5px] border-custom-border-200",children:(0,l.jsx)(tZ.Iw,{value:t.priority,onChange:e=>s(t,{priority:e},{changed_property:"priority",change_details:e}),disabled:n,buttonVariant:"transparent-with-text",buttonClassName:"rounded-none text-left",buttonContainerClassName:"w-full",onClose:r})})});var tQ=s(41256);let tG=(0,r.Pi)(e=>{let{issue:t,onChange:s,disabled:n,onClose:r}=e;return(0,l.jsx)("div",{className:"h-11 border-b-[0.5px] border-custom-border-200",children:(0,l.jsx)(tZ.qp,{value:t.start_date,maxDate:(0,ex._3)(t.target_date),onChange:e=>{let l=e?(0,ex.ss)(e):null;s(t,{start_date:l},{changed_property:"start_date",change_details:l})},disabled:n,placeholder:"Start date",icon:(0,l.jsx)(tQ.Z,{className:"h-3 w-3 flex-shrink-0"}),buttonVariant:"transparent-with-text",buttonClassName:"rounded-none text-left",buttonContainerClassName:"w-full",onClose:r})})}),t$=(0,r.Pi)(e=>{let{issue:t,onChange:s,disabled:n,onClose:r}=e;return(0,l.jsx)("div",{className:"h-11 border-b-[0.5px] border-custom-border-200",children:(0,l.jsx)(tZ.sb,{projectId:t.project_id,value:t.state_id,onChange:e=>s(t,{state_id:e},{changed_property:"state",change_details:e}),disabled:n,buttonVariant:"transparent-with-text",buttonClassName:"rounded-none text-left",buttonContainerClassName:"w-full",onClose:r})})}),tX=(0,r.Pi)(e=>{let{issue:t}=e,s=(0,G.useRouter)(),{router:{workspaceSlug:n}}=(0,y.IX)();return(0,l.jsxs)("div",{onClick:(null==t?void 0:t.sub_issues_count)?()=>{s.push({pathname:"/".concat(n,"/projects/").concat(t.project_id,"/").concat(t.archived_at?"archives/":"","issues/").concat(t.id),hash:"sub-issues"})}:()=>{},className:(0,e1.cn)("flex h-11 w-full items-center px-2.5 py-1 text-xs border-b-[0.5px] border-custom-border-200 hover:bg-custom-background-80",{"cursor-pointer":null==t?void 0:t.sub_issues_count}),children:[null==t?void 0:t.sub_issues_count," ",(null==t?void 0:t.sub_issues_count)===1?"sub-issue":"sub-issues"]})}),t0=(0,r.Pi)(e=>{let{issue:t}=e;return(0,l.jsx)("div",{className:"flex h-11 w-full items-center justify-center text-xs border-b-[0.5px] border-custom-border-200 hover:bg-custom-background-80",children:(0,ex.ot)(t.updated_at)})});var t1=s(20098),t2=s.n(t1);let t5=(0,r.Pi)(e=>{var t;let s=(0,G.useRouter)(),{workspaceSlug:r}=s.query,{issue:a,disabled:i,onClose:c}=e,{captureIssueEvent:d}=(0,y.DN)(),{issues:{addModulesToIssue:u,removeModulesFromIssue:m}}=(0,y.gk)(o.rS.MODULE),h=(0,n.useCallback)(async e=>{if(!r||!a||!a.module_ids||!e)return;let t=t2()(a.module_ids,e),l=[],n=[];for(let e of t)a.module_ids.includes(e)?n.push(e):l.push(e);l.length>0&&u(r.toString(),a.project_id,a.id,l),n.length>0&&m(r.toString(),a.project_id,a.id,n),d({eventName:"Issue updated",payload:{...a,module_ids:e,element:"Spreadsheet layout"},updates:{changed_property:"module_ids",change_details:{module_ids:e}},path:s.asPath})},[r,a,u,m,d,s.asPath]);return(0,l.jsx)("div",{className:"h-11 border-b-[0.5px] border-custom-border-200",children:(0,l.jsx)(tZ.xL,{projectId:null==a?void 0:a.project_id,value:null!==(t=null==a?void 0:a.module_ids)&&void 0!==t?t:[],onChange:h,disabled:i,placeholder:"Select modules",buttonVariant:"transparent-with-text",buttonContainerClassName:"w-full relative flex items-center p-2",buttonClassName:"relative border-[0.5px] border-custom-border-400 h-4.5",onClose:c,multiple:!0,showCount:!0,showTooltip:!0})})}),t3=(0,r.Pi)(e=>{let t=(0,G.useRouter)(),{workspaceSlug:s}=t.query,{issue:r,disabled:a,onClose:i}=e,{captureIssueEvent:c}=(0,y.DN)(),{issues:{addIssueToCycle:d,removeIssueFromCycle:u}}=(0,y.gk)(o.rS.CYCLE),m=(0,n.useCallback)(async e=>{var l;s&&r&&r.cycle_id!==e&&(e?await d(s.toString(),r.project_id,e,[r.id]):await u(s.toString(),r.project_id,null!==(l=r.cycle_id)&&void 0!==l?l:"",r.id),c({eventName:"Issue updated",payload:{...r,cycle_id:e,element:"Spreadsheet layout"},updates:{changed_property:"cycle",change_details:{cycle_id:e}},path:t.asPath}))},[s,r,d,u,c,t.asPath]);return(0,l.jsx)("div",{className:"h-11 border-b-[0.5px] border-custom-border-200",children:(0,l.jsx)(tZ._X,{projectId:r.project_id,value:r.cycle_id,onChange:m,disabled:a,placeholder:"Select cycle",buttonVariant:"transparent-with-text",buttonContainerClassName:"w-full relative flex items-center p-2",buttonClassName:"relative border-[0.5px] border-custom-border-400 h-4.5",onClose:i})})});var t4=s(17480),t8=s(73470),t6=s(77970),t7=s(49743),t9=s(17789),se=s(95232);let st={assignee:{title:"Assignees",ascendingOrderKey:"assignees__first_name",ascendingOrderTitle:"A",descendingOrderKey:"-assignees__first_name",descendingOrderTitle:"Z",icon:b.Ti,Column:tq},created_on:{title:"Created on",ascendingOrderKey:"-created_at",ascendingOrderTitle:"New",descendingOrderKey:"created_at",descendingOrderTitle:"Old",icon:t4.Z,Column:tU},due_date:{title:"Due date",ascendingOrderKey:"-target_date",ascendingOrderTitle:"New",descendingOrderKey:"target_date",descendingOrderTitle:"Old",icon:tV.Z,Column:tW},estimate:{title:"Estimate",ascendingOrderKey:"estimate_point",ascendingOrderTitle:"Low",descendingOrderKey:"-estimate_point",descendingOrderTitle:"High",icon:t8.Z,Column:tK},labels:{title:"Labels",ascendingOrderKey:"labels__name",ascendingOrderTitle:"A",descendingOrderKey:"-labels__name",descendingOrderTitle:"Z",icon:t6.Z,Column:tY},modules:{title:"Modules",ascendingOrderKey:"modules__name",ascendingOrderTitle:"A",descendingOrderKey:"-modules__name",descendingOrderTitle:"Z",icon:b.kB,Column:t5},cycle:{title:"Cycle",ascendingOrderKey:"cycle__name",ascendingOrderTitle:"A",descendingOrderKey:"-cycle__name",descendingOrderTitle:"Z",icon:b.sI,Column:t3},priority:{title:"Priority",ascendingOrderKey:"priority",ascendingOrderTitle:"None",descendingOrderKey:"-priority",descendingOrderTitle:"Urgent",icon:t7.Z,Column:tH},start_date:{title:"Start date",ascendingOrderKey:"-start_date",ascendingOrderTitle:"New",descendingOrderKey:"start_date",descendingOrderTitle:"Old",icon:tQ.Z,Column:tG},state:{title:"State",ascendingOrderKey:"state__name",ascendingOrderTitle:"A",descendingOrderKey:"-state__name",descendingOrderTitle:"Z",icon:b.go,Column:t$},updated_on:{title:"Updated on",ascendingOrderKey:"-updated_at",ascendingOrderTitle:"New",descendingOrderKey:"updated_at",descendingOrderTitle:"Old",icon:t4.Z,Column:t0},link:{title:"Link",ascendingOrderKey:"-link_count",ascendingOrderTitle:"Most",descendingOrderKey:"link_count",descendingOrderTitle:"Least",icon:t9.Z,Column:tJ},attachment_count:{title:"Attachment",ascendingOrderKey:"-attachment_count",ascendingOrderTitle:"Most",descendingOrderKey:"attachment_count",descendingOrderTitle:"Least",icon:se.Z,Column:tB},sub_issue_count:{title:"Sub-issue",ascendingOrderKey:"-sub_issues_count",ascendingOrderTitle:"Most",descendingOrderKey:"sub_issues_count",descendingOrderTitle:"Least",icon:b.uQ,Column:tX}},ss=["state","priority","assignee","labels","modules","cycle","start_date","due_date","estimate","created_on","updated_on","link","attachment_count","sub_issue_count"],sl=()=>{let e=e=>{var t,s,l,n;return(null===(t=e.closest("tr"))||void 0===t?void 0:t.previousSibling)||(null===(n=e.closest("tbody"))||void 0===n?void 0:null===(l=n.previousSibling)||void 0===l?void 0:null===(s=l.childNodes)||void 0===s?void 0:s[0])},t=e=>{var t,s,l,n;return(null===(t=e.closest("tr"))||void 0===t?void 0:t.nextSibling)||(null===(n=e.closest("thead"))||void 0===n?void 0:null===(l=n.nextSibling)||void 0===l?void 0:null===(s=l.childNodes)||void 0===s?void 0:s[0])};return function(s){var l,n,r,a;let i=s.target;if(!((null==i?void 0:i.tagName)==="TD"||(null==i?void 0:i.tagName)==="TH"))return;let o=null;if("ArrowRight"==s.key)o=i.nextSibling;else if("ArrowLeft"==s.key)o=i.previousSibling;else if("ArrowUp"==s.key){let t=Array.prototype.indexOf.call((null==i?void 0:null===(l=i.parentNode)||void 0===l?void 0:l.childNodes)||[],i),s=e(i);o=null==s?void 0:null===(n=s.childNodes)||void 0===n?void 0:n[t]}else if("ArrowDown"==s.key){let e=Array.prototype.indexOf.call((null==i?void 0:null===(r=i.parentNode)||void 0===r?void 0:r.childNodes)||[],i),s=t(i);o=null==s?void 0:s.childNodes[e]}else if("Enter"==s.key||"Space"==s.key){s.preventDefault(),null===(a=null==i?void 0:i.querySelector(".clickable"))||void 0===a||a.click();return}o&&(s.preventDefault(),null==o||o.focus(),null==o||o.scrollIntoView({behavior:"smooth",block:"center",inline:"end"}))}};var sn=s(48819);let sr=(0,I.Pi)(e=>{let{displayProperties:t,issueDetail:s,disableUserActions:r,property:a,updateIssue:i,isEstimateEnabled:o}=e,c=(0,G.useRouter)(),d=(0,n.useRef)(null),{captureIssueEvent:u}=(0,y.DN)(),m="estimate"!==a||o,{Column:h}=st[a];return(0,l.jsx)(sn.K,{displayProperties:t,displayPropertyKey:a,shouldRenderProperty:()=>m,children:(0,l.jsx)("td",{tabIndex:0,className:"h-11 w-full min-w-[8rem] bg-custom-background-100 text-sm after:absolute after:w-full after:bottom-[-1px] after:border after:border-custom-border-100 border-r-[1px] border-custom-border-100",ref:d,children:(0,l.jsx)(h,{issue:s,onChange:(e,t,s)=>i&&i(e.project_id,e.id,t).then(()=>{u({eventName:"Issue updated",payload:{...e,...t,element:"Spreadsheet layout"},updates:s,path:c.asPath})}),disabled:r,onClose:()=>{var e;null==d||null===(e=d.current)||void 0===e||e.focus()}})})})}),sa=(0,r.Pi)(e=>{let{displayProperties:t,issueId:s,isEstimateEnabled:r,nestingLevel:a,portalElement:i,updateIssue:o,quickActions:c,canEditProperties:d,isScrolled:u,containerRef:m,issueIds:h,spreadsheetColumnsList:p,spacingLeft:x=14}=e,[f,v]=(0,n.useState)(!1),{subIssues:g}=(0,y.p1)(),j=g.subIssuesByIssueId(s);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eQ.Z,{as:"tr",defaultHeight:"calc(2.75rem - 1px)",root:m,placeholderChildren:(0,l.jsx)("td",{colSpan:100,className:"border-b-[0.5px] border-custom-border-200"}),changingReference:h,children:(0,l.jsx)(si,{issueId:s,displayProperties:t,quickActions:c,canEditProperties:d,nestingLevel:a,spacingLeft:x,isEstimateEnabled:r,updateIssue:o,portalElement:i,isScrolled:u,isExpanded:f,setExpanded:v,spreadsheetColumnsList:p})}),f&&j&&j.length>0&&j.map(e=>(0,l.jsx)(sa,{issueId:e,displayProperties:t,quickActions:c,canEditProperties:d,nestingLevel:a+1,spacingLeft:x+(t.key?16:28),isEstimateEnabled:r,updateIssue:o,portalElement:i,isScrolled:u,containerRef:m,issueIds:h,spreadsheetColumnsList:p},e))]})}),si=(0,r.Pi)(e=>{let{displayProperties:t,issueId:s,isEstimateEnabled:r,nestingLevel:a,portalElement:i,updateIssue:o,quickActions:c,canEditProperties:d,isScrolled:u,isExpanded:m,setExpanded:h,spreadsheetColumnsList:p,spacingLeft:x=14}=e,[f,v]=(0,n.useState)(!1),g=(0,n.useRef)(null),j=(0,n.useRef)(null),{workspaceSlug:w}=(0,G.useRouter)().query,{getProjectIdentifierById:N}=(0,y.PY)(),{getIsIssuePeeked:k,setPeekIssue:C}=(0,y.p1)(),{isMobile:S}=(0,H.L)(),_=e=>w&&e&&e.project_id&&e.id&&!k(e.id)&&C({workspaceSlug:w.toString(),projectId:e.project_id,issueId:e.id}),{subIssues:I,issue:E}=(0,y.p1)(),P=E.getIssueById(s);(0,e7.Z)(j,()=>v(!1));let R=(0,l.jsx)("div",{ref:j,className:"flex items-center h-full w-full cursor-pointer rounded p-1 text-custom-sidebar-text-400 hover:bg-custom-background-80 ".concat(f?"bg-custom-background-80 text-custom-text-100":"text-custom-text-200"),onClick:()=>v(!f),children:(0,l.jsx)(ty.Z,{className:"h-3.5 w-3.5"})});if(!P)return null;let F=!d(P.project_id);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("td",{id:"issue-".concat(s),ref:g,tabIndex:0,className:"sticky left-0 z-10",children:(0,l.jsxs)(b.Ug,{href:"/".concat(w,"/projects/").concat(P.project_id,"/issues/").concat(s),target:"_blank",onClick:()=>_(P),className:(0,e1.cn)("group clickable cursor-pointer h-11 w-[28rem] flex items-center bg-custom-background-100 text-sm after:absolute border-r-[0.5px] z-10 border-custom-border-200",{"border-b-[0.5px]":!k(P.id),"border border-custom-primary-70 hover:border-custom-primary-70":k(P.id),"shadow-[8px_22px_22px_10px_rgba(0,0,0,0.05)]":u.current}),disabled:!!(null==P?void 0:P.tempId),children:[(0,l.jsxs)("div",{className:"flex min-w-min items-center gap-1 px-4 py-2.5 pr-0",style:P.parent_id&&0!==a?{paddingLeft:"".concat(x,"px")}:{},children:[(0,l.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:P.sub_issues_count>0&&(0,l.jsx)("button",{className:"flex items-center justify-center h-5 w-5 cursor-pointer rounded-sm text-custom-text-400 hover:text-custom-text-300",onClick:e=>{e.stopPropagation(),e.preventDefault(),a>=3?_(P):h(e=>(!e&&w&&P&&I.fetchSubIssues(w.toString(),P.project_id,P.id),!e))},children:(0,l.jsx)(e$.Z,{className:"h-4 w-4 ".concat(m?"rotate-90":"")})})}),(0,l.jsx)(sn.K,{displayProperties:t,displayPropertyKey:"key",children:(0,l.jsx)("div",{className:"relative flex cursor-pointer items-center text-center text-xs hover:text-custom-text-100",children:(0,l.jsxs)("p",{className:"flex items-center justify-center font-medium leading-7",children:[N(P.project_id),"-",P.sequence_id]})})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 justify-between h-full w-full pr-4 truncate",children:[(0,l.jsx)("div",{className:"w-full line-clamp-1 text-sm text-custom-text-100",children:(0,l.jsx)("div",{className:"w-full overflow-hidden",children:(0,l.jsx)(b.u,{tooltipContent:P.name,isMobile:S,children:(0,l.jsx)("div",{className:"h-full w-full cursor-pointer truncate px-4 text-left text-[0.825rem] text-custom-text-100 focus:outline-none",tabIndex:-1,children:P.name})})})}),(0,l.jsx)("div",{className:"hidden group-hover:block ".concat(f?"!block":""),children:c({issue:P,parentRef:g,customActionButton:R,portalElement:i.current})})]})]})}),p.map(e=>(0,l.jsx)(sr,{displayProperties:t,issueDetail:P,disableUserActions:F,property:e,updateIssue:o,isEstimateEnabled:r},e))]})});var so=s(64273),sc=s(91603),sd=s(74546),su=s(23634),sm=s(17695),sh=s(15108);let sp=e=>{let{displayFilters:t,handleDisplayFilterUpdate:s,property:n,onClose:r}=e,{storedValue:a,setValue:i}=(0,sh.Z)("spreadsheetViewSorting",""),{storedValue:o,setValue:c}=(0,sh.Z)("spreadsheetViewActiveSortingProperty",""),u=st[n],m=(e,t)=>{s({order_by:e}),i("".concat(e,"_").concat(t)),c("-created_at"===e?"":t)};return(0,l.jsxs)(b.fR,{customButtonClassName:"clickable !w-full",customButtonTabIndex:-1,className:"!w-full",customButton:(0,l.jsxs)("div",{className:"flex w-full cursor-pointer items-center justify-between gap-1.5 py-2 text-sm text-custom-text-200 hover:text-custom-text-100",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,l.jsx)(u.icon,{className:"h-4 w-4 text-custom-text-400"}),u.title]}),(0,l.jsxs)("div",{className:"ml-3 flex",children:[o===n&&(0,l.jsx)("div",{className:"flex h-3.5 w-3.5 items-center justify-center rounded-full",children:(0,l.jsx)(so.Z,{className:"h-3 w-3"})}),(0,l.jsx)(d.Z,{className:"h-3 w-3","aria-hidden":"true"})]})]}),onMenuClose:r,placement:"bottom-start",closeOnSelect:!0,children:[(0,l.jsx)(b.fR.MenuItem,{onClick:()=>m(u.ascendingOrderKey,n),children:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-1.5 px-1 ".concat(a==="".concat(u.ascendingOrderKey,"_").concat(n)?"text-custom-text-100":"text-custom-text-200 hover:text-custom-text-100"),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(sc.Z,{className:"h-3 w-3 stroke-[1.5]"}),(0,l.jsx)("span",{children:u.ascendingOrderTitle}),(0,l.jsx)(sd.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:u.descendingOrderTitle})]}),a==="".concat(u.ascendingOrderKey,"_").concat(n)&&(0,l.jsx)(Y.Z,{className:"h-3 w-3"})]})}),(0,l.jsx)(b.fR.MenuItem,{onClick:()=>m(u.descendingOrderKey,n),children:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-1.5 px-1 ".concat(a==="".concat(u.descendingOrderKey,"_").concat(n)?"text-custom-text-100":"text-custom-text-200 hover:text-custom-text-100"),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(su.Z,{className:"h-3 w-3 stroke-[1.5]"}),(0,l.jsx)("span",{children:u.descendingOrderTitle}),(0,l.jsx)(sd.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:u.ascendingOrderTitle})]}),a==="".concat(u.descendingOrderKey,"_").concat(n)&&(0,l.jsx)(Y.Z,{className:"h-3 w-3"})]})}),a&&""!==a&&(null==t?void 0:t.order_by)!=="-created_at"&&a.includes(n)&&(0,l.jsx)(b.fR.MenuItem,{className:"mt-0.5 ".concat(a==="-created_at_".concat(n)?"bg-custom-background-80":""),onClick:()=>m("-created_at",n),children:(0,l.jsxs)("div",{className:"flex items-center gap-2 px-1",children:[(0,l.jsx)(sm.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:"Clear sorting"})]})},n)]})},sx=(0,I.Pi)(e=>{let{displayProperties:t,displayFilters:s,property:r,isEstimateEnabled:a,handleDisplayFilterUpdate:i}=e,o=(0,n.useRef)(null),c="estimate"!==r||a;return(0,l.jsx)(sn.K,{displayProperties:t,displayPropertyKey:r,shouldRenderProperty:()=>c,children:(0,l.jsx)("th",{className:"h-11 w-full min-w-[8rem] items-center bg-custom-background-90 text-sm font-medium px-4 py-1 border border-b-0 border-t-0 border-custom-border-100",ref:o,tabIndex:0,children:(0,l.jsx)(sp,{displayFilters:s,handleDisplayFilterUpdate:i,property:r,onClose:()=>{var e;null==o||null===(e=o.current)||void 0===e||e.focus()}})})})}),sf=e=>{let{displayProperties:t,displayFilters:s,handleDisplayFilterUpdate:n,isEstimateEnabled:r,spreadsheetColumnsList:a}=e;return(0,l.jsx)("thead",{className:"sticky top-0 left-0 z-[12] border-b-[0.5px] border-custom-border-100",children:(0,l.jsxs)("tr",{children:[(0,l.jsxs)("th",{className:"sticky left-0 z-[15] h-11 w-[28rem] flex items-center bg-custom-background-90 text-sm font-medium before:absolute before:h-full before:right-0 before:border-[0.5px]  before:border-custom-border-100",tabIndex:-1,children:[(0,l.jsx)(sn.K,{displayProperties:t,displayPropertyKey:"key",children:(0,l.jsxs)("span",{className:"flex h-full w-24 flex-shrink-0 items-center px-4 py-2.5",children:[(0,l.jsx)("span",{className:"mr-1.5 text-custom-text-400",children:"#"}),"ID"]})}),(0,l.jsxs)("span",{className:"flex h-full w-full flex-grow items-center justify-center px-4 py-2.5",children:[(0,l.jsx)(b.uQ,{className:"mr-1.5 h-4 w-4 text-custom-text-400"}),"Issue"]})]}),a.map(e=>(0,l.jsx)(sx,{property:e,displayProperties:t,displayFilters:s,handleDisplayFilterUpdate:n,isEstimateEnabled:r},e))]})})},sv=(0,r.Pi)(e=>{let{displayProperties:t,displayFilters:s,handleDisplayFilterUpdate:r,issueIds:a,isEstimateEnabled:i,portalElement:o,quickActions:c,updateIssue:d,canEditProperties:u,containerRef:m,spreadsheetColumnsList:h}=e,p=(0,n.useRef)(!1),x=(0,n.useCallback)(()=>{if(!m.current)return;let e=m.current.scrollLeft;if(e>0!==p.current){let t=m.current.querySelectorAll("table tr td:first-child, th:first-child");for(let s=0;s<t.length;s++){let l=0===s?"8px -22px 22px 10px rgba(0, 0, 0, 0.05)":"8px 22px 22px 10px rgba(0, 0, 0, 0.05)";e>0?t[s].style.boxShadow=l:t[s].style.boxShadow="none"}p.current=e>0}},[m]);(0,n.useEffect)(()=>{let e=m.current;return e&&e.addEventListener("scroll",x),()=>{e&&e.removeEventListener("scroll",x)}},[x,m]);let f=sl();return(0,l.jsxs)("table",{className:"overflow-y-auto",onKeyDown:f,children:[(0,l.jsx)(sf,{displayProperties:t,displayFilters:s,handleDisplayFilterUpdate:r,isEstimateEnabled:i,spreadsheetColumnsList:h}),(0,l.jsx)("tbody",{children:a.map(e=>(0,l.jsx)(sa,{issueId:e,displayProperties:t,quickActions:c,canEditProperties:u,nestingLevel:0,isEstimateEnabled:i,updateIssue:d,portalElement:o,containerRef:m,isScrolled:p,issueIds:a,spreadsheetColumnsList:h},e))})]})}),sg=(0,r.Pi)(e=>{let{displayProperties:t,displayFilters:s,handleDisplayFilterUpdate:r,issueIds:i,quickActions:o,updateIssue:c,quickAddCallback:d,viewId:u,canEditProperties:m,enableQuickCreateIssue:h,disableIssueCreation:p,isWorkspaceLevel:x=!1}=e,f=(0,n.useRef)(null),v=(0,n.useRef)(null),{currentProjectDetails:g}=(0,y.PY)(),j=(null==g?void 0:g.estimate)!==null,w=x?ss:ss.filter(e=>("cycle"!==e||null!=g&&!!g.cycle_view)&&("modules"!==e||null!=g&&!!g.module_view));return i&&0!==i.length?(0,l.jsxs)("div",{className:"relative flex flex-col h-full w-full overflow-x-hidden whitespace-nowrap rounded-lg bg-custom-background-200 text-custom-text-200",children:[(0,l.jsx)("div",{ref:v,className:"spreadsheet-menu-portal"}),(0,l.jsx)("div",{ref:f,className:"vertical-scrollbar horizontal-scrollbar scrollbar-lg h-full w-full",children:(0,l.jsx)(sv,{displayProperties:t,displayFilters:s,handleDisplayFilterUpdate:r,issueIds:i,isEstimateEnabled:j,portalElement:v,quickActions:o,updateIssue:c,canEditProperties:m,containerRef:f,spreadsheetColumnsList:w})}),(0,l.jsx)("div",{className:"border-t border-custom-border-100",children:(0,l.jsx)("div",{className:"z-5 sticky bottom-0 left-0 mb-3",children:h&&!p&&(0,l.jsx)(a.R1o,{formKey:"name",quickAddCallback:d,viewId:u})})})]}):(0,l.jsx)("div",{className:"grid h-full w-full place-items-center",children:(0,l.jsx)(b.$j,{})})}),sj=(0,r.Pi)(e=>{var t,s,r,a,i;let{viewId:c,QuickActions:d,storeType:u,canEditPropertiesBasedOnProject:m,isCompletedCycle:h=!1}=e,{projectId:p}=(0,G.useRouter)().query,{membership:{currentProjectRole:x}}=(0,y.aF)(),{issues:f,issuesFilter:v}=(0,y.gk)(u),{updateIssue:g,removeIssue:j,removeIssueFromView:b,archiveIssue:w,restoreIssue:N,updateFilters:k}=(0,eB.C)(u),{enableInlineEditing:C,enableQuickAdd:S,enableIssueCreation:_}=(null==f?void 0:f.viewFlags)||{},I=!!x&&x>=eo.MC.MEMBER,E=(0,n.useCallback)(e=>{let t=m&&e?m(e):I;return C&&t},[m,C,I]),P=null!==(r=f.groupedIssueIds)&&void 0!==r?r:[],R=(0,n.useCallback)(e=>{p&&k(p.toString(),o.gc.DISPLAY_FILTERS,{...e})},[p,k]),F=(0,n.useCallback)(e=>{let{issue:t,parentRef:s,customActionButton:n,placement:r,portalElement:a}=e;return(0,l.jsx)(d,{parentRef:s,customActionButton:n,issue:t,handleDelete:async()=>j(t.project_id,t.id),handleUpdate:async e=>g&&g(t.project_id,t.id,e),handleRemoveFromView:async()=>b&&b(t.project_id,t.id),handleArchive:async()=>w&&w(t.project_id,t.id),handleRestore:async()=>N&&N(t.project_id,t.id),portalElement:a,readOnly:!I||h,placements:r})},[I,h,j,g,b,w,N]);return(0,l.jsx)(sg,{displayProperties:null!==(a=null===(t=v.issueFilters)||void 0===t?void 0:t.displayProperties)&&void 0!==a?a:{},displayFilters:null!==(i=null===(s=v.issueFilters)||void 0===s?void 0:s.displayFilters)&&void 0!==i?i:{},handleDisplayFilterUpdate:R,issueIds:P,quickActions:F,updateIssue:g,canEditProperties:E,quickAddCallback:f.quickAddIssue,viewId:c,enableQuickCreateIssue:S,disableIssueCreation:!_||!I||h})}),sb=(0,r.Pi)(()=>{let{cycleId:e}=(0,G.useRouter)().query,{currentProjectCompletedCycleIds:t}=(0,y.nv)(),{membership:{currentProjectRole:s}}=(0,y.aF)(),r=!!e&&!!t&&t.includes(e.toString()),a=!!s&&s>=eo.MC.MEMBER,i=(0,n.useCallback)(()=>!r&&a,[r,a]);return e?(0,l.jsx)(sj,{viewId:null==e?void 0:e.toString(),QuickActions:eP.JW,canEditPropertiesBasedOnProject:i,isCompletedCycle:r,storeType:o.rS.CYCLE}):null}),sy=(0,r.Pi)(()=>{let{moduleId:e}=(0,G.useRouter)().query;return e?(0,l.jsx)(sj,{viewId:e.toString(),QuickActions:eP.PF,storeType:o.rS.MODULE}):null}),sw=(0,r.Pi)(()=>(0,l.jsx)(sj,{QuickActions:eP.n,storeType:o.rS.PROJECT})),sN=(0,r.Pi)(()=>{let{viewId:e}=(0,G.useRouter)().query;return(0,l.jsx)(sj,{QuickActions:eP.n,viewId:null==e?void 0:e.toString(),storeType:o.rS.PROJECT_VIEW})}),sk={name:""},sC=e=>{var t;let{register:s,setFocus:r,projectDetails:a}=e;return(0,n.useEffect)(()=>{r("name")},[r]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h4",{className:"w-20 text-xs leading-5 text-custom-text-400",children:null!==(t=null==a?void 0:a.identifier)&&void 0!==t?t:"..."}),(0,l.jsx)("input",{type:"text",autoComplete:"off",placeholder:"Issue Title",...s("name",{required:"Issue title is required."}),className:"w-full rounded-md bg-transparent py-3 text-sm leading-5 text-custom-text-200 outline-none"})]})},sS=(0,r.Pi)(e=>{let{formKey:t,prePopulatedData:s,quickAddCallback:r,viewId:a}=e,{currentWorkspace:i}=(0,y.cF)(),{currentProjectDetails:o}=(0,y.PY)(),{captureIssueEvent:c}=(0,y.DN)(),d=(0,G.useRouter)(),{reset:u,handleSubmit:m,setFocus:h,register:p,formState:{errors:x,isSubmitting:f}}=(0,e3.cI)({defaultValues:sk}),v=(0,n.useRef)(null),[g,j]=(0,n.useState)(!1),w=()=>j(!1);(0,e6.Z)("Escape",w),(0,e7.Z)(v,w),(0,n.useEffect)(()=>{h("name")},[h,g]),(0,n.useEffect)(()=>{g||u({...sk})},[g,u]),(0,n.useEffect)(()=>{x&&Object.keys(x).forEach(e=>{var t;let s=x[e];(0,b.fz)({type:b.do.ERROR,title:"Error!",message:(null==s?void 0:null===(t=s.message)||void 0===t?void 0:t.toString())||"Some error occurred. Please try again."})})},[x]);let N=async e=>{if(f||!i||!o)return;u({...sk});let t=(0,e8.vd)(o.id,{...null!=s?s:{},...e});if(r){let e=r(i.slug,o.id,{...t},a);(0,b.uW)(e,{loading:"Adding issue...",success:{title:"Success!",message:()=>"Issue created successfully."},error:{title:"Error!",message:e=>(null==e?void 0:e.message)||"Some error occurred. Please try again."}}),await e.then(e=>{c({eventName:el.lc,payload:{...e,state:"SUCCESS",element:"Spreadsheet quick add"},path:d.asPath})}).catch(e=>{c({eventName:el.lc,payload:{...t,state:"FAILED",element:"Spreadsheet quick add"},path:d.asPath}),console.error(e)})}};return(0,l.jsxs)("div",{children:[g&&(0,l.jsx)("div",{children:(0,l.jsx)("form",{ref:v,onSubmit:m(N),className:"z-10 flex items-center gap-x-5 border-[0.5px] border-t-0 border-custom-border-100 bg-custom-background-100 px-4 shadow-custom-shadow-sm",children:(0,l.jsx)(sC,{formKey:t,register:p,setFocus:h,projectDetails:null!=o?o:null})})}),g&&(0,l.jsxs)("p",{className:"ml-3 mt-3 text-xs italic text-custom-text-200",children:["Press ","'","Enter","'"," to add another issue"]}),!g&&(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsxs)("button",{type:"button",className:"flex items-center gap-x-[6px] rounded-md px-2 pt-3 text-custom-primary-100",onClick:()=>j(!0),children:[(0,l.jsx)(e4.Z,{className:"h-3.5 w-3.5 stroke-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-custom-primary-100",children:"New Issue"})]})})]})});var s_=s(31408);let sI=e=>{let{workspaceSlug:t,projectId:s,filterParams:r}=e,[a,i]=(0,n.useState)(!1);return(0,l.jsxs)("div",{children:[(0,l.jsx)(s_.xB,{workspaceSlug:t,projectId:s,preLoadedData:{filters:{...r}},isOpen:a,onClose:()=>i(!1)}),(0,l.jsx)(b.zx,{size:"sm",prependIcon:(0,l.jsx)(e4.Z,{}),onClick:()=>i(!0),children:"Save View"})]})}},60680:function(e,t,s){s.d(t,{P:function(){return V}});var l=s(24246),n=s(27378),r=s(65331),a=s(97964),i=s(27680),o=s(43659),c=s(86677),d=s(25449),u=s(68114),m=s(865),h=s(93997),p=s(51374),x=s(10634),f=s(76926),v=s(20107),g=s(3807),j=s(90292),b=s(19190),y=s(47542),w=s(23258);let N=(0,o.Pi)(e=>{let{sub_group_by:t,column_id:s,icon:r,title:a,count:i,kanbanFilters:o,handleKanbanFilters:m,issuePayload:h,disableIssueCreation:p,storeType:f,addIssuesToView:v}=e,N=!t&&(null==o?void 0:o.group_by.includes(s)),[k,C]=n.useState(!1),[S,_]=n.useState(!1),{setTrackElement:I}=(0,x.DN)(),E=(0,c.useRouter)(),{workspaceSlug:P,projectId:R,moduleId:F,cycleId:O}=E.query,T=E.pathname.includes("draft-issue"),A=F||O,D=F?{module:F.toString()}:{cycle:!0},M=async e=>{if(!P||!R)return;let t=e.map(e=>e.id);try{await (null==v?void 0:v(t)),(0,d.fz)({type:d.do.SUCCESS,title:"Success!",message:"Issues added to the cycle successfully."})}catch(e){(0,d.fz)({type:d.do.ERROR,title:"Error!",message:"Selected issues could not be added to the cycle. Please try again."})}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(u.vlH,{isOpen:k,onClose:()=>C(!1),data:h,storeType:f,isDraft:T}),A&&(0,l.jsx)(w.H2,{workspaceSlug:null==P?void 0:P.toString(),projectId:null==R?void 0:R.toString(),isOpen:S,handleClose:()=>_(!1),searchParams:D,handleOnSubmit:M}),(0,l.jsxs)("div",{className:"relative flex flex-shrink-0 gap-2 p-1.5 ".concat(N?"w-[44px] flex-col items-center":"w-full flex-row items-center"),children:[(0,l.jsx)("div",{className:"flex h-[20px] w-[20px] flex-shrink-0 items-center justify-center overflow-hidden rounded-sm",children:r||(0,l.jsx)(g.Z,{width:14,strokeWidth:2})}),(0,l.jsxs)("div",{className:"relative flex items-center gap-1 ".concat(N?"flex-col":"w-full flex-row overflow-hidden"),children:[(0,l.jsx)("div",{className:"line-clamp-1 inline-block overflow-hidden truncate font-medium text-custom-text-100 ".concat(N?"vertical-lr max-h-[400px]":""),children:a}),(0,l.jsx)("div",{className:"flex-shrink-0 text-sm font-medium text-custom-text-300 ".concat(N?"":"pl-2"),children:i||0})]}),null===t&&(0,l.jsx)("div",{className:"flex h-[20px] w-[20px] flex-shrink-0 cursor-pointer items-center justify-center overflow-hidden rounded-sm transition-all hover:bg-custom-background-80",onClick:()=>m("group_by",s),children:N?(0,l.jsx)(j.Z,{width:14,strokeWidth:2}):(0,l.jsx)(b.Z,{width:14,strokeWidth:2})}),!p&&(A?(0,l.jsxs)(d.fR,{customButton:(0,l.jsx)("span",{className:"flex h-[20px] w-[20px] flex-shrink-0 cursor-pointer items-center justify-center overflow-hidden rounded-sm transition-all hover:bg-custom-background-80",children:(0,l.jsx)(y.Z,{height:14,width:14,strokeWidth:2})}),placement:"bottom-end",children:[(0,l.jsx)(d.fR.MenuItem,{onClick:()=>{I("Kanban layout"),C(!0)},children:(0,l.jsx)("span",{className:"flex items-center justify-start gap-2",children:"Create issue"})}),(0,l.jsx)(d.fR.MenuItem,{onClick:()=>{I("Kanban layout"),_(!0)},children:(0,l.jsx)("span",{className:"flex items-center justify-start gap-2",children:"Add an existing issue"})})]}):(0,l.jsx)("div",{className:"flex h-[20px] w-[20px] flex-shrink-0 cursor-pointer items-center justify-center overflow-hidden rounded-sm transition-all hover:bg-custom-background-80",onClick:()=>{I("Kanban layout"),C(!0)},children:(0,l.jsx)(y.Z,{width:14,strokeWidth:2})}))]})]})});var k=s(6780),C=s(30967),S=s.n(C),_=s(17706);let I=e=>{var t,s;let l;let{location:n,source:r}=e,a=r.data;for(let e of null!==(s=null==n?void 0:null===(t=n.initial)||void 0===t?void 0:t.dropTargets)&&void 0!==s?s:[]){let t=null==e?void 0:e.data;t&&"COLUMN"===t.type&&(l=t)}if((null==a?void 0:a.id)!==void 0&&(null==l?void 0:l.groupId))return{groupId:l.groupId,subGroupId:l.subGroupId,columnId:l.columnId,id:a.id}},E=e=>{var t,s;let l,n;let{location:r}=e;for(let e of null!==(s=null==r?void 0:null===(t=r.current)||void 0===t?void 0:t.dropTargets)&&void 0!==s?s:[]){let t=null==e?void 0:e.data;t&&(("COLUMN"===t.type||"DELETE"===t.type)&&(n=t),"ISSUE"===t.type&&(l=t))}if(null==n?void 0:n.groupId)return{groupId:n.groupId,subGroupId:n.subGroupId,columnId:n.columnId,id:null==l?void 0:l.id}},P=function(e,t,s){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n={},r=t?e.indexOf(t):l?0:e.length;if(e&&e.length>0){if(0===r){let t=s(e[0]);if(!t)return n;n={...n,sort_order:t.sort_order-65535}}else if(r===e.length){let t=s(e[e.length-1]);if(!t)return n;n={...n,sort_order:t.sort_order+65535}}else{let t=e[r-1],l=e[r],a=s(t),i=s(l);if(!a||!i)return n;n={...n,sort_order:(a.sort_order+i.sort_order)/2}}}else n={...n,sort_order:65535};return n},R=async function(e,t,s,l,n,r,a){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(!e.id||!r||a&&(!e.subGroupId||!t.subGroupId))return;let o={},c=l(e.groupId,e.subGroupId),d=l(t.groupId,t.subGroupId),u=s(e.id);if(c&&d&&u){if(o={...o={id:u.id,project_id:u.project_id},...P(d,t.id,s,i)},e.groupId&&t.groupId&&e.groupId!==t.groupId){let s=_.U[r],l=u[s];Array.isArray(l)?(S()(l,e.groupId),l.push(t.groupId)):l=t.groupId,o={...o,[s]:l}}if(a&&e.subGroupId&&t.subGroupId&&e.subGroupId!==t.subGroupId){let s=_.U[a],l=u[s];Array.isArray(l)?(S()(l,e.subGroupId),l.push(t.subGroupId)):l=t.subGroupId,o={...o,[s]:l}}if(o)return n&&await n(u.project_id,u.id,{...o,id:u.id,project_id:u.project_id})}};var F=s(27905);let O=e=>{var t;let{groupId:s,sub_group_id:o,group_by:c,orderBy:d,sub_group_by:u,issuesMap:m,displayProperties:p,issueIds:f,isDragDisabled:g,updateIssue:j,quickActions:b,canEditProperties:y,enableQuickIssueCreate:w,disableIssueCreation:N,quickAddCallback:C,viewId:S,scrollableContainerRef:_,handleOnDrop:P}=e,R=(0,x.eD)(),[O,T]=(0,n.useState)(!1),A=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=A.current;if(e)return(0,r.$)((0,a.wO)({element:e,getData:()=>({groupId:s,subGroupId:o,columnId:"".concat(s,"__").concat(o),type:"COLUMN"}),onDragEnter:()=>{T(!0)},onDragLeave:()=>{T(!1)},onDragStart:()=>{T(!0)},onDrop:e=>{T(!1);let t=I(e),s=E(e);t&&s&&(P(t,s),(0,v.jH)(e.source.element.id,"sort_order"!==d))}}),(0,i.O)({element:e}))},[null==A?void 0:A.current,s,o,T,d]);let D=O&&"sort_order"!==d,M=null===(t=h.Wf.find(e=>e.key===d))||void 0===t?void 0:t.title;return(0,l.jsxs)("div",{id:"".concat(s,"__").concat(o),className:(0,k.cn)("relative h-full transition-all min-h-[50px]",{"bg-custom-background-80 rounded":O},{"vertical-scrollbar scrollbar-md":!u&&!D}),ref:A,children:[(0,l.jsxs)("div",{className:(0,k.cn)("absolute top-0 left-0 h-full w-full items-center text-sm font-medium text-custom-text-300 rounded",{"flex flex-col bg-custom-background-80 border-[1px] border-custom-border-300 z-[2]":D},{hidden:!D},{"justify-center":!u}),children:[M&&(0,l.jsxs)("span",{className:"pt-6",children:["The layout is ordered by ",M,"."]}),(0,l.jsx)("span",{children:"Drop here to move the issue."})]}),(0,l.jsx)(F.Xw,{sub_group_id:o,columnId:s,issuesMap:m,issueIds:(null==f?void 0:f[s])||[],displayProperties:p,isDragDisabled:g,updateIssue:j,quickActions:b,canEditProperties:y,scrollableContainerRef:u?_:A}),w&&!N&&(0,l.jsx)("div",{className:"w-full bg-custom-background-90 py-0.5 sticky bottom-0",children:(0,l.jsx)(F.Uq,{formKey:"name",groupId:s,subGroupId:o,prePopulatedData:{...c&&((e,t,s,l)=>{var n;let r=null===(n=R.projectStates)||void 0===n?void 0:n.find(e=>e.default),a={state_id:null==r?void 0:r.id};return e&&(a="state"===e?{...a,state_id:s}:"priority"===e?{...a,priority:s}:"cycle"===e?{...a,cycle_id:s}:"module"===e?{...a,module_ids:[s]}:"labels"===e&&"None"!=s?{...a,label_ids:[s]}:"assignees"===e&&"None"!=s?{...a,assignee_ids:[s]}:"created_by"===e?{...a}:{...a,[e]:s}),t&&(a="state"===t?{...a,state_id:l}:"priority"===t?{...a,priority:l}:"cycle"===e?{...a,cycle_id:l}:"module"===e?{...a,module_ids:[l]}:"labels"===t&&"None"!=l?{...a,label_ids:[l]}:"assignees"===t&&"None"!=l?{...a,assignee_ids:[l]}:"created_by"===t?{...a}:{...a,[t]:l}),a})(c,u,s,o)},quickAddCallback:C,viewId:S})})]})},T=(0,o.Pi)(e=>{let{issuesMap:t,issueIds:s,displayProperties:n,sub_group_by:r,group_by:a,sub_group_id:i="null",isDragDisabled:o,updateIssue:c,quickActions:d,kanbanFilters:u,handleKanbanFilters:m,enableQuickIssueCreate:h,quickAddCallback:p,viewId:f,disableIssueCreation:g,storeType:j,addIssuesToView:b,canEditProperties:y,scrollableContainerRef:w,handleOnDrop:k,showEmptyGroup:C=!0,subGroupIssueHeaderCount:S,orderBy:_}=e,I=(0,x.Kb)(),E=(0,x.PY)(),P=(0,x.NP)(),R=(0,x.nv)(),F=(0,x.b7)(),T=(0,x.eD)(),A=(0,v.K_)(a,E,R,F,P,T,I,!0,(0,v.xV)(j));if(!A)return null;let D=e=>{if(r){let t={showGroup:!0,showIssues:!0};return C||(t.showGroup=!S||S(e.id)>0),t}{let l={showGroup:!0,showIssues:!0};if(!C){var t;(null==s?void 0:null===(t=s[e.id])||void 0===t?void 0:t.length)>0?l.showGroup=!0:l.showGroup=!1}return(null==u?void 0:u.group_by.includes(e.id))&&(l.showIssues=!1),l}},M="created_by"===a;return(0,l.jsx)("div",{className:"relative w-full flex gap-2 px-2 ".concat("h-full"),children:A&&A.length>0&&A.map(e=>{var x;let v=D(e);return!1===v.showGroup?(0,l.jsx)(l.Fragment,{}):(0,l.jsxs)("div",{className:"relative flex flex-shrink-0 flex-col group ".concat(v.showIssues?"w-[350px]":""," "),children:[null===r&&(0,l.jsx)("div",{className:"sticky top-0 z-[2] w-full flex-shrink-0 bg-custom-background-90 py-1",children:(0,l.jsx)(N,{sub_group_by:r,group_by:a,column_id:e.id,icon:e.icon,title:e.name,count:(null==s?void 0:null===(x=s[e.id])||void 0===x?void 0:x.length)||0,issuePayload:e.payload,disableIssueCreation:g||M,storeType:j,addIssuesToView:b,kanbanFilters:u,handleKanbanFilters:m})}),v.showIssues&&(0,l.jsx)(O,{groupId:e.id,issuesMap:t,issueIds:s,displayProperties:n,sub_group_by:r,group_by:a,orderBy:_,sub_group_id:i,isDragDisabled:o,updateIssue:c,quickActions:d,enableQuickIssueCreate:h,quickAddCallback:p,viewId:f,disableIssueCreation:g,canEditProperties:y,scrollableContainerRef:w,handleOnDrop:k})]},e.id)})})}),A=(0,o.Pi)(e=>{let{issuesMap:t,issueIds:s,displayProperties:n,sub_group_by:r,group_by:a,sub_group_id:i="null",updateIssue:o,quickActions:c,kanbanFilters:d,handleKanbanFilters:u,enableQuickIssueCreate:m,quickAddCallback:h,viewId:p,disableIssueCreation:f,storeType:v,addIssuesToView:g,canEditProperties:j,scrollableContainerRef:b,handleOnDrop:y,showEmptyGroup:w,subGroupIssueHeaderCount:N,orderBy:k}=e,C=(0,x.m8)();return(0,l.jsx)(T,{issuesMap:t,issueIds:s,displayProperties:n,group_by:a,sub_group_by:r,orderBy:k,sub_group_id:i,isDragDisabled:!(null==C?void 0:C.getCanUserDragDrop(a,r)),updateIssue:o,quickActions:c,kanbanFilters:d,handleKanbanFilters:u,enableQuickIssueCreate:m,quickAddCallback:h,viewId:p,disableIssueCreation:f,storeType:v,addIssuesToView:g,canEditProperties:j,scrollableContainerRef:b,handleOnDrop:y,showEmptyGroup:w,subGroupIssueHeaderCount:N})});var D=s(65709),M=s(18927);let z=(0,o.Pi)(e=>{let{icon:t,title:s,count:n,column_id:r,kanbanFilters:a,handleKanbanFilters:i}=e;return(0,l.jsxs)("div",{className:"relative flex w-full flex-shrink-0 flex-row items-center gap-2 rounded-sm p-1.5 cursor-pointer",onClick:()=>i("sub_group_by",r),children:[(0,l.jsx)("div",{className:"flex h-[20px] w-[20px] flex-shrink-0 items-center justify-center overflow-hidden rounded-sm transition-all hover:bg-custom-background-80",children:(null==a?void 0:a.sub_group_by.includes(r))?(0,l.jsx)(D.Z,{width:14,strokeWidth:2}):(0,l.jsx)(M.Z,{width:14,strokeWidth:2})}),(0,l.jsx)("div",{className:"flex h-[20px] w-[20px] flex-shrink-0 items-center justify-center overflow-hidden rounded-sm",children:t||(0,l.jsx)(g.Z,{width:14,strokeWidth:2})}),(0,l.jsxs)("div",{className:"flex flex-shrink-0 items-center gap-1 text-sm",children:[(0,l.jsx)("div",{className:"line-clamp-1 text-custom-text-100",children:s}),(0,l.jsx)("div",{className:"pl-2 text-sm font-medium text-custom-text-300",children:n||0})]})]})}),L=(e,t)=>{let s=0;return Object.keys(e).map(l=>{var n,r;s+=(null==e?void 0:null===(r=e[l])||void 0===r?void 0:null===(n=r[t])||void 0===n?void 0:n.length)||0}),s},Z=(e,t,s)=>!!s||L(e,t.id)>0,q=e=>{let{issueIds:t,sub_group_by:s,group_by:n,storeType:r,list:a,kanbanFilters:i,handleKanbanFilters:o,showEmptyGroup:c}=e;return(0,l.jsx)("div",{className:"relative flex h-max min-h-full w-full items-center gap-2",children:a&&a.length>0&&a.map(e=>!1===Z(t,e,c)?(0,l.jsx)(l.Fragment,{}):(0,l.jsx)("div",{className:"flex w-[350px] flex-shrink-0 flex-col",children:(0,l.jsx)(N,{sub_group_by:s,group_by:n,column_id:e.id,icon:e.icon,title:e.name,count:L(t,null==e?void 0:e.id),kanbanFilters:i,handleKanbanFilters:o,issuePayload:e.payload,storeType:r})},"".concat(s,"_").concat(e.id)))})},B=(0,o.Pi)(e=>{let{issuesMap:t,issueIds:s,sub_group_by:n,group_by:r,list:a,storeType:i,updateIssue:o,quickActions:c,displayProperties:d,kanbanFilters:u,handleKanbanFilters:m,showEmptyGroup:h,enableQuickIssueCreate:p,canEditProperties:x,addIssuesToView:f,quickAddCallback:v,viewId:g,scrollableContainerRef:j,handleOnDrop:b,orderBy:y}=e,w=e=>{var t;let l=0;return(null==s?void 0:s[e])&&(null===(t=Object.keys(null==s?void 0:s[e]))||void 0===t||t.forEach(t=>{var n,r;l+=(null==s?void 0:null===(r=s[e])||void 0===r?void 0:null===(n=r[t])||void 0===n?void 0:n.length)||0})),l},N=e=>{let t={showGroup:!0,showIssues:!0};return h?t.showGroup=!0:w(e.id)>0?t.showGroup=!0:t.showGroup=!1,(null==u?void 0:u.sub_group_by.includes(e.id))&&(t.showIssues=!1),t};return(0,l.jsx)("div",{className:"relative h-max min-h-full w-full",children:a&&a.length>0&&a.map(e=>{let a=N(e);return!1===a.showGroup?(0,l.jsx)(l.Fragment,{}):(0,l.jsxs)("div",{className:"flex flex-shrink-0 flex-col",children:[(0,l.jsx)("div",{className:"sticky top-[50px] z-[3] py-1 flex w-full items-center bg-custom-background-100 border-y-[0.5px] border-custom-border-200",children:(0,l.jsx)("div",{className:"sticky left-0 flex-shrink-0",children:(0,l.jsx)(z,{column_id:e.id,icon:e.icon,title:e.name||"",count:w(e.id),kanbanFilters:u,handleKanbanFilters:m})})}),a.showIssues&&(0,l.jsx)("div",{className:"relative",children:(0,l.jsx)(A,{issuesMap:t,issueIds:null==s?void 0:s[e.id],displayProperties:d,sub_group_by:n,group_by:r,sub_group_id:e.id,storeType:i,updateIssue:o,quickActions:c,kanbanFilters:u,handleKanbanFilters:m,showEmptyGroup:h,enableQuickIssueCreate:p,canEditProperties:x,addIssuesToView:f,quickAddCallback:v,viewId:g,scrollableContainerRef:j,handleOnDrop:b,orderBy:y,subGroupIssueHeaderCount:e=>L(s,e)})})]},e.id)})})}),U=(0,o.Pi)(e=>{let{issuesMap:t,issueIds:s,displayProperties:n,sub_group_by:r,group_by:a,orderBy:i,updateIssue:o,storeType:c,quickActions:d,kanbanFilters:u,handleKanbanFilters:m,showEmptyGroup:h,handleOnDrop:p,disableIssueCreation:f,enableQuickIssueCreate:g,canEditProperties:j,addIssuesToView:b,quickAddCallback:y,viewId:w,scrollableContainerRef:N}=e,k=(0,x.Kb)(),C=(0,x.PY)(),S=(0,x.NP)(),_=(0,x.nv)(),I=(0,x.b7)(),E=(0,x.eD)(),P=(0,v.K_)(a,C,_,I,S,E,k,!0,(0,v.xV)(c)),R=(0,v.K_)(r,C,_,I,S,E,k,!0,(0,v.xV)(c));return P&&R?(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"sticky top-0 z-[4] h-[50px] bg-custom-background-90 px-2",children:(0,l.jsx)(q,{issueIds:s,group_by:a,sub_group_by:r,kanbanFilters:u,handleKanbanFilters:m,list:P,storeType:c,showEmptyGroup:h})}),r&&(0,l.jsx)(B,{issuesMap:t,list:R,issueIds:s,displayProperties:n,group_by:a,sub_group_by:r,orderBy:i,updateIssue:o,quickActions:d,kanbanFilters:u,handleKanbanFilters:m,showEmptyGroup:h,handleOnDrop:p,disableIssueCreation:f,enableQuickIssueCreate:g,addIssuesToView:b,canEditProperties:j,quickAddCallback:y,viewId:w,scrollableContainerRef:N,storeType:c})]}):null}),V=(0,o.Pi)(e=>{var t,s,o,v;let{QuickActions:g,showLoader:j,viewId:b,storeType:y,addIssuesToView:w,canEditPropertiesBasedOnProject:N,isCompletedCycle:k=!1}=e,C=(0,c.useRouter)(),{workspaceSlug:S,projectId:_}=C.query,{membership:{currentProjectRole:E}}=(0,x.aF)(),{captureIssueEvent:P}=(0,x.DN)(),{issueMap:F,issuesFilter:O,issues:T}=(0,x.gk)(y),{issue:{getIssueById:D}}=(0,x.p1)(),{updateIssue:M,removeIssue:z,removeIssueFromView:L,archiveIssue:Z,restoreIssue:q,updateFilters:B}=(0,f.C)(y),V=(0,n.useRef)(null),[W,K]=(0,n.useState)(!1),{isDragging:Y}=(0,x.m8)(),J=(null==T?void 0:T.groupedIssueIds)||[],H=null==O?void 0:null===(t=O.issueFilters)||void 0===t?void 0:t.displayFilters,Q=null==O?void 0:null===(s=O.issueFilters)||void 0===s?void 0:s.displayProperties,G=null==H?void 0:H.sub_group_by,$=null==H?void 0:H.group_by,X=null==H?void 0:H.order_by,ee=H||null,et=G?U:A,{enableInlineEditing:es,enableQuickAdd:el,enableIssueCreation:en}=(null==T?void 0:T.viewFlags)||{},er=(0,n.useRef)(null),[ea,ei]=(0,n.useState)(void 0),[eo,ec]=(0,n.useState)(!1),ed=!!E&&E>=p.MC.MEMBER,eu=(0,n.useCallback)(e=>{let t=N&&e?N(e):ed;return es&&t},[N,es,ed]);(0,n.useEffect)(()=>{let e=er.current;if(e)return(0,r.$)((0,i.O)({element:e}))},[null==er?void 0:er.current]),(0,n.useEffect)(()=>{let e=V.current;if(e)return(0,r.$)((0,a.wO)({element:e,getData:()=>({columnId:"issue-trash-box",groupId:"issue-trash-box",type:"DELETE"}),onDragEnter:()=>{K(!0)},onDragLeave:()=>{K(!1)},onDrop:e=>{K(!1);let t=I(e);t&&(ei(t.id),ec(!0))}}))},[null==V?void 0:V.current,K,ei,ec]);let em=async(e,t)=>{e.columnId&&t.columnId&&t.columnId===e.columnId&&t.id===e.id||await R(e,t,D,T.getIssueIds,M,$,G,"sort_order"!==X).catch(e=>{var t;(0,d.fz)({title:"Error!",type:d.do.ERROR,message:null!==(t=null==e?void 0:e.detail)&&void 0!==t?t:"Failed to perform this action"})})},eh=(0,n.useCallback)(e=>{let{issue:t,parentRef:s,customActionButton:n}=e;return(0,l.jsx)(g,{parentRef:s,customActionButton:n,issue:t,handleDelete:async()=>z(t.project_id,t.id),handleUpdate:async e=>M&&M(t.project_id,t.id,e),handleRemoveFromView:async()=>L&&L(t.project_id,t.id),handleArchive:async()=>Z&&Z(t.project_id,t.id),handleRestore:async()=>q&&q(t.project_id,t.id),readOnly:!ed||k})},[ed,k,z,M,L,Z,q]),ep=async()=>{let e=D(null!=ea?ea:"");ea&&e&&await z(e.project_id,ea).finally(()=>{ec(!1),ei(void 0),P({eventName:m.IO,payload:{id:ea,state:"FAILED",element:"Kanban layout drag & drop"},path:C.asPath})})},ex=(null==O?void 0:null===(o=O.issueFilters)||void 0===o?void 0:o.kanbanFilters)||{group_by:[],sub_group_by:[]};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(u.rKc,{dataId:ea,isOpen:eo,handleClose:()=>ec(!1),onSubmit:ep}),j&&(null==T?void 0:T.loader)==="init-loader"&&(0,l.jsx)("div",{className:"fixed right-2 top-16 z-30 flex h-10 w-10 items-center justify-center rounded bg-custom-background-80 shadow-custom-shadow-sm",children:(0,l.jsx)(d.$j,{className:"h-5 w-5"})}),(0,l.jsx)("div",{className:"horizontal-scrollbar scrollbar-lg relative flex h-full w-full bg-custom-background-90 ".concat(G?"vertical-scrollbar overflow-y-auto":"overflow-x-auto overflow-y-hidden"),ref:er,children:(0,l.jsxs)("div",{className:"relative h-full w-max min-w-full bg-custom-background-90",children:[(0,l.jsx)("div",{className:"fixed left-1/2 -translate-x-1/2 ".concat(Y?"z-40":""," top-3 mx-3 flex w-72 items-center justify-center"),ref:V,children:(0,l.jsx)("div",{className:"".concat(Y?"opacity-100":"opacity-0"," flex w-full items-center justify-center rounded border-2 border-red-500/20 bg-custom-background-100 px-3 py-5 text-xs font-medium italic text-red-500 ").concat(W?"bg-red-500 opacity-70 blur-2xl":""," transition duration-300"),children:"Drop here to delete the issue."})}),(0,l.jsx)("div",{className:"h-full w-max",children:(0,l.jsx)(et,{issuesMap:F,issueIds:J,displayProperties:Q,sub_group_by:G,group_by:$,orderBy:X,updateIssue:M,quickActions:eh,handleKanbanFilters:(e,t)=>{if(S&&_){var s,l;let n=(null==O?void 0:null===(l=O.issueFilters)||void 0===l?void 0:null===(s=l.kanbanFilters)||void 0===s?void 0:s[e])||[];n.includes(t)?n=n.filter(e=>e!=t):n.push(t),B(_.toString(),h.gc.KANBAN_FILTERS,{[e]:n})}},kanbanFilters:ex,enableQuickIssueCreate:el,showEmptyGroup:null===(v=null==ee?void 0:ee.show_empty_groups)||void 0===v||v,quickAddCallback:null==T?void 0:T.quickAddIssue,viewId:b,disableIssueCreation:!en||!ed||k,canEditProperties:eu,storeType:y,addIssuesToView:w,scrollableContainerRef:er,handleOnDrop:em})})]})})]})})},27905:function(e,t,s){s.d(t,{Ts:function(){return k},vE:function(){return S},Uq:function(){return M},RX:function(){return g},Xw:function(){return E},SU:function(){return C},qf:function(){return I}});var l=s(24246),n=s(27378),r=s(65331),a=s(97964),i=s(43659),o=s(25449),c=s(89001),d=s(20107),u=s(6780),m=s(10634),h=s(42683),p=s(18894),x=s(17764),f=s(48819);let v=(0,i.Pi)(e=>{let{cardRef:t,issue:s,updateIssue:n,quickActions:r,isReadOnly:a,displayProperties:i}=e,{isMobile:c}=(0,p.L)(),{getProjectIdentifierById:d}=(0,m.PY)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.K,{displayProperties:i||{},displayPropertyKey:"key",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("div",{className:"line-clamp-1 text-xs text-custom-text-300",children:[d(s.project_id),"-",s.sequence_id]}),(0,l.jsx)("div",{className:"absolute -top-1 right-0 hidden group-hover/kanban-block:block",onClick:e=>{e.stopPropagation(),e.preventDefault()},children:r({issue:s,parentRef:t})})]})}),(null==s?void 0:s.is_draft)?(0,l.jsx)(o.u,{tooltipContent:s.name,isMobile:c,children:(0,l.jsx)("span",{children:s.name})}):(0,l.jsx)("div",{className:"w-full line-clamp-1 text-sm text-custom-text-100 mb-1.5",children:(0,l.jsx)(o.u,{tooltipContent:s.name,isMobile:c,children:(0,l.jsx)("span",{children:s.name})})}),(0,l.jsx)(x.j,{className:"flex flex-wrap items-center gap-2 whitespace-nowrap text-custom-text-300 pt-1.5",issue:s,displayProperties:i,activeLayout:"Kanban",updateIssue:n,isReadOnly:a})]})}),g=(0,i.Pi)(e=>{let{issueId:t,issuesMap:s,displayProperties:i,isDragDisabled:p,updateIssue:x,quickActions:f,canEditProperties:g,scrollableContainerRef:j,issueIds:b}=e,y=(0,n.useRef)(null),{router:{workspaceSlug:w}}=(0,m.IX)(),{getIsIssuePeeked:N,setPeekIssue:k}=(0,m.p1)(),C=e=>w&&e&&e.project_id&&e.id&&!N(e.id)&&k({workspaceSlug:w,projectId:e.project_id,issueId:e.id}),S=s[t],{setIsDragging:_}=(0,m.m8)(),[I,E]=(0,n.useState)(!1),[P,R]=(0,n.useState)(!1),F=g(null==S?void 0:S.project_id),O=!p&&!(null==S?void 0:S.tempId)&&F;return((0,h.Z)(y,()=>{var e,t;null==y||null===(t=y.current)||void 0===t||null===(e=t.classList)||void 0===e||e.remove(d.EL)}),(0,n.useEffect)(()=>{let e=y.current;if(e)return(0,r.$)((0,a.En)({element:e,dragHandle:e,canDrag:()=>O,getInitialData:()=>({id:null==S?void 0:S.id,type:"ISSUE"}),onDragStart:()=>{R(!0),_(!0)},onDrop:()=>{_(!1),R(!1)}}),(0,a.wO)({element:e,getData:()=>({id:null==S?void 0:S.id,type:"ISSUE"}),onDragEnter:()=>{E(!0)},onDragLeave:()=>{E(!1)},onDrop:()=>{E(!1)}}))},[null==y?void 0:y.current,null==S?void 0:S.id,R,E]),S)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.fH,{isVisible:!P&&I}),(0,l.jsx)("div",{className:(0,u.cn)("group/kanban-block relative p-1.5",{"z-[1]":P}),onDragStart:()=>{O?R(!0):(0,o.fz)({type:o.do.WARNING,title:"Cannot move issue",message:"Drag and drop is disabled for the current grouping"})},children:(0,l.jsx)(o.Ug,{id:"issue-".concat(S.id),href:"/".concat(w,"/projects/").concat(S.project_id,"/").concat(S.archived_at?"archives/":"","issues/").concat(S.id),ref:y,className:(0,u.cn)("block rounded border-[1px] outline-[0.5px] outline-transparent w-full border-custom-border-200 bg-custom-background-100 text-sm transition-all hover:border-custom-border-400",{"hover:cursor-pointer":O},{"border border-custom-primary-70 hover:border-custom-primary-70":N(S.id)},{"bg-custom-background-80 z-[100]":P}),target:"_blank",onClick:()=>C(S),disabled:!!(null==S?void 0:S.tempId),children:(0,l.jsx)(c.Z,{classNames:"space-y-2 px-3 py-2",root:j,defaultHeight:"100px",horizontalOffset:50,changingReference:b,children:(0,l.jsx)(v,{cardRef:y,issue:S,displayProperties:i,updateIssue:x,quickActions:f,isReadOnly:!F})})})})]}):null});g.displayName="KanbanIssueBlock";var j=s(86677),b=s(68114),y=s(93997),w=s(51374),N=s(60680);let k=(0,i.Pi)(()=>{var e;let{workspaceSlug:t,projectId:s,cycleId:r}=(0,j.useRouter)().query,{issues:a}=(0,m.gk)(y.rS.CYCLE),{currentProjectCompletedCycleIds:i}=(0,m.nv)(),{membership:{currentProjectRole:o}}=(0,m.aF)(),c=!!r&&!!i&&i.includes(r.toString()),d=!!o&&o>=w.MC.MEMBER,u=(0,n.useCallback)(()=>!c&&d,[c,d]),h=(0,n.useCallback)(e=>{if(!t||!s||!r)throw Error();return a.addIssueToCycle(t.toString(),s.toString(),r.toString(),e)},[null==a?void 0:a.addIssueToCycle,t,s,r]);return(0,l.jsx)(N.P,{showLoader:!0,QuickActions:b.JWn,viewId:null!==(e=null==r?void 0:r.toString())&&void 0!==e?e:"",storeType:y.rS.CYCLE,addIssuesToView:h,canEditPropertiesBasedOnProject:u,isCompletedCycle:c})}),C=(0,i.Pi)(()=>{let{workspaceSlug:e,projectId:t,moduleId:s}=(0,j.useRouter)().query,{issues:n}=(0,m.gk)(y.rS.MODULE);return(0,l.jsx)(N.P,{showLoader:!0,QuickActions:b.PFz,viewId:null==s?void 0:s.toString(),storeType:y.rS.MODULE,addIssuesToView:l=>{if(!e||!t||!s)throw Error();return n.addIssuesToModule(e.toString(),t.toString(),s.toString(),l)}})});s(73865);let S=(0,i.Pi)(()=>(0,l.jsx)(N.P,{showLoader:!0,QuickActions:b.naC,storeType:y.rS.PROJECT}));var _=s(12404);let I=(0,i.Pi)(()=>{let{viewId:e}=(0,j.useRouter)().query;return(0,l.jsx)(N.P,{showLoader:!0,QuickActions:_.n,storeType:y.rS.PROJECT_VIEW,viewId:null==e?void 0:e.toString()})}),E=(0,n.memo)(e=>{let{sub_group_id:t,columnId:s,issuesMap:n,issueIds:r,displayProperties:a,isDragDisabled:i,updateIssue:o,quickActions:c,canEditProperties:d,scrollableContainerRef:u}=e;return(0,l.jsx)(l.Fragment,{children:r&&r.length>0?(0,l.jsx)(l.Fragment,{children:r.map(e=>{if(!e)return null;let m=e;return s&&(m="".concat(m,"__").concat(s)),t&&(m="".concat(m,"__").concat(t)),(0,l.jsx)(b.RXO,{issueId:e,issuesMap:n,displayProperties:a,updateIssue:o,quickActions:c,draggableId:m,isDragDisabled:i,canEditProperties:d,scrollableContainerRef:u,issueIds:r},m)})}):null})});var P=s(88039),R=s(47542),F=s(865),O=s(85409),T=s(38758);let A=e=>{var t;let{register:s,setFocus:r,projectDetail:a}=e;return(0,n.useEffect)(()=>{r("name")},[r]),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("h4",{className:"text-xs font-medium leading-5 text-custom-text-300",children:null!==(t=null==a?void 0:a.identifier)&&void 0!==t?t:"..."}),(0,l.jsx)("input",{autoComplete:"off",placeholder:"Issue Title",...s("name",{required:"Issue title is required."}),className:"w-full rounded-md bg-transparent px-2 py-1.5 pl-0 text-sm font-medium leading-5 text-custom-text-200 outline-none"})]})},D={name:""},M=(0,i.Pi)(e=>{let{formKey:t,prePopulatedData:s,quickAddCallback:r,viewId:a}=e,i=(0,j.useRouter)(),{workspaceSlug:c,projectId:d}=i.query,{getProjectById:u}=(0,m.PY)(),{captureIssueEvent:p}=(0,m.DN)(),x=d?u(d.toString()):null,f=(0,n.useRef)(null),[v,g]=(0,n.useState)(!1),b=()=>g(!1);(0,T.Z)("Escape",b),(0,h.Z)(f,b);let{reset:y,handleSubmit:w,setFocus:N,register:k,formState:{isSubmitting:C}}=(0,P.cI)({defaultValues:D});(0,n.useEffect)(()=>{v||y({...D})},[v,y]);let S=async e=>{if(C||!c||!d)return;y({...D});let t=(0,O.vd)(d.toString(),{...null!=s?s:{},...e});if(r){let e=r(c.toString(),d.toString(),{...t},a);(0,o.uW)(e,{loading:"Adding issue...",success:{title:"Success!",message:()=>"Issue created successfully."},error:{title:"Error!",message:e=>(null==e?void 0:e.message)||"Some error occurred. Please try again."}}),await e.then(e=>{p({eventName:F.lc,payload:{...e,state:"SUCCESS",element:"Kanban quick add"},path:i.asPath})}).catch(()=>{p({eventName:F.lc,payload:{...t,state:"FAILED",element:"Kanban quick add"},path:i.asPath})})}};return(0,l.jsx)(l.Fragment,{children:v?(0,l.jsxs)("div",{className:"m-1.5 overflow-hidden rounded shadow-custom-shadow-sm",children:[(0,l.jsx)("form",{ref:f,onSubmit:w(S),className:"flex w-full items-center gap-x-3 bg-custom-background-100 p-3",children:(0,l.jsx)(A,{formKey:t,register:k,setFocus:N,projectDetail:x})}),(0,l.jsx)("div",{className:"px-3 py-2 text-xs italic text-custom-text-200",children:"Press 'Enter' to add another issue"})]}):(0,l.jsxs)("div",{className:"flex w-full cursor-pointer items-center gap-2 p-3 py-1.5 text-custom-primary-100",onClick:()=>g(!0),children:[(0,l.jsx)(R.Z,{className:"h-3.5 w-3.5 stroke-2"}),(0,l.jsx)("span",{className:"text-sm font-medium text-custom-primary-100",children:"New Issue"})]})})})},73865:function(e,t,s){s.d(t,{e:function(){return d}});var l=s(24246),n=s(43659),r=s(68114),a=s(93997),i=s(51374),o=s(10634),c=s(60680);let d=(0,n.Pi)(()=>{let{membership:{currentWorkspaceAllProjectsRole:e}}=(0,o.aF)();return(0,l.jsx)(c.P,{showLoader:!0,QuickActions:r.naC,storeType:a.rS.PROFILE,canEditPropertiesBasedOnProject:t=>{let s=e&&e[t];return!!s&&s>=i.MC.MEMBER}})})},76143:function(e,t,s){s.d(t,{v:function(){return j}});var l=s(24246),n=s(27378),r=s(43659),a=s(51374),i=s(10634),o=s(76926),c=s(68114),d=s(20107),u=s(86677),m=s(83074),h=s(47542),p=s(25449),x=s(23258);let f=(0,r.Pi)(e=>{let{icon:t,title:s,count:r,issuePayload:a,disableIssueCreation:o,storeType:d,addIssuesToView:f}=e,v=(0,u.useRouter)(),{workspaceSlug:g,projectId:j,moduleId:b,cycleId:y}=v.query,{setTrackElement:w}=(0,i.DN)(),[N,k]=(0,n.useState)(!1),[C,S]=(0,n.useState)(!1),_=v.pathname.includes("draft-issue"),I=b||y,E=b?{module:b.toString()}:{cycle:!0},P=async e=>{if(!g||!j)return;let t=e.map(e=>e.id);try{await (null==f?void 0:f(t)),(0,p.fz)({type:p.do.SUCCESS,title:"Success!",message:"Issues added to the cycle successfully."})}catch(e){(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Selected issues could not be added to the cycle. Please try again."})}};return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"relative flex w-full flex-shrink-0 flex-row items-center gap-2 py-1.5",children:[(0,l.jsx)("div",{className:"flex h-5 w-5 flex-shrink-0 items-center justify-center overflow-hidden rounded-sm",children:t||(0,l.jsx)(m.Z,{className:"h-3.5 w-3.5",strokeWidth:2})}),(0,l.jsxs)("div",{className:"relative flex w-full flex-row items-center gap-1 overflow-hidden",children:[(0,l.jsx)("div",{className:"inline-block line-clamp-1 truncate font-medium text-custom-text-100",children:s}),(0,l.jsx)("div",{className:"pl-2 text-sm font-medium text-custom-text-300",children:r||0})]}),!o&&(I?(0,l.jsxs)(p.fR,{customButton:(0,l.jsx)("span",{className:"flex h-5 w-5 flex-shrink-0 cursor-pointer items-center justify-center overflow-hidden rounded-sm transition-all hover:bg-custom-background-80",children:(0,l.jsx)(h.Z,{className:"h-3.5 w-3.5",strokeWidth:2})}),children:[(0,l.jsx)(p.fR.MenuItem,{onClick:()=>{w("List layout"),k(!0)},children:(0,l.jsx)("span",{className:"flex items-center justify-start gap-2",children:"Create issue"})}),(0,l.jsx)(p.fR.MenuItem,{onClick:()=>{w("List layout"),S(!0)},children:(0,l.jsx)("span",{className:"flex items-center justify-start gap-2",children:"Add an existing issue"})})]}):(0,l.jsx)("div",{className:"flex h-5 w-5 flex-shrink-0 cursor-pointer items-center justify-center overflow-hidden rounded-sm transition-all hover:bg-custom-background-80",onClick:()=>{w("List layout"),k(!0)},children:(0,l.jsx)(h.Z,{width:14,strokeWidth:2})})),(0,l.jsx)(c.vlH,{isOpen:N,onClose:()=>k(!1),data:a,storeType:d,isDraft:_}),I&&(0,l.jsx)(x.H2,{workspaceSlug:null==g?void 0:g.toString(),projectId:null==j?void 0:j.toString(),isOpen:C,handleClose:()=>S(!1),searchParams:E,handleOnSubmit:P})]})})}),v=e=>{let{issueIds:t,issuesMap:s,group_by:r,updateIssue:a,quickActions:o,displayProperties:u,enableIssueQuickAdd:m,showEmptyGroup:h,canEditProperties:p,quickAddCallback:x,viewId:v,disableIssueCreation:g,storeType:j,addIssuesToView:b,isCompletedCycle:y=!1}=e,w=(0,i.Kb)(),N=(0,i.PY)(),k=(0,i.NP)(),C=(0,i.eD)(),S=(0,i.nv)(),_=(0,i.b7)(),I=(0,n.useRef)(null),E=(0,d.K_)(r,N,S,_,k,C,w,!0,(0,d.xV)(j));if(!E)return null;let P=(e,t)=>{var s;let l=null===(s=C.projectStates)||void 0===s?void 0:s.find(e=>e.default),n={state_id:null==l?void 0:l.id};return null===e?{...n}:"state"===e?{...n,state_id:t}:"priority"===e?{...n,priority:t}:"labels"===e&&"None"!=t?{...n,label_ids:[t]}:"assignees"===e&&"None"!=t?{...n,assignee_ids:[t]}:"cycle"===e&&"None"!=t?{...n,cycle_id:t}:"module"===e&&"None"!=t?{...n,module_ids:[t]}:"created_by"===e?{...n}:{...n,[e]:t}},R=e=>{let t=(null==e?void 0:e.length)||0;return!!h||!(t<=0)},F=null===r,O="created_by"===r;return(0,l.jsx)("div",{ref:I,className:"vertical-scrollbar scrollbar-lg relative h-full w-full overflow-auto vertical-scrollbar-margin-top-md",children:E&&E.length>0&&E.map(e=>{var n;return R(F?t:null==t?void 0:t[e.id])&&(0,l.jsxs)("div",{className:"flex flex-shrink-0 flex-col",children:[(0,l.jsx)("div",{className:"sticky top-0 z-[2] w-full flex-shrink-0 border-b border-custom-border-200 bg-custom-background-90 px-3 py-1",children:(0,l.jsx)(f,{icon:e.icon,title:e.name||"",count:F?(null==t?void 0:t.length)||0:(null==t?void 0:null===(n=t[e.id])||void 0===n?void 0:n.length)||0,issuePayload:e.payload,disableIssueCreation:g||O||y,storeType:j,addIssuesToView:b})}),t&&(0,l.jsx)(c.aTZ,{issueIds:F?t||0:(null==t?void 0:t[e.id])||0,issuesMap:s,updateIssue:a,quickActions:o,displayProperties:u,canEditProperties:p,containerRef:I}),m&&!g&&!O&&!y&&(0,l.jsx)("div",{className:"sticky bottom-0 z-[1] w-full flex-shrink-0",children:(0,l.jsx)(c.LnB,{prePopulatedData:P(r,e.id),quickAddCallback:x,viewId:v})})]},e.id)})})},g=e=>{let{issueIds:t,issuesMap:s,group_by:n,updateIssue:r,quickActions:a,quickAddCallback:i,viewId:o,displayProperties:c,showEmptyGroup:d,enableIssueQuickAdd:u,canEditProperties:m,disableIssueCreation:h,storeType:p,addIssuesToView:x,isCompletedCycle:f=!1}=e;return(0,l.jsx)("div",{className:"relative h-full w-full",children:(0,l.jsx)(v,{issueIds:t,issuesMap:s,group_by:n,updateIssue:r,quickActions:a,displayProperties:c,enableIssueQuickAdd:u,showEmptyGroup:d,canEditProperties:m,quickAddCallback:i,viewId:o,disableIssueCreation:h,storeType:p,addIssuesToView:x,isCompletedCycle:f})})},j=(0,r.Pi)(e=>{var t,s,r;let{QuickActions:c,viewId:d,storeType:u,addIssuesToView:m,canEditPropertiesBasedOnProject:h,isCompletedCycle:p=!1}=e,{issuesFilter:x,issues:f}=(0,i.gk)(u),{updateIssue:v,removeIssue:j,removeIssueFromView:b,archiveIssue:y,restoreIssue:w}=(0,o.C)(u),{membership:{currentProjectRole:N}}=(0,i.aF)(),{issueMap:k}=(0,i.gk)(),C=!!N&&N>=a.MC.MEMBER,S=(null==f?void 0:f.groupedIssueIds)||[],{enableInlineEditing:_,enableQuickAdd:I,enableIssueCreation:E}=(null==f?void 0:f.viewFlags)||{},P=(0,n.useCallback)(e=>{let t=h&&e?h(e):C;return!!_&&t},[h,_,C]),R=null==x?void 0:null===(t=x.issueFilters)||void 0===t?void 0:t.displayFilters,F=null==x?void 0:null===(s=x.issueFilters)||void 0===s?void 0:s.displayProperties,O=(null==R?void 0:R.group_by)||null,T=null!==(r=null==R?void 0:R.show_empty_groups)&&void 0!==r&&r,A=(0,n.useCallback)(e=>{let{issue:t,parentRef:s}=e;return(0,l.jsx)(c,{parentRef:s,issue:t,handleDelete:async()=>j(t.project_id,t.id),handleUpdate:async e=>v&&v(t.project_id,t.id,e),handleRemoveFromView:async()=>b&&b(t.project_id,t.id),handleArchive:async()=>y&&y(t.project_id,t.id),handleRestore:async()=>w&&w(t.project_id,t.id),readOnly:!C||p})},[C,p,j,v,b,y,w]);return(0,l.jsx)("div",{className:"relative h-full w-full bg-custom-background-90",children:(0,l.jsx)(g,{issuesMap:k,displayProperties:F,group_by:O,updateIssue:v,quickActions:A,issueIds:S,showEmptyGroup:T,viewId:d,quickAddCallback:null==f?void 0:f.quickAddIssue,enableIssueQuickAdd:!!I,canEditProperties:P,disableIssueCreation:!E||!C,storeType:u,addIssuesToView:m,isCompletedCycle:p})})})},95919:function(e,t,s){s.d(t,{j:function(){return d}});var l=s(24246),n=s(43659),r=s(68114),a=s(93997),i=s(51374),o=s(10634),c=s(76143);let d=(0,n.Pi)(()=>{let{membership:{currentWorkspaceAllProjectsRole:e}}=(0,o.aF)();return(0,l.jsx)(c.v,{QuickActions:r.naC,storeType:a.rS.PROFILE,canEditPropertiesBasedOnProject:t=>{let s=e&&e[t];return!!s&&s>=i.MC.MEMBER}})})},17764:function(e,t,s){s.d(t,{j:function(){return C}});var l=s(24246),n=s(27378),r=s(20098),a=s.n(r),i=s(43659),o=s(86677),c=s(41256),d=s(21219),u=s(32036),m=s(95232),h=s(3515),p=s(25449),x=s(36738),f=s(865),v=s(93997),g=s(6780),j=s(74273),b=s(85409),y=s(10634),w=s(18894),N=s(80314),k=s(48819);let C=(0,i.Pi)(e=>{var t,s,r,i,C,S,_;let{issue:I,updateIssue:E,displayProperties:P,activeLayout:R,isReadOnly:F,className:O}=e,{getProjectById:T}=(0,y.PY)(),{labelMap:A}=(0,y.NP)(),{captureIssueEvent:D}=(0,y.DN)(),{issues:{addModulesToIssue:M,removeModulesFromIssue:z}}=(0,y.gk)(v.rS.MODULE),{issues:{addIssueToCycle:L,removeIssueFromCycle:Z}}=(0,y.gk)(v.rS.CYCLE),{areEstimatesEnabledForCurrentProject:q}=(0,y.ZT)(),{getStateById:B}=(0,y.eD)(),{isMobile:U}=(0,w.L)(),V=T(I.project_id),W=(0,o.useRouter)(),{workspaceSlug:K}=W.query,Y="".concat(R," layout"),J=B(I.state_id),H=(0,n.useMemo)(()=>({addModulesToIssue:async e=>{K&&I.project_id&&I.id&&await (null==M?void 0:M(K.toString(),I.project_id,I.id,e))},removeModulesFromIssue:async e=>{K&&I.project_id&&I.id&&await (null==z?void 0:z(K.toString(),I.project_id,I.id,e))},addIssueToCycle:async e=>{K&&I.project_id&&I.id&&await (null==L?void 0:L(K.toString(),I.project_id,e,[I.id]))},removeIssueFromCycle:async e=>{K&&I.project_id&&I.id&&await (null==Z?void 0:Z(K.toString(),I.project_id,e,I.id))}}),[K,I,M,z,L,Z]),Q=(0,n.useCallback)(e=>{if(!I||!I.module_ids||!e)return;let t=a()(I.module_ids,e),s=[],l=[];for(let e of t)I.module_ids.includes(e)?l.push(e):s.push(e);s.length>0&&H.addModulesToIssue(s),l.length>0&&H.removeModulesFromIssue(l),D({eventName:f.C6,payload:{...I,state:"SUCCESS",element:Y},path:W.asPath,updates:{changed_property:"module_ids",change_details:{module_ids:e}}})},[H,D,Y,W,I]),G=(0,n.useCallback)(e=>{var t,s,l;I&&I.cycle_id!==e&&(e?null===(t=H.addIssueToCycle)||void 0===t||t.call(H,e):null===(s=H.removeIssueFromCycle)||void 0===s||s.call(H,null!==(l=I.cycle_id)&&void 0!==l?l:""),D({eventName:f.C6,payload:{...I,state:"SUCCESS",element:Y},path:W.asPath,updates:{changed_property:"cycle",change_details:{cycle_id:e}}}))},[I,H,D,Y,W.asPath]),$=()=>{W.push({pathname:"/".concat(K,"/projects/").concat(I.project_id,"/").concat(I.archived_at?"archives/":"","issues/").concat(I.id),hash:"sub-issues"})};if(!P)return null;let X=(null==I?void 0:null===(t=I.label_ids)||void 0===t?void 0:t.map(e=>A[e]))||[],ee=(0,j._3)(I.start_date);null==ee||ee.setDate(ee.getDate());let et=(0,j._3)(I.target_date);null==et||et.setDate(et.getDate());let es=e=>{e.stopPropagation(),e.preventDefault()};return(0,l.jsxs)("div",{className:O,children:[(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"state",children:(0,l.jsx)("div",{className:"h-5",onClick:es,children:(0,l.jsx)(x.sb,{buttonContainerClassName:"truncate max-w-40",value:I.state_id,onChange:e=>{E&&E(I.project_id,I.id,{state_id:e}).then(()=>{D({eventName:f.C6,payload:{...I,state:"SUCCESS",element:Y},path:W.asPath,updates:{changed_property:"state",change_details:e}})})},projectId:I.project_id,disabled:F,buttonVariant:"border-with-text",showTooltip:!0})})}),(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"priority",children:(0,l.jsx)("div",{className:"h-5",onClick:es,children:(0,l.jsx)(x.Iw,{value:(null==I?void 0:I.priority)||null,onChange:e=>{E&&E(I.project_id,I.id,{priority:e}).then(()=>{D({eventName:f.C6,payload:{...I,state:"SUCCESS",element:Y},path:W.asPath,updates:{changed_property:"priority",change_details:e}})})},disabled:F,buttonVariant:"border-without-text",buttonClassName:"border",showTooltip:!0})})}),(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"labels",children:(0,l.jsx)("div",{className:"h-5",onClick:es,children:(0,l.jsx)(N.Y,{projectId:(null==I?void 0:I.project_id)||null,value:(null==I?void 0:I.label_ids)||null,defaultOptions:X,onChange:e=>{E&&E(I.project_id,I.id,{label_ids:e}).then(()=>{D({eventName:f.C6,payload:{...I,state:"SUCCESS",element:Y},path:W.asPath,updates:{changed_property:"labels",change_details:e}})})},disabled:F,hideDropdownArrow:!0})})}),(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"start_date",children:(0,l.jsx)("div",{className:"h-5",onClick:es,children:(0,l.jsx)(x.qp,{value:null!==(C=I.start_date)&&void 0!==C?C:null,onChange:e=>{E&&E(I.project_id,I.id,{start_date:e?(0,j.ss)(e):null}).then(()=>{D({eventName:f.C6,payload:{...I,state:"SUCCESS",element:Y},path:W.asPath,updates:{changed_property:"start_date",change_details:e?(0,j.ss)(e):null}})})},maxDate:et,placeholder:"Start date",icon:(0,l.jsx)(c.Z,{className:"h-3 w-3 flex-shrink-0"}),buttonVariant:I.start_date?"border-with-text":"border-without-text",disabled:F,showTooltip:!0})})}),(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"due_date",children:(0,l.jsx)("div",{className:"h-5",onClick:es,children:(0,l.jsx)(x.qp,{value:null!==(S=null==I?void 0:I.target_date)&&void 0!==S?S:null,onChange:e=>{E&&E(I.project_id,I.id,{target_date:e?(0,j.ss)(e):null}).then(()=>{D({eventName:f.C6,payload:{...I,state:"SUCCESS",element:Y},path:W.asPath,updates:{changed_property:"target_date",change_details:e?(0,j.ss)(e):null}})})},minDate:ee,placeholder:"Due date",icon:(0,l.jsx)(d.Z,{className:"h-3 w-3 flex-shrink-0"}),buttonVariant:I.target_date?"border-with-text":"border-without-text",buttonClassName:(0,b.QU)(I.target_date,null==J?void 0:J.group)?"text-red-500":"",clearIconClassName:"!text-custom-text-100",disabled:F,showTooltip:!0})})}),(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"assignee",children:(0,l.jsx)("div",{className:"h-5",onClick:es,children:(0,l.jsx)(x.Yp,{projectId:null==I?void 0:I.project_id,value:null==I?void 0:I.assignee_ids,onChange:e=>{E&&E(I.project_id,I.id,{assignee_ids:e}).then(()=>{D({eventName:f.C6,payload:{...I,state:"SUCCESS",element:Y},path:W.asPath,updates:{changed_property:"assignees",change_details:e}})})},disabled:F,multiple:!0,buttonVariant:(null===(s=I.assignee_ids)||void 0===s?void 0:s.length)>0?"transparent-without-text":"border-without-text",buttonClassName:(null===(r=I.assignee_ids)||void 0===r?void 0:r.length)>0?"hover:bg-transparent px-0":"",showTooltip:(null==I?void 0:null===(i=I.assignee_ids)||void 0===i?void 0:i.length)===0,placeholder:"Assignees",tooltipContent:""})})}),(null==V?void 0:V.module_view)&&(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"modules",children:(0,l.jsx)("div",{className:"h-5",onClick:es,children:(0,l.jsx)(x.xL,{buttonContainerClassName:"truncate max-w-40",projectId:null==I?void 0:I.project_id,value:null!==(_=null==I?void 0:I.module_ids)&&void 0!==_?_:[],onChange:Q,disabled:F,multiple:!0,buttonVariant:"border-with-text",showCount:!0,showTooltip:!0})})}),(null==V?void 0:V.cycle_view)&&(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"cycle",children:(0,l.jsx)("div",{className:"h-5",onClick:es,children:(0,l.jsx)(x._X,{buttonContainerClassName:"truncate max-w-40",projectId:null==I?void 0:I.project_id,value:null==I?void 0:I.cycle_id,onChange:G,disabled:F,buttonVariant:"border-with-text",showTooltip:!0})})}),q&&(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"estimate",children:(0,l.jsx)("div",{className:"h-5",onClick:es,children:(0,l.jsx)(x.ym,{value:I.estimate_point,onChange:e=>{E&&E(I.project_id,I.id,{estimate_point:e}).then(()=>{D({eventName:f.C6,payload:{...I,state:"SUCCESS",element:Y},path:W.asPath,updates:{changed_property:"estimate_point",change_details:e}})})},projectId:I.project_id,disabled:F,buttonVariant:"border-with-text",showTooltip:!0})})}),(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"sub_issue_count",shouldRenderProperty:e=>!!e.sub_issue_count&&!!I.sub_issues_count,children:(0,l.jsx)(p.u,{tooltipHeading:"Sub-issues",tooltipContent:"".concat(I.sub_issues_count),isMobile:U,children:(0,l.jsxs)("div",{onClick:e=>{e.stopPropagation(),e.preventDefault(),I.sub_issues_count&&$()},className:(0,g.cn)("flex h-5 flex-shrink-0 items-center justify-center gap-2 overflow-hidden rounded border-[0.5px] border-custom-border-300 px-2.5 py-1",{"hover:bg-custom-background-80 cursor-pointer":I.sub_issues_count}),children:[(0,l.jsx)(u.Z,{className:"h-3 w-3 flex-shrink-0",strokeWidth:2}),(0,l.jsx)("div",{className:"text-xs",children:I.sub_issues_count})]})})}),(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"attachment_count",shouldRenderProperty:e=>!!e.attachment_count&&!!I.attachment_count,children:(0,l.jsx)(p.u,{tooltipHeading:"Attachments",tooltipContent:"".concat(I.attachment_count),isMobile:U,children:(0,l.jsxs)("div",{className:"flex h-5 flex-shrink-0 items-center justify-center gap-2 overflow-hidden rounded border-[0.5px] border-custom-border-300 px-2.5 py-1",onClick:es,children:[(0,l.jsx)(m.Z,{className:"h-3 w-3 flex-shrink-0",strokeWidth:2}),(0,l.jsx)("div",{className:"text-xs",children:I.attachment_count})]})})}),(0,l.jsx)(k.K,{displayProperties:P,displayPropertyKey:"link",shouldRenderProperty:e=>!!e.link&&!!I.link_count,children:(0,l.jsx)(p.u,{tooltipHeading:"Links",tooltipContent:"".concat(I.link_count),isMobile:U,children:(0,l.jsxs)("div",{className:"flex h-5 flex-shrink-0 items-center justify-center gap-2 overflow-hidden rounded border-[0.5px] border-custom-border-300 px-2.5 py-1",onClick:es,children:[(0,l.jsx)(h.Z,{className:"h-3 w-3 flex-shrink-0",strokeWidth:2}),(0,l.jsx)("div",{className:"text-xs",children:I.link_count})]})})})]})})},80314:function(e,t,s){s.d(t,{Y:function(){return v}});var l=s(24246),n=s(27378),r=s(43659),a=s(69570),i=s(68687),o=s(65709),c=s(81630),d=s(1759),u=s(66778),m=s(25449),h=s(10634),p=s(93270),x=s(42683),f=s(18894);let v=(0,r.Pi)(e=>{let{projectId:t,value:s,defaultOptions:r=[],onChange:v,onClose:g,disabled:j,hideDropdownArrow:b=!1,className:y,buttonClassName:w="",optionsClassName:N="",placement:k,maxRender:C=2,noLabelBorder:S=!1,placeholderText:_}=e,[I,E]=(0,n.useState)(""),[P,R]=(0,n.useState)(!1),F=(0,n.useRef)(null),O=(0,n.useRef)(null),[T,A]=(0,n.useState)(null),[D,M]=(0,n.useState)(null),[z,L]=(0,n.useState)(!1),{router:{workspaceSlug:Z}}=(0,h.IX)(),{fetchProjectLabels:q,getProjectLabels:B}=(0,h.NP)(),{isMobile:U}=(0,f.L)(),V=B(t),W=()=>{!V&&Z&&t&&q(Z,t).then(()=>L(!1))},K=()=>{P&&(R(!1),g&&g())},Y=()=>{P||W(),R(e=>!e),P&&g&&g()},J=(0,p.j)(Y,K);(0,x.Z)(F,K),(0,n.useEffect)(()=>{P&&O.current&&O.current.focus()},[P]);let{styles:H,attributes:Q}=(0,a.D)(T,D,{placement:null!=k?k:"bottom-start",modifiers:[{name:"preventOverflow",options:{padding:12}}]});if(!s)return null;let G=r;V&&V.length>0&&(G=V);let $=G.map(e=>({value:null==e?void 0:e.id,query:null==e?void 0:e.name,content:(0,l.jsxs)("div",{className:"flex items-center justify-start gap-2 overflow-hidden",children:[(0,l.jsx)("span",{className:"h-2.5 w-2.5 flex-shrink-0 rounded-full",style:{backgroundColor:null==e?void 0:e.color}}),(0,l.jsx)("div",{className:"line-clamp-1 inline-block truncate",children:null==e?void 0:e.name})]})})),X=""===I?$:null==$?void 0:$.filter(e=>e.query.toLowerCase().includes(I.toLowerCase())),ee=(0,l.jsx)("div",{className:"flex h-5 w-full flex-wrap items-center gap-2 overflow-hidden",children:s.length>0?s.length<=C?(0,l.jsx)(l.Fragment,{children:null==G?void 0:G.filter(e=>s.includes(null==e?void 0:e.id)).map(e=>{var t,s;return(0,l.jsx)(m.u,{position:"top",tooltipHeading:"Labels",tooltipContent:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",isMobile:U,children:(0,l.jsx)("div",{className:"flex overflow-hidden hover:bg-custom-background-80 ".concat(!j&&"cursor-pointer"," h-full max-w-full flex-shrink-0 items-center rounded border-[0.5px] border-custom-border-300 px-2.5 py-1 text-xs"),children:(0,l.jsxs)("div",{className:"flex max-w-full items-center gap-1.5 overflow-hidden text-custom-text-200",children:[(0,l.jsx)("span",{className:"h-2 w-2 flex-shrink-0 rounded-full",style:{backgroundColor:null!==(s=null==e?void 0:e.color)&&void 0!==s?s:"#000000"}}),(0,l.jsx)("div",{className:"line-clamp-1 inline-block w-auto max-w-[100px] truncate",children:null==e?void 0:e.name})]})},null==e?void 0:e.id)},e.id)})}):(0,l.jsx)("div",{className:"flex h-full flex-shrink-0 items-center rounded border-[0.5px] border-custom-border-300 px-2.5 py-1 text-xs ".concat(j?"cursor-not-allowed":"cursor-pointer"),children:(0,l.jsx)(m.u,{isMobile:U,position:"top",tooltipHeading:"Labels",tooltipContent:null==G?void 0:G.filter(e=>s.includes(null==e?void 0:e.id)).map(e=>null==e?void 0:e.name).join(", "),children:(0,l.jsxs)("div",{className:"flex h-full items-center gap-1.5 text-custom-text-200",children:[(0,l.jsx)("span",{className:"h-2 w-2 flex-shrink-0 rounded-full bg-custom-primary"}),"".concat(s.length," Labels")]})})}):(0,l.jsx)(m.u,{position:"top",tooltipHeading:"Labels",tooltipContent:"None",isMobile:U,children:(0,l.jsxs)("div",{className:"flex h-full items-center justify-center gap-2 rounded px-2.5 py-1 text-xs hover:bg-custom-background-80 ".concat(S?"":"border-[0.5px] border-custom-border-300"),children:[(0,l.jsx)(i.Z,{className:"h-3.5 w-3.5",strokeWidth:2}),_]})})});return(0,l.jsxs)(u.h,{as:"div",ref:F,className:"w-auto max-w-full flex-shrink-0 text-left ".concat(y),value:s,onChange:v,disabled:j,onKeyDown:J,multiple:!0,children:[(0,l.jsx)(u.h.Button,{as:n.Fragment,children:(0,l.jsxs)("button",{ref:A,type:"button",className:"clickable flex w-full items-center justify-between gap-1 text-xs ".concat(j?"cursor-not-allowed text-custom-text-200":s.length<=C?"cursor-pointer":"cursor-pointer hover:bg-custom-background-80","  ").concat(w),onClick:e=>{e.stopPropagation(),e.preventDefault(),Y()},children:[ee,!b&&!j&&(0,l.jsx)(o.Z,{className:"h-3 w-3","aria-hidden":"true"})]})}),P&&(0,l.jsx)(u.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsxs)("div",{className:"z-10 my-1 w-48 whitespace-nowrap rounded border border-custom-border-300 bg-custom-background-100 px-2 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none ".concat(N),ref:M,style:H.popper,...Q.popper,children:[(0,l.jsxs)("div",{className:"flex w-full items-center justify-start rounded border border-custom-border-200 bg-custom-background-90 px-2",children:[(0,l.jsx)(c.Z,{className:"h-3.5 w-3.5 text-custom-text-300"}),(0,l.jsx)(u.h.Input,{ref:O,className:"w-full bg-transparent px-2 py-1 text-xs text-custom-text-200 placeholder:text-custom-text-400 focus:outline-none",value:I,onChange:e=>E(e.target.value),placeholder:"Search",displayValue:e=>(null==e?void 0:e.name)||"",onKeyDown:e=>{""!==I&&"Escape"===e.key&&(e.stopPropagation(),E(""))}})]}),(0,l.jsx)("div",{className:"mt-2 max-h-48 space-y-1 overflow-y-scroll",children:z?(0,l.jsx)("p",{className:"text-center text-custom-text-200",children:"Loading..."}):X.length>0?X.map(e=>(0,l.jsx)(u.h.Option,{value:e.value,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation())},className:e=>{let{active:t,selected:s}=e;return"flex cursor-pointer select-none items-center justify-between gap-2 truncate rounded px-1 py-1.5 hover:bg-custom-background-80 ".concat(t?"bg-custom-background-80":""," ").concat(s?"text-custom-text-100":"text-custom-text-200")},children:t=>{let{selected:s}=t;return(0,l.jsxs)(l.Fragment,{children:[e.content,s&&(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(d.Z,{className:"h-3.5 w-3.5"})})]})}},e.value)):(0,l.jsx)("span",{className:"flex items-center gap-2 p-1",children:(0,l.jsx)("p",{className:"text-left text-custom-text-200 ",children:"No matching results"})})})]})})]})})},48819:function(e,t,s){s.d(t,{K:function(){return n}});var l=s(24246);let n=(0,s(43659).Pi)(e=>{let{displayProperties:t,shouldRenderProperty:s,displayPropertyKey:n,children:r}=e;return(Array.isArray(n)?n.every(e=>!!t[e]):!!t[n])&&(!s||s(t))?(0,l.jsx)(l.Fragment,{children:r}):null})},12404:function(e,t,s){s.d(t,{C7:function(){return E},YB:function(){return _},JW:function(){return N},e3:function(){return I},PF:function(){return k},n:function(){return C}});var l=s(24246),n=s(27378),r=s(48159),a=s.n(r),i=s(50649),o=s(86677),c=s(62468),d=s(32681),u=s(37969),m=s(3515),h=s(25262),p=s(54129),x=s(25449),f=s(68114),v=s(93997),g=s(51374),j=s(52934),b=s(6780),y=s(10712),w=s(10634);let N=(0,i.Pi)(e=>{var t,s;let{issue:r,handleDelete:i,handleUpdate:N,handleRemoveFromView:k,handleArchive:C,customActionButton:S,portalElement:_,readOnly:I=!1,placements:E="bottom-start",parentRef:P}=e,[R,F]=(0,n.useState)(!1),[O,T]=(0,n.useState)(void 0),[A,D]=(0,n.useState)(!1),[M,z]=(0,n.useState)(!1),{workspaceSlug:L,cycleId:Z}=(0,o.useRouter)().query,{setTrackElement:q}=(0,w.DN)(),{issuesFilter:B}=(0,w.gk)(v.rS.CYCLE),{membership:{currentProjectRole:U}}=(0,w.aF)(),{getStateById:V}=(0,w.eD)(),W=V(r.state_id),K=!!U&&U>=g.MC.MEMBER&&!I,Y=!!W&&[j.q.completed.key,j.q.cancelled.key].includes(null==W?void 0:W.group),J="".concat(null===(s=B.issueFilters)||void 0===s?void 0:null===(t=s.displayFilters)||void 0===t?void 0:t.layout," layout"),H="".concat(L,"/projects/").concat(r.project_id,"/issues/").concat(r.id),Q=a()({...r,name:"".concat(r.name," (copy)")},["id"]),G=[{key:"edit",title:"Edit",icon:c.Z,action:()=>{var e;T({...r,cycle_id:null!==(e=null==Z?void 0:Z.toString())&&void 0!==e?e:null}),q(J),F(!0)},shouldRender:K},{key:"make-a-copy",title:"Make a copy",icon:d.Z,action:()=>{q(J),F(!0)},shouldRender:K},{key:"open-in-new-tab",title:"Open in new tab",icon:u.Z,action:()=>window.open("/".concat(H),"_blank")},{key:"copy-link",title:"Copy link",icon:m.Z,action:()=>(0,y.fQ)(H).then(()=>(0,x.fz)({type:x.do.SUCCESS,title:"Link copied",message:"Issue link copied to clipboard"}))},{key:"remove-from-cycle",title:"Remove from cycle",icon:h.Z,action:()=>null==k?void 0:k(),shouldRender:K},{key:"archive",title:"Archive",description:Y?void 0:"Only completed or canceled\nissues can be archived",icon:x.rK,className:"items-start",iconClassName:"mt-1",action:()=>z(!0),disabled:!Y,shouldRender:C&&K},{key:"delete",title:"Delete",icon:p.Z,action:()=>{q(J),D(!0)},shouldRender:K}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.WyS,{data:r,isOpen:M,handleClose:()=>z(!1),onSubmit:C}),(0,l.jsx)(f.rKc,{data:r,isOpen:A,handleClose:()=>D(!1),onSubmit:i}),(0,l.jsx)(f.vlH,{isOpen:R,onClose:()=>{F(!1),T(void 0)},data:null!=O?O:Q,onSubmit:async e=>{O&&N&&await N(e)},storeType:v.rS.CYCLE}),(0,l.jsx)(x.xV,{parentRef:P,items:G}),(0,l.jsx)(x.fR,{ellipsis:!0,placement:E,customButton:S,portalElement:_,menuItemsClassName:"z-[14]",maxHeight:"lg",closeOnSelect:!0,children:G.map(e=>!1===e.shouldRender?null:(0,l.jsxs)(x.fR.MenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.action()},className:(0,b.cn)("flex items-center gap-2",{"text-custom-text-400":e.disabled},e.className),disabled:e.disabled,children:[e.icon&&(0,l.jsx)(e.icon,{className:(0,b.cn)("h-3 w-3",e.iconClassName)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:e.title}),e.description&&(0,l.jsx)("p",{className:(0,b.cn)("text-custom-text-300 whitespace-pre-line",{"text-custom-text-400":e.disabled}),children:e.description})]})]},e.key))})]})}),k=(0,i.Pi)(e=>{var t,s;let{issue:r,handleDelete:i,handleUpdate:N,handleRemoveFromView:k,handleArchive:C,customActionButton:S,portalElement:_,readOnly:I=!1,placements:E="bottom-start",parentRef:P}=e,[R,F]=(0,n.useState)(!1),[O,T]=(0,n.useState)(void 0),[A,D]=(0,n.useState)(!1),[M,z]=(0,n.useState)(!1),{workspaceSlug:L,moduleId:Z}=(0,o.useRouter)().query,{setTrackElement:q}=(0,w.DN)(),{issuesFilter:B}=(0,w.gk)(v.rS.MODULE),{membership:{currentProjectRole:U}}=(0,w.aF)(),{getStateById:V}=(0,w.eD)(),W=V(r.state_id),K=!!U&&U>=g.MC.MEMBER&&!I,Y=!!W&&[j.q.completed.key,j.q.cancelled.key].includes(null==W?void 0:W.group),J="".concat(null===(s=B.issueFilters)||void 0===s?void 0:null===(t=s.displayFilters)||void 0===t?void 0:t.layout," layout"),H="".concat(L,"/projects/").concat(r.project_id,"/issues/").concat(r.id),Q=a()({...r,name:"".concat(r.name," (copy)")},["id"]),G=[{key:"edit",title:"Edit",icon:c.Z,action:()=>{T({...r,module_ids:Z?[Z.toString()]:[]}),q(J),F(!0)},shouldRender:K},{key:"make-a-copy",title:"Make a copy",icon:d.Z,action:()=>{q(J),F(!0)},shouldRender:K},{key:"open-in-new-tab",title:"Open in new tab",icon:u.Z,action:()=>window.open("/".concat(H),"_blank")},{key:"copy-link",title:"Copy link",icon:m.Z,action:()=>(0,y.fQ)(H).then(()=>(0,x.fz)({type:x.do.SUCCESS,title:"Link copied",message:"Issue link copied to clipboard"}))},{key:"remove-from-module",title:"Remove from module",icon:h.Z,action:()=>null==k?void 0:k(),shouldRender:K},{key:"archive",title:"Archive",description:Y?void 0:"Only completed or canceled\nissues can be archived",icon:x.rK,className:"items-start",iconClassName:"mt-1",action:()=>z(!0),disabled:!Y,shouldRender:C&&K},{key:"delete",title:"Delete",icon:p.Z,action:()=>{q(J),D(!0)},shouldRender:K}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.WyS,{data:r,isOpen:M,handleClose:()=>z(!1),onSubmit:C}),(0,l.jsx)(f.rKc,{data:r,isOpen:A,handleClose:()=>D(!1),onSubmit:i}),(0,l.jsx)(f.vlH,{isOpen:R,onClose:()=>{F(!1),T(void 0)},data:null!=O?O:Q,onSubmit:async e=>{O&&N&&await N(e)},storeType:v.rS.MODULE}),(0,l.jsx)(x.xV,{parentRef:P,items:G}),(0,l.jsx)(x.fR,{ellipsis:!0,placement:E,customButton:S,portalElement:_,menuItemsClassName:"z-[14]",maxHeight:"lg",closeOnSelect:!0,children:G.map(e=>!1===e.shouldRender?null:(0,l.jsxs)(x.fR.MenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.action()},className:(0,b.cn)("flex items-center gap-2",{"text-custom-text-400":e.disabled},e.className),disabled:e.disabled,children:[e.icon&&(0,l.jsx)(e.icon,{className:(0,b.cn)("h-3 w-3",e.iconClassName)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:e.title}),e.description&&(0,l.jsx)("p",{className:(0,b.cn)("text-custom-text-300 whitespace-pre-line",{"text-custom-text-400":e.disabled}),children:e.description})]})]},e.key))})]})}),C=(0,i.Pi)(e=>{var t,s,r;let{issue:i,handleDelete:h,handleUpdate:N,handleArchive:k,customActionButton:C,portalElement:S,readOnly:_=!1,placements:I="bottom-end",parentRef:E}=e,P=(0,o.useRouter)(),{workspaceSlug:R}=P.query,[F,O]=(0,n.useState)(!1),[T,A]=(0,n.useState)(void 0),[D,M]=(0,n.useState)(!1),[z,L]=(0,n.useState)(!1),{membership:{currentProjectRole:Z}}=(0,w.aF)(),{setTrackElement:q}=(0,w.DN)(),{issuesFilter:B}=(0,w.gk)(v.rS.PROJECT),{getStateById:U}=(0,w.eD)(),V="".concat(null===(s=B.issueFilters)||void 0===s?void 0:null===(t=s.displayFilters)||void 0===t?void 0:t.layout," layout"),W=U(i.state_id),K=!!Z&&Z>=g.MC.MEMBER&&!_,Y=!!W&&[j.q.completed.key,j.q.cancelled.key].includes(null==W?void 0:W.group),J="".concat(R,"/projects/").concat(i.project_id,"/issues/").concat(i.id),H=(null==P?void 0:null===(r=P.asPath)||void 0===r?void 0:r.includes("draft-issues"))||!1,Q=a()({...i,name:"".concat(i.name," (copy)"),is_draft:!H&&i.is_draft},["id"]),G=[{key:"edit",title:"Edit",icon:c.Z,action:()=>{q(V),A(i),O(!0)},shouldRender:K},{key:"make-a-copy",title:"Make a copy",icon:d.Z,action:()=>{q(V),O(!0)},shouldRender:K},{key:"open-in-new-tab",title:"Open in new tab",icon:u.Z,action:()=>window.open("/".concat(J),"_blank")},{key:"copy-link",title:"Copy link",icon:m.Z,action:()=>(0,y.fQ)(J).then(()=>(0,x.fz)({type:x.do.SUCCESS,title:"Link copied",message:"Issue link copied to clipboard"}))},{key:"archive",title:"Archive",description:Y?void 0:"Only completed or canceled\nissues can be archived",icon:x.rK,className:"items-start",iconClassName:"mt-1",action:()=>L(!0),disabled:!Y,shouldRender:k&&K},{key:"delete",title:"Delete",icon:p.Z,action:()=>{q(V),M(!0)},shouldRender:K}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.WyS,{data:i,isOpen:z,handleClose:()=>L(!1),onSubmit:k}),(0,l.jsx)(f.rKc,{data:i,isOpen:D,handleClose:()=>M(!1),onSubmit:h}),(0,l.jsx)(f.vlH,{isOpen:F,onClose:()=>{O(!1),A(void 0)},data:null!=T?T:Q,onSubmit:async e=>{T&&N&&await N(e)},storeType:v.rS.PROJECT,isDraft:H}),(0,l.jsx)(x.xV,{parentRef:E,items:G}),(0,l.jsx)(x.fR,{ellipsis:!0,placement:I,customButton:C,portalElement:S,menuItemsClassName:"z-[14]",maxHeight:"lg",closeOnSelect:!0,children:G.map(e=>!1===e.shouldRender?null:(0,l.jsxs)(x.fR.MenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.action()},className:(0,b.cn)("flex items-center gap-2",{"text-custom-text-400":e.disabled},e.className),disabled:e.disabled,children:[e.icon&&(0,l.jsx)(e.icon,{className:(0,b.cn)("h-3 w-3",e.iconClassName)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:e.title}),e.description&&(0,l.jsx)("p",{className:(0,b.cn)("text-custom-text-300 whitespace-pre-line",{"text-custom-text-400":e.disabled}),children:e.description})]})]},e.key))})]})});var S=s(9204);let _=(0,i.Pi)(e=>{var t,s;let{issue:r,handleDelete:a,handleRestore:i,customActionButton:c,portalElement:d,readOnly:h=!1,placements:j="bottom-end",parentRef:N}=e,[k,C]=(0,n.useState)(!1),{workspaceSlug:_}=(0,o.useRouter)().query,{membership:{currentProjectRole:I}}=(0,w.aF)(),{setTrackElement:E}=(0,w.DN)(),{issuesFilter:P}=(0,w.gk)(v.rS.ARCHIVED),R="".concat(null===(s=P.issueFilters)||void 0===s?void 0:null===(t=s.displayFilters)||void 0===t?void 0:t.layout," layout"),F=!!I&&I>=g.MC.MEMBER&&!h,O="".concat(_,"/projects/").concat(r.project_id,"/archives/issues/").concat(r.id),T=async()=>{i&&await i().then(()=>{(0,x.fz)({type:x.do.SUCCESS,title:"Restore success",message:"Your issue can be found in project issues."})}).catch(()=>{(0,x.fz)({type:x.do.ERROR,title:"Error!",message:"Issue could not be restored. Please try again."})})},A=[{key:"restore",title:"Restore",icon:S.Z,action:T,shouldRender:i&&F},{key:"open-in-new-tab",title:"Open in new tab",icon:u.Z,action:()=>window.open("/".concat(O),"_blank")},{key:"copy-link",title:"Copy link",icon:m.Z,action:()=>(0,y.fQ)(O).then(()=>(0,x.fz)({type:x.do.SUCCESS,title:"Link copied",message:"Issue link copied to clipboard"}))},{key:"delete",title:"Delete",icon:p.Z,action:()=>{E(R),C(!0)},shouldRender:F}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.rKc,{data:r,isOpen:k,handleClose:()=>C(!1),onSubmit:a}),(0,l.jsx)(x.xV,{parentRef:N,items:A}),(0,l.jsx)(x.fR,{ellipsis:!0,customButton:c,portalElement:d,placement:j,menuItemsClassName:"z-[14]",maxHeight:"lg",closeOnSelect:!0,children:A.map(e=>!1===e.shouldRender?null:(0,l.jsxs)(x.fR.MenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.action()},className:(0,b.cn)("flex items-center gap-2",{"text-custom-text-400":e.disabled},e.className),disabled:e.disabled,children:[e.icon&&(0,l.jsx)(e.icon,{className:(0,b.cn)("h-3 w-3",e.iconClassName)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:e.title}),e.description&&(0,l.jsx)("p",{className:(0,b.cn)("text-custom-text-300 whitespace-pre-line",{"text-custom-text-400":e.disabled}),children:e.description})]})]},e.key))})]})}),I=(0,i.Pi)(e=>{var t,s;let{issue:r,handleDelete:i,handleUpdate:o,customActionButton:d,portalElement:u,readOnly:m=!1,placements:h="bottom-end",parentRef:j}=e,[y,N]=(0,n.useState)(!1),[k,C]=(0,n.useState)(void 0),[S,_]=(0,n.useState)(!1),{membership:{currentProjectRole:I}}=(0,w.aF)(),{setTrackElement:E}=(0,w.DN)(),{issuesFilter:P}=(0,w.gk)(v.rS.PROJECT),R="".concat(null===(s=P.issueFilters)||void 0===s?void 0:null===(t=s.displayFilters)||void 0===t?void 0:t.layout," layout"),F=!!I&&I>=g.MC.MEMBER&&!m,O=a()({...r,name:"".concat(r.name," (copy)"),is_draft:!0},["id"]),T=[{key:"edit",title:"Edit",icon:c.Z,action:()=>{E(R),C(r),N(!0)},shouldRender:F},{key:"delete",title:"Delete",icon:p.Z,action:()=>{E(R),_(!0)},shouldRender:F}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.rKc,{data:r,isOpen:S,handleClose:()=>_(!1),onSubmit:i}),(0,l.jsx)(f.vlH,{isOpen:y,onClose:()=>{N(!1),C(void 0)},data:null!=k?k:O,onSubmit:async e=>{k&&o&&await o(e)},storeType:v.rS.PROJECT,isDraft:!0}),(0,l.jsx)(x.xV,{parentRef:j,items:T}),(0,l.jsx)(x.fR,{ellipsis:!0,customButton:d,portalElement:u,placement:h,menuItemsClassName:"z-[14]",maxHeight:"lg",closeOnSelect:!0,children:T.map(e=>!1===e.shouldRender?null:(0,l.jsxs)(x.fR.MenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.action()},className:(0,b.cn)("flex items-center gap-2",{"text-custom-text-400":e.disabled},e.className),disabled:e.disabled,children:[e.icon&&(0,l.jsx)(e.icon,{className:(0,b.cn)("h-3 w-3",e.iconClassName)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:e.title}),e.description&&(0,l.jsx)("p",{className:(0,b.cn)("text-custom-text-300 whitespace-pre-line",{"text-custom-text-400":e.disabled}),children:e.description})]})]},e.key))})]})}),E=(0,i.Pi)(e=>{let{issue:t,handleDelete:s,handleUpdate:r,handleArchive:i,customActionButton:h,portalElement:g,readOnly:N=!1,placements:k="bottom-start",parentRef:C}=e,[S,_]=(0,n.useState)(!1),[I,E]=(0,n.useState)(void 0),[P,R]=(0,n.useState)(!1),[F,O]=(0,n.useState)(!1),{workspaceSlug:T}=(0,o.useRouter)().query,{setTrackElement:A}=(0,w.DN)(),{getStateById:D}=(0,w.eD)(),M=D(t.state_id),z=!N,L=!!M&&[j.q.completed.key,j.q.cancelled.key].includes(null==M?void 0:M.group),Z="".concat(T,"/projects/").concat(t.project_id,"/issues/").concat(t.id),q=a()({...t,name:"".concat(t.name," (copy)")},["id"]),B=[{key:"edit",title:"Edit",icon:c.Z,action:()=>{A("Global issues"),E(t),_(!0)},shouldRender:z},{key:"make-a-copy",title:"Make a copy",icon:d.Z,action:()=>{A("Global issues"),_(!0)},shouldRender:z},{key:"open-in-new-tab",title:"Open in new tab",icon:u.Z,action:()=>window.open("/".concat(Z),"_blank")},{key:"copy-link",title:"Copy link",icon:m.Z,action:()=>(0,y.fQ)(Z).then(()=>(0,x.fz)({type:x.do.SUCCESS,title:"Link copied",message:"Issue link copied to clipboard"}))},{key:"archive",title:"Archive",description:L?void 0:"Only completed or canceled\nissues can be archived",icon:x.rK,className:"items-start",iconClassName:"mt-1",action:()=>O(!0),disabled:!L,shouldRender:i&&z},{key:"delete",title:"Delete",icon:p.Z,action:()=>{A("Global issues"),R(!0)},shouldRender:z}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.WyS,{data:t,isOpen:F,handleClose:()=>O(!1),onSubmit:i}),(0,l.jsx)(f.rKc,{data:t,isOpen:P,handleClose:()=>R(!1),onSubmit:s}),(0,l.jsx)(f.vlH,{isOpen:S,onClose:()=>{_(!1),E(void 0)},data:null!=I?I:q,onSubmit:async e=>{I&&r&&await r(e)},storeType:v.rS.PROJECT}),(0,l.jsx)(x.xV,{parentRef:C,items:B}),(0,l.jsx)(x.fR,{ellipsis:!0,customButton:h,portalElement:g,placement:k,menuItemsClassName:"z-[14]",maxHeight:"lg",closeOnSelect:!0,children:B.map(e=>!1===e.shouldRender?null:(0,l.jsxs)(x.fR.MenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.action()},className:(0,b.cn)("flex items-center gap-2",{"text-custom-text-400":e.disabled},e.className),disabled:e.disabled,children:[e.icon&&(0,l.jsx)(e.icon,{className:(0,b.cn)("h-3 w-3",e.iconClassName)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:e.title}),e.description&&(0,l.jsx)("p",{className:(0,b.cn)("text-custom-text-300 whitespace-pre-line",{"text-custom-text-400":e.disabled}),children:e.description})]})]},e.key))})]})})},30582:function(e,t,s){s.d(t,{u:function(){return g}});var l=s(24246);s(27378);var n=s(43659),r=s(86677),a=s(30201),i=s(32246),o=s(92775),c=s(93997),d=s(10634),u=s(46479),m=s(68114);let h=(0,n.Pi)(()=>{let{workspaceSlug:e,projectId:t}=(0,r.useRouter)().query,{issuesFilter:{issueFilters:s,updateFilters:n}}=(0,d.gk)(c.rS.DRAFT),{projectLabels:a}=(0,d.NP)(),{projectStates:i}=(0,d.eD)(),o=null==s?void 0:s.filters,u={};return(Object.entries(null!=o?o:{}).forEach(e=>{let[t,s]=e;s&&(Array.isArray(s)&&0===s.length||(u[t]=s))}),0===Object.keys(u).length)?null:(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 gap-2.5",children:[(0,l.jsx)(m.v4D,{appliedFilters:u,handleClearAllFilters:()=>{if(!e||!t)return;let s={};Object.keys(null!=o?o:{}).forEach(e=>{s[e]=[]}),n(e.toString(),t.toString(),c.gc.FILTERS,{...s})},handleRemoveFilter:(l,r)=>{var a,i;if(!e||!t)return;if(!r){n(e.toString(),t.toString(),c.gc.FILTERS,{[l]:null});return}let o=null!==(i=null==s?void 0:null===(a=s.filters)||void 0===a?void 0:a[l])&&void 0!==i?i:[];o=o.filter(e=>e!==r),n(e.toString(),t.toString(),c.gc.FILTERS,{[l]:o})},labels:null!=a?a:[],states:i}),(0,l.jsx)(m.L7G,{workspaceSlug:e,projectId:t,filterParams:u})]})});var p=s(60680);let x=(0,n.Pi)(()=>(0,l.jsx)(p.P,{showLoader:!0,QuickActions:m.e3T,storeType:c.rS.DRAFT}));var f=s(76143);let v=(0,n.Pi)(()=>{let{workspaceSlug:e,projectId:t}=(0,r.useRouter)().query;return e&&t?(0,l.jsx)(f.v,{QuickActions:m.e3T,storeType:c.rS.DRAFT}):null}),g=(0,n.Pi)(()=>{var e,t,s;let{workspaceSlug:n,projectId:m}=(0,r.useRouter)().query,{issues:p,issuesFilter:f}=(0,d.gk)(c.rS.DRAFT);(0,a.ZP)(n&&m?"DRAFT_ISSUES_".concat(n.toString(),"_").concat(m.toString()):null,async()=>{n&&m&&(await (null==f?void 0:f.fetchFilters(n.toString(),m.toString())),await (null==p?void 0:p.fetchIssues(n.toString(),m.toString(),(null==p?void 0:p.groupedIssueIds)?"mutation":"init-loader")))},{revalidateIfStale:!1,revalidateOnFocus:!1});let g=(null==f?void 0:null===(t=f.issueFilters)||void 0===t?void 0:null===(e=t.displayFilters)||void 0===e?void 0:e.layout)||void 0;return n&&m?(null==p?void 0:p.loader)!=="init-loader"&&(null==p?void 0:p.groupedIssueIds)?(0,l.jsxs)("div",{className:"relative flex h-full w-full flex-col overflow-hidden",children:[(0,l.jsx)(h,{}),(null==p?void 0:null===(s=p.groupedIssueIds)||void 0===s?void 0:s.length)===0?(0,l.jsx)("div",{className:"relative h-full w-full overflow-y-auto",children:(0,l.jsx)(u.q6,{})}):(0,l.jsxs)("div",{className:"relative h-full w-full overflow-auto",children:["list"===g?(0,l.jsx)(v,{}):"kanban"===g?(0,l.jsx)(x,{}):null,(0,l.jsx)(i.Ky,{is_draft:!0})]})]}):(0,l.jsx)(l.Fragment,{children:g&&(0,l.jsx)(o.Xj,{layout:g})}):(0,l.jsx)(l.Fragment,{})})},20107:function(e,t,s){s.d(t,{$B:function(){return u},EL:function(){return d},K_:function(){return h},jH:function(){return N},xV:function(){return m}});var l=s(24246),n=s(30959),r=s(88287),a=s(25449),i=s(91256),o=s(93997),c=s(52934);let d="highlight",u="highlight-with-line",m=e=>!![o.rS.PROFILE,o.rS.GLOBAL].includes(e),h=(e,t,s,l,n,r,a,i,o)=>{switch(e){case"project":return p(t);case"cycle":return x(t,s);case"module":return f(t,l);case"state":return v(r);case"state_detail.group":return g();case"priority":return j();case"labels":return b(n,o);case"assignees":return y(a);case"created_by":return w(a);default:if(i)return[{id:"null",name:"All Issues",payload:{},icon:void 0}]}},p=e=>{let{workspaceProjectIds:t,projectMap:s}=e;if(t)return t.filter(e=>!!s[e]).map(e=>{let t=s[e];return{id:t.id,name:t.name,icon:(0,l.jsx)("div",{className:"w-6 h-6 grid place-items-center flex-shrink-0",children:(0,l.jsx)(i.h0,{logo:t.logo_props})}),payload:{project_id:t.id}}})},x=(e,t)=>{let{currentProjectDetails:s}=e,{getProjectCycleIds:n,getCycleById:i}=t;if(!s||!(null==s?void 0:s.id))return;let o=(null==s?void 0:s.id)?n(null==s?void 0:s.id):void 0;if(!o)return;let c=[];return o.map(e=>{let t=i(e);if(t){let e=t.status?t.status.toLocaleLowerCase():"draft";c.push({id:t.id,name:t.name,icon:(0,l.jsx)(a.Y7,{cycleGroup:e,className:"h-3.5 w-3.5"}),payload:{cycle_id:t.id}})}}),c.push({id:"None",name:"None",icon:(0,l.jsx)(r.Z,{className:"h-3.5 w-3.5"})}),c},f=(e,t)=>{let{currentProjectDetails:s}=e,{getProjectModuleIds:n,getModuleById:r}=t;if(!s||!(null==s?void 0:s.id))return;let i=(null==s?void 0:s.id)?n(null==s?void 0:s.id):void 0;if(!i)return;let o=[];return i.map(e=>{let t=r(e);t&&o.push({id:t.id,name:t.name,icon:(0,l.jsx)(a.kB,{className:"h-3.5 w-3.5"}),payload:{module_ids:[t.id]}})}),o.push({id:"None",name:"None",icon:(0,l.jsx)(a.kB,{className:"h-3.5 w-3.5"})}),o},v=e=>{let{projectStates:t}=e;if(t)return t.map(e=>({id:e.id,name:e.name,icon:(0,l.jsx)("div",{className:"h-3.5 w-3.5 rounded-full",children:(0,l.jsx)(a.b_,{stateGroup:e.group,color:e.color,width:"14",height:"14"})}),payload:{state_id:e.id}}))},g=()=>Object.values(c.q).map(e=>({id:e.key,name:e.label,icon:(0,l.jsx)("div",{className:"h-3.5 w-3.5 rounded-full",children:(0,l.jsx)(a.b_,{stateGroup:e.key,width:"14",height:"14"})}),payload:{}})),j=()=>o.Ku.map(e=>({id:e.key,name:e.title,icon:(0,l.jsx)(a.bJ,{priority:null==e?void 0:e.key}),payload:{priority:e.key}})),b=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{workspaceLabels:s,projectLabels:n}=e;return[...t?s||[]:n||[],{id:"None",name:"None",color:"#666"}].map(e=>({id:e.id,name:e.name,icon:(0,l.jsx)("div",{className:"h-[12px] w-[12px] rounded-full",style:{backgroundColor:e.color?e.color:"#666"}}),payload:(null==e?void 0:e.id)==="None"?{}:{label_ids:[e.id]}}))},y=e=>{let{project:{projectMemberIds:t},getUserDetails:s}=e;if(!t)return;let n=t.map(e=>{let t=s(e);return{id:e,name:(null==t?void 0:t.display_name)||"",icon:(0,l.jsx)(a.qE,{name:null==t?void 0:t.display_name,src:null==t?void 0:t.avatar,size:"md"}),payload:{assignee_ids:[e]}}});return n.push({id:"None",name:"None",icon:(0,l.jsx)(a.qE,{size:"md"}),payload:{}}),n},w=e=>{let{project:{projectMemberIds:t},getUserDetails:s}=e;if(t)return t.map(e=>{let t=s(e);return{id:e,name:(null==t?void 0:t.display_name)||"",icon:(0,l.jsx)(a.qE,{name:null==t?void 0:t.display_name,src:null==t?void 0:t.avatar,size:"md"}),payload:{}}})},N=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];setTimeout(async()=>{var l;let r=document.getElementById(null!=e?e:"");null==r||null===(l=r.classList)||void 0===l||l.add(s?u:d),t&&r&&await (0,n.Z)(r,{behavior:"smooth",block:"center",duration:1500})},200)}},32246:function(e,t,s){s.d(t,{Ky:function(){return K},ko:function(){return b},tz:function(){return G},Np:function(){return w},$G:function(){return _},SC:function(){return q}});var l=s(24246),n=s(50649),r=s(79894),a=s.n(r),i=s(74546),o=s(88569),c=s(17789),d=s(9204),u=s(54129),m=s(25449),h=s(68114),p=s(52934),x=s(6780),f=s(10712),v=s(10634),g=s(18894);let j=[{key:"side-peek",icon:m.Hk,title:"Side Peek"},{key:"modal",icon:m.yN,title:"Modal"},{key:"full-screen",icon:m.lj,title:"Full Screen"}],b=(0,n.Pi)(e=>{let{peekMode:t,setPeekMode:s,workspaceSlug:n,projectId:r,issueId:b,isArchived:y,disabled:w,removeRoutePeekId:N,toggleDeleteIssueModal:k,toggleArchiveIssueModal:C,handleRestoreIssue:S,isSubmitting:_}=e,{currentUser:I}=(0,v.aF)(),{issue:{getIssueById:E}}=(0,v.p1)(),{getStateById:P}=(0,v.eD)(),{isMobile:R}=(0,g.L)(),F=E(b),O=F?P(null==F?void 0:F.state_id):void 0,T=j.find(e=>e.key===t),A="".concat(n,"/projects/").concat(r,"/").concat(y?"archives/":"","issues/").concat(b),D=!!O&&[p.q.completed.key,p.q.cancelled.key].includes(null==O?void 0:O.group);return(0,l.jsxs)("div",{className:"relative flex items-center justify-between p-4 ".concat((null==T?void 0:T.key)==="full-screen"?"border-b border-custom-border-200":""),children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(m.u,{tooltipContent:"Close the peek view",isMobile:R,children:(0,l.jsx)("button",{onClick:N,children:(0,l.jsx)(i.Z,{className:"h-4 w-4 text-custom-text-300 hover:text-custom-text-200"})})}),(0,l.jsx)(m.u,{tooltipContent:"Open issue in full screen",isMobile:R,children:(0,l.jsx)(a(),{href:"/".concat(A),onClick:()=>N(),children:(0,l.jsx)(o.Z,{className:"h-4 w-4 text-custom-text-300 hover:text-custom-text-200"})})}),T&&(0,l.jsx)("div",{className:"flex flex-shrink-0 items-center gap-2",children:(0,l.jsx)(m.AP,{value:T,onChange:e=>s(e),customButton:(0,l.jsx)(m.u,{tooltipContent:"Toggle peek view layout",isMobile:R,children:(0,l.jsx)("button",{type:"button",className:"",children:(0,l.jsx)(T.icon,{className:"h-4 w-4 text-custom-text-300 hover:text-custom-text-200"})})}),children:j.map(e=>(0,l.jsx)(m.AP.Option,{value:e.key,children:(0,l.jsxs)("div",{className:"flex items-center gap-1.5 ".concat(T.key===e.key?"text-custom-text-200":"text-custom-text-400 hover:text-custom-text-200"),children:[(0,l.jsx)(e.icon,{className:"-my-1 h-4 w-4 flex-shrink-0"}),e.title]})},e.key))})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,l.jsx)(h.y2U,{isSubmitting:_}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[I&&!y&&(0,l.jsx)(h.PBC,{workspaceSlug:n,projectId:r,issueId:b}),(0,l.jsx)(m.u,{tooltipContent:"Copy link",isMobile:R,children:(0,l.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),e.preventDefault(),(0,f.fQ)(A).then(()=>{(0,m.fz)({type:m.do.SUCCESS,title:"Link Copied!",message:"Issue link copied to clipboard."})})},children:(0,l.jsx)(c.Z,{className:"h-4 w-4 -rotate-45 text-custom-text-300 hover:text-custom-text-200"})})}),!y&&!w&&(0,l.jsx)(m.u,{isMobile:R,tooltipContent:D?"Archive":"Only completed or canceled issues can be archived",children:(0,l.jsx)("button",{type:"button",className:(0,x.cn)("text-custom-text-300",{"hover:text-custom-text-200":D,"cursor-not-allowed text-custom-text-400":!D}),onClick:()=>{D&&C(b)},children:(0,l.jsx)(m.rK,{className:"h-4 w-4"})})}),y&&!w&&(0,l.jsx)(m.u,{tooltipContent:"Restore",isMobile:R,children:(0,l.jsx)("button",{type:"button",onClick:S,children:(0,l.jsx)(d.Z,{className:"h-4 w-4 text-custom-text-300 hover:text-custom-text-200"})})}),!w&&(0,l.jsx)(m.u,{tooltipContent:"Delete",isMobile:R,children:(0,l.jsx)("button",{type:"button",onClick:()=>k(b),children:(0,l.jsx)(u.Z,{className:"h-4 w-4 text-custom-text-300 hover:text-custom-text-200"})})})]})]})]})});var y=s(27378);let w=e=>{let{disabled:t,issueId:s,projectId:n,workspaceSlug:r}=e,{captureIssueEvent:a}=(0,v.DN)(),{attachment:{createAttachment:i,removeAttachment:o}}=(0,v.p1)(),c=(0,y.useMemo)(()=>({create:async e=>{try{let t=i(r,n,s,e);(0,m.uW)(t,{loading:"Uploading attachment...",success:{title:"Attachment uploaded",message:()=>"The attachment has been successfully uploaded"},error:{title:"Attachment not uploaded",message:()=>"The attachment could not be uploaded"}});let l=await t;a({eventName:"Issue attachment added",payload:{id:s,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:"attachment",change_details:l.id}})}catch(e){a({eventName:"Issue attachment added",payload:{id:s,state:"FAILED",element:"Issue detail page"}})}},remove:async e=>{try{if(!r||!n||!s)throw Error("Missing required fields");await o(r,n,s,e),(0,m.fz)({message:"The attachment has been successfully removed",type:m.do.SUCCESS,title:"Attachment removed"}),a({eventName:"Issue attachment deleted",payload:{id:s,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:"attachment",change_details:""}})}catch(e){a({eventName:"Issue attachment deleted",payload:{id:s,state:"FAILED",element:"Issue detail page"},updates:{changed_property:"attachment",change_details:""}}),(0,m.fz)({message:"The Attachment could not be removed",type:m.do.ERROR,title:"Attachment not removed"})}}}),[r,n,s,a,i,o]);return(0,l.jsxs)("div",{children:[(0,l.jsx)("h6",{className:"text-sm font-medium",children:"Attachments"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-2 mt-3",children:[(0,l.jsx)(h.aSx,{workspaceSlug:r,disabled:t,handleAttachmentOperations:c}),(0,l.jsx)(h.Flk,{issueId:s,disabled:t,handleAttachmentOperations:c})]})]})};var N=s(83114),k=s(31543),C=s(78518),S=s(79360);let _=(0,n.Pi)(e=>{let{workspaceSlug:t,issueId:s,issueOperations:n,disabled:r,isArchived:a,isSubmitting:i,setIsSubmitting:o}=e,{getProjectById:c}=(0,v.PY)(),{currentUser:d}=(0,v.aF)(),{issue:{getIssueById:u}}=(0,v.p1)(),{setShowAlert:m}=(0,N.Z)("submitting"===i);(0,y.useEffect)(()=>{"submitted"===i?(m(!1),setTimeout(async()=>{o("saved")},2e3)):"submitting"===i&&m(!0)},[i,m,o]);let h=s?u(s):void 0;if(!h)return(0,l.jsx)(l.Fragment,{});let p=c(null==h?void 0:h.project_id),x=void 0!==h.description_html||null!==h.description_html?""!=h.description_html?h.description_html:"<p></p>":void 0;return(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("span",{className:"text-base font-medium text-custom-text-400",children:[null==p?void 0:p.identifier,"-",null==h?void 0:h.sequence_id]}),(0,l.jsx)(S.N,{workspaceSlug:t,projectId:h.project_id,issueId:h.id,isSubmitting:i,setIsSubmitting:e=>o(e),issueOperations:n,disabled:r,value:h.name,containerClassName:"-ml-3"}),(0,l.jsx)(k.j,{workspaceSlug:t,projectId:h.project_id,issueId:h.id,initialValue:x,swrIssueDescription:x,disabled:r,issueOperations:n,setIsSubmitting:e=>o(e),containerClassName:"-ml-3 !mb-6 border-none"}),d&&(0,l.jsx)(C.J,{workspaceSlug:t,projectId:h.project_id,issueId:s,currentUser:d,disabled:a})]})});var I=s(43659),E=s(49743),P=s(41256),R=s(21219),F=s(73470),O=s(34202),T=s(25262),A=s(50811),D=s(14820),M=s(77970),z=s(36738),L=s(74273),Z=s(85409);let q=(0,I.Pi)(e=>{var t,s,n,r,a;let{workspaceSlug:i,projectId:o,issueId:c,issueOperations:d,disabled:u}=e,{getProjectById:p}=(0,v.PY)(),{issue:{getIssueById:f}}=(0,v.p1)(),{getStateById:g}=(0,v.eD)(),j=f(c);if(!j)return(0,l.jsx)(l.Fragment,{});let b=p(j.project_id),y=null==b?void 0:b.estimate,w=g(j.state_id),N=(0,L._3)(j.start_date);null==N||N.setDate(N.getDate());let k=(0,L._3)(j.target_date);return null==k||k.setDate(k.getDate()),(0,l.jsxs)("div",{children:[(0,l.jsx)("h6",{className:"text-sm font-medium",children:"Properties"}),(0,l.jsxs)("div",{className:"w-full space-y-2 mt-3 ".concat(u?"opacity-60":""),children:[(0,l.jsxs)("div",{className:"flex w-full items-center gap-3 h-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(m.go,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"State"})]}),(0,l.jsx)(z.sb,{value:null!==(r=null==j?void 0:j.state_id)&&void 0!==r?r:void 0,onChange:e=>d.update(i,o,c,{state_id:e}),projectId:o,disabled:u,buttonVariant:"transparent-with-text",className:"w-3/4 flex-grow group",buttonContainerClassName:"w-full text-left",buttonClassName:"text-sm",dropdownArrow:!0,dropdownArrowClassName:"h-3.5 w-3.5 hidden group-hover:inline"})]}),(0,l.jsxs)("div",{className:"flex w-full items-center gap-3 h-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(m.Ti,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Assignees"})]}),(0,l.jsx)(z.Yp,{value:null!==(a=null==j?void 0:j.assignee_ids)&&void 0!==a?a:void 0,onChange:e=>d.update(i,o,c,{assignee_ids:e}),disabled:u,projectId:o,placeholder:"Add assignees",multiple:!0,buttonVariant:(null==j?void 0:null===(t=j.assignee_ids)||void 0===t?void 0:t.length)>1?"transparent-without-text":"transparent-with-text",className:"w-3/4 flex-grow group",buttonContainerClassName:"w-full text-left",buttonClassName:"text-sm justify-between ".concat((null==j?void 0:null===(s=j.assignee_ids)||void 0===s?void 0:s.length)>0?"":"text-custom-text-400"),hideIcon:(null===(n=j.assignee_ids)||void 0===n?void 0:n.length)===0,dropdownArrow:!0,dropdownArrowClassName:"h-3.5 w-3.5 hidden group-hover:inline"})]}),(0,l.jsxs)("div",{className:"flex w-full items-center gap-3 h-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(E.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Priority"})]}),(0,l.jsx)(z.Iw,{value:null==j?void 0:j.priority,onChange:e=>d.update(i,o,c,{priority:e}),disabled:u,buttonVariant:"border-with-text",className:"w-3/4 flex-grow rounded px-2 hover:bg-custom-background-80 group",buttonContainerClassName:"w-full text-left",buttonClassName:"w-min h-auto whitespace-nowrap"})]}),(0,l.jsxs)("div",{className:"flex w-full items-center gap-3 h-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(P.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Start date"})]}),(0,l.jsx)(z.qp,{value:j.start_date,onChange:e=>d.update(i,o,c,{start_date:e?(0,L.ss)(e):null}),placeholder:"Add start date",buttonVariant:"transparent-with-text",maxDate:null!=k?k:void 0,disabled:u,className:"w-3/4 flex-grow group",buttonContainerClassName:"w-full text-left",buttonClassName:"text-sm ".concat((null==j?void 0:j.start_date)?"":"text-custom-text-400"),hideIcon:!0,clearIconClassName:"h-3 w-3 hidden group-hover:inline"})]}),(0,l.jsxs)("div",{className:"flex w-full items-center gap-3 h-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(R.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Due date"})]}),(0,l.jsx)(z.qp,{value:j.target_date,onChange:e=>d.update(i,o,c,{target_date:e?(0,L.ss)(e):null}),placeholder:"Add due date",buttonVariant:"transparent-with-text",minDate:null!=N?N:void 0,disabled:u,className:"w-3/4 flex-grow group",buttonContainerClassName:"w-full text-left",buttonClassName:(0,x.cn)("text-sm",{"text-custom-text-400":!j.target_date,"text-red-500":(0,Z.QU)(j.target_date,null==w?void 0:w.group)}),hideIcon:!0,clearIconClassName:"h-3 w-3 hidden group-hover:inline !text-custom-text-100"})]}),y&&(0,l.jsxs)("div",{className:"flex w-full items-center gap-3 h-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(F.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Estimate"})]}),(0,l.jsx)(z.ym,{value:(null==j?void 0:j.estimate_point)!==null?j.estimate_point:null,onChange:e=>d.update(i,o,c,{estimate_point:e}),projectId:o,disabled:u,buttonVariant:"transparent-with-text",className:"w-3/4 flex-grow group",buttonContainerClassName:"w-full text-left",buttonClassName:"text-sm ".concat((null==j?void 0:j.estimate_point)!==null?"":"text-custom-text-400"),placeholder:"None",hideIcon:!0,dropdownArrow:!0,dropdownArrowClassName:"h-3.5 w-3.5 hidden group-hover:inline"})]}),(null==b?void 0:b.module_view)&&(0,l.jsxs)("div",{className:"flex w-full items-center gap-3 min-h-8 h-full",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(m.kB,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Module"})]}),(0,l.jsx)(h.wPB,{className:"w-3/4 flex-grow",workspaceSlug:i,projectId:o,issueId:c,issueOperations:d,disabled:u})]}),(null==b?void 0:b.cycle_view)&&(0,l.jsxs)("div",{className:"flex w-full items-center gap-3 h-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(m.sI,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Cycle"})]}),(0,l.jsx)(h.zKH,{className:"w-3/4 flex-grow",workspaceSlug:i,projectId:o,issueId:c,issueOperations:d,disabled:u})]}),(0,l.jsxs)("div",{className:"flex w-full items-center gap-3 h-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(O.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("p",{children:"Parent"})]}),(0,l.jsx)(h.nW6,{className:"w-3/4 flex-grow h-full",disabled:u,issueId:c,issueOperations:d,projectId:o,workspaceSlug:i})]}),(0,l.jsxs)("div",{className:"flex gap-3 min-h-8",children:[(0,l.jsxs)("div",{className:"flex pt-2 gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(m.vx,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Relates to"})]}),(0,l.jsx)(h.r5l,{className:"w-3/4 flex-grow min-h-8 h-full",workspaceSlug:i,projectId:o,issueId:c,relationKey:"relates_to",disabled:u})]}),(0,l.jsxs)("div",{className:"flex gap-3 min-h-8",children:[(0,l.jsxs)("div",{className:"flex pt-2 gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(T.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Blocking"})]}),(0,l.jsx)(h.r5l,{className:"w-3/4 flex-grow min-h-8 h-full",workspaceSlug:i,projectId:o,issueId:c,relationKey:"blocking",disabled:u})]}),(0,l.jsxs)("div",{className:"flex gap-3 min-h-8",children:[(0,l.jsxs)("div",{className:"flex pt-2 gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(A.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Blocked by"})]}),(0,l.jsx)(h.r5l,{className:"w-3/4 flex-grow min-h-8 h-full",workspaceSlug:i,projectId:o,issueId:c,relationKey:"blocked_by",disabled:u})]}),(0,l.jsxs)("div",{className:"flex gap-3 min-h-8",children:[(0,l.jsxs)("div",{className:"flex pt-2 gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(D.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Duplicate of"})]}),(0,l.jsx)(h.r5l,{className:"w-3/4 flex-grow min-h-8 h-full",workspaceSlug:i,projectId:o,issueId:c,relationKey:"duplicate",disabled:u})]}),(0,l.jsxs)("div",{className:"flex w-full items-center gap-3 min-h-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 w-1/4 flex-shrink-0 text-sm text-custom-text-300",children:[(0,l.jsx)(M.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,l.jsx)("span",{children:"Labels"})]}),(0,l.jsx)("div",{className:"flex w-full flex-col gap-3",children:(0,l.jsx)(h.WK7,{workspaceSlug:i,projectId:o,issueId:c,disabled:u})})]})]}),(0,l.jsx)("div",{className:"w-full pt-3",children:(0,l.jsx)(h.DtO,{workspaceSlug:i,projectId:o,issueId:c,disabled:u})})]})});var B=s(86677),U=s(865),V=s(93997),W=s(51374);let K=(0,I.Pi)(e=>{let{is_archived:t=!1,is_draft:s=!1}=e,n=(0,B.useRouter)(),{membership:{currentWorkspaceAllProjectsRole:r}}=(0,v.aF)(),{issues:{restoreIssue:a}}=(0,v.gk)(V.rS.ARCHIVED),{peekIssue:i,updateIssue:o,removeIssue:c,archiveIssue:d,issue:{getIssueById:u,fetchIssue:p}}=(0,v.p1)(),{addCycleToIssue:x,addIssueToCycle:f,removeIssueFromCycle:g,addModulesToIssue:j,removeIssueFromModule:b,removeModulesFromIssue:w}=(0,v.p1)(),{captureIssueEvent:N}=(0,v.DN)(),[k,C]=(0,y.useState)(!1),S=(0,y.useMemo)(()=>({fetch:async(e,l,n)=>{try{await p(e,l,n,t?"ARCHIVED":s?"DRAFT":"DEFAULT")}catch(e){console.error("Error fetching the parent issue")}},update:async(e,t,s,l)=>{await o(e,t,s,l).then(()=>{N({eventName:U.C6,payload:{...l,issueId:s,state:"SUCCESS",element:"Issue peek-overview"},updates:{changed_property:Object.keys(l).join(","),change_details:Object.values(l).join(",")},path:n.asPath})}).catch(()=>{N({eventName:U.C6,payload:{state:"FAILED",element:"Issue peek-overview"},path:n.asPath}),(0,m.fz)({title:"Error!",type:m.do.ERROR,message:"Issue update failed"})})},remove:async(e,t,s)=>{try{c(e,t,s),(0,m.fz)({title:"Success!",type:m.do.SUCCESS,message:"Issue deleted successfully"}),N({eventName:U.IO,payload:{id:s,state:"SUCCESS",element:"Issue peek-overview"},path:n.asPath})}catch(e){(0,m.fz)({title:"Error!",type:m.do.ERROR,message:"Issue delete failed"}),N({eventName:U.IO,payload:{id:s,state:"FAILED",element:"Issue peek-overview"},path:n.asPath})}},archive:async(e,t,s)=>{try{await d(e,t,s),N({eventName:U._E,payload:{id:s,state:"SUCCESS",element:"Issue peek-overview"},path:n.asPath})}catch(e){N({eventName:U._E,payload:{id:s,state:"FAILED",element:"Issue peek-overview"},path:n.asPath})}},restore:async(e,t,s)=>{try{await a(e,t,s),(0,m.fz)({type:m.do.SUCCESS,title:"Restore success",message:"Your issue can be found in project issues."}),N({eventName:U.WY,payload:{id:s,state:"SUCCESS",element:"Issue peek-overview"},path:n.asPath})}catch(e){(0,m.fz)({type:m.do.ERROR,title:"Error!",message:"Issue could not be restored. Please try again."}),N({eventName:U.WY,payload:{id:s,state:"FAILED",element:"Issue peek-overview"},path:n.asPath})}},addCycleToIssue:async(e,t,s,l)=>{try{console.log("Peek adding..."),await x(e,t,s,l),N({eventName:U.C6,payload:{issueId:l,state:"SUCCESS",element:"Issue peek-overview"},updates:{changed_property:"cycle_id",change_details:s},path:n.asPath})}catch(e){(0,m.fz)({type:m.do.ERROR,title:"Error!",message:"Issue could not be added to the cycle. Please try again."}),N({eventName:U.C6,payload:{state:"FAILED",element:"Issue peek-overview"},updates:{changed_property:"cycle_id",change_details:s},path:n.asPath})}},addIssueToCycle:async(e,t,s,l)=>{try{await f(e,t,s,l),N({eventName:U.C6,payload:{...l,state:"SUCCESS",element:"Issue peek-overview"},updates:{changed_property:"cycle_id",change_details:s},path:n.asPath})}catch(e){(0,m.fz)({type:m.do.ERROR,title:"Error!",message:"Issue could not be added to the cycle. Please try again."}),N({eventName:U.C6,payload:{state:"FAILED",element:"Issue peek-overview"},updates:{changed_property:"cycle_id",change_details:s},path:n.asPath})}},removeIssueFromCycle:async(e,t,s,l)=>{try{let r=g(e,t,s,l);(0,m.uW)(r,{loading:"Removing issue from the cycle...",success:{title:"Success!",message:()=>"Issue removed from the cycle successfully."},error:{title:"Error!",message:()=>"Issue could not be removed from the cycle. Please try again."}}),await r,N({eventName:U.C6,payload:{issueId:l,state:"SUCCESS",element:"Issue peek-overview"},updates:{changed_property:"cycle_id",change_details:""},path:n.asPath})}catch(e){N({eventName:U.C6,payload:{state:"FAILED",element:"Issue peek-overview"},updates:{changed_property:"cycle_id",change_details:""},path:n.asPath})}},addModulesToIssue:async(e,t,s,l)=>{try{let r=await j(e,t,s,l);N({eventName:U.C6,payload:{...r,state:"SUCCESS",element:"Issue peek-overview"},updates:{changed_property:"module_id",change_details:l},path:n.asPath})}catch(e){(0,m.fz)({type:m.do.ERROR,title:"Error!",message:"Issue could not be added to the module. Please try again."}),N({eventName:U.C6,payload:{id:s,state:"FAILED",element:"Issue peek-overview"},updates:{changed_property:"module_id",change_details:l},path:n.asPath})}},removeIssueFromModule:async(e,t,s,l)=>{try{let r=b(e,t,s,l);(0,m.uW)(r,{loading:"Removing issue from the module...",success:{title:"Success!",message:()=>"Issue removed from the module successfully."},error:{title:"Error!",message:()=>"Issue could not be removed from the module. Please try again."}}),await r,N({eventName:U.C6,payload:{id:l,state:"SUCCESS",element:"Issue peek-overview"},updates:{changed_property:"module_id",change_details:""},path:n.asPath})}catch(e){N({eventName:U.C6,payload:{id:l,state:"FAILED",element:"Issue peek-overview"},updates:{changed_property:"module_id",change_details:""},path:n.asPath})}},removeModulesFromIssue:async(e,t,s,l)=>{let n=w(e,t,s,l);(0,m.uW)(n,{loading:"Removing module from issue...",success:{title:"Success!",message:()=>"Module removed from issue successfully"},error:{title:"Error!",message:()=>"Module remove from issue failed"}}),await n}}),[t,s,p,o,c,d,a,f,g,j,b,w,N,n.asPath]);if((0,y.useEffect)(()=>{i&&(C(!0),S.fetch(i.workspaceSlug,i.projectId,i.issueId).finally(()=>{C(!1)}))},[i,S]),!(null==i?void 0:i.workspaceSlug)||!(null==i?void 0:i.projectId)||!(null==i?void 0:i.issueId))return(0,l.jsx)(l.Fragment,{});let _=u(i.issueId)||void 0,I=null==r?void 0:r[null==i?void 0:i.projectId],E=!!I&&I>=W.MC.MEMBER;return(0,l.jsx)(h.tzh,{workspaceSlug:i.workspaceSlug,projectId:i.projectId,issueId:i.issueId,isLoading:!_||!!k,is_archived:t,disabled:!E,issueOperations:S})});var Y=s(38758),J=(e,t,s)=>{let l=l=>{if(e.current&&!e.current.contains(l.target)){let e=l.target;for(;e;){if(e.id==="issue-".concat(s))return;e=e.parentElement}t()}};(0,y.useEffect)(()=>(document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}))},H=s(4062),Q=s(94938);let G=(0,I.Pi)(e=>{let{workspaceSlug:t,projectId:s,issueId:n,isLoading:r,is_archived:a,disabled:i=!1,issueOperations:o}=e,[c,d]=(0,y.useState)("side-peek"),[u,p]=(0,y.useState)("saved"),f=(0,y.useRef)(null),{currentUser:g}=(0,v.aF)(),{setPeekIssue:j,isAnyModalOpen:b,isDeleteIssueModalOpen:w,isArchiveIssueModalOpen:N,toggleDeleteIssueModal:k,toggleArchiveIssueModal:C,issue:{getIssueById:S}}=(0,v.p1)(),_=S(n),I=()=>{j(void 0)};J(f,()=>{b||I()},n),(0,Y.Z)("Escape",()=>{var e;let t=document.querySelector("#slash-command"),s=(null===(e=document.activeElement)||void 0===e?void 0:e.tagName)==="INPUT";if(!b&&!t&&!s){I();let e=document.getElementById("issue-".concat(n));e&&(null==e||e.focus())}});let E=async()=>{o.restore&&(await o.restore(t,s,n),I())};return(0,l.jsxs)(l.Fragment,{children:[_&&!a&&(0,l.jsx)(h.WyS,{isOpen:N===n,handleClose:()=>C(null),data:_,onSubmit:async()=>{o.archive&&await o.archive(t,s,n),I()}}),_&&w===_.id&&(0,l.jsx)(h.rKc,{isOpen:!!w,handleClose:()=>{k(null)},data:_,onSubmit:()=>o.remove(t,s,n).then(()=>I())}),(0,l.jsx)("div",{className:"w-full !text-base",children:n&&(0,l.jsxs)("div",{ref:f,className:(0,x.cn)("fixed z-20 flex flex-col overflow-hidden rounded border border-custom-border-200 bg-custom-background-100 transition-all duration-300",{"bottom-0 right-0 top-0 w-full md:w-[50%]":"side-peek"===c,"size-5/6 top-[8.33%] left-[8.33%]":"modal"===c,"inset-0 m-4":"full-screen"===c}),style:{boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.12), 0px 6px 12px 0px rgba(16, 24, 40, 0.12), 0px 1px 16px 0px rgba(16, 24, 40, 0.12)"},children:[(0,l.jsx)(h.ko_,{peekMode:c,setPeekMode:e=>d(e),removeRoutePeekId:I,toggleDeleteIssueModal:k,toggleArchiveIssueModal:C,handleRestoreIssue:E,isArchived:a,issueId:n,workspaceSlug:t,projectId:s,isSubmitting:u,disabled:i}),(0,l.jsx)("div",{className:"vertical-scrollbar scrollbar-md relative h-full w-full overflow-hidden overflow-y-auto",children:r&&!_?(0,l.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,l.jsx)(m.$j,{})}):_&&(0,l.jsx)(l.Fragment,{children:["side-peek","modal"].includes(c)?(0,l.jsxs)("div",{className:"relative flex flex-col gap-3 px-8 py-5 space-y-3",children:[(0,l.jsx)(h.$GQ,{workspaceSlug:t,projectId:s,issueId:n,issueOperations:o,disabled:i||a,isArchived:a,isSubmitting:u,setIsSubmitting:e=>p(e)}),g&&(0,l.jsx)(Q.P,{workspaceSlug:t,projectId:s,parentIssueId:n,currentUser:g,disabled:i||a}),(0,l.jsx)(h.Nph,{disabled:i||a,issueId:n,projectId:s,workspaceSlug:t}),(0,l.jsx)(h.SCJ,{workspaceSlug:t,projectId:s,issueId:n,issueOperations:o,disabled:i||a}),(0,l.jsx)(H.J3,{workspaceSlug:t,projectId:s,issueId:n,disabled:a})]}):(0,l.jsxs)("div",{className:"vertical-scrollbar flex h-full w-full overflow-auto",children:[(0,l.jsx)("div",{className:"relative h-full w-full space-y-6 overflow-auto p-4 py-5",children:(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)(h.$GQ,{workspaceSlug:t,projectId:s,issueId:n,issueOperations:o,disabled:i||a,isArchived:a,isSubmitting:u,setIsSubmitting:e=>p(e)}),g&&(0,l.jsx)(Q.P,{workspaceSlug:t,projectId:s,parentIssueId:n,currentUser:g,disabled:i||a}),(0,l.jsx)(h.Nph,{disabled:i||a,issueId:n,projectId:s,workspaceSlug:t}),(0,l.jsx)(H.J3,{workspaceSlug:t,projectId:s,issueId:n,disabled:a})]})}),(0,l.jsx)("div",{className:"h-full !w-[400px] flex-shrink-0 border-l border-custom-border-200 p-4 py-5 ".concat(a?"pointer-events-none":""),children:(0,l.jsx)(h.SCJ,{workspaceSlug:t,projectId:s,issueId:n,issueOperations:o,disabled:i||a})})]})})})]})})]})})},30800:function(e,t,s){s.d(t,{p:function(){return g}});var l=s(24246),n=s(27378),r=s(43659),a=s(86677),i=s(69570),o=s(77970),c=s(81630),d=s(1759),u=s(70584),m=s(47542),h=s(66778),p=s(92775),x=s(10634),f=s(93270),v=s(42683);let g=(0,r.Pi)(e=>{var t;let{setIsOpen:s,value:r,onChange:g,projectId:j,label:b,disabled:y=!1,tabIndex:w,createLabelEnabled:N=!0}=e,{workspaceSlug:k}=(0,a.useRouter)().query,{getProjectLabels:C,fetchProjectLabels:S}=(0,x.NP)(),[_,I]=(0,n.useState)(""),[E,P]=(0,n.useState)(null),[R,F]=(0,n.useState)(null),[O,T]=(0,n.useState)(!1),A=(0,n.useRef)(null),D=(0,n.useRef)(null),{styles:M,attributes:z}=(0,i.D)(E,R,{placement:"bottom-start"}),L=C(j),Z=""===_?L:null==L?void 0:L.filter(e=>e.name.toLowerCase().includes(_.toLowerCase())),q=()=>{!L&&k&&j&&S(k.toString(),j),E&&E.focus()},B=()=>{O&&T(!1),E&&E.blur()},U=()=>{O||q(),T(e=>!e)},V=(0,f.j)(U,B);return(0,v.Z)(A,B),(0,n.useEffect)(()=>{O&&D.current&&D.current.focus()},[O]),(0,l.jsxs)(h.h,{as:"div",ref:A,tabIndex:w,value:r,onChange:e=>{g(e)},className:"relative flex-shrink-0 h-full",multiple:!0,disabled:y,onKeyDown:V,children:[(0,l.jsx)(h.h.Button,{as:n.Fragment,children:(0,l.jsx)("button",{type:"button",ref:P,className:"h-full flex cursor-pointer items-center gap-2 text-xs text-custom-text-200",onClick:e=>{e.stopPropagation(),e.preventDefault(),U()},children:b||(r&&r.length>0?(0,l.jsx)("span",{className:"flex items-center justify-center gap-2 text-xs h-full",children:(0,l.jsx)(p.k0,{labels:null!==(t=r.map(e=>null==L?void 0:L.find(t=>t.id===e)))&&void 0!==t?t:[],length:3,showLength:!0})}):(0,l.jsxs)("div",{className:"h-full flex items-center justify-center gap-1 rounded border-[0.5px] border-custom-border-300 px-2 py-1 text-xs hover:bg-custom-background-80",children:[(0,l.jsx)(o.Z,{className:"h-3 w-3 flex-shrink-0"}),(0,l.jsx)("span",{children:"Labels"})]}))})}),O&&(0,l.jsx)(h.h.Options,{className:"fixed z-10",static:!0,children:(0,l.jsxs)("div",{className:"my-1 w-48 rounded border-[0.5px] border-custom-border-300 bg-custom-background-100 px-2 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none",ref:F,style:M.popper,...z.popper,children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border border-custom-border-100 bg-custom-background-90 px-2",children:[(0,l.jsx)(c.Z,{className:"h-3.5 w-3.5 text-custom-text-400",strokeWidth:1.5}),(0,l.jsx)(h.h.Input,{as:"input",ref:D,className:"w-full bg-transparent py-1 text-xs text-custom-text-200 placeholder:text-custom-text-400 focus:outline-none",onChange:e=>I(e.target.value),placeholder:"Search",displayValue:e=>null==e?void 0:e.name})]}),(0,l.jsxs)("div",{className:"mt-2 max-h-48 space-y-1 overflow-y-scroll",children:[L&&Z?Z.length>0?Z.map(e=>{let t=null==L?void 0:L.filter(t=>t.parent===e.id);return 0!==t.length?(0,l.jsxs)("div",{className:"border-y border-custom-border-200",children:[(0,l.jsxs)("div",{className:"flex select-none items-center gap-2 truncate p-2 text-custom-text-100",children:[(0,l.jsx)(u.Z,{className:"h-3 w-3"})," ",e.name]}),(0,l.jsx)("div",{children:t.map(e=>(0,l.jsx)(h.h.Option,{className:e=>{let{active:t}=e;return"".concat(t?"bg-custom-background-80":""," group flex min-w-[14rem] cursor-pointer select-none items-center gap-2 truncate rounded px-1 py-1.5 text-custom-text-200")},value:e.id,children:t=>{let{selected:s}=t;return(0,l.jsxs)("div",{className:"flex w-full justify-between gap-2 rounded",children:[(0,l.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[(0,l.jsx)("span",{className:"h-2.5 w-2.5 flex-shrink-0 rounded-full",style:{backgroundColor:null==e?void 0:e.color}}),(0,l.jsx)("span",{children:e.name})]}),(0,l.jsx)("div",{className:"flex items-center justify-center rounded p-1",children:(0,l.jsx)(d.Z,{className:"h-3 w-3 ".concat(s?"opacity-100":"opacity-0")})})]})}},e.id))})]},e.id):e.parent?void 0:(0,l.jsx)(h.h.Option,{className:e=>{let{active:t}=e;return"".concat(t?"bg-custom-background-80":""," group flex w-full cursor-pointer select-none items-center gap-2 truncate rounded px-1 py-1.5 text-custom-text-200")},value:e.id,children:t=>{let{selected:s}=t;return(0,l.jsxs)("div",{className:"flex w-full justify-between gap-2 rounded",children:[(0,l.jsxs)("div",{className:"flex items-center justify-start gap-2 truncate",children:[(0,l.jsx)("span",{className:"h-2.5 w-2.5 flex-shrink-0 rounded-full",style:{backgroundColor:e.color}}),(0,l.jsx)("span",{className:"truncate",children:e.name})]}),(0,l.jsx)("div",{className:"flex shrink-0 items-center justify-center rounded p-1",children:(0,l.jsx)(d.Z,{className:"h-3 w-3 ".concat(s?"opacity-100":"opacity-0")})})]})}},e.id)}):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"No matching results"}):(0,l.jsx)("p",{className:"text-custom-text-400 italic py-1 px-1.5",children:"Loading..."}),N&&(0,l.jsxs)("button",{type:"button",className:"flex items-center gap-2 w-full select-none rounded px-1 py-2 hover:bg-custom-background-80",onClick:()=>s(!0),children:[(0,l.jsx)(m.Z,{className:"h-3 w-3","aria-hidden":"true"}),(0,l.jsx)("span",{className:"whitespace-nowrap",children:"Create new label"})]})]})]})})]})})},94938:function(e,t,s){s.d(t,{P:function(){return C}});var l=s(24246),n=s(27378),r=s(43659),a=s(86677),i=s(7419),o=s(78543),c=s(47542),d=s(62468),u=s(25449),m=s(23258),h=s(68114),p=s(6780),x=s(10712),f=s(10634),v=s(97779),g=s(3515),j=s(82558),b=s(18894),y=s(36738);let w=e=>{let{workspaceSlug:t,parentIssueId:s,issueId:n,disabled:r,subIssueOperations:a}=e,{issue:{getIssueById:i}}=(0,f.p1)(),o=i(n);return o?(0,l.jsxs)("div",{className:"relative flex items-center gap-2",children:[(0,l.jsx)("div",{className:"h-5 flex-shrink-0",children:(0,l.jsx)(y.sb,{value:o.state_id,projectId:o.project_id,onChange:e=>a.updateSubIssue(t,o.project_id,s,n,{state_id:e},{...o}),disabled:!r,buttonVariant:"border-with-text"})}),(0,l.jsx)("div",{className:"h-5 flex-shrink-0",children:(0,l.jsx)(y.Iw,{value:o.priority,onChange:e=>a.updateSubIssue(t,o.project_id,s,n,{priority:e}),disabled:!r,buttonVariant:"border-without-text",buttonClassName:"border"})}),(0,l.jsx)("div",{className:"h-5 flex-shrink-0",children:(0,l.jsx)(y.Yp,{value:o.assignee_ids,projectId:o.project_id,onChange:e=>a.updateSubIssue(t,o.project_id,s,n,{assignee_ids:e}),disabled:!r,multiple:!0,buttonVariant:((null==o?void 0:o.assignee_ids)||[]).length>0?"transparent-without-text":"border-without-text",buttonClassName:((null==o?void 0:o.assignee_ids)||[]).length>0?"hover:bg-transparent px-0":""})})]}):(0,l.jsx)(l.Fragment,{})},N=(0,r.Pi)(e=>{var t;let{workspaceSlug:s,projectId:n,parentIssueId:r,issueId:a,spacingLeft:c=10,disabled:m,handleIssueCrudState:h,subIssueOperations:x}=e,{getIsIssuePeeked:y,setPeekIssue:N,issue:{getIssueById:C},subIssues:{subIssueHelpersByIssueId:S,setSubIssueHelpers:_},toggleCreateIssueModal:I,toggleDeleteIssueModal:E}=(0,f.p1)(),P=(0,f.PY)(),{getProjectStates:R}=(0,f.eD)(),{isMobile:F}=(0,b.L)(),O=C(a),T=O&&O.project_id&&P.getProjectById(O.project_id)||void 0,A=(null==O?void 0:O.project_id)&&(null===(t=R(null==O?void 0:O.project_id))||void 0===t?void 0:t.find(e=>(null==O?void 0:O.state_id)==e.id))||void 0,D=S(r),M=e=>s&&e&&e.project_id&&e.id&&!y(e.id)&&N({workspaceSlug:s,projectId:e.project_id,issueId:e.id});return O?(0,l.jsxs)("div",{children:[O&&(0,l.jsxs)("div",{className:"group relative flex h-full w-full items-center gap-2 border-b border-custom-border-100 px-2 py-1 transition-all hover:bg-custom-background-90",style:{paddingLeft:"".concat(c,"px")},children:[(0,l.jsx)("div",{className:"h-[22px] w-[22px] flex-shrink-0",children:(null==O?void 0:O.sub_issues_count)>0&&(0,l.jsx)(l.Fragment,{children:D.preview_loader.includes(O.id)?(0,l.jsx)("div",{className:"flex h-full w-full cursor-not-allowed items-center justify-center rounded-sm bg-custom-background-80 transition-all",children:(0,l.jsx)(i.Z,{width:14,strokeWidth:2,className:"animate-spin"})}):(0,l.jsx)("div",{className:"flex h-full w-full cursor-pointer items-center justify-center rounded-sm transition-all hover:bg-custom-background-80",onClick:async()=>{D.issue_visibility.includes(a)||(_(r,"preview_loader",a),await x.fetchSubIssues(s,n,a),_(r,"preview_loader",a)),_(r,"issue_visibility",a)},children:(0,l.jsx)(o.Z,{className:(0,p.cn)("h-3 w-3 transition-all",{"rotate-90":D.issue_visibility.includes(O.id)}),strokeWidth:2})})})}),(0,l.jsxs)("div",{className:"flex w-full cursor-pointer items-center gap-2",children:[(0,l.jsx)("div",{className:"h-[6px] w-[6px] flex-shrink-0 rounded-full",style:{backgroundColor:null==A?void 0:A.color}}),(0,l.jsxs)("div",{className:"flex-shrink-0 text-xs text-custom-text-200",children:[null==T?void 0:T.identifier,"-",null==O?void 0:O.sequence_id]}),(0,l.jsx)(u.Ug,{id:"issue-".concat(O.id),href:"/".concat(s,"/projects/").concat(O.project_id,"/issues/").concat(O.id),target:"_blank",onClick:()=>M(O),className:"w-full line-clamp-1 cursor-pointer text-sm text-custom-text-100",children:(0,l.jsx)(u.u,{tooltipContent:O.name,isMobile:F,children:(0,l.jsx)("span",{children:O.name})})})]}),(0,l.jsx)("div",{className:"flex-shrink-0 text-sm",children:(0,l.jsx)(w,{workspaceSlug:s,parentIssueId:r,issueId:a,disabled:m,subIssueOperations:x})}),(0,l.jsx)("div",{className:"flex-shrink-0 text-sm",children:(0,l.jsxs)(u.fR,{placement:"bottom-end",ellipsis:!0,children:[m&&(0,l.jsx)(u.fR.MenuItem,{onClick:()=>{h("update",r,{...O}),I(!0)},children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.Z,{className:"h-3.5 w-3.5",strokeWidth:2}),(0,l.jsx)("span",{children:"Edit issue"})]})}),m&&(0,l.jsx)(u.fR.MenuItem,{onClick:()=>{h("delete",r,O),E(O.id)},children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(v.Z,{className:"h-3.5 w-3.5",strokeWidth:2}),(0,l.jsx)("span",{children:"Delete issue"})]})}),(0,l.jsx)(u.fR.MenuItem,{onClick:()=>x.copyText("".concat(s,"/projects/").concat(O.project_id,"/issues/").concat(O.id)),children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(g.Z,{className:"h-3.5 w-3.5",strokeWidth:2}),(0,l.jsx)("span",{children:"Copy issue link"})]})})]})}),m&&(0,l.jsx)(l.Fragment,{children:D.issue_loader.includes(O.id)?(0,l.jsx)("div",{className:"flex h-[22px] w-[22px] flex-shrink-0 cursor-not-allowed items-center justify-center overflow-hidden rounded-sm transition-all",children:(0,l.jsx)(i.Z,{width:14,strokeWidth:2,className:"animate-spin"})}):(0,l.jsx)("div",{className:"invisible flex h-[22px] w-[22px] flex-shrink-0 cursor-pointer items-center justify-center overflow-hidden rounded-sm transition-all hover:bg-custom-background-80 group-hover:visible",onClick:()=>{x.removeSubIssue(s,O.project_id,r,O.id)},children:(0,l.jsx)(j.Z,{width:14,strokeWidth:2})})})]}),D.issue_visibility.includes(a)&&O.sub_issues_count&&O.sub_issues_count>0&&(0,l.jsx)(k,{workspaceSlug:s,projectId:O.project_id,parentIssueId:O.id,spacingLeft:c+22,disabled:m,handleIssueCrudState:h,subIssueOperations:x})]},a):(0,l.jsx)(l.Fragment,{})}),k=(0,r.Pi)(e=>{let{workspaceSlug:t,projectId:s,parentIssueId:n,spacingLeft:r=10,disabled:a,handleIssueCrudState:i,subIssueOperations:o}=e,{subIssues:{subIssuesByIssueId:c}}=(0,f.p1)(),d=c(n);return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"relative",children:[d&&d.length>0&&d.map(e=>(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(N,{workspaceSlug:t,projectId:s,parentIssueId:n,issueId:e,spacingLeft:r,disabled:a,handleIssueCrudState:i,subIssueOperations:o})})),(0,l.jsx)("div",{className:"absolute bottom-0 top-0  ".concat(r>10?"border-l border-custom-border-100":""),style:{left:"".concat(r-12,"px")}})]})})}),C=(0,r.Pi)(e=>{var t,s,r,v,g,j,b,y,w,N,C,S,_,I,E,P,R,F,O,T,A;let{workspaceSlug:D,projectId:M,parentIssueId:z,disabled:L=!1}=e,Z=(0,a.useRouter)(),{issue:{getIssueById:q},subIssues:{subIssuesByIssueId:B,stateDistributionByIssueId:U,subIssueHelpersByIssueId:V,setSubIssueHelpers:W},fetchSubIssues:K,createSubIssues:Y,updateSubIssue:J,removeSubIssue:H,deleteSubIssue:Q,isCreateIssueModalOpen:G,toggleCreateIssueModal:$,isSubIssuesModalOpen:X,toggleSubIssuesModal:ee,toggleDeleteIssueModal:et}=(0,f.p1)(),{setTrackElement:es,captureIssueEvent:el}=(0,f.DN)(),[en,er]=(0,n.useState)({create:{toggle:!1,parentIssueId:void 0,issue:void 0},existing:{toggle:!1,parentIssueId:void 0,issue:void 0},update:{toggle:!1,parentIssueId:void 0,issue:void 0},delete:{toggle:!1,parentIssueId:void 0,issue:void 0}}),ea=(0,n.useCallback)(()=>{"sub-issues"===Z.asPath.split("#")[1]&&setTimeout(()=>{let e=document.getElementById("sub-issues");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},200)},[Z.asPath]);(0,n.useEffect)(()=>{Z.asPath&&ea()},[Z.asPath,ea]);let ei=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;er({...en,[e]:{toggle:!en[e].toggle,parentIssueId:t,issue:s}})},eo=(0,n.useMemo)(()=>({copyText:e=>{let t=window.location.origin?window.location.origin:"";(0,x.TE)("".concat(t,"/").concat(e)).then(()=>{(0,u.fz)({type:u.do.SUCCESS,title:"Link Copied!",message:"Issue link copied to clipboard."})})},fetchSubIssues:async(e,t,s)=>{try{await K(e,t,s)}catch(e){(0,u.fz)({type:u.do.ERROR,title:"Error!",message:"Error fetching sub-issues"})}},addSubIssue:async(e,t,s,l)=>{try{await Y(e,t,s,l),(0,u.fz)({type:u.do.SUCCESS,title:"Success!",message:"Sub-issues added successfully"})}catch(e){(0,u.fz)({type:u.do.ERROR,title:"Error!",message:"Error adding sub-issue"})}},updateSubIssue:async function(e,t,s,l,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];try{W(s,"issue_loader",l),await J(e,t,s,l,n,r,a),el({eventName:"Sub-issue updated",payload:{...r,...n,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:Object.keys(n).join(","),change_details:Object.values(n).join(",")},path:Z.asPath}),(0,u.fz)({type:u.do.SUCCESS,title:"Success!",message:"Sub-issue updated successfully"}),W(s,"issue_loader",l)}catch(e){el({eventName:"Sub-issue updated",payload:{...r,...n,state:"FAILED",element:"Issue detail page"},updates:{changed_property:Object.keys(n).join(","),change_details:Object.values(n).join(",")},path:Z.asPath}),(0,u.fz)({type:u.do.ERROR,title:"Error!",message:"Error updating sub-issue"})}},removeSubIssue:async(e,t,s,l)=>{try{W(s,"issue_loader",l),await H(e,t,s,l),(0,u.fz)({type:u.do.SUCCESS,title:"Success!",message:"Sub-issue removed successfully"}),el({eventName:"Sub-issue removed",payload:{id:l,state:"SUCCESS",element:"Issue detail page"},updates:{changed_property:"parent_id",change_details:s},path:Z.asPath}),W(s,"issue_loader",l)}catch(e){el({eventName:"Sub-issue removed",payload:{id:l,state:"FAILED",element:"Issue detail page"},updates:{changed_property:"parent_id",change_details:s},path:Z.asPath}),(0,u.fz)({type:u.do.ERROR,title:"Error!",message:"Error removing sub-issue"})}},deleteSubIssue:async(e,t,s,l)=>{try{W(s,"issue_loader",l),await Q(e,t,s,l),(0,u.fz)({type:u.do.SUCCESS,title:"Error!",message:"Issue deleted successfully"}),el({eventName:"Sub-issue deleted",payload:{id:l,state:"SUCCESS",element:"Issue detail page"},path:Z.asPath}),W(s,"issue_loader",l)}catch(e){el({eventName:"Sub-issue removed",payload:{id:l,state:"FAILED",element:"Issue detail page"},path:Z.asPath}),(0,u.fz)({type:u.do.ERROR,title:"Error!",message:"Error deleting issue"})}}}),[K,Y,J,H,Q,W]),ec=q(z),ed=U(z),eu=B(z),em=V("".concat(z,"_root")),eh=(0,n.useCallback)(async()=>{em.issue_visibility.includes(z)||(W("".concat(z,"_root"),"preview_loader",z),await eo.fetchSubIssues(D,M,z),W("".concat(z,"_root"),"preview_loader",z)),W("".concat(z,"_root"),"issue_visibility",z)},[z,M,W,em.issue_visibility,eo,D]);return((0,n.useEffect)(()=>(eh(),()=>{eh()}),[z]),ec)?(0,l.jsx)("div",{id:"sub-issues",className:"h-full w-full space-y-2",children:eu?(0,l.jsxs)(l.Fragment,{children:[eu&&(null==eu?void 0:eu.length)>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"relative flex items-center justify-between gap-2 text-xs",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("button",{type:"button",className:"flex items-center gap-1 rounded py-1 px-2 transition-all hover:bg-custom-background-80 font-medium",onClick:eh,children:[(0,l.jsx)("div",{className:"flex flex-shrink-0 items-center justify-center",children:em.preview_loader.includes(z)?(0,l.jsx)(i.Z,{strokeWidth:2,className:"h-3 w-3 animate-spin"}):(0,l.jsx)(o.Z,{className:(0,p.cn)("h-3 w-3 transition-all",{"rotate-90":em.issue_visibility.includes(z)}),strokeWidth:2})}),(0,l.jsx)("div",{children:"Sub-issues"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-custom-text-300",children:[(0,l.jsx)(u.QT,{size:16,percentage:(null==ed?void 0:null===(t=ed.completed)||void 0===t?void 0:t.length)&&eu.length?(null==ed?void 0:null===(s=ed.completed)||void 0===s?void 0:s.length)/eu.length*100:0,strokeWidth:3}),(0,l.jsxs)("span",{children:[null!==(T=null==ed?void 0:null===(r=ed.completed)||void 0===r?void 0:r.length)&&void 0!==T?T:0,"/",eu.length," Done"]})]})]}),!L&&(0,l.jsxs)(u.fR,{label:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.Z,{className:"h-3 w-3"}),"Add sub-issue"]}),buttonClassName:"whitespace-nowrap",placement:"bottom-end",noBorder:!0,noChevron:!0,children:[(0,l.jsx)(u.fR.MenuItem,{onClick:()=>{es("Issue detail nested sub-issue"),ei("create",z,null),$(!0)},children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:"Create new"})]})}),(0,l.jsx)(u.fR.MenuItem,{onClick:()=>{es("Issue detail nested sub-issue"),ei("existing",z,null),ee(ec.id)},children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(u.uQ,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:"Add existing"})]})})]})]}),em.issue_visibility.includes(z)&&(0,l.jsx)("div",{className:"border border-b-0 border-custom-border-100",children:(0,l.jsx)(k,{workspaceSlug:D,projectId:M,parentIssueId:z,spacingLeft:10,disabled:!L,handleIssueCrudState:ei,subIssueOperations:eo})})]}):!L&&(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"text-xs italic text-custom-text-300",children:"No sub-issues yet"}),(0,l.jsxs)(u.fR,{label:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.Z,{className:"h-3 w-3"}),"Add sub-issue"]}),buttonClassName:"whitespace-nowrap",placement:"bottom-end",noBorder:!0,noChevron:!0,children:[(0,l.jsx)(u.fR.MenuItem,{onClick:()=>{es("Issue detail nested sub-issue"),ei("create",z,null),$(!0)},children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:"Create new"})]})}),(0,l.jsx)(u.fR.MenuItem,{onClick:()=>{es("Issue detail nested sub-issue"),ei("existing",z,null),ee(ec.id)},children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(u.uQ,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:"Add existing"})]})})]})]}),(null==en?void 0:null===(v=en.create)||void 0===v?void 0:v.toggle)&&(null==en?void 0:null===(g=en.create)||void 0===g?void 0:g.parentIssueId)&&G&&(0,l.jsx)(h.vlH,{isOpen:null==en?void 0:null===(j=en.create)||void 0===j?void 0:j.toggle,data:{parent_id:null==en?void 0:null===(b=en.create)||void 0===b?void 0:b.parentIssueId},onClose:()=>{ei("create",null,null),$(!1)},onSubmit:async e=>{await eo.addSubIssue(D,M,z,[e.id])}}),(null==en?void 0:null===(y=en.existing)||void 0===y?void 0:y.toggle)&&(null==en?void 0:null===(w=en.existing)||void 0===w?void 0:w.parentIssueId)&&X&&(0,l.jsx)(m.H2,{workspaceSlug:D,projectId:M,isOpen:null==en?void 0:null===(N=en.existing)||void 0===N?void 0:N.toggle,handleClose:()=>{ei("existing",null,null),ee(null)},searchParams:{sub_issue:!0,issue_id:null==en?void 0:null===(C=en.existing)||void 0===C?void 0:C.parentIssueId},handleOnSubmit:e=>eo.addSubIssue(D,M,z,e.map(e=>e.id)),workspaceLevelToggle:!0}),(null==en?void 0:null===(S=en.update)||void 0===S?void 0:S.toggle)&&(null==en?void 0:null===(_=en.update)||void 0===_?void 0:_.issue)&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(h.vlH,{isOpen:null==en?void 0:null===(I=en.update)||void 0===I?void 0:I.toggle,onClose:()=>{ei("update",null,null),$(!1)},data:null!==(A=null==en?void 0:null===(E=en.update)||void 0===E?void 0:E.issue)&&void 0!==A?A:void 0,onSubmit:async e=>{var t;await eo.updateSubIssue(D,M,z,e.id,e,null==en?void 0:null===(t=en.update)||void 0===t?void 0:t.issue,!0)}})}),(null==en?void 0:null===(P=en.delete)||void 0===P?void 0:P.toggle)&&(null==en?void 0:null===(R=en.delete)||void 0===R?void 0:R.issue)&&en.delete.parentIssueId&&en.delete.issue.id&&(0,l.jsx)(h.rKc,{isOpen:null==en?void 0:null===(F=en.delete)||void 0===F?void 0:F.toggle,handleClose:()=>{ei("delete",null,null),et(null)},data:null==en?void 0:null===(O=en.delete)||void 0===O?void 0:O.issue,onSubmit:async()=>{var e,t,s;return await eo.deleteSubIssue(D,M,null==en?void 0:null===(e=en.delete)||void 0===e?void 0:e.parentIssueId,null==en?void 0:null===(s=en.delete)||void 0===s?void 0:null===(t=s.issue)||void 0===t?void 0:t.id)}})]}):(0,l.jsx)("div",{className:"py-3 text-center text-sm  font-medium text-custom-text-300",children:"Loading..."})}):(0,l.jsx)(l.Fragment,{})})},79360:function(e,t,s){s.d(t,{N:function(){return c}});var l=s(24246),n=s(27378),r=s(50649),a=s(25449),i=s(6780),o=s(65758);let c=(0,r.Pi)(e=>{let{disabled:t,value:s,workspaceSlug:r,isSubmitting:c,setIsSubmitting:d,issueId:u,issueOperations:m,projectId:h,className:p,containerClassName:x}=e,[f,v]=(0,n.useState)(""),[g,j]=(0,n.useState)(!1),b=(0,o.Z)(f,1500);(0,n.useEffect)(()=>{s&&v(s)},[s]),(0,n.useEffect)(()=>{let e=document.querySelector("#title-input");b&&b!==s&&m.update(r,h,u,{name:b}).finally(()=>{if(d("saved"),e&&!e.matches(":focus")){let e=b.trim();e!==f&&v(e)}})},[b]),(0,n.useEffect)(()=>{let e=()=>{let e=f.trim();e!==f&&"submitting"!==c&&(v(e),d("submitting"))},t=document.querySelector("#title-input");return t&&t.addEventListener("blur",e),()=>{t&&t.removeEventListener("blur",e)}},[f,c,d]);let y=(0,n.useCallback)(e=>{d("submitting"),v(e.target.value)},[d]);return t?(0,l.jsx)("div",{className:"text-2xl font-medium",children:f}):(0,l.jsxs)("div",{className:(0,i.cn)("relative",x),children:[(0,l.jsx)(a.Kx,{id:"title-input",className:(0,i.cn)("block w-full resize-none overflow-hidden rounded border-none bg-transparent px-3 py-0 text-2xl font-medium outline-none ring-0",{"ring-red-400":0===f.length},p),disabled:t,value:f,onChange:y,maxLength:255,placeholder:"Issue title",onFocus:()=>j(!0),onBlur:()=>j(!1)}),(0,l.jsxs)("div",{className:(0,i.cn)("pointer-events-none absolute bottom-1 right-1 z-[2] rounded bg-custom-background-100 p-0.5 text-xs text-custom-text-200 opacity-0 transition-opacity",{"opacity-100":g}),children:[(0,l.jsx)("span",{className:"".concat(0===f.length||f.length>255?"text-red-500":""),children:f.length}),"/255"]})]})})},56030:function(e,t,s){s.d(t,{Pe:function(){return g},b8:function(){return b},Ws:function(){return w},sy:function(){return W},zO:function(){return V},v1:function(){return J}});var l=s(24246),n=s(27378),r=s(43659),a=s(86677),i=s(36547),o=s(88039),c=s(65709),d=s(30335),u=s(15455),m=s(30640),h=s(25449);let p=["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],x=()=>{let e=Math.floor(Math.random()*p.length);return p[e]};var f=s(10634);let v={name:"",color:"rgb(var(--color-text-200))"},g=(0,r.Pi)(e=>{let{isOpen:t,projectId:s,handleClose:r,onSuccess:g}=e,{workspaceSlug:j}=(0,a.useRouter)().query,{createLabel:b}=(0,f.NP)(),{formState:{errors:y,isSubmitting:w},handleSubmit:N,watch:k,control:C,reset:S,setValue:_,setFocus:I}=(0,o.cI)({defaultValues:v});(0,n.useEffect)(()=>{I("name")},[I,t]),(0,n.useEffect)(()=>{t&&_("color",x())},[_,t]);let E=()=>{r(),S(v)},P=async e=>{j&&await b(j.toString(),s.toString(),e).then(e=>{E(),g&&g(e)}).catch(t=>{var s;(0,h.fz)({title:"Oops!",type:h.do.ERROR,message:null!==(s=null==t?void 0:t.error)&&void 0!==s?s:"Error while adding the label"}),S(e)})};return(0,l.jsx)(d.u.Root,{show:t,as:n.Fragment,children:(0,l.jsxs)(u.V,{as:"div",className:"relative z-30",onClose:E,children:[(0,l.jsx)(d.u.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,l.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center sm:p-0",children:(0,l.jsx)(d.u.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,l.jsx)(u.V.Panel,{className:"relative transform rounded-lg bg-custom-background-100 px-4 pb-4 pt-5 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-full sm:max-w-2xl sm:p-6",children:(0,l.jsxs)("form",{onSubmit:N(P),children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(u.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-custom-text-100",children:"Create Label"}),(0,l.jsxs)("div",{className:"mt-8 flex items-center gap-2",children:[(0,l.jsx)(m.J,{className:"relative",children:e=>{var t;let{open:s,close:r}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(m.J.Button,{className:"group inline-flex items-center rounded-sm py-2 text-base font-medium hover:text-custom-text-100 focus:outline-none ".concat(s?"text-custom-text-100":"text-custom-text-200"),children:[k("color")&&""!==k("color")&&(0,l.jsx)("span",{className:"ml-2 h-5 w-5 rounded",style:{backgroundColor:null!==(t=k("color"))&&void 0!==t?t:"black"}}),(0,l.jsx)(c.Z,{className:"ml-2 h-5 w-5 group-hover:text-custom-text-200 ".concat(s?"text-gray-600":"text-gray-400"),"aria-hidden":"true"})]}),(0,l.jsx)(d.u,{as:n.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,l.jsx)(m.J.Panel,{className:"fixed left-5 z-50 mt-3 w-screen max-w-xs transform px-2 sm:px-0",children:(0,l.jsx)(o.Qr,{name:"color",control:C,render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(i.e8,{color:t,colors:p,onChange:e=>{s(e.hex),r()}})}})})})]})}}),(0,l.jsx)("div",{className:"flex w-full flex-col justify-center gap-0.5",children:(0,l.jsx)(o.Qr,{control:C,name:"name",rules:{required:"Label title is required"},render:e=>{let{field:{value:t,onChange:s,ref:n}}=e;return(0,l.jsx)(h.II,{id:"name",name:"name",type:"text",value:t,onChange:s,ref:n,tabIndex:1,hasError:!!y.name,placeholder:"Label title",className:"w-full resize-none text-xl"})}})})]})]}),(0,l.jsxs)("div",{className:"mt-5 flex justify-end gap-2",children:[(0,l.jsx)(h.zx,{variant:"neutral-primary",size:"sm",onClick:E,children:"Cancel"}),(0,l.jsx)(h.zx,{variant:"primary",size:"sm",type:"submit",loading:w,children:w?"Creating Label...":"Create Label"})]})]})})})})})]})})}),j={name:"",color:"rgb(var(--color-text-200))"},b=(0,r.Pi)((0,n.forwardRef)(function(e,t){let{labelForm:s,setLabelForm:r,isUpdating:c,labelToUpdate:u,onClose:v}=e,{workspaceSlug:g,projectId:b}=(0,a.useRouter)().query,{createLabel:y,updateLabel:w}=(0,f.NP)(),{handleSubmit:N,control:k,reset:C,formState:{errors:S,isSubmitting:_},watch:I,setValue:E,setFocus:P}=(0,o.cI)({defaultValues:j}),R=()=>{r(!1),C(j),v&&v()},F=async e=>{g&&b&&!_&&await y(g.toString(),b.toString(),e).then(()=>{R(),C(j)}).catch(t=>{var s;(0,h.fz)({title:"Oops!",type:h.do.ERROR,message:null!==(s=null==t?void 0:t.error)&&void 0!==s?s:"Error while adding the label"}),C(e)})},O=async e=>{g&&b&&!_&&await w(g.toString(),b.toString(),null==u?void 0:u.id,e).then(()=>{C(j),R()}).catch(t=>{var s;(0,h.fz)({title:"Oops!",type:h.do.ERROR,message:null!==(s=null==t?void 0:t.error)&&void 0!==s?s:"Error while updating the label"}),C(e)})};return(0,n.useEffect)(()=>{P("name")},[P,s]),(0,n.useEffect)(()=>{u&&(E("name",u.name),E("color",u.color&&""!==u.color?u.color:"#000"))},[u,E]),(0,n.useEffect)(()=>{if(u){E("color",u.color&&""!==u.color?u.color:"#000");return}E("color",x())},[u,E]),(0,l.jsxs)("form",{ref:t,onSubmit:e=>{e.preventDefault(),N(c?O:F)()},className:"flex w-full scroll-m-8 items-center gap-2 bg-custom-background-100 ".concat(s?"":"hidden"),children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(m.J,{className:"relative z-10 flex h-full w-full items-center justify-center",children:e=>{let{open:t}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.J.Button,{className:"group inline-flex items-center text-base font-medium focus:outline-none ".concat(t?"text-custom-text-100":"text-custom-text-200"),children:(0,l.jsx)("span",{className:"h-4 w-4 rounded-full",style:{backgroundColor:I("color")}})}),(0,l.jsx)(d.u,{as:n.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,l.jsx)(m.J.Panel,{className:"absolute left-0 top-full z-20 mt-3 w-screen max-w-xs px-2 sm:px-0",children:(0,l.jsx)(o.Qr,{name:"color",control:k,render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(i.e8,{colors:p,color:t,onChange:e=>s(e.hex)})}})})})]})}})}),(0,l.jsx)("div",{className:"flex flex-1 flex-col justify-center",children:(0,l.jsx)(o.Qr,{control:k,name:"name",rules:{required:"Label title is required"},render:e=>{let{field:{value:t,onChange:s,ref:n}}=e;return(0,l.jsx)(h.II,{id:"labelName",name:"name",type:"text",autoFocus:!0,value:t,onChange:s,ref:n,hasError:!!S.name,placeholder:"Label title",className:"w-full"})}})}),(0,l.jsx)(h.zx,{variant:"neutral-primary",onClick:()=>R(),size:"sm",children:"Cancel"}),(0,l.jsx)(h.zx,{variant:"primary",type:"submit",size:"sm",loading:_,children:c?_?"Updating":"Update":_?"Adding":"Add"})]})}));var y=s(23258);let w=(0,r.Pi)(e=>{let{isOpen:t,onClose:s,data:r}=e,{workspaceSlug:i,projectId:o}=(0,a.useRouter)().query,{deleteLabel:c}=(0,f.NP)(),[d,u]=(0,n.useState)(!1),m=()=>{s(),u(!1)},p=async()=>{i&&o&&r&&(u(!0),await c(i.toString(),o.toString(),r.id).then(()=>{m()}).catch(e=>{u(!1);let t=(null==e?void 0:e.error)||"Label could not be deleted. Please try again.";(0,h.fz)({type:h.do.ERROR,title:"Error!",message:t})}))};return(0,l.jsx)(y.qv,{handleClose:m,handleSubmit:p,isDeleting:d,isOpen:t,title:"Delete Label",content:(0,l.jsxs)(l.Fragment,{children:["Are you sure you want to delete ",(0,l.jsx)("span",{className:"font-medium text-custom-text-100",children:null==r?void 0:r.name}),"? This will remove the label from all the issue and from any views where the label is being filtered upon."]})})});var N=s(62468),k=s(54129),C=s(49505),S=s(82558),_=s(42683),I=s(12248);let E=(0,n.forwardRef)((e,t)=>{let{isDragging:s}=e;return(0,l.jsxs)("button",{type:"button",className:"mr-1 flex flex-shrink-0 rounded text-custom-sidebar-text-200 group-hover:opacity-100 cursor-grab ".concat(s?"opacity-100":"opacity-0"),ref:t,children:[(0,l.jsx)(I.Z,{className:"h-3.5 w-3.5 stroke-custom-text-400"}),(0,l.jsx)(I.Z,{className:"-ml-5 h-3.5 w-3.5 stroke-custom-text-400"})]})});E.displayName="DragHandle";var P=s(70584);let R=e=>{let{name:t,color:s,isGroup:n}=e;return(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[n?(0,l.jsx)(P.Z,{className:"h-3.5 w-3.5",color:s}):(0,l.jsx)("span",{className:"h-3.5 w-3.5 flex-shrink-0 rounded-full",style:{backgroundColor:s&&""!==s?s:"#000"}}),(0,l.jsx)("h6",{className:"text-sm",children:t})]})},F=e=>{let{label:t,isDragging:s,customMenuItems:r,handleLabelDelete:a,isLabelGroup:i,dragHandleRef:o}=e,[c,d]=(0,n.useState)(!1),u=(0,n.useRef)(null);return(0,_.Z)(u,()=>d(!1)),(0,l.jsxs)("div",{className:"group flex items-center",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(E,{isDragging:s,ref:o}),(0,l.jsx)(R,{color:t.color,name:t.name,isGroup:null!=i&&i})]}),(0,l.jsxs)("div",{ref:u,className:"absolute right-3 flex items-start gap-3.5 px-4 ".concat(c||i?"opacity-100":"opacity-0 group-hover:pointer-events-auto group-hover:opacity-100"," ").concat(i&&"-top-0.5"),children:[(0,l.jsx)(h.fR,{ellipsis:!0,children:r.map(e=>{let{isVisible:s,onClick:n,CustomIcon:r,text:a,key:i}=e;return s&&(0,l.jsx)(h.fR.MenuItem,{onClick:()=>n(t),children:(0,l.jsxs)("span",{className:"flex items-center justify-start gap-2",children:[(0,l.jsx)(r,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:a})]})},i)})}),!i&&(0,l.jsx)("div",{className:"py-0.5",children:(0,l.jsx)("button",{className:"flex h-4 w-4 items-center justify-start gap-2",onClick:()=>a(t),children:(0,l.jsx)(S.Z,{className:"h-4 w-4  flex-shrink-0 text-custom-sidebar-text-400"})})})]})]})};var O=s(65331),T=s(97964),A=s(34069),D=s(52448),M=s(58329),z=s(50649),L=s(37634);let Z=(e,t,s)=>{var l,n;let r=null==e?void 0:e.data,a=null==t?void 0:t.data,i=null==s?void 0:null===(l=s.current)||void 0===l?void 0:l.dropTargets;if((null==i?void 0:i.length)>1&&(null==r?void 0:r.isGroup))return"make-child";if(!r||!a)return;let o=null===(n=(0,M.E)(r))||void 0===n?void 0:n.type;return"instruction-blocked"===o&&(o=r.isChild?"reorder-above":"make-child"),"make-child"===o&&a.isGroup&&(o="reorder-above"),o},q=(e,t,s)=>{let l=null==e?void 0:e.data;return!!l&&l.id!==(null==t?void 0:t.id)&&l.id!==(null==t?void 0:t.parent)&&(!s||!l.isGroup)},B=e=>{let{label:t,isGroup:s}=e;return(0,l.jsx)("div",{className:"py-3 pl-2 pr-4 border-[1px] border-custom-border-200 bg-custom-background-100",children:(0,l.jsx)(R,{name:t.name,color:t.color,isGroup:s})})},U=(0,z.Pi)(e=>{let{label:t,isGroup:s,isChild:r,isLastChild:a,children:i,onDrop:o}=e,[c,d]=(0,n.useState)(!1),[u,m]=(0,n.useState)(void 0),p=(0,n.useRef)(null),x=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=p.current,n=x.current;if(e)return(0,O.$)((0,T.En)({element:e,dragHandle:null!=n?n:void 0,getInitialData:()=>({id:null==t?void 0:t.id,parentId:null==t?void 0:t.parent,isGroup:s,isChild:r}),onDragStart:()=>{d(!0)},onDrop:()=>{d(!1)},onGenerateDragPreview:e=>{let{nativeSetDragImage:n}=e;(0,D.L)({getOffset:(0,A.s)({x:"0px",y:"0px"}),render:e=>{let{container:n}=e,r=(0,L.createRoot)(n);return r.render((0,l.jsx)(B,{label:t,isGroup:s})),()=>r.unmount()},nativeSetDragImage:n})}}),(0,T.wO)({element:e,canDrop:e=>{let{source:s}=e;return q(s,t,r)},getData:e=>{let{input:l,element:n}=e,i={id:null==t?void 0:t.id,parentId:null==t?void 0:t.parent,isGroup:s,isChild:r},o=[];return r&&o.push("make-child"),a||o.push("reorder-below"),(0,M.n)(i,{input:l,element:n,currentLevel:r?1:0,indentPerLevel:0,mode:a?"last-in-group":"standard",block:o})},onDrag:e=>{let{self:t,source:s,location:l}=e;m(Z(t,s,l))},onDragLeave:()=>{m(void 0)},onDrop:e=>{var t,s;let{source:l,location:n}=e;m(void 0);let a=null!==(s=null==n?void 0:null===(t=n.current)||void 0===t?void 0:t.dropTargets)&&void 0!==s?s:[];if(r||!a||a.length<=0)return;let i=a.length>1?a.find(e=>{var t;return null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.isChild}):a[0],c=null,d=!1,u=null==i?void 0:i.data;if(!i||!u)return;let h=Z(i,l,n);c="make-child"===h?u.id:u.parentId;let p="make-child"!==h?u.id:void 0;"reorder-below"===h&&(d=!0);let x=l.data;x.id&&o(x.id,c,p,d)}}))},[null==p?void 0:p.current,null==x?void 0:x.current,t,r,s,a,o]),(0,l.jsxs)("div",{ref:p,children:[(0,l.jsx)(h.fH,{classNames:"my-1",isVisible:"reorder-above"===u}),i(c,"make-child"==u,x),a&&(0,l.jsx)(h.fH,{classNames:"my-1",isVisible:"reorder-below"===u})]})}),V=e=>{let{label:t,setIsUpdating:s,handleLabelDelete:r,isChild:i,isLastChild:o,isParentDragging:c=!1,onDrop:d}=e,[u,m]=(0,n.useState)(!1),{workspaceSlug:h,projectId:p}=(0,a.useRouter)().query,{updateLabel:x}=(0,f.NP)(),v=[{CustomIcon:S.Z,onClick:e=>{h&&p&&x(h.toString(),p.toString(),e.id,{parent:null})},isVisible:!!t.parent,text:"Remove from group",key:"remove_from_group"},{CustomIcon:N.Z,onClick:()=>{m(!0),s(!0)},isVisible:!0,text:"Edit label",key:"edit_label"}];return(0,l.jsx)(U,{label:t,isGroup:!1,isChild:i,isLastChild:o,onDrop:d,children:(e,n,a)=>(0,l.jsx)("div",{className:"rounded ".concat(n?"border-[2px] border-custom-primary-100":"border-[1.5px] border-transparent"),children:(0,l.jsx)("div",{className:"py-3 px-1 group relative flex items-center justify-between gap-2 space-y-3 rounded  ".concat(n?"":"border-[0.5px] border-custom-border-200"," ").concat(e||c?"bg-custom-background-80":"bg-custom-background-100"),children:u?(0,l.jsx)(b,{labelForm:u,setLabelForm:m,isUpdating:!0,labelToUpdate:t,onClose:()=>{m(!1),s(!1)}}):(0,l.jsx)(F,{label:t,isDragging:e,customMenuItems:v,handleLabelDelete:r,dragHandleRef:a})})})})},W=(0,r.Pi)(e=>{let{label:t,labelChildren:s,handleLabelDelete:r,isUpdating:a,setIsUpdating:i,isLastChild:o,onDrop:u}=e,[m,h]=(0,n.useState)(!1),p=[{CustomIcon:N.Z,onClick:()=>{h(!0),i(!0)},isVisible:!0,text:"Edit label",key:"edit_label"},{CustomIcon:k.Z,onClick:r,isVisible:!0,text:"Delete label",key:"delete_label"}];return(0,l.jsx)(U,{label:t,isGroup:!0,isChild:!1,isLastChild:o,onDrop:u,children:(e,n,o)=>(0,l.jsx)("div",{className:"rounded ".concat(n?"border-[2px] border-custom-primary-100":"border-[1.5px] border-transparent"),children:(0,l.jsx)(C.p,{as:"div",className:"rounded  text-custom-text-100 ".concat(n?"":"border-[0.5px] border-custom-border-200"," ").concat(e?"bg-custom-background-80":"bg-custom-background-100"),defaultOpen:!0,children:n=>{let{open:x}=n;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"py-3 pl-1 pr-3 ".concat(!a&&"max-h-full overflow-y-hidden"),children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"relative flex cursor-pointer items-center justify-between gap-2",children:[m?(0,l.jsx)(b,{labelForm:m,setLabelForm:h,isUpdating:!0,labelToUpdate:t,onClose:()=>{h(!1),i(!1)}}):(0,l.jsx)(F,{label:t,isDragging:e,customMenuItems:p,handleLabelDelete:r,isLabelGroup:!0,dragHandleRef:o}),(0,l.jsx)(C.p.Button,{children:(0,l.jsx)("span",{children:(0,l.jsx)(c.Z,{className:"h-4 w-4 text-custom-sidebar-text-400 ".concat(x?"":"rotate-90 transform")})})})]}),(0,l.jsx)(d.u,{show:x,enter:"transition duration-100 ease-out",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0",children:(0,l.jsx)(C.p.Panel,{children:(0,l.jsx)("div",{className:"ml-6",children:s.map((t,n)=>(0,l.jsx)("div",{className:"group flex w-full items-center text-sm",children:(0,l.jsx)("div",{className:"w-full",children:(0,l.jsx)(V,{label:t,handleLabelDelete:()=>r(t),setIsUpdating:i,isParentDragging:e,isChild:!0,isLastChild:n===s.length-1,onDrop:u})})},t.id))})})})]})})})}})})})});var K=s(74371),Y=s(70540);let J=(0,z.Pi)(()=>{let[e,t]=(0,n.useState)(!1),[s,r]=(0,n.useState)(!1),[i,o]=(0,n.useState)(null),c=(0,n.useRef)(null),{workspaceSlug:d,projectId:u}=(0,a.useRouter)().query,{projectLabels:m,updateLabelPosition:p,projectLabelsTree:x}=(0,f.NP)(),v=(e,t,s,l)=>{if(d&&u){p(null==d?void 0:d.toString(),null==u?void 0:u.toString(),e,t,s,l);return}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w,{isOpen:!!i,data:null!=i?i:null,onClose:()=>o(null)}),(0,l.jsxs)("div",{className:"flex items-center justify-between border-b border-custom-border-100 py-3.5",children:[(0,l.jsx)("h3",{className:"text-xl font-medium",children:"Labels"}),(0,l.jsx)(h.zx,{variant:"primary",onClick:()=>{r(!1),t(!0)},size:"sm",children:"Add label"})]}),(0,l.jsxs)("div",{className:"w-full py-8",children:[e&&(0,l.jsx)("div",{className:"my-2 w-full rounded border border-custom-border-200 px-3.5 py-2",children:(0,l.jsx)(b,{labelForm:e,setLabelForm:t,isUpdating:s,ref:c,onClose:()=>{t(!1),r(!1)}})}),m?0!==m.length||e?x&&(0,l.jsx)("div",{className:"mt-3",children:x.map((e,t)=>e.children&&e.children.length?(0,l.jsx)(W,{label:e,labelChildren:e.children||[],handleLabelDelete:e=>o(e),isUpdating:s,setIsUpdating:r,isLastChild:t===x.length-1,onDrop:v},e.id):(0,l.jsx)(V,{label:e,setIsUpdating:r,handleLabelDelete:e=>o(e),isChild:!1,isLastChild:t===x.length-1,onDrop:v},e.id))}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full w-full",children:(0,l.jsx)(K.ub,{type:Y.C.PROJECT_SETTINGS_LABELS})}):!e&&(0,l.jsxs)(h.aN,{className:"space-y-5",children:[(0,l.jsx)(h.aN.Item,{height:"42px"}),(0,l.jsx)(h.aN.Item,{height:"42px"}),(0,l.jsx)(h.aN.Item,{height:"42px"}),(0,l.jsx)(h.aN.Item,{height:"42px"})]})]})]})})},98036:function(e,t,s){s.d(t,{zg:function(){return c},lx:function(){return m},bH:function(){return v},Wn:function(){return eA},aV:function(){return eE},KJ:function(){return eF},ej:function(){return eP},vz:function(){return X},ps:function(){return L},OW:function(){return w},lN:function(){return N},M2:function(){return _},fS:function(){return I},y_:function(){return E},uv:function(){return x},RE:function(){return ed.R},mB:function(){return ec.m},Nf:function(){return C},wX:function(){return U},aE:function(){return J},y1:function(){return H},df:function(){return em},Og:function(){return ew},CR:function(){return T},Wv:function(){return eh},fu:function(){return eb},ib:function(){return D},UN:function(){return e_},B6:function(){return G},t7:function(){return eo}});var l=s(24246),n=s(43659),r=s(82558),a=s(60801),i=s(74273),o=s(10712);let c=(0,n.Pi)(e=>{let{editable:t,handleRemove:s,values:n}=e,c=e=>{let t="",s=a.UC.find(t=>t.value===e);if(s)t=s.name;else{let s=e.split(";");if(2===s.length){let[e,l]=s;t="".concat((0,o.fm)(l)," ").concat((0,i.ot)(e))}}return t};return(0,l.jsx)(l.Fragment,{children:n.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)("span",{className:"normal-case",children:c(e)}),t&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>s(e),children:(0,l.jsx)(r.Z,{size:10,strokeWidth:2})})]},e))})});var d=s(25449),u=s(10634);let m=(0,n.Pi)(e=>{let{handleRemove:t,values:s,editable:n}=e,{workspace:{getWorkspaceMemberDetails:a}}=(0,u.Kb)();return(0,l.jsx)(l.Fragment,{children:s.map(e=>{var s;let i=null===(s=a(e))||void 0===s?void 0:s.member;return i?(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)(d.qE,{name:i.display_name,src:i.avatar,showTooltip:!1}),(0,l.jsx)("span",{className:"normal-case",children:i.display_name}),n&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(r.Z,{size:10,strokeWidth:2})})]},e):null})})}),h=["lead","members"],p=["start_date","target_date"],x=e=>{let{appliedFilters:t,isFavoriteFilterApplied:s,handleClearAllFilters:n,handleRemoveFilter:a,handleDisplayFiltersUpdate:i,alwaysAllowEditing:d,isArchived:u=!1}=e;return(t||s)&&(0!==Object.keys(t).length||s)?(0,l.jsxs)("div",{className:"flex flex-wrap items-stretch gap-2 bg-custom-background-100",children:[Object.entries(t).map(e=>{let[t,s]=e;if(s&&(!Array.isArray(s)||0!==s.length))return(0,l.jsx)("div",{className:"flex flex-wrap items-center gap-2 rounded-md border border-custom-border-200 px-2 py-1 capitalize",children:(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,l.jsx)("span",{className:"text-xs text-custom-text-300",children:(0,o.y2)(t)}),"status"===t&&(0,l.jsx)(v,{editable:d,handleRemove:e=>a("status",e),values:s}),p.includes(t)&&(0,l.jsx)(c,{editable:d,handleRemove:e=>a(t,e),values:s}),h.includes(t)&&(0,l.jsx)(m,{editable:d,handleRemove:e=>a(t,e),values:s}),d&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>a(t,null),children:(0,l.jsx)(r.Z,{size:12,strokeWidth:2})})]})},t)}),!u&&s&&(0,l.jsx)("div",{className:"flex flex-wrap items-center gap-2 rounded-md border border-custom-border-200 px-2 py-1 capitalize",children:(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,l.jsx)("span",{className:"text-xs text-custom-text-300",children:"Modules"}),(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded p-1 text-xs bg-custom-background-80",children:["Favorite",d&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>i&&i({favorites:!s}),children:(0,l.jsx)(r.Z,{size:10,strokeWidth:2})})]})]})},"module_display_filters"),d&&(0,l.jsxs)("button",{type:"button",onClick:n,className:"flex items-center gap-2 rounded-md border border-custom-border-200 px-2 py-1 text-xs text-custom-text-300 hover:text-custom-text-200",children:["Clear all",(0,l.jsx)(r.Z,{size:12,strokeWidth:2})]})]}):null};var f=s(27234);let v=(0,n.Pi)(e=>{let{handleRemove:t,values:s,editable:n}=e;return(0,l.jsx)(l.Fragment,{children:s.map(e=>{let s=null===f.D8||void 0===f.D8?void 0:f.D8.find(t=>t.value===e);return s?(0,l.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,l.jsx)(d.Kr,{status:s.value,height:"12px",width:"12px"}),s.label,n&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,l.jsx)(r.Z,{size:10,strokeWidth:2})})]},e):null})})});var g=s(27378),j=s(95099),b=s.n(j),y=s(68114);let w=(0,n.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:n,memberIds:r,searchQuery:a}=e,[i,o]=(0,g.useState)(5),[c,m]=(0,g.useState)(!0),{getUserDetails:h}=(0,u.Kb)(),{currentUser:p}=(0,u.aF)(),x=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,f=(0,g.useMemo)(()=>{let e=(r||[]).filter(e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase().includes(a.toLowerCase())});return b()(e,[e=>!(null!=s?s:[]).includes(e),e=>e!==(null==p?void 0:p.id),e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase()}])},[a]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(y.YHs,{title:"Lead".concat(x>0?" (".concat(x,")"):""),isPreviewEnabled:c,handleIsPreviewEnabled:()=>m(!c)}),c&&(0,l.jsx)("div",{children:f?f.length>0?(0,l.jsxs)(l.Fragment,{children:[f.slice(0,i).map(e=>{let t=h(e);return t?(0,l.jsx)(y.f2,{isChecked:null!=s&&!!s.includes(t.id),onClick:()=>n(t.id),icon:(0,l.jsx)(d.qE,{name:t.display_name,src:t.avatar,showTooltip:!1,size:"md"}),title:(null==p?void 0:p.id)===t.id?"You":null==t?void 0:t.display_name},"lead-".concat(t.id)):null}),f.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{f&&(i===f.length?o(5):o(f.length))},children:i===f.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(d.aN,{className:"space-y-2",children:[(0,l.jsx)(d.aN.Item,{height:"20px"}),(0,l.jsx)(d.aN.Item,{height:"20px"}),(0,l.jsx)(d.aN.Item,{height:"20px"})]})})]})}),N=(0,n.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:n,memberIds:r,searchQuery:a}=e,[i,o]=(0,g.useState)(5),[c,m]=(0,g.useState)(!0),{getUserDetails:h}=(0,u.Kb)(),{currentUser:p}=(0,u.aF)(),x=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,f=(0,g.useMemo)(()=>{let e=(r||[]).filter(e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase().includes(a.toLowerCase())});return b()(e,[e=>!(null!=s?s:[]).includes(e),e=>e!==(null==p?void 0:p.id),e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase()}])},[a]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(y.YHs,{title:"Members".concat(x>0?" (".concat(x,")"):""),isPreviewEnabled:c,handleIsPreviewEnabled:()=>m(!c)}),c&&(0,l.jsx)("div",{children:f?f.length>0?(0,l.jsxs)(l.Fragment,{children:[f.slice(0,i).map(e=>{let t=h(e);return t?(0,l.jsx)(y.f2,{isChecked:null!=s&&!!s.includes(t.id),onClick:()=>n(t.id),icon:(0,l.jsx)(d.qE,{name:t.display_name,src:t.avatar,showTooltip:!1,size:"md"}),title:(null==p?void 0:p.id)===t.id?"You":null==t?void 0:t.display_name},"member-".concat(t.id)):null}),f.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{f&&(i===f.length?o(5):o(f.length))},children:i===f.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(d.aN,{className:"space-y-2",children:[(0,l.jsx)(d.aN.Item,{height:"20px"}),(0,l.jsx)(d.aN.Item,{height:"20px"}),(0,l.jsx)(d.aN.Item,{height:"20px"})]})})]})});var k=s(81630);let C=(0,n.Pi)(e=>{var t,s,n,a,i;let{displayFilters:o,filters:c,handleDisplayFiltersUpdate:d,handleFiltersUpdate:u,memberIds:m,isArchived:h=!1}=e,[p,x]=(0,g.useState)("");return(0,l.jsxs)("div",{className:"flex h-full w-full flex-col overflow-hidden",children:[(0,l.jsx)("div",{className:"bg-custom-background-100 p-2.5 pb-0",children:(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border-[0.5px] border-custom-border-200 bg-custom-background-90 px-1.5 py-1 text-xs",children:[(0,l.jsx)(k.Z,{className:"text-custom-text-400",size:12,strokeWidth:2}),(0,l.jsx)("input",{type:"text",className:"w-full bg-custom-background-90 outline-none placeholder:text-custom-text-400",placeholder:"Search",value:p,onChange:e=>x(e.target.value),autoFocus:!0}),""!==p&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>x(""),children:(0,l.jsx)(r.Z,{className:"text-custom-text-300",size:12,strokeWidth:2})})]})}),(0,l.jsxs)("div",{className:"h-full w-full divide-y divide-custom-border-200 overflow-y-auto px-2.5 vertical-scrollbar scrollbar-sm",children:[!h&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(y.f2,{isChecked:!!o.favorites,onClick:()=>d({favorites:!o.favorites}),title:"Favorites"})}),!h&&(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(I,{appliedFilters:null!==(t=c.status)&&void 0!==t?t:null,handleUpdate:e=>u("status",e),searchQuery:p})}),(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(w,{appliedFilters:null!==(s=c.lead)&&void 0!==s?s:null,handleUpdate:e=>u("lead",e),searchQuery:p,memberIds:m})}),(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(N,{appliedFilters:null!==(n=c.members)&&void 0!==n?n:null,handleUpdate:e=>u("members",e),searchQuery:p,memberIds:m})}),(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(_,{appliedFilters:null!==(a=c.start_date)&&void 0!==a?a:null,handleUpdate:e=>u("start_date",e),searchQuery:p})}),(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(E,{appliedFilters:null!==(i=c.target_date)&&void 0!==i?i:null,handleUpdate:e=>u("target_date",e),searchQuery:p})})]})]})});var S=s(23258);let _=(0,n.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:n,searchQuery:r}=e,[o,c]=(0,g.useState)(!0),[d,u]=(0,g.useState)(!1),m=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,h=a.UC.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())),p=()=>((null==s?void 0:s.filter(e=>(0,i.hc)(e.split(";")[0])))||[]).length>0;return(0,l.jsxs)(l.Fragment,{children:[d&&(0,l.jsx)(S.iF,{handleClose:()=>u(!1),isOpen:d,onSelect:e=>n(e),title:"Start date"}),(0,l.jsx)(y.YHs,{title:"Start date".concat(m>0?" (".concat(m,")"):""),isPreviewEnabled:o,handleIsPreviewEnabled:()=>c(!o)}),o&&(0,l.jsx)("div",{children:h.length>0?(0,l.jsxs)(l.Fragment,{children:[h.map(e=>(0,l.jsx)(y.f2,{isChecked:null!=s&&!!s.includes(e.value),onClick:()=>n(e.value),title:e.name,multiple:!0},e.value)),(0,l.jsx)(y.f2,{isChecked:p(),onClick:()=>{p()?n((null==s?void 0:s.filter(e=>e.includes("-")))||[]):u(!0)},title:"Custom",multiple:!0})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})}),I=(0,n.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:n,searchQuery:r}=e,[a,i]=(0,g.useState)(!0),o=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,c=f.D8.filter(e=>e.value.includes(r.toLowerCase()));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(y.YHs,{title:"Status".concat(o>0?" (".concat(o,")"):""),isPreviewEnabled:a,handleIsPreviewEnabled:()=>i(!a)}),a&&(0,l.jsx)("div",{children:c.length>0?c.map(e=>(0,l.jsx)(y.f2,{isChecked:null!=s&&!!s.includes(e.value),onClick:()=>n(e.value),icon:(0,l.jsx)(d.Kr,{status:e.value}),title:e.label},e.value)):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})}),E=(0,n.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:n,searchQuery:r}=e,[o,c]=(0,g.useState)(!0),[d,u]=(0,g.useState)(!1),m=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,h=a.UC.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())),p=()=>((null==s?void 0:s.filter(e=>(0,i.hc)(e.split(";")[0])))||[]).length>0;return(0,l.jsxs)(l.Fragment,{children:[d&&(0,l.jsx)(S.iF,{handleClose:()=>u(!1),isOpen:d,onSelect:e=>n(e),title:"Due date"}),(0,l.jsx)(y.YHs,{title:"Due date".concat(m>0?" (".concat(m,")"):""),isPreviewEnabled:o,handleIsPreviewEnabled:()=>c(!o)}),o&&(0,l.jsx)("div",{children:h.length>0?(0,l.jsxs)(l.Fragment,{children:[h.map(e=>(0,l.jsx)(y.f2,{isChecked:null!=s&&!!s.includes(e.value),onClick:()=>n(e.value),title:e.name,multiple:!0},e.value)),(0,l.jsx)(y.f2,{isChecked:p(),onClick:()=>{p()?n((null==s?void 0:s.filter(e=>e.includes("-")))||[]):u(!0)},title:"Custom",multiple:!0})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})});var P=s(91603),R=s(65709),F=s(1759),O=s(6780);let T=e=>{let{onChange:t,value:s}=e,n=f.SE.find(e=>null==s?void 0:s.includes(e.key)),r=(null==s?void 0:s[0])==="-",a=null==s?void 0:s.includes("sort_order");return(0,l.jsxs)(d.fR,{customButton:(0,l.jsxs)("div",{className:(0,O.cn)((0,d.A6)("neutral-primary","sm"),"px-2 text-custom-text-300"),children:[(0,l.jsx)(P.Z,{className:"h-3 w-3"}),null==n?void 0:n.label,(0,l.jsx)(R.Z,{className:"h-3 w-3",strokeWidth:2})]}),placement:"bottom-end",maxHeight:"lg",closeOnSelect:!0,children:[f.SE.map(e=>(0,l.jsxs)(d.fR.MenuItem,{className:"flex items-center justify-between gap-2",onClick:()=>{r&&!a?t("-".concat(e.key)):t(e.key)},children:[e.label,(null==s?void 0:s.includes(e.key))&&(0,l.jsx)(F.Z,{className:"h-3 w-3"})]},e.key)),!a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("hr",{className:"my-2 border-custom-border-200"}),(0,l.jsxs)(d.fR.MenuItem,{className:"flex items-center justify-between gap-2",onClick:()=>{r&&t(s.slice(1))},children:["Ascending",!r&&(0,l.jsx)(F.Z,{className:"h-3 w-3"})]}),(0,l.jsxs)(d.fR.MenuItem,{className:"flex items-center justify-between gap-2",onClick:()=>{r||t("-".concat(s))},children:["Descending",r&&(0,l.jsx)(F.Z,{className:"h-3 w-3"})]})]})]})};var A=s(88039);let D=e=>{let{control:t,error:s,tabIndex:n}=e;return(0,l.jsx)(A.Qr,{control:t,rules:{required:!0},name:"status",render:e=>{var t,r;let{field:{value:a,onChange:i}}=e;return(0,l.jsx)(d.AP,{value:a,label:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2 text-xs py-0.5 ".concat(s?"text-red-500":""),children:[a?(0,l.jsx)(d.Kr,{status:a}):(0,l.jsx)(d.go,{className:"h-3 w-3 ".concat(s?"text-red-500":"text-custom-text-200")}),null!==(r=null===(t=f.D8.find(e=>e.value===a))||void 0===t?void 0:t.label)&&void 0!==r?r:(0,l.jsx)("span",{className:"".concat(s?"text-red-500":"text-custom-text-200"),children:"Status"})]}),onChange:i,tabIndex:n,noChevron:!0,children:f.D8.map(e=>(0,l.jsx)(d.AP.Option,{value:e.value,children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.Kr,{status:e.value}),e.label]})},e.value))})}})};var M=s(86677),z=s(865);let L=(0,n.Pi)(e=>{let{data:t,isOpen:s,onClose:n}=e,[r,a]=(0,g.useState)(!1),i=(0,M.useRouter)(),{workspaceSlug:o,projectId:c,moduleId:m,peekModule:h}=i.query,{captureModuleEvent:p}=(0,u.DN)(),{deleteModule:x}=(0,u.b7)(),f=()=>{n(),a(!1)},v=async()=>{o&&c&&(a(!0),await x(o.toString(),c.toString(),t.id).then(()=>{(m||h)&&i.push("/".concat(o,"/projects/").concat(t.project_id,"/modules")),f(),(0,d.fz)({type:d.do.SUCCESS,title:"Success!",message:"Module deleted successfully."}),p({eventName:z.My,payload:{...t,state:"SUCCESS"}})}).catch(()=>{(0,d.fz)({type:d.do.ERROR,title:"Error!",message:"Module could not be deleted. Please try again."}),p({eventName:z.My,payload:{...t,state:"FAILED"}})}).finally(()=>{a(!1)}))};return(0,l.jsx)(S.qv,{handleClose:f,handleSubmit:v,isDeleting:r,isOpen:s,title:"Delete Module",content:(0,l.jsxs)(l.Fragment,{children:["Are you sure you want to delete module-"," ",(0,l.jsx)("span",{className:"break-all font-medium text-custom-text-100",children:null==t?void 0:t.name}),"? All of the data related to the module will be permanently removed. This action cannot be undone."]})})});var Z=s(36738),q=s(26313);let B={name:"",description:"",status:"backlog",lead_id:null,member_ids:[]},U=e=>{var t;let{handleFormSubmit:s,handleClose:n,status:r,projectId:a,setActiveProject:o,data:c}=e,{formState:{errors:u,isSubmitting:m,dirtyFields:h},handleSubmit:p,control:x,reset:f}=(0,A.cI)({defaultValues:{project_id:a,name:(null==c?void 0:c.name)||"",description:(null==c?void 0:c.description)||"",status:(null==c?void 0:c.status)||"backlog",lead_id:(null==c?void 0:c.lead_id)||null,member_ids:(null==c?void 0:c.member_ids)||[]}}),v=async e=>{await s(e,h),f({...B})};return(0,g.useEffect)(()=>{f({...B,...c})},[c,f]),(0,l.jsxs)("form",{onSubmit:p(v),children:[(0,l.jsxs)("div",{className:"space-y-5 p-5",children:[(0,l.jsxs)("div",{className:"flex items-center gap-x-3",children:[!r&&(0,l.jsx)(A.Qr,{control:x,name:"project_id",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(Z.MB,{value:t,onChange:e=>{s(e),o(e)},buttonVariant:"border-with-text",renderCondition:e=>(0,q.Fn)(e),tabIndex:10})})}}),(0,l.jsxs)("h3",{className:"text-xl font-medium text-custom-text-200",children:[r?"Update":"Create"," Module"]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)(A.Qr,{control:x,name:"name",rules:{required:"Title is required",maxLength:{value:255,message:"Title should be less than 255 characters"}},render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(d.II,{id:"name",name:"name",type:"text",value:t,onChange:s,hasError:!!(null==u?void 0:u.name),placeholder:"Title",className:"w-full text-base",tabIndex:1,autoFocus:!0})}}),(0,l.jsx)("span",{className:"text-xs text-red-500",children:null==u?void 0:null===(t=u.name)||void 0===t?void 0:t.message})]}),(0,l.jsx)("div",{children:(0,l.jsx)(A.Qr,{name:"description",control:x,render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(d.Kx,{id:"description",name:"description",value:t,onChange:s,placeholder:"Description",className:"w-full text-base resize-none min-h-24",hasError:!!(null==u?void 0:u.description),tabIndex:2})}})}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,l.jsx)(A.Qr,{control:x,name:"start_date",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(A.Qr,{control:x,name:"target_date",render:e=>{let{field:{value:n,onChange:r}}=e;return(0,l.jsx)(Z.CF,{buttonVariant:"border-with-text",className:"h-7",minDate:new Date,value:{from:(0,i._3)(t),to:(0,i._3)(n)},onSelect:e=>{s((null==e?void 0:e.from)?(0,i.ss)(e.from):null),r((null==e?void 0:e.to)?(0,i.ss)(e.to):null)},placeholder:{from:"Start date",to:"End date"},hideIcon:{to:!0},tabIndex:3})}})}}),(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(D,{control:x,error:u.status,tabIndex:4})}),(0,l.jsx)(A.Qr,{control:x,name:"lead_id",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(Z.Yp,{value:t,onChange:s,projectId:a,multiple:!1,buttonVariant:"border-with-text",placeholder:"Lead",tabIndex:5})})}}),(0,l.jsx)(A.Qr,{control:x,name:"member_ids",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)("div",{className:"h-7",children:(0,l.jsx)(Z.Yp,{value:t,onChange:s,projectId:a,multiple:!0,buttonVariant:t&&t.length>0?"transparent-without-text":"border-with-text",buttonClassName:t&&t.length>0?"hover:bg-transparent px-0":"",placeholder:"Members",tabIndex:6})})}})]})]})]}),(0,l.jsxs)("div",{className:"px-5 py-4 flex items-center justify-end gap-2 border-t-[0.5px] border-custom-border-200",children:[(0,l.jsx)(d.zx,{variant:"neutral-primary",size:"sm",onClick:n,tabIndex:7,children:"Cancel"}),(0,l.jsx)(d.zx,{variant:"primary",size:"sm",type:"submit",loading:m,tabIndex:8,children:r?m?"Updating":"Update Module":m?"Creating":"Create Module"})]})]})};var V=s(50649),W=s(79894),K=s.n(W),Y=s(18894);let J=(0,V.Pi)(e=>{var t,s,n;let{moduleId:r}=e,a=(0,M.useRouter)(),{router:{workspaceSlug:o}}=(0,u.IX)(),{getModuleById:c}=(0,u.b7)(),m=c(r),{isMobile:h}=(0,Y.L)();return(0,l.jsxs)("div",{className:"relative flex h-full w-full items-center rounded",style:{backgroundColor:null===(t=f.D8.find(e=>e.value===(null==m?void 0:m.status)))||void 0===t?void 0:t.color},onClick:()=>a.push("/".concat(o,"/projects/").concat(null==m?void 0:m.project_id,"/modules/").concat(null==m?void 0:m.id)),children:[(0,l.jsx)("div",{className:"absolute left-0 top-0 h-full w-full bg-custom-background-100/50"}),(0,l.jsx)(d.u,{isMobile:h,tooltipContent:(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("h5",{children:null==m?void 0:m.name}),(0,l.jsxs)("div",{children:[(0,i.ot)(null!==(s=null==m?void 0:m.start_date)&&void 0!==s?s:"")," to"," ",(0,i.ot)(null!==(n=null==m?void 0:m.target_date)&&void 0!==n?n:"")]})]}),position:"top-left",children:(0,l.jsx)("div",{className:"relative w-full truncate px-2.5 py-1 text-sm text-custom-text-100",children:null==m?void 0:m.name})})]})}),H=(0,V.Pi)(e=>{var t;let{moduleId:s}=e,{router:{workspaceSlug:n}}=(0,u.IX)(),{getModuleById:r}=(0,u.b7)(),a=r(s);return(0,l.jsxs)(K(),{className:"relative flex h-full w-full items-center gap-2",href:"/".concat(n,"/projects/").concat(null==a?void 0:a.project_id,"/modules/").concat(null==a?void 0:a.id),children:[(0,l.jsx)(d.Kr,{status:null!==(t=null==a?void 0:a.status)&&void 0!==t?t:"backlog",height:"16px",width:"16px"}),(0,l.jsx)("h6",{className:"flex-grow truncate text-sm font-medium",children:null==a?void 0:a.name})]})});var Q=s(95633);let G=(0,n.Pi)(()=>{let{workspaceSlug:e,projectId:t}=(0,M.useRouter)().query,{currentProjectDetails:s}=(0,u.PY)(),{getFilteredModuleIds:n,moduleMap:r,updateModuleDetails:a}=(0,u.b7)(),{currentProjectDisplayFilters:o}=(0,u.zE)(),c=t?n(t.toString()):void 0,d=async(t,s)=>{if(!e||!t)return;let l={...s};s.sort_order&&(l.sort_order=s.sort_order.newSortOrder),await a(e.toString(),t.project_id,t.id,l)},m=(null==s?void 0:s.member_role)===20||(null==s?void 0:s.member_role)===15;return(0,l.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,l.jsx)(Q.TB,{title:"Modules",loaderTitle:"Modules",blocks:c?null==c?void 0:c.map(e=>{let t=r[e];return{data:t,id:t.id,sort_order:t.sort_order,start_date:(0,i._3)(t.start_date),target_date:(0,i._3)(t.target_date)}}):null,sidebarToRender:e=>(0,l.jsx)(Q.sW,{...e}),blockUpdateHandler:(e,t)=>d(e,t),blockToRender:e=>(0,l.jsx)(J,{moduleId:e.id}),enableBlockLeftResize:m,enableBlockRightResize:m,enableBlockMove:m,enableReorder:m&&(null==o?void 0:o.order_by)==="sort_order",enableAddBlock:m,showAllBlocks:!0})})}),$={name:"",description:"",status:"backlog",lead_id:null,member_ids:[]},X=(0,n.Pi)(e=>{let{isOpen:t,onClose:s,data:n,workspaceSlug:r,projectId:a}=e,[i,o]=(0,g.useState)(null),{captureModuleEvent:c}=(0,u.DN)(),{workspaceProjectIds:m}=(0,u.PY)(),{createModule:h,updateModuleDetails:p}=(0,u.b7)(),x=()=>{f($),s()},{reset:f}=(0,A.cI)({defaultValues:$}),v=async e=>{var t;if(!r||!a)return;let s=null!==(t=e.project_id)&&void 0!==t?t:a.toString();await h(r.toString(),s,e).then(e=>{x(),(0,d.fz)({type:d.do.SUCCESS,title:"Success!",message:"Module created successfully."}),c({eventName:z.dI,payload:{...e,state:"SUCCESS"}})}).catch(e=>{var t;(0,d.fz)({type:d.do.ERROR,title:"Error!",message:null!==(t=null==e?void 0:e.detail)&&void 0!==t?t:"Module could not be created. Please try again."}),c({eventName:z.dI,payload:{...n,state:"FAILED"}})})},j=async(e,t)=>{var s;if(!r||!a||!n)return;let l=null!==(s=e.project_id)&&void 0!==s?s:a.toString();await p(r.toString(),l,n.id,e).then(e=>{x(),(0,d.fz)({type:d.do.SUCCESS,title:"Success!",message:"Module updated successfully."}),c({eventName:z.dw,payload:{...e,changed_properties:Object.keys(t||{}),state:"SUCCESS"}})}).catch(e=>{var t;(0,d.fz)({type:d.do.ERROR,title:"Error!",message:null!==(t=null==e?void 0:e.detail)&&void 0!==t?t:"Module could not be updated. Please try again."}),c({eventName:z.dw,payload:{...n,state:"FAILED"}})})},b=async(e,t)=>{if(!r||!a)return;let s={...e};n?await j(s,t):await v(s)};return(0,g.useEffect)(()=>{var e;if(!t){o(null);return}if(n&&n.project_id){o(n.project_id);return}m&&m.length>0&&!i&&o(null!==(e=null!=a?a:null==m?void 0:m[0])&&void 0!==e?e:null)},[i,n,a,m,t]),(0,l.jsx)(S.QU,{isOpen:t,handleClose:x,position:S.fM.TOP,width:S.j4.XXL,children:(0,l.jsx)(U,{handleFormSubmit:b,handleClose:x,status:!!n,projectId:null!=i?i:"",setActiveProject:o,data:n})})});var ee=s(38579),et=s.n(ee),es=s(4314),el=s(74371),en=s(92775),er=s(70540),ea={src:"/_next/static/media/all-filters.799ea881.svg",height:217,width:205,blurWidth:0,blurHeight:0},ei={src:"/_next/static/media/name-filter.4c3fcec8.svg",height:217,width:206,blurWidth:0,blurHeight:0};let eo=(0,n.Pi)(()=>{var e,t,s,n;let{workspaceSlug:r,projectId:a,peekModule:i}=(0,M.useRouter)().query,{commandPalette:o}=(0,u.IX)(),{setTrackElement:c}=(0,u.DN)(),{getProjectModuleIds:d,getFilteredModuleIds:m,loader:h}=(0,u.b7)(),{currentProjectDisplayFilters:p,searchQuery:x}=(0,u.zE)(),f=a?d(a.toString()):void 0,v=a?m(a.toString()):void 0;return!h&&f&&v?0===f.length?(0,l.jsx)(el.ub,{type:er.C.PROJECT_MODULE,primaryButtonOnClick:()=>{c("Module empty state"),o.toggleCreateModuleModal(!0)}}):0===v.length?(0,l.jsx)("div",{className:"h-full w-full grid place-items-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(et(),{src:""===x.trim()?ea:ei,className:"h-36 sm:h-48 w-36 sm:w-48 mx-auto",alt:"No matching modules"}),(0,l.jsx)("h5",{className:"text-xl font-medium mt-7 mb-1",children:"No matching modules"}),(0,l.jsx)("p",{className:"text-custom-text-400 text-base",children:""===x.trim()?"Remove the filters to see all modules":"Remove the search criteria to see all modules"})]})}):(0,l.jsxs)(l.Fragment,{children:[(null==p?void 0:p.layout)==="list"&&(0,l.jsx)("div",{className:"h-full overflow-y-auto",children:(0,l.jsxs)("div",{className:"flex h-full w-full justify-between",children:[(0,l.jsx)(es.P,{children:v.map(e=>(0,l.jsx)(em,{moduleId:e},e))}),(0,l.jsx)(eh,{projectId:null!==(e=null==a?void 0:a.toString())&&void 0!==e?e:"",workspaceSlug:null!==(t=null==r?void 0:r.toString())&&void 0!==t?t:""})]})}),(null==p?void 0:p.layout)==="board"&&(0,l.jsx)("div",{className:"h-full w-full",children:(0,l.jsxs)("div",{className:"flex h-full w-full justify-between",children:[(0,l.jsx)("div",{className:"grid h-full w-full grid-cols-1 gap-6 overflow-y-auto p-8 ".concat(i?"lg:grid-cols-1 xl:grid-cols-2 3xl:grid-cols-3":"lg:grid-cols-2 xl:grid-cols-3 3xl:grid-cols-4"," auto-rows-max transition-all vertical-scrollbar scrollbar-lg"),children:v.map(e=>(0,l.jsx)(ed.R,{moduleId:e},e))}),(0,l.jsx)(eh,{projectId:null!==(s=null==a?void 0:a.toString())&&void 0!==s?s:"",workspaceSlug:null!==(n=null==r?void 0:r.toString())&&void 0!==n?n:""})]})}),(null==p?void 0:p.layout)==="gantt"&&(0,l.jsx)(G,{})]}):(0,l.jsxs)(l.Fragment,{children:[(null==p?void 0:p.layout)==="list"&&(0,l.jsx)(en.ci,{}),(null==p?void 0:p.layout)==="board"&&(0,l.jsx)(en.Cv,{}),(null==p?void 0:p.layout)==="gantt"&&(0,l.jsx)(en.OT,{})]})});var ec=s(92260),ed=s(8256),eu=s(19711);let em=(0,n.Pi)(e=>{var t;let{moduleId:s}=e,n=(0,g.useRef)(null),r=(0,M.useRouter)(),{workspaceSlug:a}=r.query,{getModuleById:i}=(0,u.b7)(),{isMobile:o}=(0,Y.L)(),c=i(s);if(!c)return null;let m=(c.completed_issues+c.cancelled_issues)/c.total_issues*100,h=isNaN(m)?0:Math.floor(m),p="completed"===c.status,x=e=>{e.stopPropagation(),e.preventDefault();let{query:t}=r;t.peekModule?(delete t.peekModule,r.push({pathname:r.pathname,query:{...t}})):r.push({pathname:r.pathname,query:{...t,peekModule:s}})};return(0,l.jsx)(es.H,{title:null!==(t=null==c?void 0:c.name)&&void 0!==t?t:"",itemLink:"/".concat(a,"/projects/").concat(c.project_id,"/modules/").concat(c.id),onItemClick:e=>{c.archived_at&&x(e)},prependTitleElement:(0,l.jsx)(d.QT,{size:30,percentage:h,strokeWidth:3,children:p?100===h?(0,l.jsx)(F.Z,{className:"h-3 w-3 stroke-[2] text-custom-primary-100"}):(0,l.jsx)("span",{className:"text-sm text-custom-primary-100",children:"!"}):100===h?(0,l.jsx)(F.Z,{className:"h-3 w-3 stroke-[2] text-custom-primary-100"}):(0,l.jsx)("span",{className:"text-xs text-custom-text-300",children:"".concat(h,"%")})}),appendTitleElement:(0,l.jsx)("button",{onClick:x,className:"z-[5] flex-shrink-0 ".concat(o?"flex":"hidden group-hover:flex"),children:(0,l.jsx)(eu.Z,{className:"h-4 w-4 text-custom-text-400"})}),actionableItems:(0,l.jsx)(ew,{moduleId:s,moduleDetails:c,parentRef:n}),isMobile:o,parentRef:n})}),eh=(0,n.Pi)(e=>{var t;let{projectId:s,workspaceSlug:n,isArchived:r=!1}=e,a=(0,M.useRouter)(),{peekModule:i}=a.query,o=g.useRef(null),{fetchModuleDetails:c,fetchArchivedModuleDetails:d}=(0,u.b7)();return(0,g.useEffect)(()=>{i&&(r?d(n,s,i.toString()):c(n,s,i.toString()))},[d,c,r,i,s,n]),(0,l.jsx)(l.Fragment,{children:i&&(0,l.jsx)("div",{ref:o,className:"flex h-full w-full max-w-[24rem] flex-shrink-0 flex-col gap-3.5 overflow-y-auto border-l border-custom-border-100 bg-custom-sidebar-background-100 px-6 duration-300 absolute md:relative right-0 z-[9]",style:{boxShadow:"0px 1px 4px 0px rgba(0, 0, 0, 0.06), 0px 2px 4px 0px rgba(16, 24, 40, 0.06), 0px 1px 8px -1px rgba(16, 24, 40, 0.06)"},children:(0,l.jsx)(ec.m,{moduleId:null!==(t=null==i?void 0:i.toString())&&void 0!==t?t:"",handleClose:()=>{delete a.query.peekModule,a.push({pathname:a.pathname,query:{...a.query}})},isArchived:r})})})});var ep=s(62468),ex=s(37969),ef=s(3515),ev=s(9204),eg=s(54129),ej=s(51374);let eb=(0,V.Pi)(e=>{var t;let{parentRef:s,moduleId:n,projectId:r,workspaceSlug:a}=e,i=(0,M.useRouter)(),[c,m]=(0,g.useState)(!1),[h,p]=(0,g.useState)(!1),[x,f]=(0,g.useState)(!1),{setTrackElement:v}=(0,u.DN)(),{membership:{currentWorkspaceAllProjectsRole:j}}=(0,u.aF)(),{getModuleById:b,restoreModule:y}=(0,u.b7)(),w=b(n),N=!!(null==w?void 0:w.archived_at),k=!!j&&j[r]>=ej.MC.MEMBER,C=null==w?void 0:null===(t=w.status)||void 0===t?void 0:t.toLocaleLowerCase(),S=!!C&&["completed","cancelled"].includes(C),_="".concat(a,"/projects/").concat(r,"/modules/").concat(n),I=async()=>await y(a,r,n).then(()=>{(0,d.fz)({type:d.do.SUCCESS,title:"Restore success",message:"Your module can be found in project modules."}),i.push("/".concat(a,"/projects/").concat(r,"/archives/modules"))}).catch(()=>(0,d.fz)({type:d.do.ERROR,title:"Error!",message:"Module could not be restored. Please try again."})),E=[{key:"edit",title:"Edit",icon:ep.Z,action:()=>{v("Modules page list layout"),m(!0)},shouldRender:k&&!N},{key:"open-new-tab",action:()=>window.open("/".concat(_),"_blank"),title:"Open in new tab",icon:ex.Z,shouldRender:!N},{key:"copy-link",action:()=>(0,o.fQ)(_).then(()=>{(0,d.fz)({type:d.do.SUCCESS,title:"Link Copied!",message:"Module link copied to clipboard."})}),title:"Copy link",icon:ef.Z,shouldRender:!N},{key:"archive",action:()=>p(!0),title:"Archive",description:S?void 0:"Only completed or canceled\nmodule can be archived.",icon:d.rK,className:"items-start",iconClassName:"mt-1",shouldRender:k&&!N,disabled:!S},{key:"restore",action:I,title:"Restore",icon:ev.Z,shouldRender:k&&N},{key:"delete",action:()=>{v("Modules page list layout"),f(!0)},title:"Delete",icon:eg.Z,shouldRender:k}];return(0,l.jsxs)(l.Fragment,{children:[w&&(0,l.jsxs)("div",{className:"fixed",children:[(0,l.jsx)(X,{isOpen:c,onClose:()=>m(!1),data:w,projectId:r,workspaceSlug:a}),(0,l.jsx)(eA,{workspaceSlug:a,projectId:r,moduleId:n,isOpen:h,handleClose:()=>p(!1)}),(0,l.jsx)(L,{data:w,isOpen:x,onClose:()=>f(!1)})]}),(0,l.jsx)(d.xV,{parentRef:s,items:E}),(0,l.jsx)(d.fR,{ellipsis:!0,placement:"bottom-end",closeOnSelect:!0,children:E.map(e=>!1===e.shouldRender?null:(0,l.jsxs)(d.fR.MenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.action()},className:(0,O.cn)("flex items-center gap-2",{"text-custom-text-400":e.disabled},e.className),disabled:e.disabled,children:[e.icon&&(0,l.jsx)(e.icon,{className:(0,O.cn)("h-3 w-3",e.iconClassName)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:e.title}),e.description&&(0,l.jsx)("p",{className:(0,O.cn)("text-custom-text-300 whitespace-pre-line",{"text-custom-text-400":e.disabled}),children:e.description})]})]},e.key))})]})});var ey=s(93164);let ew=(0,V.Pi)(e=>{var t,s,n;let{moduleId:r,moduleDetails:a,parentRef:o}=e,{workspaceSlug:c,projectId:m}=(0,M.useRouter)().query,{membership:{currentProjectRole:h}}=(0,u.aF)(),{addModuleToFavorites:p,removeModuleFromFavorites:x}=(0,u.b7)(),{getUserDetails:v}=(0,u.Kb)(),{captureEvent:g}=(0,u.DN)(),{isMobile:j}=(0,Y.L)(),b=(0,i._3)(a.target_date),y=(0,i._3)(a.start_date),w=a.start_date||a.target_date,N=f.D8.find(e=>e.value===a.status),k=!!h&&h>=ej.MC.MEMBER,C=e=>{if(e.stopPropagation(),e.preventDefault(),!c||!m)return;let t=p(c.toString(),m.toString(),r).then(()=>{g(z.Tb,{module_id:r,element:"Grid layout",state:"SUCCESS"})});(0,d.uW)(t,{loading:"Adding module to favorites...",success:{title:"Success!",message:()=>"Module added to favorites."},error:{title:"Error!",message:()=>"Couldn't add the module to favorites. Please try again."}})},_=e=>{if(e.stopPropagation(),e.preventDefault(),!c||!m)return;let t=x(c.toString(),m.toString(),r).then(()=>{g(z.Vc,{module_id:r,element:"Grid layout",state:"SUCCESS"})});(0,d.uW)(t,{loading:"Removing module from favorites...",success:{title:"Success!",message:()=>"Module removed from favorites."},error:{title:"Error!",message:()=>"Couldn't remove the module from favorites. Please try again."}})};return(0,l.jsxs)(l.Fragment,{children:[N&&(0,l.jsx)("span",{className:"flex h-6 w-20 flex-shrink-0 items-center justify-center rounded-sm text-center text-xs",style:{color:N.color,backgroundColor:"".concat(N.color,"20")},children:N.label}),w&&(0,l.jsxs)("span",{className:" text-xs text-custom-text-300",children:[null!==(s=(0,i.ot)(y))&&void 0!==s?s:"_ _"," - ",null!==(n=(0,i.ot)(b))&&void 0!==n?n:"_ _"]}),(0,l.jsx)(d.u,{tooltipContent:"".concat((null==a?void 0:null===(t=a.member_ids)||void 0===t?void 0:t.length)||0," Members"),isMobile:j,children:(0,l.jsx)("div",{className:"flex w-10 cursor-default items-center justify-center gap-1",children:a.member_ids.length>0?(0,l.jsx)(d.HE,{showTooltip:!1,children:a.member_ids.map(e=>{let t=v(e);return(0,l.jsx)(d.qE,{name:null==t?void 0:t.display_name,src:null==t?void 0:t.avatar},null==t?void 0:t.id)})}):(0,l.jsx)("span",{className:"flex h-5 w-5 items-end justify-center rounded-full border border-dashed border-custom-text-400 bg-custom-background-80",children:(0,l.jsx)(ey.Z,{className:"h-4 w-4 text-custom-text-400"})})})}),k&&!a.archived_at&&(0,l.jsx)(S.MD,{onClick:e=>{a.is_favorite?_(e):C(e)},selected:a.is_favorite}),c&&m&&(0,l.jsx)(eb,{parentRef:o,moduleId:r,projectId:m.toString(),workspaceSlug:c.toString()})]})});var eN=s(64273),ek=s(18469),eC=s(1422),eS=s(42683);let e_=(0,V.Pi)(()=>{let e=(0,g.useRef)(null),{projectId:t}=(0,M.useRouter)().query,{isMobile:s}=(0,Y.L)(),{workspace:{workspaceMemberIds:n}}=(0,u.Kb)(),{currentProjectDisplayFilters:a,currentProjectFilters:i,searchQuery:o,updateDisplayFilters:c,updateFilters:m,updateSearchQuery:h}=(0,u.zE)(),[p,x]=(0,g.useState)(""!==o),v=(0,g.useCallback)((e,s)=>{var l,n;if(!t)return;let r=null!==(l=null==i?void 0:i[e])&&void 0!==l?l:[];Array.isArray(s)?s.forEach(e=>{r.includes(e)?r.splice(r.indexOf(e),1):r.push(e)}):(null==i?void 0:null===(n=i[e])||void 0===n?void 0:n.includes(s))?r.splice(r.indexOf(s),1):r.push(s),m(t.toString(),{[e]:r})},[i,t,m]);(0,eS.Z)(e,()=>{p&&""===o.trim()&&x(!1)});let j=0!==(0,eC.w)(null!=i?i:{})||(null==a?void 0:a.favorites);return(0,l.jsxs)("div",{className:"hidden h-full sm:flex items-center gap-3 self-end",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[!p&&(0,l.jsx)("button",{type:"button",className:"-mr-1 p-2 hover:bg-custom-background-80 rounded text-custom-text-400 grid place-items-center",onClick:()=>{var t;x(!0),null===(t=e.current)||void 0===t||t.focus()},children:(0,l.jsx)(k.Z,{className:"h-3.5 w-3.5"})}),(0,l.jsxs)("div",{className:(0,ek.cn)("ml-auto flex items-center justify-start gap-1 rounded-md border border-transparent bg-custom-background-100 text-custom-text-400 w-0 transition-[width] ease-linear overflow-hidden opacity-0",{"w-64 px-2.5 py-1.5 border-custom-border-200 opacity-100":p}),children:[(0,l.jsx)(k.Z,{className:"h-3.5 w-3.5"}),(0,l.jsx)("input",{ref:e,className:"w-full max-w-[234px] border-none bg-transparent text-sm text-custom-text-100 placeholder:text-custom-text-400 focus:outline-none",placeholder:"Search",value:o,onChange:e=>h(e.target.value),onKeyDown:t=>{if("Escape"===t.key){if(o&&""!==o.trim())h("");else{var s;x(!1),null===(s=e.current)||void 0===s||s.blur()}}}}),p&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>{x(!1)},children:(0,l.jsx)(r.Z,{className:"h-3 w-3"})})]})]}),(0,l.jsx)(T,{value:null==a?void 0:a.order_by,onChange:e=>{t&&e!==(null==a?void 0:a.order_by)&&c(t.toString(),{order_by:e})}}),(0,l.jsx)(y.lqY,{icon:(0,l.jsx)(eN.Z,{className:"h-3 w-3"}),title:"Filters",placement:"bottom-end",isFiltersApplied:j,children:(0,l.jsx)(C,{displayFilters:null!=a?a:{},filters:null!=i?i:{},handleDisplayFiltersUpdate:e=>{t&&c(t.toString(),e)},handleFiltersUpdate:v,memberIds:null!=n?n:void 0})}),(0,l.jsx)("div",{className:"hidden md:flex items-center gap-1 rounded bg-custom-background-80 p-1",children:f.SU.map(e=>(0,l.jsx)(d.u,{tooltipContent:e.title,isMobile:s,children:(0,l.jsx)("button",{type:"button",className:(0,ek.cn)("group grid h-[22px] w-7 place-items-center overflow-hidden rounded transition-all hover:bg-custom-background-100",{"bg-custom-background-100 shadow-custom-shadow-2xs":(null==a?void 0:a.layout)===e.key}),onClick:()=>{t&&c(t.toString(),{layout:e.key})},children:(0,l.jsx)(e.icon,{strokeWidth:2,className:(0,ek.cn)("h-3.5 w-3.5 text-custom-text-200",{"text-custom-text-100":(null==a?void 0:a.layout)===e.key})})})},e.key))})]})});var eI=s(30201);let eE=(0,n.Pi)(()=>{var e;let{workspaceSlug:t,projectId:s}=(0,M.useRouter)().query,{fetchArchivedModules:n,projectArchivedModuleIds:r,loader:a}=(0,u.b7)(),{clearAllFilters:i,currentProjectArchivedFilters:o,updateFilters:c}=(0,u.zE)(),d=null!==(e=null==r?void 0:r.length)&&void 0!==e?e:0;(0,eI.ZP)(t&&s?"ARCHIVED_MODULES_".concat(t.toString(),"_").concat(s.toString()):null,async()=>{t&&s&&await n(t.toString(),s.toString())},{revalidateIfStale:!1,revalidateOnFocus:!1});let m=(0,g.useCallback)((e,t)=>{var l;if(!s)return;let n=null!==(l=null==o?void 0:o[e])&&void 0!==l?l:[];n=t?n.filter(e=>e!==t):[],c(s.toString(),{[e]:n},"archived")},[o,s,c]);return t&&s?a||!r?(0,l.jsx)(en.ci,{}):(0,l.jsxs)(l.Fragment,{children:[0!==(0,eC.w)(null!=o?o:{})&&(0,l.jsx)("div",{className:"border-b border-custom-border-200 px-5 py-3",children:(0,l.jsx)(x,{appliedFilters:null!=o?o:{},handleClearAllFilters:()=>i(s.toString(),"archived"),handleRemoveFilter:m,alwaysAllowEditing:!0,isArchived:!0})}),0===d?(0,l.jsx)("div",{className:"h-full place-items-center",children:(0,l.jsx)(el.ub,{type:er.C.PROJECT_ARCHIVED_NO_MODULES})}):(0,l.jsx)("div",{className:"relative h-full w-full overflow-auto",children:(0,l.jsx)(eP,{workspaceSlug:t.toString(),projectId:s.toString()})})]}):(0,l.jsx)(l.Fragment,{})}),eP=(0,n.Pi)(e=>{var t,s;let{workspaceSlug:n,projectId:r}=e,{getFilteredArchivedModuleIds:a,loader:i}=(0,u.b7)(),{archivedModulesSearchQuery:o}=(0,u.zE)(),c=a(r);return i||!c?(0,l.jsx)(en.ci,{}):0===c.length?(0,l.jsx)("div",{className:"h-full w-full grid place-items-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(et(),{src:""===o.trim()?ea:ei,className:"h-36 sm:h-48 w-36 sm:w-48 mx-auto",alt:"No matching modules"}),(0,l.jsx)("h5",{className:"text-xl font-medium mt-7 mb-1",children:"No matching modules"}),(0,l.jsx)("p",{className:"text-custom-text-400 text-base",children:""===o.trim()?"Remove the filters to see all modules":"Remove the search criteria to see all modules"})]})}):(0,l.jsx)("div",{className:"h-full overflow-y-auto",children:(0,l.jsxs)("div",{className:"flex h-full w-full justify-between",children:[(0,l.jsx)("div",{className:"flex h-full w-full flex-col overflow-y-auto vertical-scrollbar scrollbar-lg",children:c.map(e=>(0,l.jsx)(em,{moduleId:e},e))}),(0,l.jsx)(eh,{projectId:null!==(t=null==r?void 0:r.toString())&&void 0!==t?t:"",workspaceSlug:null!==(s=null==n?void 0:n.toString())&&void 0!==s?s:"",isArchived:!0})]})})});var eR=s(42903);let eF=(0,n.Pi)(()=>{let{projectId:e}=(0,M.useRouter)().query,t=(0,g.useRef)(null),{currentProjectArchivedFilters:s,currentProjectDisplayFilters:n,archivedModulesSearchQuery:a,updateFilters:i,updateDisplayFilters:o,updateArchivedModulesSearchQuery:c}=(0,u.zE)(),{workspace:{workspaceMemberIds:d}}=(0,u.Kb)(),[m,h]=(0,g.useState)(""!==a);(0,eS.Z)(t,()=>{m&&""===a.trim()&&h(!1)});let p=(0,g.useCallback)((t,l)=>{var n,r;if(!e)return;let a=null!==(n=null==s?void 0:s[t])&&void 0!==n?n:[];Array.isArray(l)?l.forEach(e=>{a.includes(e)?a.splice(a.indexOf(e),1):a.push(e)}):(null==s?void 0:null===(r=s[t])||void 0===r?void 0:r.includes(l))?a.splice(a.indexOf(l),1):a.push(l),i(e.toString(),{[t]:a},"archived")},[s,e,i]),x=0!==(0,eC.w)(null!=s?s:{});return(0,l.jsxs)("div",{className:"group relative flex border-b border-custom-border-200",children:[(0,l.jsx)("div",{className:"flex w-full items-center overflow-x-auto px-4 gap-2 horizontal-scrollbar scrollbar-sm",children:(0,l.jsx)(eR.o,{})}),(0,l.jsxs)("div",{className:"h-full flex items-center gap-3 self-end px-8",children:[!m&&(0,l.jsx)("button",{type:"button",className:"-mr-5 p-2 hover:bg-custom-background-80 rounded text-custom-text-400 grid place-items-center",onClick:()=>{var e;h(!0),null===(e=t.current)||void 0===e||e.focus()},children:(0,l.jsx)(k.Z,{className:"h-3.5 w-3.5"})}),(0,l.jsxs)("div",{className:(0,O.cn)("ml-auto flex items-center justify-start gap-1 rounded-md border border-transparent bg-custom-background-100 text-custom-text-400 w-0 transition-[width] ease-linear overflow-hidden opacity-0",{"w-64 px-2.5 py-1.5 border-custom-border-200 opacity-100":m}),children:[(0,l.jsx)(k.Z,{className:"h-3.5 w-3.5"}),(0,l.jsx)("input",{ref:t,className:"w-full max-w-[234px] border-none bg-transparent text-sm text-custom-text-100 placeholder:text-custom-text-400 focus:outline-none",placeholder:"Search",value:a,onChange:e=>c(e.target.value),onKeyDown:e=>{if("Escape"===e.key){if(a&&""!==a.trim())c("");else{var s;h(!1),null===(s=t.current)||void 0===s||s.blur()}}}}),m&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>{c(""),h(!1)},children:(0,l.jsx)(r.Z,{className:"h-3 w-3"})})]}),(0,l.jsx)(T,{value:null==n?void 0:n.order_by,onChange:t=>{e&&t!==(null==n?void 0:n.order_by)&&o(e.toString(),{order_by:t})}}),(0,l.jsx)(y.lqY,{icon:(0,l.jsx)(eN.Z,{className:"h-3 w-3"}),title:"Filters",placement:"bottom-end",isFiltersApplied:x,children:(0,l.jsx)(C,{displayFilters:null!=n?n:{},filters:null!=s?s:{},handleDisplayFiltersUpdate:t=>{e&&o(e.toString(),t)},handleFiltersUpdate:p,memberIds:null!=d?d:void 0,isArchived:!0})})]})]})});var eO=s(30335),eT=s(15455);let eA=e=>{let{workspaceSlug:t,projectId:s,moduleId:n,isOpen:r,handleClose:a}=e,i=(0,M.useRouter)(),[o,c]=(0,g.useState)(!1),{getModuleNameById:m,archiveModule:h}=(0,u.b7)(),p=m(n),x=()=>{c(!1),a()},f=async()=>{c(!0),await h(t,s,n).then(()=>{(0,d.fz)({type:d.do.SUCCESS,title:"Archive success",message:"Your archives can be found in project archives."}),x(),i.push("/".concat(t,"/projects/").concat(s,"/modules"))}).catch(()=>(0,d.fz)({type:d.do.ERROR,title:"Error!",message:"Module could not be archived. Please try again."})).finally(()=>c(!1))};return(0,l.jsx)(eO.u.Root,{show:r,as:g.Fragment,children:(0,l.jsxs)(eT.V,{as:"div",className:"relative z-20",onClose:x,children:[(0,l.jsx)(eO.u.Child,{as:g.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,l.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,l.jsx)(eO.u.Child,{as:g.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,l.jsx)(eT.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-full sm:max-w-lg",children:(0,l.jsxs)("div",{className:"px-5 py-4",children:[(0,l.jsxs)("h3",{className:"text-xl font-medium 2xl:text-2xl",children:["Archive module ",p]}),(0,l.jsx)("p",{className:"mt-3 text-sm text-custom-text-200",children:"Are you sure you want to archive the module? All your archives can be restored later."}),(0,l.jsxs)("div",{className:"mt-3 flex justify-end gap-2",children:[(0,l.jsx)(d.zx,{variant:"neutral-primary",size:"sm",onClick:x,children:"Cancel"}),(0,l.jsx)(d.zx,{size:"sm",tabIndex:1,onClick:f,loading:o,children:o?"Archiving":"Archive"})]})]})})})})})]})})}},8256:function(e,t,s){s.d(t,{R:function(){return j}});var l=s(24246),n=s(27378),r=s(43659),a=s(79894),i=s.n(a),o=s(86677),c=s(19711),d=s(25449),u=s(23258),m=s(98036),h=s(865),p=s(27234),x=s(51374),f=s(74273),v=s(10634),g=s(18894);e=s.hmd(e);let j=(0,r.Pi)(t=>{var s,r,a;let{moduleId:j}=t,b=(0,n.useRef)(null),y=(0,o.useRouter)(),{workspaceSlug:w,projectId:N}=y.query,{membership:{currentProjectRole:k}}=(0,v.aF)(),{getModuleById:C,addModuleToFavorites:S,removeModuleFromFavorites:_}=(0,v.b7)(),{getUserDetails:I}=(0,v.Kb)(),{captureEvent:E}=(0,v.DN)(),P=C(j),R=!!k&&k>=x.MC.MEMBER,{isMobile:F}=(0,g.L)(),O=e=>{if(e.stopPropagation(),e.preventDefault(),!w||!N)return;let t=S(w.toString(),N.toString(),j).then(()=>{E(h.Tb,{module_id:j,element:"Grid layout",state:"SUCCESS"})});(0,d.uW)(t,{loading:"Adding module to favorites...",success:{title:"Success!",message:()=>"Module added to favorites."},error:{title:"Error!",message:()=>"Couldn't add the module to favorites. Please try again."}})},T=e=>{if(e.stopPropagation(),e.preventDefault(),!w||!N)return;let t=_(w.toString(),N.toString(),j).then(()=>{E(h.Vc,{module_id:j,element:"Grid layout",state:"SUCCESS"})});(0,d.uW)(t,{loading:"Removing module from favorites...",success:{title:"Success!",message:()=>"Module removed from favorites."},error:{title:"Error!",message:()=>"Couldn't remove the module from favorites. Please try again."}})};if(!P)return null;let A=P.backlog_issues+P.unstarted_issues+P.started_issues+P.completed_issues+P.cancelled_issues,D=P.completed_issues/A*100,M=(0,f._3)(P.target_date),z=(0,f._3)(P.start_date),L=P.target_date||P.start_date,Z=p.D8.find(e=>e.value===P.status),q=e&&A&&0!==A?A===P.completed_issues?"".concat(A," Issue").concat(A>1?"s":""):"".concat(P.completed_issues,"/").concat(A," Issues"):"0 Issue";return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(i(),{ref:b,href:"/".concat(w,"/projects/").concat(P.project_id,"/modules/").concat(P.id),children:(0,l.jsxs)("div",{className:"flex h-44 w-full flex-col justify-between rounded  border border-custom-border-100 bg-custom-background-100 p-4 text-sm hover:shadow-md",children:[(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsx)(d.u,{tooltipContent:P.name,position:"top",isMobile:F,children:(0,l.jsx)("span",{className:"truncate text-base font-medium",children:P.name})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[Z&&(0,l.jsx)("span",{className:"flex h-6 w-20 items-center justify-center rounded-sm text-center text-xs",style:{color:Z.color,backgroundColor:"".concat(Z.color,"20")},children:Z.label}),(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault();let{query:t}=y;t.peekModule?(delete t.peekModule,y.push({pathname:y.pathname,query:{...t}})):y.push({pathname:y.pathname,query:{...t,peekModule:j}})},children:(0,l.jsx)(c.Z,{className:"h-4 w-4 text-custom-text-400"})})]})]})}),(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 text-custom-text-200",children:[(0,l.jsx)(d.uQ,{className:"h-4 w-4 text-custom-text-300"}),(0,l.jsx)("span",{className:"text-xs text-custom-text-300",children:null!=q?q:"0 Issue"})]}),(null===(s=P.member_ids)||void 0===s?void 0:s.length)>0&&(0,l.jsx)(d.u,{tooltipContent:"".concat(P.member_ids.length," Members"),isMobile:F,children:(0,l.jsx)("div",{className:"flex cursor-default items-center gap-1",children:(0,l.jsx)(d.HE,{showTooltip:!1,children:P.member_ids.map(e=>{let t=I(e);return(0,l.jsx)(d.qE,{name:null==t?void 0:t.display_name,src:null==t?void 0:t.avatar},null==t?void 0:t.id)})})})})]}),(0,l.jsx)(d.u,{isMobile:F,tooltipContent:isNaN(D)?"0":"".concat(D.toFixed(0),"%"),position:"top-left",children:(0,l.jsx)("div",{className:"flex w-full items-center",children:(0,l.jsx)("div",{className:"bar relative h-1.5 w-full rounded bg-custom-background-90",style:{boxShadow:"1px 1px 4px 0px rgba(161, 169, 191, 0.35) inset"},children:(0,l.jsx)("div",{className:"absolute left-0 top-0 h-1.5 rounded bg-blue-600 duration-300",style:{width:"".concat(isNaN(D)?0:D.toFixed(0),"%")}})})})}),(0,l.jsx)("div",{className:"flex items-center justify-between py-0.5",children:L?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("span",{className:"text-xs text-custom-text-300",children:[null!==(r=(0,f.ot)(z))&&void 0!==r?r:"_ _"," - ",null!==(a=(0,f.ot)(M))&&void 0!==a?a:"_ _"]})}):(0,l.jsx)("span",{className:"text-xs text-custom-text-400",children:"No due date"})})]})]})}),(0,l.jsxs)("div",{className:"absolute right-4 bottom-3.5 flex items-center gap-1.5",children:[R&&(0,l.jsx)(u.MD,{onClick:e=>{P.is_favorite?T(e):O(e)},selected:!!P.is_favorite}),w&&N&&(0,l.jsx)(m.fu,{parentRef:b,moduleId:j,projectId:N.toString(),workspaceSlug:w.toString()})]})]})})},92260:function(e,t,s){s.d(t,{m:function(){return O}});var l=s(24246),n=s(27378),r=s(43659),a=s(86677),i=s(88039),o=s(78543),c=s(3515),d=s(9204),u=s(54129),m=s(41256),h=s(75437),p=s(65709),x=s(93965),f=s(47542),v=s(19711),g=s(49505),j=s(30335),b=s(25449),y=s(23258),w=s(96883),N=s(36738),k=s(98036),C=s(865),S=s(93997),_=s(27234),I=s(51374),E=s(74273),P=s(10712),R=s(10634);e=s.hmd(e);let F={lead_id:"",member_ids:[],start_date:null,target_date:null,status:"backlog"},O=(0,r.Pi)(t=>{var s;let{moduleId:r,handleClose:O,isArchived:T}=t,[A,D]=(0,n.useState)(!1),[M,z]=(0,n.useState)(!1),[L,Z]=(0,n.useState)(!1),[q,B]=(0,n.useState)(null),U=(0,a.useRouter)(),{workspaceSlug:V,projectId:W,peekModule:K}=U.query,{membership:{currentProjectRole:Y}}=(0,R.aF)(),{getModuleById:J,updateModuleDetails:H,createModuleLink:Q,updateModuleLink:G,deleteModuleLink:$,restoreModule:X}=(0,R.b7)(),{setTrackElement:ee,captureModuleEvent:et,captureEvent:es}=(0,R.DN)(),{issuesFilter:{issueFilters:el,updateFilters:en}}=(0,R.gk)(S.rS.MODULE),er=J(r),ea=null==er?void 0:null===(s=er.status)||void 0===s?void 0:s.toLocaleLowerCase(),ei=!!ea&&["completed","cancelled"].includes(ea),{reset:eo,control:ec}=(0,i.cI)({defaultValues:F}),ed=e=>{V&&W&&r&&H(V.toString(),W.toString(),r.toString(),e).then(t=>{et({eventName:C.dw,payload:{...t,changed_properties:Object.keys(e)[0],element:"Right side-peek",state:"SUCCESS"}})}).catch(()=>{et({eventName:C.dw,payload:{...e,state:"FAILED"}})})},eu=async e=>{if(!V||!W||!r)return;let t={metadata:{},...e};Q(V.toString(),W.toString(),r.toString(),t).then(()=>{es(C.Fb,{module_id:r,state:"SUCCESS"}),(0,b.fz)({type:b.do.SUCCESS,title:"Success!",message:"Module link created successfully."})}).catch(()=>{(0,b.fz)({type:b.do.ERROR,title:"Error!",message:"Some error occurred"})})},em=async(t,s)=>{if(!V||!W||!e)return;let l={metadata:{},...t};G(V.toString(),W.toString(),r.toString(),s,l).then(()=>{es(C.pm,{module_id:r,state:"SUCCESS"}),(0,b.fz)({type:b.do.SUCCESS,title:"Success!",message:"Module link updated successfully."})}).catch(()=>{(0,b.fz)({type:b.do.ERROR,title:"Error!",message:"Some error occurred"})})},eh=async t=>{V&&W&&e&&$(V.toString(),W.toString(),r.toString(),t).then(()=>{es(C.NH,{module_id:r,state:"SUCCESS"}),(0,b.fz)({type:b.do.SUCCESS,title:"Success!",message:"Module link deleted successfully."})}).catch(()=>{(0,b.fz)({type:b.do.ERROR,title:"Error!",message:"Some error occurred"})})},ep=async(e,t)=>{ed({start_date:e?(0,E.ss)(e):null,target_date:t?(0,E.ss)(t):null}),(0,b.fz)({type:b.do.SUCCESS,title:"Success!",message:"Module updated successfully."})},ex=async e=>{e.preventDefault(),e.stopPropagation(),V&&W&&r&&await X(V.toString(),W.toString(),r).then(()=>{(0,b.fz)({type:b.do.SUCCESS,title:"Restore success",message:"Your module can be found in project modules."}),U.push("/".concat(V,"/projects/").concat(W,"/archives/modules"))}).catch(()=>(0,b.fz)({type:b.do.ERROR,title:"Error!",message:"Module could not be restored. Please try again."}))};(0,n.useEffect)(()=>{er&&eo({...er})},[er,eo]);let ef=(0,n.useCallback)((e,t)=>{var s,l,n,a;if(!V||!W)return;let i=null!==(l=null==el?void 0:null===(s=el.filters)||void 0===s?void 0:s[e])&&void 0!==l?l:[];Array.isArray(t)?t.forEach(e=>{i.includes(e)?i.splice(i.indexOf(e),1):i.push(e)}):(null==el?void 0:null===(a=el.filters)||void 0===a?void 0:null===(n=a[e])||void 0===n?void 0:n.includes(t))?i.splice(i.indexOf(t),1):i.push(t),en(V.toString(),W.toString(),S.gc.FILTERS,{[e]:i},r)},[V,W,r,el,en]),ev=(0,E._3)(null==er?void 0:er.start_date),eg=(0,E._3)(null==er?void 0:er.target_date),ej=ev&&ev<=new Date,eb=ev&&eg&&eg>=ev,ey=er?Math.round(er.completed_issues/er.total_issues*100):null,ew=e=>{B(e),Z(!0)};if(!er)return(0,l.jsxs)(b.aN,{children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(b.aN.Item,{height:"15px",width:"50%"}),(0,l.jsx)(b.aN.Item,{height:"15px",width:"30%"})]}),(0,l.jsxs)("div",{className:"mt-8 space-y-3",children:[(0,l.jsx)(b.aN.Item,{height:"30px"}),(0,l.jsx)(b.aN.Item,{height:"30px"}),(0,l.jsx)(b.aN.Item,{height:"30px"})]})]});let eN=_.D8.find(e=>e.value===er.status),ek=0===er.total_issues?"0 Issue":"".concat(er.completed_issues,"/").concat(er.total_issues),eC=!!Y&&Y>=I.MC.MEMBER;return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(y.I3,{isOpen:L,handleClose:()=>{Z(!1),B(null)},data:q,status:!!q,createIssueLink:eu,updateIssueLink:em}),V&&W&&(0,l.jsx)(k.Wn,{workspaceSlug:V.toString(),projectId:W.toString(),moduleId:r,isOpen:M,handleClose:()=>z(!1)}),(0,l.jsx)(k.ps,{isOpen:A,onClose:()=>D(!1),data:er}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"sticky z-10 top-0 flex items-center justify-between bg-custom-sidebar-background-100 py-5",children:[(0,l.jsx)("div",{children:(0,l.jsx)("button",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-custom-border-300",onClick:()=>O(),children:(0,l.jsx)(o.Z,{className:"h-3 w-3 stroke-2 text-white"})})}),(0,l.jsxs)("div",{className:"flex items-center gap-3.5",children:[!T&&(0,l.jsx)("button",{onClick:()=>{(0,P.fQ)("".concat(V,"/projects/").concat(W,"/modules/").concat(r)).then(()=>{(0,b.fz)({type:b.do.SUCCESS,title:"Link copied",message:"Module link copied to clipboard"})}).catch(()=>{(0,b.fz)({type:b.do.ERROR,title:"Error!",message:"Some error occurred"})})},children:(0,l.jsx)(c.Z,{className:"h-3 w-3 text-custom-text-300"})}),eC&&(0,l.jsxs)(b.fR,{placement:"bottom-end",ellipsis:!0,children:[!T&&(0,l.jsx)(b.fR.MenuItem,{onClick:()=>z(!0),disabled:!ei,children:ei?(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(b.rK,{className:"h-3 w-3"}),"Archive module"]}):(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)(b.rK,{className:"h-3 w-3"}),(0,l.jsxs)("div",{className:"-mt-1",children:[(0,l.jsx)("p",{children:"Archive module"}),(0,l.jsxs)("p",{className:"text-xs text-custom-text-400",children:["Only completed or cancelled ",(0,l.jsx)("br",{})," module can be archived."]})]})]})}),T&&(0,l.jsx)(b.fR.MenuItem,{onClick:ex,children:(0,l.jsxs)("span",{className:"flex items-center justify-start gap-2",children:[(0,l.jsx)(d.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:"Restore module"})]})}),(0,l.jsx)(b.fR.MenuItem,{onClick:()=>{ee("Module peek-overview"),D(!0)},children:(0,l.jsxs)("span",{className:"flex items-center justify-start gap-2",children:[(0,l.jsx)(u.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{children:"Delete module"})]})})]})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsx)("div",{className:"flex items-center gap-5 pt-2",children:(0,l.jsx)(i.Qr,{control:ec,name:"status",render:e=>{var t;let{field:{value:s}}=e;return(0,l.jsx)(b.AP,{customButton:(0,l.jsx)("span",{className:"flex h-6 w-20 items-center justify-center rounded-sm text-center text-xs ".concat(eC&&!T?"cursor-pointer":"cursor-not-allowed"),style:{color:eN?eN.color:"#a3a3a2",backgroundColor:eN?"".concat(eN.color,"20"):"#a3a3a220"},children:null!==(t=null==eN?void 0:eN.label)&&void 0!==t?t:"Backlog"}),value:s,onChange:e=>{ed({status:e})},disabled:!eC||T,children:_.D8.map(e=>(0,l.jsx)(b.AP.Option,{value:e.value,children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(b.Kr,{status:e.value}),e.label]})},e.value))})}})}),(0,l.jsx)("h4",{className:"w-full break-words text-xl font-semibold text-custom-text-100",children:er.name})]}),er.description&&(0,l.jsx)(b.Kx,{className:"outline-none ring-none w-full max-h-max bg-transparent !p-0 !m-0 !border-0 resize-none text-sm leading-5 text-custom-text-200",value:er.description,disabled:!0}),(0,l.jsxs)("div",{className:"flex items-center justify-start gap-1",children:[(0,l.jsxs)("div",{className:"flex w-2/5 items-center justify-start gap-2 text-custom-text-300",children:[(0,l.jsx)(m.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-base",children:"Date range"})]}),(0,l.jsx)("div",{className:"h-7 w-3/5",children:(0,l.jsx)(i.Qr,{control:ec,name:"start_date",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(i.Qr,{control:ec,name:"target_date",render:e=>{let{field:{value:n,onChange:r}}=e,a=(0,E._3)(t),i=(0,E._3)(n);return(0,l.jsx)(N.CF,{buttonContainerClassName:"w-full",buttonVariant:"background-with-text",minDate:new Date,value:{from:a,to:i},onSelect:e=>{s((null==e?void 0:e.from)?(0,E.ss)(e.from):null),r((null==e?void 0:e.to)?(0,E.ss)(e.to):null),ep(null==e?void 0:e.from,null==e?void 0:e.to)},placeholder:{from:"Start date",to:"Target date"},disabled:!eC||T})}})}})})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-5 pb-6 pt-2.5",children:[(0,l.jsxs)("div",{className:"flex items-center justify-start gap-1",children:[(0,l.jsxs)("div",{className:"flex w-2/5 items-center justify-start gap-2 text-custom-text-300",children:[(0,l.jsx)(h.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-base",children:"Lead"})]}),(0,l.jsx)(i.Qr,{control:ec,name:"lead_id",render:e=>{var t;let{field:{value:s}}=e;return(0,l.jsx)("div",{className:"h-7 w-3/5",children:(0,l.jsx)(N.Yp,{value:null!=s?s:null,onChange:e=>{ed({lead_id:e})},projectId:null!==(t=null==W?void 0:W.toString())&&void 0!==t?t:"",multiple:!1,buttonVariant:"background-with-text",placeholder:"Lead",disabled:!eC||T})})}})]}),(0,l.jsxs)("div",{className:"flex items-center justify-start gap-1",children:[(0,l.jsxs)("div",{className:"flex w-2/5 items-center justify-start gap-2 text-custom-text-300",children:[(0,l.jsx)(b.Ti,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-base",children:"Members"})]}),(0,l.jsx)(i.Qr,{control:ec,name:"member_ids",render:e=>{var t;let{field:{value:s}}=e;return(0,l.jsx)("div",{className:"h-7 w-3/5",children:(0,l.jsx)(N.Yp,{value:null!=s?s:[],onChange:e=>{ed({member_ids:e})},multiple:!0,projectId:null!==(t=null==W?void 0:W.toString())&&void 0!==t?t:"",buttonVariant:s&&(null==s?void 0:s.length)>0?"transparent-without-text":"background-with-text",buttonClassName:s&&s.length>0?"hover:bg-transparent px-0":"",disabled:!eC||T})})}})]}),(0,l.jsxs)("div",{className:"flex items-center justify-start gap-1",children:[(0,l.jsxs)("div",{className:"flex w-2/5 items-center justify-start gap-2 text-custom-text-300",children:[(0,l.jsx)(b.uQ,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-base",children:"Issues"})]}),(0,l.jsx)("div",{className:"flex h-7 w-3/5 items-center",children:(0,l.jsx)("span",{className:"px-1.5 text-sm text-custom-text-300",children:ek})})]})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("div",{className:"flex w-full flex-col items-center justify-start gap-2 border-t border-custom-border-200 px-1.5 py-5",children:(0,l.jsx)(g.p,{defaultOpen:!0,children:e=>{var t,s;let{open:n}=e;return(0,l.jsxs)("div",{className:"relative  flex  h-full w-full flex-col ".concat(n?"":"flex-row"),children:[(0,l.jsxs)(g.p.Button,{className:"flex w-full items-center justify-between gap-2 p-1.5",disabled:!ej||!eb,children:[(0,l.jsx)("div",{className:"flex items-center justify-start gap-2 text-sm",children:(0,l.jsx)("span",{className:"font-medium text-custom-text-200",children:"Progress"})}),(0,l.jsxs)("div",{className:"flex items-center gap-2.5",children:[ey?(0,l.jsx)("span",{className:"flex h-5 w-9 items-center justify-center rounded bg-amber-500/20 text-xs font-medium text-amber-500",children:ey?"".concat(ey,"%"):""}):"",ej&&eb?(0,l.jsx)(p.Z,{className:"h-3 w-3 ".concat(n?"rotate-180 transform":""),"aria-hidden":"true"}):(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(x.Z,{height:14,width:14,className:"text-custom-text-200"}),(0,l.jsx)("span",{className:"text-xs italic text-custom-text-200",children:(null==er?void 0:er.start_date)&&(null==er?void 0:er.target_date)?"This module isn't active yet.":"Invalid date. Please enter valid date."})]})]})]}),(0,l.jsx)(j.u,{show:n,children:(0,l.jsx)(g.p.Panel,{children:(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[er.start_date&&er.target_date?(0,l.jsxs)("div",{className:" h-full w-full pt-4",children:[(0,l.jsx)("div",{className:"flex  items-start  gap-4 py-2 text-xs",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 text-custom-text-100",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,l.jsx)("span",{className:"h-2.5 w-2.5 rounded-full bg-[#A9BBD0]"}),(0,l.jsx)("span",{children:"Ideal"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,l.jsx)("span",{className:"h-2.5 w-2.5 rounded-full bg-[#4C8FFF]"}),(0,l.jsx)("span",{children:"Current"})]})]})}),(0,l.jsx)("div",{className:"relative h-40 w-full max-w-80",children:(0,l.jsx)(w.Z,{distribution:null!==(s=null===(t=er.distribution)||void 0===t?void 0:t.completion_chart)&&void 0!==s?s:{},startDate:er.start_date,endDate:er.target_date,totalIssues:er.total_issues})})]}):"",er.total_issues>0&&(0,l.jsx)("div",{className:"h-full w-full border-t border-custom-border-200 pt-5",children:(0,l.jsx)(y.R,{distribution:er.distribution,groupedIssues:{backlog:er.backlog_issues,unstarted:er.unstarted_issues,started:er.started_issues,completed:er.completed_issues,cancelled:er.cancelled_issues},totalIssues:er.total_issues,module:er,isPeekView:!!K,filters:el,handleFiltersUpdate:ef})})]})})})]})}})}),(0,l.jsx)("div",{className:"flex w-full flex-col items-center justify-start gap-2 border-t border-custom-border-200 px-1.5 py-5",children:(0,l.jsx)(g.p,{children:e=>{let{open:t}=e;return(0,l.jsxs)("div",{className:"relative  flex  h-full w-full flex-col ".concat(t?"":"flex-row"),children:[(0,l.jsxs)(g.p.Button,{className:"flex w-full items-center justify-between gap-2 p-1.5",children:[(0,l.jsx)("div",{className:"flex items-center justify-start gap-2 text-sm",children:(0,l.jsx)("span",{className:"font-medium text-custom-text-200",children:"Links"})}),(0,l.jsx)("div",{className:"flex items-center gap-2.5",children:(0,l.jsx)(p.Z,{className:"h-3.5 w-3.5 ".concat(t?"rotate-180 transform":""),"aria-hidden":"true"})})]}),(0,l.jsx)(j.u,{show:t,children:(0,l.jsx)(g.p.Panel,{children:(0,l.jsx)("div",{className:"mt-2 flex h-72 w-full flex-col space-y-3 overflow-y-auto",children:Y&&er.link_module&&er.link_module.length>0?(0,l.jsxs)(l.Fragment,{children:[eC&&!T&&(0,l.jsx)("div",{className:"flex w-full items-center justify-end",children:(0,l.jsxs)("button",{className:"flex items-center gap-1.5 text-sm font-medium text-custom-primary-100",onClick:()=>Z(!0),children:[(0,l.jsx)(f.Z,{className:"h-3 w-3"}),"Add link"]})}),r&&(0,l.jsx)(y.GG,{moduleId:r,handleEditLink:ew,handleDeleteLink:eh,userAuth:{isGuest:Y===I.MC.GUEST,isViewer:Y===I.MC.VIEWER,isMember:Y===I.MC.MEMBER,isOwner:Y===I.MC.ADMIN},disabled:T})]}):(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(v.Z,{className:"h-3.5 w-3.5 stroke-[1.5] text-custom-text-300"}),(0,l.jsx)("span",{className:"p-0.5 text-xs text-custom-text-300",children:"No links added yet"})]}),eC&&!T&&(0,l.jsxs)("button",{className:"flex items-center gap-1.5 text-sm font-medium text-custom-primary-100",onClick:()=>Z(!0),children:[(0,l.jsx)(f.Z,{className:"h-3 w-3"}),"Add link"]})]})})})})]})}})})]})]})]})})},10779:function(e,t,s){s.d(t,{bG:function(){return o},j5:function(){return m},OW:function(){return v},lN:function(){return g},U5:function(){return w},FU:function(){return I}});var l=s(24246),n=s(27378),r=s(43659),a=s(68114),i=s(51374);let o=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,searchQuery:o}=e,[c,d]=(0,n.useState)(!0),u=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,m=i.SQ.filter(e=>e.label.includes(o.toLowerCase()));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Access".concat(u>0?" (".concat(u,")"):""),isPreviewEnabled:c,handleIsPreviewEnabled:()=>d(!c)}),c&&(0,l.jsx)("div",{children:m.length>0?m.map(e=>(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes("".concat(e.key)),onClick:()=>r("".concat(e.key)),icon:(0,l.jsx)(e.icon,{className:"h-3 w-3"}),title:e.label},e.key)):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})});var c=s(23258),d=s(60801),u=s(74273);let m=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,searchQuery:i}=e,[o,m]=(0,n.useState)(!0),[h,p]=(0,n.useState)(!1),x=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,f=d.XX.filter(e=>e.name.toLowerCase().includes(i.toLowerCase())),v=()=>((null==s?void 0:s.filter(e=>(0,u.hc)(e.split(";")[0])))||[]).length>0;return(0,l.jsxs)(l.Fragment,{children:[h&&(0,l.jsx)(c.iF,{handleClose:()=>p(!1),isOpen:h,onSelect:e=>r(e),title:"Created date"}),(0,l.jsx)(a.YHs,{title:"Created date".concat(x>0?" (".concat(x,")"):""),isPreviewEnabled:o,handleIsPreviewEnabled:()=>m(!o)}),o&&(0,l.jsx)("div",{children:f.length>0?(0,l.jsxs)(l.Fragment,{children:[f.map(e=>(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(e.value),onClick:()=>r(e.value),title:e.name,multiple:!1},e.value)),(0,l.jsx)(a.f2,{isChecked:v(),onClick:()=>{v()?r((null==s?void 0:s.filter(e=>e.includes("-")))||[]):p(!0)},title:"Custom",multiple:!1})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"})})]})});var h=s(95099),p=s.n(h),x=s(25449),f=s(10634);let v=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,memberIds:i,searchQuery:o}=e,[c,d]=(0,n.useState)(5),[u,m]=(0,n.useState)(!0),{getUserDetails:h}=(0,f.Kb)(),{currentUser:v}=(0,f.aF)(),g=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,j=(0,n.useMemo)(()=>{let e=(i||[]).filter(e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase().includes(o.toLowerCase())});return p()(e,[e=>!(null!=s?s:[]).includes(e),e=>e!==(null==v?void 0:v.id),e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase()}])},[o]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Lead".concat(g>0?" (".concat(g,")"):""),isPreviewEnabled:u,handleIsPreviewEnabled:()=>m(!u)}),u&&(0,l.jsx)("div",{children:j?j.length>0?(0,l.jsxs)(l.Fragment,{children:[j.slice(0,c).map(e=>{let t=h(e);return t?(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(t.id),onClick:()=>r(t.id),icon:(0,l.jsx)(x.qE,{name:t.display_name,src:t.avatar,showTooltip:!1,size:"md"}),title:(null==v?void 0:v.id)===t.id?"You":null==t?void 0:t.display_name},"lead-".concat(t.id)):null}),j.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{j&&(c===j.length?d(5):d(j.length))},children:c===j.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(x.aN,{className:"space-y-2",children:[(0,l.jsx)(x.aN.Item,{height:"20px"}),(0,l.jsx)(x.aN.Item,{height:"20px"}),(0,l.jsx)(x.aN.Item,{height:"20px"})]})})]})}),g=(0,r.Pi)(e=>{var t;let{appliedFilters:s,handleUpdate:r,memberIds:i,searchQuery:o}=e,[c,d]=(0,n.useState)(5),[u,m]=(0,n.useState)(!0),{getUserDetails:h}=(0,f.Kb)(),{currentUser:v}=(0,f.aF)(),g=null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0,j=(0,n.useMemo)(()=>{let e=(i||[]).filter(e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase().includes(o.toLowerCase())});return p()(e,[e=>!(null!=s?s:[]).includes(e),e=>e!==(null==v?void 0:v.id),e=>{var t;return null===(t=h(e))||void 0===t?void 0:t.display_name.toLowerCase()}])},[o]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.YHs,{title:"Members".concat(g>0?" (".concat(g,")"):""),isPreviewEnabled:u,handleIsPreviewEnabled:()=>m(!u)}),u&&(0,l.jsx)("div",{children:j?j.length>0?(0,l.jsxs)(l.Fragment,{children:[j.slice(0,c).map(e=>{let t=h(e);return t?(0,l.jsx)(a.f2,{isChecked:null!=s&&!!s.includes(t.id),onClick:()=>r(t.id),icon:(0,l.jsx)(x.qE,{name:t.display_name,src:t.avatar,showTooltip:!1,size:"md"}),title:(null==v?void 0:v.id)===t.id?"You":null==t?void 0:t.display_name},"member-".concat(t.id)):null}),j.length>5&&(0,l.jsx)("button",{type:"button",className:"ml-8 text-xs font-medium text-custom-primary-100",onClick:()=>{j&&(c===j.length?d(5):d(j.length))},children:c===j.length?"View less":"View all"})]}):(0,l.jsx)("p",{className:"text-xs italic text-custom-text-400",children:"No matches found"}):(0,l.jsxs)(x.aN,{className:"space-y-2",children:[(0,l.jsx)(x.aN.Item,{height:"20px"}),(0,l.jsx)(x.aN.Item,{height:"20px"}),(0,l.jsx)(x.aN.Item,{height:"20px"})]})})]})});var j=s(81630),b=s(82558),y=s(91256);let w=(0,r.Pi)(e=>{var t,s,r,i;let{displayFilters:o,filters:c,handleFiltersUpdate:d,handleDisplayFiltersUpdate:u,memberIds:m}=e,[h,p]=(0,n.useState)("");return(0,l.jsxs)("div",{className:"flex h-full w-full flex-col overflow-hidden",children:[(0,l.jsx)("div",{className:"bg-custom-background-100 p-2.5 pb-0",children:(0,l.jsxs)("div",{className:"flex items-center gap-1.5 rounded border-[0.5px] border-custom-border-200 bg-custom-background-90 px-1.5 py-1 text-xs",children:[(0,l.jsx)(j.Z,{className:"text-custom-text-400",size:12,strokeWidth:2}),(0,l.jsx)("input",{type:"text",className:"w-full bg-custom-background-90 outline-none placeholder:text-custom-text-400",placeholder:"Search",value:h,onChange:e=>p(e.target.value),autoFocus:!0}),""!==h&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>p(""),children:(0,l.jsx)(b.Z,{className:"text-custom-text-300",size:12,strokeWidth:2})})]})}),(0,l.jsxs)("div",{className:"h-full w-full divide-y divide-custom-border-200 overflow-y-auto px-2.5 vertical-scrollbar scrollbar-sm",children:[(0,l.jsxs)("div",{className:"py-2",children:[(0,l.jsx)(a.f2,{isChecked:!!o.my_projects,onClick:()=>u({my_projects:!o.my_projects}),title:"My projects"}),(0,l.jsx)(a.f2,{isChecked:!!o.archived_projects,onClick:()=>u({archived_projects:!o.archived_projects}),title:"Archived"})]}),(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(y.bG,{appliedFilters:null!==(t=c.access)&&void 0!==t?t:null,handleUpdate:e=>d("access",e),searchQuery:h})}),(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(y.OW,{appliedFilters:null!==(s=c.lead)&&void 0!==s?s:null,handleUpdate:e=>d("lead",e),searchQuery:h,memberIds:m})}),(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(y.lN,{appliedFilters:null!==(r=c.members)&&void 0!==r?r:null,handleUpdate:e=>d("members",e),searchQuery:h,memberIds:m})}),(0,l.jsx)("div",{className:"py-2",children:(0,l.jsx)(y.j5,{appliedFilters:null!==(i=c.created_at)&&void 0!==i?i:null,handleUpdate:e=>d("created_at",e),searchQuery:h})})]})]})});var N=s(91603),k=s(65709),C=s(1759),S=s(6780);let _=["sort_order"],I=e=>{let{onChange:t,value:s,isMobile:n=!1}=e,r=i.LO.find(e=>null==s?void 0:s.includes(e.key)),a=(null==s?void 0:s[0])==="-",o=!!s&&_.includes(s);return(0,l.jsxs)(x.fR,{className:"".concat(n?"flex w-full justify-center":""),customButton:(0,l.jsx)(l.Fragment,{children:n?(0,l.jsxs)("div",{className:"flex text-sm items-center gap-2 neutral-primary text-custom-text-200",children:[(0,l.jsx)(N.Z,{className:"h-3 w-3"}),null==r?void 0:r.label,(0,l.jsx)(k.Z,{className:"h-3 w-3",strokeWidth:2})]}):(0,l.jsxs)("div",{className:(0,S.cn)((0,x.A6)("neutral-primary","sm"),"px-2 text-custom-text-200"),children:[(0,l.jsx)(N.Z,{className:"h-3 w-3"}),null==r?void 0:r.label,(0,l.jsx)(k.Z,{className:"h-3 w-3",strokeWidth:2})]})}),placement:"bottom-end",closeOnSelect:!0,children:[i.LO.map(e=>(0,l.jsxs)(x.fR.MenuItem,{className:"flex items-center justify-between gap-2",onClick:()=>{a?t("sort_order"==e.key?e.key:"-".concat(e.key)):t(e.key)},children:[e.label,(null==s?void 0:s.includes(e.key))&&(0,l.jsx)(C.Z,{className:"h-3 w-3"})]},e.key)),(0,l.jsx)("hr",{className:"my-2 border-custom-border-200"}),(0,l.jsxs)(x.fR.MenuItem,{className:"flex items-center justify-between gap-2",onClick:()=>{a&&t(s.slice(1))},disabled:o,children:["Ascending",!o&&!a&&(0,l.jsx)(C.Z,{className:"h-3 w-3"})]}),(0,l.jsxs)(x.fR.MenuItem,{className:"flex items-center justify-between gap-2",onClick:()=>{a||t("-".concat(s))},disabled:o,children:["Descending",!o&&a&&(0,l.jsx)(C.Z,{className:"h-3 w-3"})]})]})}},91256:function(e,t,s){s.d(t,{ds:function(){return c},zg:function(){return h},lx:function(){return f},eU:function(){return v},zD:function(){return V},gg:function(){return W},lD:function(){return te},Pn:function(){return ew},xy:function(){return eC},m8:function(){return L},bG:function(){return y.bG},j5:function(){return y.j5},OW:function(){return y.OW},lN:function(){return y.lN},$o:function(){return e0},Xv:function(){return eP},Jf:function(){return eF},am:function(){return eT},Uh:function(){return b},t:function(){return em},Uj:function(){return X},qm:function(){return eE},nx:function(){return eS},hI:function(){return U},U5:function(){return y.U5},h0:function(){return eg},WC:function(){return e2},JO:function(){return e4},FU:function(){return y.FU},g4:function(){return e6},Cl:function(){return eJ},ee:function(){return eV},B8:function(){return D},rZ:function(){return e9}});var l,n,r=s(24246),a=s(43659),i=s(82558),o=s(51374);let c=(0,a.Pi)(e=>{let{handleRemove:t,values:s,editable:l}=e;return(0,r.jsx)(r.Fragment,{children:s.map(e=>{let s=o.SQ.find(t=>"".concat(t.key)===e);return(0,r.jsxs)("div",{className:"flex items-center gap-1 rounded p-1 text-xs bg-custom-background-80",children:[null==s?void 0:s.label,l&&(0,r.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,r.jsx)(i.Z,{size:10,strokeWidth:2})})]},e)})})});var d=s(60801),u=s(74273),m=s(10712);let h=(0,a.Pi)(e=>{let{editable:t,handleRemove:s,values:l}=e,n=e=>{let t="",s=d.XX.find(t=>t.value===e);if(s)t=s.name;else{let s=e.split(";");if(2===s.length){let[e,l]=s;t="".concat((0,m.fm)(l)," ").concat((0,u.ot)(e))}}return t};return(0,r.jsx)(r.Fragment,{children:l.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,r.jsx)("span",{className:"normal-case",children:n(e)}),t&&(0,r.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>s(e),children:(0,r.jsx)(i.Z,{size:10,strokeWidth:2})})]},e))})});var p=s(25449),x=s(10634);let f=(0,a.Pi)(e=>{let{handleRemove:t,values:s,editable:l}=e,{workspace:{getWorkspaceMemberDetails:n}}=(0,x.Kb)();return(0,r.jsx)(r.Fragment,{children:s.map(e=>{var s;let a=null===(s=n(e))||void 0===s?void 0:s.member;return a?(0,r.jsxs)("div",{className:"flex items-center gap-1 rounded bg-custom-background-80 p-1 text-xs",children:[(0,r.jsx)(p.qE,{name:a.display_name,src:a.avatar,showTooltip:!1}),(0,r.jsx)("span",{className:"normal-case",children:a.display_name}),l&&(0,r.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,r.jsx)(i.Z,{size:10,strokeWidth:2})})]},e):null})})}),v=(0,a.Pi)(e=>{let{handleRemove:t,values:s,editable:l}=e;return(0,r.jsx)(r.Fragment,{children:s.map(e=>{var s;let n=null===(s=o.IK.find(t=>t.key===e))||void 0===s?void 0:s.label;return(0,r.jsxs)("div",{className:"flex items-center gap-1 rounded p-1 text-xs bg-custom-background-80",children:[n,l&&(0,r.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>t(e),children:(0,r.jsx)(i.Z,{size:10,strokeWidth:2})})]},e)})})}),g=["lead","members"],j=["created_at"],b=e=>{let{appliedFilters:t,appliedDisplayFilters:s,handleClearAllFilters:l,handleRemoveFilter:n,handleRemoveDisplayFilter:a,alwaysAllowEditing:o,filteredProjects:d,totalProjects:u}=e;return(t||s)&&(0!==Object.keys(t).length||0!==s.length)?(0,r.jsxs)("div",{className:"flex items-start justify-between gap-1.5",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-stretch gap-2 bg-custom-background-100",children:[Object.entries(null!=t?t:{}).map(e=>{let[t,s]=e;if(s&&(!Array.isArray(s)||0!==s.length))return(0,r.jsx)("div",{className:"flex flex-wrap items-center gap-2 rounded-md border border-custom-border-200 px-2 py-1 capitalize",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,r.jsx)("span",{className:"text-xs text-custom-text-300",children:(0,m.y2)(t)}),"access"===t&&(0,r.jsx)(c,{editable:o,handleRemove:e=>n("access",e),values:s}),j.includes(t)&&(0,r.jsx)(h,{editable:o,handleRemove:e=>n(t,e),values:s}),g.includes(t)&&(0,r.jsx)(f,{editable:o,handleRemove:e=>n(t,e),values:s}),o&&(0,r.jsx)("button",{type:"button",className:"grid place-items-center text-custom-text-300 hover:text-custom-text-200",onClick:()=>n(t,null),children:(0,r.jsx)(i.Z,{size:12,strokeWidth:2})})]})},t)}),s.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap items-center gap-2 rounded-md border border-custom-border-200 px-2 py-1 capitalize",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,r.jsx)("span",{className:"text-xs text-custom-text-300",children:"Projects"}),(0,r.jsx)(v,{editable:o,values:s,handleRemove:e=>a(e)})]})},"project_display_filters"),o&&(0,r.jsxs)("button",{type:"button",onClick:l,className:"flex items-center gap-2 rounded-md border border-custom-border-200 px-2 py-1 text-xs text-custom-text-300 hover:text-custom-text-200",children:["Clear all",(0,r.jsx)(i.Z,{size:12,strokeWidth:2})]})]}),(0,r.jsx)(p.u,{tooltipContent:(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-semibold",children:d})," of"," ",(0,r.jsx)("span",{className:"font-semibold",children:u})," projects match the applied filters."]}),children:(0,r.jsxs)("span",{className:"bg-custom-background-80 rounded-full text-sm font-medium py-1 px-2.5",children:[d,"/",u]})})]}):null};var y=s(10779),w=s(27378),N=s(86677),k=s(88039),C=s(50811),S=s(1759),_=s(80372),I=s(30335),E=s(15455),P=s(65709),R=s(18927),F=s(30640);let O=e=>{let{children:t,label:s,placeholder:l="Select"}=e;return(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(F.J,{className:"relative",children:e=>{let{open:n}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(F.J.Button,{className:"".concat("","  relative flex items-center gap-1 outline-none ring-0"),children:[(0,r.jsx)("div",{className:"text-sm",children:null!=s?s:l}),(0,r.jsx)("div",{className:"grid h-5 w-5 place-items-center",children:n?(0,r.jsx)(R.Z,{className:"h-4 w-4"}):(0,r.jsx)(P.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)(I.u,{as:w.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,r.jsx)(F.J.Panel,{className:"absolute right-0 z-10 mt-1 min-w-[150px]",children:(0,r.jsx)("div",{className:"mt-1 overflow-hidden overflow-y-auto rounded border border-custom-border-300 bg-custom-background-90 shadow-custom-shadow-2xs focus:outline-none",children:t})})})]})}})})},T={id:null,comments:!1,reactions:!1,votes:!1,inbox:null,views:["list","kanban"]},A=[{key:"list",label:"List"},{key:"kanban",label:"Kanban"}],D=(0,a.Pi)(e=>{let{isOpen:t,project:s,onClose:l}=e,[n,a]=(0,w.useState)(!1),[i,o]=(0,w.useState)(!1),c="https://plane.sh";c||(c=window.location.protocol+"//"+window.location.host+"/spaces");let{workspaceSlug:d}=(0,N.useRouter)().query,{projectPublishSettings:u,getProjectSettingsAsync:m,publishProject:h,updateProjectSettingsAsync:f,unPublishProject:v,fetchSettingsLoader:g}=(0,x.me)(),{control:j,formState:{isSubmitting:b},getValues:y,handleSubmit:P,reset:R,watch:F}=(0,k.cI)({defaultValues:T}),D=()=>{l(),o(!1),R({...T})};(0,w.useEffect)(()=>{if(u&&"not-initialized"!==u){let e=[];if(null==u?void 0:u.views){let t=null==u?void 0:u.views;if(!t)return;t.list&&e.push("list"),t.kanban&&e.push("kanban"),t.calendar&&e.push("calendar"),t.gantt&&e.push("gantt"),t.spreadsheet&&e.push("spreadsheet"),e=e&&e.length>0?e:["list"]}R({id:(null==u?void 0:u.id)||null,comments:(null==u?void 0:u.comments)||!1,reactions:(null==u?void 0:u.reactions)||!1,votes:(null==u?void 0:u.votes)||!1,inbox:(null==u?void 0:u.inbox)||null,views:e})}},[R,u,t]),(0,w.useEffect)(()=>{d&&t&&"not-initialized"===u&&m(d.toString(),s.id)},[t,d,s,u,m]);let M=async e=>{if(d)return h(d.toString(),s.id,e).then(e=>(D(),e)).catch(e=>e)},z=async e=>{var t;d&&await f(d.toString(),s.id,null!==(t=e.id)&&void 0!==t?t:"",e).then(e=>((0,p.fz)({type:p.do.SUCCESS,title:"Success!",message:"Publish settings updated successfully!"}),D(),e)).catch(e=>(console.error("error",e),e))},L=async e=>{d&&e&&(a(!0),await v(d.toString(),s.id,e).then(e=>(D(),e)).catch(()=>(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Something went wrong while un-publishing the project."})).finally(()=>a(!1)))},Z=async e=>{var t;if(!e.views||0===e.views.length){(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Please select at least one view layout to publish the project."});return}let l={comments:e.comments,reactions:e.reactions,votes:e.votes,inbox:e.inbox,views:{list:e.views.includes("list"),kanban:e.views.includes("kanban"),calendar:e.views.includes("calendar"),gantt:e.views.includes("gantt"),spreadsheet:e.views.includes("spreadsheet")}};s.is_deployed?await z({id:null!==(t=F("id"))&&void 0!==t?t:"",...l}):await M(l)},q=()=>{if(!u||"not-initialized"===u)return;let e=y();if(u.comments!==e.comments||u.reactions!==e.reactions||u.votes!==e.votes){o(!0);return}let t=0;if(A.forEach(s=>{u.views[s.key]!==e.views.includes(s.key)&&t++}),0!==t){o(!0);return}o(!1)};return(0,r.jsx)(I.u.Root,{show:t,as:w.Fragment,children:(0,r.jsxs)(E.V,{as:"div",className:"relative z-20",onClose:D,children:[(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-20 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center sm:p-0",children:(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-100",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsx)(E.V.Panel,{className:"w-full transform rounded-lg bg-custom-background-100 text-left shadow-custom-shadow-md transition-all sm:w-3/5 lg:w-1/2 xl:w-2/5",children:(0,r.jsxs)("form",{onSubmit:P(Z),className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2 px-6 pt-4",children:[(0,r.jsx)("h5",{className:"inline-block text-xl font-semibold",children:"Publish"}),s.is_deployed&&(0,r.jsx)(p.zx,{variant:"danger",onClick:()=>{var e;return L(null!==(e=F("id"))&&void 0!==e?e:"")},loading:n,children:n?"Un-publishing...":"Un-publish"})]}),g?(0,r.jsxs)(p.aN,{className:"space-y-4 px-6",children:[(0,r.jsx)(p.aN.Item,{height:"30px"}),(0,r.jsx)(p.aN.Item,{height:"30px"}),(0,r.jsx)(p.aN.Item,{height:"30px"}),(0,r.jsx)(p.aN.Item,{height:"30px"})]}):(0,r.jsxs)("div",{className:"px-6",children:[s.is_deployed&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"relative flex items-center gap-2 rounded-md border border-custom-border-100 bg-custom-background-80 px-3 py-2",children:[(0,r.jsx)("div",{className:"flex-grow truncate text-sm",children:"".concat(c,"/").concat(d,"/").concat(s.id)}),(0,r.jsx)("div",{className:"relative flex flex-shrink-0 items-center gap-1",children:(0,r.jsx)(e=>{let{copy_link:t}=e,[s,l]=(0,w.useState)(!1),n=()=>{navigator.clipboard.writeText(t),l(!0),setTimeout(()=>{l(!1)},1e3)};return(0,r.jsx)("div",{className:"flex h-[30px] min-w-[30px] cursor-pointer items-center justify-center rounded border border-custom-border-100 bg-custom-background-100 px-2 text-xs hover:bg-custom-background-90",onClick:()=>n(),children:s?"Copied":"Copy Link"})},{copy_link:"".concat(c,"/").concat(d,"/").concat(s.id)})})]}),(0,r.jsxs)("div",{className:"mt-3 flex items-center gap-1 text-custom-primary-100",children:[(0,r.jsx)("div",{className:"flex h-5 w-5 items-center overflow-hidden",children:(0,r.jsx)(C.Z,{className:"h-5 w-5"})}),(0,r.jsx)("div",{className:"text-sm",children:"This project is live on web"})]})]}),(0,r.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,r.jsxs)("div",{className:"relative flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"text-sm",children:"Views"}),(0,r.jsx)(k.Qr,{control:j,name:"views",render:e=>{let{field:{onChange:t,value:s}}=e;return(0,r.jsx)(O,{label:s.length>0?A.filter(e=>s.includes(e.key)).map(e=>e.label).join(", "):"",placeholder:"Select views",children:(0,r.jsx)(r.Fragment,{children:A.map(e=>(0,r.jsxs)("div",{className:"relative m-1 flex cursor-pointer items-center justify-between gap-2 rounded-sm p-1 px-2 text-custom-text-200 ".concat(s.includes(e.key)?"bg-custom-background-80 text-custom-text-100":"hover:bg-custom-background-80 hover:text-custom-text-100"),onClick:()=>{let l=s.length>0?s.includes(e.key)?s.filter(t=>t!==e.key):[...s,e.key]:[e.key];0!==l.length&&(t(l),q())},children:[(0,r.jsx)("div",{className:"text-sm",children:e.label}),(0,r.jsx)("div",{className:"relative flex h-4 w-4 items-center justify-center",children:s.length>0&&s.includes(e.key)&&(0,r.jsx)(S.Z,{className:"h-5 w-5"})})]},e.key))})})}})]}),(0,r.jsxs)("div",{className:"relative flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"text-sm",children:"Allow comments"}),(0,r.jsx)(k.Qr,{control:j,name:"comments",render:e=>{let{field:{onChange:t,value:s}}=e;return(0,r.jsx)(p.Zh,{value:s,onChange:e=>{t(e),q()},size:"sm"})}})]}),(0,r.jsxs)("div",{className:"relative flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"text-sm",children:"Allow reactions"}),(0,r.jsx)(k.Qr,{control:j,name:"reactions",render:e=>{let{field:{onChange:t,value:s}}=e;return(0,r.jsx)(p.Zh,{value:s,onChange:e=>{t(e),q()},size:"sm"})}})]}),(0,r.jsxs)("div",{className:"relative flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"text-sm",children:"Allow voting"}),(0,r.jsx)(k.Qr,{control:j,name:"votes",render:e=>{let{field:{onChange:t,value:s}}=e;return(0,r.jsx)(p.Zh,{value:s,onChange:e=>{t(e),q()},size:"sm"})}})]})]})]}),(0,r.jsxs)("div",{className:"relative flex items-center justify-between border-t border-custom-border-200 px-6 py-5",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-sm text-custom-text-400",children:[(0,r.jsx)(_.Z,{className:"h-4 w-4"}),(0,r.jsx)("div",{className:"text-sm",children:"Anyone with the link can access"})]}),!g&&(0,r.jsxs)("div",{className:"relative flex items-center gap-2",children:[(0,r.jsx)(p.zx,{variant:"neutral-primary",size:"sm",onClick:D,children:"Cancel"}),s.is_deployed?(0,r.jsx)(r.Fragment,{children:i&&(0,r.jsx)(p.zx,{variant:"primary",size:"sm",type:"submit",loading:b,children:b?"Updating...":"Update settings"})}):(0,r.jsx)(p.zx,{variant:"primary",size:"sm",type:"submit",loading:b,children:b?"Publishing...":"Publish"})]})]})]})})})})})]})})});var M=s(78543),z=s(49505);let L=e=>{let{projectDetails:t,handleDelete:s}=e;return(0,r.jsx)(z.p,{as:"div",className:"border-t border-custom-border-100 py-4",children:e=>{let{open:l}=e;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)(z.p.Button,{as:"button",type:"button",className:"flex w-full items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xl tracking-tight",children:"Delete Project"}),l?(0,r.jsx)(R.Z,{className:"h-5 w-5"}):(0,r.jsx)(M.Z,{className:"h-5 w-5"})]}),(0,r.jsx)(I.u,{show:l,enter:"transition duration-100 ease-out",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0",children:(0,r.jsx)(z.p.Panel,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-8 pt-4",children:[(0,r.jsx)("span",{className:"text-sm tracking-tight",children:"The danger zone of the project delete page is a critical area that requires careful consideration and attention. When deleting a project, all of the data and resources within that project will be permanently removed and cannot be recovered."}),(0,r.jsx)("div",{children:t?(0,r.jsx)("div",{children:(0,r.jsx)(p.zx,{variant:"danger",onClick:s,children:"Delete my project"})}):(0,r.jsx)(p.aN,{className:"mt-2 w-full",children:(0,r.jsx)(p.aN.Item,{height:"38px",width:"144px"})})})]})})})]})}})};var Z=s(95108),q=s(27943);let B=[{title:"Cycles",description:"Time-box issues and boost momentum, similar to sprints in scrum.",icon:(0,r.jsx)(p.sI,{className:"h-4 w-4 flex-shrink-0 rotate-180 text-purple-500"}),property:"cycle_view"},{title:"Modules",description:"Group multiple issues together and track the progress.",icon:(0,r.jsx)(p.kB,{width:16,height:16,className:"flex-shrink-0 text-red-500"}),property:"module_view"},{title:"Views",description:"Apply filters to issues and save them to analyse and investigate work.",icon:(0,r.jsx)(p.DK,{className:"h-4 w-4 flex-shrink-0 text-cyan-500"}),property:"issue_views_view"},{title:"Pages",description:"Document ideas, feature requirements, discussions within your project.",icon:(0,r.jsx)(Z.Z,{className:"h-4 w-4 flex-shrink-0 text-red-400"}),property:"page_view"},{title:"Inbox",description:"Capture external inputs, move valid issues to workflow.",icon:(0,r.jsx)(q.Z,{className:"h-4 w-4 flex-shrink-0 text-fuchsia-500"}),property:"inbox_view"}],U=(0,a.Pi)(e=>{let{workspaceSlug:t,projectId:s,isAdmin:l}=e,{captureEvent:n}=(0,x.DN)(),{currentUser:a}=(0,x.aF)(),{getProjectById:i,updateProject:o}=(0,x.PY)(),c=i(s),d=async e=>{if(!t||!s||!c)return;let l=o(t,s,e);(0,p.uW)(l,{loading:"Updating project feature...",success:{title:"Success!",message:()=>"Project feature updated successfully."},error:{title:"Error!",message:()=>"Something went wrong while updating project feature. Please try again."}})};return a?(0,r.jsx)("div",{className:"mx-4",children:B.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between gap-x-8 gap-y-2 border-b border-custom-border-100 bg-custom-background-100 pt-4 pb-2 last:border-b-0",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-center rounded bg-custom-primary-50/10 p-3",children:e.icon}),(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)("h4",{className:"text-sm font-medium leading-5",children:e.title}),(0,r.jsx)("p",{className:"text-sm tracking-tight text-custom-text-300 leading-5",children:e.description})]})]}),(0,r.jsx)(p.Zh,{value:!!(null==c?void 0:c[e.property]),onChange:()=>{n("Toggle ".concat(e.title.toLowerCase()),{enabled:!(null==c?void 0:c[e.property]),element:"Project settings feature page"}),d({[e.property]:!(null==c?void 0:c[e.property])})},disabled:!l,size:"sm"})]},e.property))}):(0,r.jsx)(r.Fragment,{})}),V=e=>{let{projectDetails:t,handleArchive:s}=e;return(0,r.jsx)(z.p,{as:"div",className:"border-t border-custom-border-100 py-4",children:e=>{let{open:l}=e;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)(z.p.Button,{as:"button",type:"button",className:"flex w-full items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xl tracking-tight",children:"Archive project"}),l?(0,r.jsx)(R.Z,{className:"h-5 w-5"}):(0,r.jsx)(M.Z,{className:"h-5 w-5"})]}),(0,r.jsx)(I.u,{show:l,enter:"transition duration-100 ease-out",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0",children:(0,r.jsx)(z.p.Panel,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-8 pt-4",children:[(0,r.jsx)("span",{className:"text-sm tracking-tight",children:"Archiving a project will unlist your project from your side navigation although you will still be able to access it from your projects page. You can restore the project or delete it whenever you want."}),(0,r.jsx)("div",{children:t?(0,r.jsx)("div",{children:(0,r.jsx)(p.zx,{variant:"outline-danger",onClick:s,children:"Archive project"})}):(0,r.jsx)(p.aN,{className:"mt-2 w-full",children:(0,r.jsx)(p.aN.Item,{height:"38px",width:"144px"})})})]})})})]})}})},W=e=>{let{workspaceSlug:t,projectId:s,isOpen:l,onClose:n,archive:a}=e,i=(0,N.useRouter)(),[o,c]=(0,w.useState)(!1),{getProjectById:d,archiveProject:u,restoreProject:m}=(0,x.PY)(),h=d(s);if(!h)return null;let f=async()=>{c(!0),await u(t,s).then(()=>{(0,p.fz)({type:p.do.SUCCESS,title:"Archive success",message:"".concat(h.name," has been archived successfully")}),n(),i.push("/".concat(t,"/projects/"))}).catch(()=>(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Project could not be archived. Please try again."})).finally(()=>c(!1))},v=async()=>{c(!0),await m(t,s).then(()=>{(0,p.fz)({type:p.do.SUCCESS,title:"Restore success",message:"You can find ".concat(h.name," in your projects.")}),n(),i.push("/".concat(t,"/projects/"))}).catch(()=>(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Project could not be restored. Please try again."})).finally(()=>c(!1))};return(0,r.jsx)(I.u.Root,{show:l,as:w.Fragment,children:(0,r.jsxs)(E.V,{as:"div",className:"relative z-20",onClose:()=>{c(!1),n()},children:[(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsx)(E.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-full sm:max-w-lg",children:(0,r.jsxs)("div",{className:"px-5 py-4",children:[(0,r.jsxs)("h3",{className:"text-xl font-medium 2xl:text-2xl",children:[a?"Archive":"Restore"," ",h.name]}),(0,r.jsx)("p",{className:"mt-3 text-sm text-custom-text-200",children:a?"This project and its issues, cycles, modules, and pages will be archived. Its issues wont appear in search. Only project admins can restore the project.":"Restoring a project will activate it and make it visible to all members of the project. Are you sure you want to continue?"}),(0,r.jsxs)("div",{className:"mt-3 flex justify-end gap-2",children:[(0,r.jsx)(p.zx,{variant:"neutral-primary",size:"sm",onClick:n,children:"Cancel"}),(0,r.jsx)(p.zx,{size:"sm",tabIndex:1,onClick:a?f:v,loading:o,children:a?o?"Archiving":"Archive":o?"Restoring":"Restore"})]})]})})})})})]})})};var K=s(38579),Y=s.n(K),J=s(74371),H=s(92775),Q=s(70540),G={src:"/_next/static/media/all-filters.65031e8d.svg",height:217,width:206,blurWidth:0,blurHeight:0},$={src:"/_next/static/media/name-filter.4622feed.svg",height:217,width:206,blurWidth:0,blurHeight:0};let X=(0,a.Pi)(()=>{let{commandPalette:e}=(0,x.IX)(),{setTrackElement:t}=(0,x.DN)(),{workspaceProjectIds:s,filteredProjectIds:l,getProjectById:n}=(0,x.PY)(),{searchQuery:a,currentWorkspaceDisplayFilters:i}=(0,x.HK)();return(null==s?void 0:s.length)!==0||(null==i?void 0:i.archived_projects)?l?0===l.length?(0,r.jsx)("div",{className:"h-full w-full grid place-items-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(Y(),{src:""===a.trim()?G:$,className:"h-36 sm:h-48 w-36 sm:w-48 mx-auto",alt:"No matching projects"}),(0,r.jsx)("h5",{className:"text-xl font-medium mt-7 mb-1",children:"No matching projects"}),(0,r.jsx)("p",{className:"text-custom-text-400 text-base whitespace-pre-line",children:""===a.trim()?"Remove the filters to see all projects":"No projects detected with the matching\ncriteria. Create a new project instead"})]})}):(0,r.jsx)("div",{className:"h-full w-full overflow-y-auto p-8 vertical-scrollbar scrollbar-lg",children:(0,r.jsx)("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3",children:l.map(e=>{let t=n(e);if(t)return(0,r.jsx)(em,{project:t},t.id)})})}):(0,r.jsx)(H.FY,{}):(0,r.jsx)(J.ub,{type:Q.C.WORKSPACE_PROJECTS,primaryButtonOnClick:()=>{t("Project empty state"),e.toggleCreateProjectModal(!0)}})});var ee=s(79894),et=s.n(ee),es=s(62468),el=s(69873),en=s(37969),er=s(3515),ea=s(9204),ei=s(54129),eo=s(85997),ec=s(23258),ed=s(6780),eu=s(18894);let em=(0,a.Pi)(e=>{var t,s;let{project:l}=e,[n,a]=(0,w.useState)(!1),[i,c]=(0,w.useState)(!1),[d,h]=(0,w.useState)(!1),f=(0,w.useRef)(null),v=(0,N.useRouter)(),{workspaceSlug:g}=v.query,{addProjectToFavorites:j,removeProjectFromFavorites:b}=(0,x.PY)(),{isMobile:y}=(0,eu.L)();l.member_role;let k=null===(t=l.members)||void 0===t?void 0:t.map(e=>e.member_id),C=l.member_role===o.MC.ADMIN,_=l.member_role===o.MC.MEMBER,I=!!l.archived_at,E=()=>{if(!g)return;let e=j(g.toString(),l.id);(0,p.uW)(e,{loading:"Adding project to favorites...",success:{title:"Success!",message:()=>"Project added to favorites."},error:{title:"Error!",message:()=>"Couldn't add the project to favorites. Please try again."}})},P=()=>{if(!g)return;let e=b(g.toString(),l.id);(0,p.uW)(e,{loading:"Removing project from favorites...",success:{title:"Success!",message:()=>"Project removed from favorites."},error:{title:"Error!",message:()=>"Couldn't remove the project from favorites. Please try again."}})},R="".concat(g,"/projects/").concat(l.id,"/issues"),F=()=>(0,m.fQ)(R).then(()=>(0,p.fz)({type:p.do.SUCCESS,title:"Link Copied!",message:"Project link copied to clipboard."})),O=[{key:"edit",action:()=>v.push("/".concat(g,"/projects/").concat(l.id,"/settings")),title:"Edit",icon:es.Z,shouldRender:!I&&(C||_)},{key:"join",action:()=>c(!0),title:"Join",icon:el.Z,shouldRender:!l.is_member&&!I},{key:"open-new-tab",action:()=>window.open("/".concat(R),"_blank"),title:"Open in new tab",icon:en.Z,shouldRender:l.is_member&&!I},{key:"copy-link",action:F,title:"Copy link",icon:er.Z,shouldRender:!I},{key:"restore",action:()=>h(!0),title:"Restore",icon:ea.Z,shouldRender:I&&C},{key:"delete",action:()=>a(!0),title:"Delete",icon:ei.Z,shouldRender:I&&C}];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eC,{project:l,isOpen:n,onClose:()=>a(!1)}),g&&(0,r.jsx)(eP,{workspaceSlug:g.toString(),project:l,isOpen:i,handleClose:()=>c(!1)}),g&&l&&(0,r.jsx)(W,{workspaceSlug:g.toString(),projectId:l.id,isOpen:d,onClose:()=>h(!1),archive:!1}),(0,r.jsxs)(et(),{ref:f,href:"/".concat(g,"/projects/").concat(l.id,"/issues"),onClick:e=>{l.is_member&&!I||(e.preventDefault(),e.stopPropagation(),I||c(!0))},className:"flex flex-col rounded border border-custom-border-200 bg-custom-background-100",children:[(0,r.jsx)(p.xV,{parentRef:f,items:O}),(0,r.jsxs)("div",{className:"relative h-[118px] w-full rounded-t ",children:[(0,r.jsx)("div",{className:"absolute inset-0 z-[1] bg-gradient-to-t from-black/60 to-transparent"}),(0,r.jsx)("img",{src:null!==(s=l.cover_image)&&void 0!==s?s:"https://images.unsplash.com/photo-1672243775941-10d763d9adef?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80",alt:l.name,className:"absolute left-0 top-0 h-full w-full rounded-t object-cover"}),(0,r.jsxs)("div",{className:"absolute bottom-4 z-[1] flex h-10 w-full items-center justify-between gap-3 px-4",children:[(0,r.jsxs)("div",{className:"flex flex-grow items-center gap-2.5 truncate",children:[(0,r.jsx)("div",{className:"h-9 w-9 flex-shrink-0 grid place-items-center rounded bg-white/90",children:(0,r.jsx)(eg,{logo:l.logo_props})}),(0,r.jsxs)("div",{className:"flex w-full flex-col justify-between gap-0.5 truncate",children:[(0,r.jsx)("h3",{className:"truncate font-semibold text-white",children:l.name}),(0,r.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,r.jsxs)("p",{className:"text-xs font-medium text-white",children:[l.identifier," "]}),0===l.network&&(0,r.jsx)(eo.Z,{className:"h-2.5 w-2.5 text-white "})]})]})]}),!I&&(0,r.jsxs)("div",{className:"flex h-full flex-shrink-0 items-center gap-2",children:[(0,r.jsx)("button",{className:"flex h-6 w-6 items-center justify-center rounded bg-white/10",onClick:e=>{e.stopPropagation(),e.preventDefault(),F()},children:(0,r.jsx)(er.Z,{className:"h-3 w-3 text-white"})}),(0,r.jsx)(ec.MD,{buttonClassName:"h-6 w-6 bg-white/10",iconClassName:(0,ed.cn)("h-3 w-3",{"text-white":!l.is_favorite}),onClick:e=>{e.preventDefault(),e.stopPropagation(),l.is_favorite?P():E()},selected:l.is_favorite})]})]})]}),(0,r.jsxs)("div",{className:(0,ed.cn)("flex h-[104px] w-full flex-col justify-between rounded-b p-4",{"opacity-90":I}),children:[(0,r.jsx)("p",{className:"line-clamp-2 break-words text-sm text-custom-text-300",children:l.description&&""!==l.description.trim()?l.description:"Created on ".concat((0,u.ot)(l.created_at))}),(0,r.jsxs)("div",{className:"item-center flex justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)(p.u,{isMobile:y,tooltipHeading:"Members",tooltipContent:l.members&&l.members.length>0?"".concat(l.members.length," Members"):"No Member",position:"top",children:k&&k.length>0?(0,r.jsx)("div",{className:"flex cursor-pointer items-center gap-2 text-custom-text-200",children:(0,r.jsx)(p.HE,{showTooltip:!1,children:k.map(e=>{var t;let s=null===(t=l.members)||void 0===t?void 0:t.find(t=>t.member_id===e);return s?(0,r.jsx)(p.qE,{name:s.member__display_name,src:s.member__avatar},s.id):null})})}):(0,r.jsx)("span",{className:"text-sm italic text-custom-text-400",children:"No Member Yet"})}),I&&(0,r.jsx)("div",{className:"text-xs text-custom-text-400 font-medium",children:"Archived"})]}),I?C&&(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)("div",{className:"flex items-center justify-center text-xs text-custom-text-400 font-medium hover:text-custom-text-200",onClick:e=>{e.preventDefault(),e.stopPropagation(),h(!0)},children:(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(ea.Z,{className:"h-3.5 w-3.5"}),"Restore"]})}),(0,r.jsx)("div",{className:"flex items-center justify-center text-xs text-custom-text-400 font-medium hover:text-custom-text-200",onClick:e=>{e.preventDefault(),e.stopPropagation(),a(!0)},children:(0,r.jsx)(ei.Z,{className:"h-3.5 w-3.5"})})]}):(0,r.jsxs)(r.Fragment,{children:[l.is_member&&(C||_?(0,r.jsx)(et(),{className:"flex items-center justify-center rounded p-1 text-custom-text-400 hover:bg-custom-background-80 hover:text-custom-text-200",onClick:e=>{e.stopPropagation()},href:"/".concat(g,"/projects/").concat(l.id,"/settings"),children:(0,r.jsx)(es.Z,{className:"h-3.5 w-3.5"})}):(0,r.jsxs)("span",{className:"flex items-center gap-1 text-custom-text-400 text-sm",children:[(0,r.jsx)(S.Z,{className:"h-3.5 w-3.5"}),"Joined"]})),!l.is_member&&(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(p.zx,{variant:"link-primary",className:"!p-0 font-semibold",onClick:e=>{e.preventDefault(),e.stopPropagation(),c(!0)},children:"Join"})})]})]})]})]})]})});var eh=s(19711),ep=s(36738),ex=s(865),ef=s(20673),ev=s(26313);let eg=e=>{var t;let{className:s,logo:l}=e;return(null==l?void 0:l.in_use)==="icon"&&(null==l?void 0:l.icon)?(0,r.jsx)("span",{style:{color:l.icon.color},className:(0,ed.cn)("material-symbols-rounded text-base",s),children:l.icon.name}):(null==l?void 0:l.in_use)==="emoji"&&(null==l?void 0:l.emoji)?(0,r.jsx)("span",{className:(0,ed.cn)("text-base",s),children:null===(t=l.emoji.value)||void 0===t?void 0:t.split("-").map(e=>String.fromCodePoint(parseInt(e,10)))}):(0,r.jsx)(r.Fragment,{})},ej={cover_image:o.uZ[Math.floor(Math.random()*o.uZ.length)],description:"",logo_props:{in_use:"emoji",emoji:{value:(0,ef.lD)()}},identifier:"",name:"",network:2,project_lead:null},eb=(0,a.Pi)(e=>{var t,s;let{setToFavorite:l,workspaceSlug:n,onClose:a,handleNextStep:c}=e,{captureProjectEvent:d}=(0,x.DN)(),{addProjectToFavorites:u,createProject:m}=(0,x.PY)(),[h,f]=(0,w.useState)(!0),{formState:{errors:v,isSubmitting:g},handleSubmit:j,reset:b,control:y,watch:N,setValue:C}=(0,k.cI)({defaultValues:ej,reValidateMode:"onChange"}),{isMobile:S}=(0,eu.L)(),_=e=>{n&&u(n.toString(),e).catch(()=>{(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Couldn't remove the project from favorites. Please try again."})})},I=async e=>{var t;return e.identifier=null===(t=e.identifier)||void 0===t?void 0:t.toUpperCase(),m(n.toString(),e).then(e=>{let t={...e,state:"SUCCESS"};d({eventName:ex.t8,payload:t}),(0,p.fz)({type:p.do.SUCCESS,title:"Success!",message:"Project created successfully."}),l&&_(e.id),c(e.id)}).catch(t=>{Object.keys(t.data).map(s=>{(0,p.fz)({type:p.do.ERROR,title:"Error!",message:t.data[s]}),d({eventName:ex.t8,payload:{...e,state:"FAILED"}})})})},E=e=>t=>{if(!h){e(t);return}""===t.target.value?C("identifier",""):C("identifier",(0,ev.jI)(t.target.value).substring(0,5)),e(t)},P=e=>t=>{let{value:s}=t.target,l=(0,ev.jI)(s);f(!1),e(l)},R=()=>{a(),f(!0),setTimeout(()=>{b()},300)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"group relative h-44 w-full rounded-lg bg-custom-background-80",children:[N("cover_image")&&(0,r.jsx)("img",{src:N("cover_image"),className:"absolute left-0 top-0 h-full w-full rounded-lg object-cover",alt:"Cover image"}),(0,r.jsx)("div",{className:"absolute right-2 top-2 p-2",children:(0,r.jsx)("button",{"data-posthog":"PROJECT_MODAL_CLOSE",type:"button",onClick:R,tabIndex:8,children:(0,r.jsx)(i.Z,{className:"h-5 w-5 text-white"})})}),(0,r.jsx)("div",{className:"absolute bottom-2 right-2",children:(0,r.jsx)(k.Qr,{name:"cover_image",control:y,render:e=>{let{field:{value:t,onChange:s}}=e;return(0,r.jsx)(ec.pq,{label:"Change Cover",onChange:s,control:y,value:t,tabIndex:9})}})}),(0,r.jsx)("div",{className:"absolute -bottom-[22px] left-3",children:(0,r.jsx)(k.Qr,{name:"logo_props",control:y,render:e=>{var t;let{field:{value:s,onChange:l}}=e;return(0,r.jsx)(p.DI,{label:(0,r.jsx)("span",{className:"grid h-11 w-11 place-items-center rounded-md bg-custom-background-80",children:(0,r.jsx)(eg,{logo:s,className:"text-xl"})}),onChange:e=>{let t={};(null==e?void 0:e.type)==="emoji"?t={value:(0,ef.US)(e.value.unified),url:e.value.imageUrl}:(null==e?void 0:e.type)==="icon"&&(t=e.value),l({in_use:null==e?void 0:e.type,[null==e?void 0:e.type]:t})},defaultIconColor:s.in_use&&"icon"===s.in_use?null===(t=s.icon)||void 0===t?void 0:t.color:void 0,defaultOpen:s.in_use&&"emoji"===s.in_use?p.Ml.EMOJI:p.Ml.ICON})}})})]}),(0,r.jsxs)("form",{onSubmit:j(I),className:"px-3",children:[(0,r.jsxs)("div",{className:"mt-9 space-y-6 pb-5",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-x-2 gap-y-3 md:grid-cols-4",children:[(0,r.jsxs)("div",{className:"md:col-span-3",children:[(0,r.jsx)(k.Qr,{control:y,name:"name",rules:{required:"Name is required",maxLength:{value:255,message:"Title should be less than 255 characters"}},render:e=>{let{field:{value:t,onChange:s}}=e;return(0,r.jsx)(p.II,{id:"name",name:"name",type:"text",value:t,onChange:E(s),hasError:!!v.name,placeholder:"Project name",className:"w-full focus:border-blue-400",tabIndex:1})}}),(0,r.jsx)("span",{className:"text-xs text-red-500",children:(0,r.jsx)(r.Fragment,{children:null==v?void 0:null===(t=v.name)||void 0===t?void 0:t.message})})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(k.Qr,{control:y,name:"identifier",rules:{required:"Project ID is required",validate:e=>/^[IA-Z0-9]+$/.test(e.toUpperCase())||"Only Alphanumeric & Non-latin characters are allowed.",minLength:{value:1,message:"Project ID must at least be of 1 character"},maxLength:{value:5,message:"Project ID must at most be of 5 characters"}},render:e=>{let{field:{value:t,onChange:s}}=e;return(0,r.jsx)(p.II,{id:"identifier",name:"identifier",type:"text",value:t,onChange:P(s),hasError:!!v.identifier,placeholder:"Project ID",className:(0,ed.cn)("w-full text-xs focus:border-blue-400 pr-7",{uppercase:t}),tabIndex:2})}}),(0,r.jsx)(p.u,{isMobile:S,tooltipContent:"Helps you identify issues in the project uniquely, (e.g. APP-123). Max 5 characters.",className:"text-sm",position:"right-top",children:(0,r.jsx)(eh.Z,{className:"absolute right-2 top-2.5 h-3 w-3 text-custom-text-400"})}),(0,r.jsx)("span",{className:"text-xs text-red-500",children:null==v?void 0:null===(s=v.identifier)||void 0===s?void 0:s.message})]}),(0,r.jsx)("div",{className:"md:col-span-4",children:(0,r.jsx)(k.Qr,{name:"description",control:y,render:e=>{let{field:{value:t,onChange:s}}=e;return(0,r.jsx)(p.Kx,{id:"description",name:"description",value:t,placeholder:"Description...",onChange:s,className:"!h-24 text-sm focus:border-blue-400",hasError:!!(null==v?void 0:v.description),tabIndex:3})}})})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsx)(k.Qr,{name:"network",control:y,render:e=>{let{field:{onChange:t,value:s}}=e,l=o.SQ.find(e=>e.key===s);return(0,r.jsx)("div",{className:"flex-shrink-0",tabIndex:4,children:(0,r.jsx)(p.AP,{value:s,onChange:t,label:(0,r.jsx)("div",{className:"flex items-center gap-1",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.icon,{className:"h-3 w-3"}),l.label]}):(0,r.jsx)("span",{className:"text-custom-text-400",children:"Select network"})}),placement:"bottom-start",noChevron:!0,tabIndex:4,children:o.SQ.map(e=>(0,r.jsx)(p.AP.Option,{value:e.key,children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(e.icon,{className:"h-3.5 w-3.5"}),(0,r.jsxs)("div",{className:"-mt-1",children:[(0,r.jsx)("p",{children:e.label}),(0,r.jsx)("p",{className:"text-xs text-custom-text-400",children:e.description})]})]})},e.key))})})}}),(0,r.jsx)(k.Qr,{name:"project_lead",control:y,render:e=>{let{field:{value:t,onChange:s}}=e;return null==t||"string"==typeof t?(0,r.jsx)("div",{className:"flex-shrink-0",tabIndex:5,children:(0,r.jsx)(ep.Yp,{value:t,onChange:e=>s(e===t?null:e),placeholder:"Lead",multiple:!1,buttonVariant:"border-with-text",tabIndex:5})}):(0,r.jsx)(r.Fragment,{})}})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 pt-4 border-t border-custom-border-100",children:[(0,r.jsx)(p.zx,{variant:"neutral-primary",size:"sm",onClick:R,tabIndex:6,children:"Cancel"}),(0,r.jsx)(p.zx,{variant:"primary",type:"submit",size:"sm",loading:g,tabIndex:7,children:g?"Creating":"Create project"})]})]})]})}),ey=(0,s(50649).Pi)(e=>{let{workspaceSlug:t,projectId:s,onClose:l}=e,{getProjectById:n}=(0,x.PY)();if(!t||!s)return null;let a=n(s);return a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"px-4 py-2",children:[(0,r.jsx)("h3",{className:"text-base font-medium leading-6",children:"Toggle project features"}),(0,r.jsx)("div",{className:"text-sm tracking-tight text-custom-text-200 leading-5",children:"Turn on features which help you manage and run your project."})]}),(0,r.jsx)(U,{workspaceSlug:t,projectId:s,isAdmin:!0}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2 mt-4 px-4 pt-4 pb-2 border-t border-custom-border-100",children:[(0,r.jsxs)("div",{className:"text-sm text-custom-text-300 font-medium",children:["Congrats! Project ",(0,r.jsx)(eg,{logo:a.logo_props})," ",(0,r.jsx)("p",{className:"break-all",children:a.name})," created."]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(p.zx,{variant:"neutral-primary",size:"sm",onClick:l,tabIndex:1,children:"Close"}),(0,r.jsx)(et(),{href:"/".concat(t,"/projects/").concat(s,"/issues"),onClick:l,className:(0,p.A6)("primary","sm"),tabIndex:2,children:"Open project"})]})]})]}):null});(l=n||(n={})).CREATE_PROJECT="CREATE_PROJECT",l.FEATURE_SELECTION="FEATURE_SELECTION";let ew=e=>{let{isOpen:t,onClose:s,setToFavorite:l=!1,workspaceSlug:n}=e,[a,i]=(0,w.useState)("CREATE_PROJECT"),[o,c]=(0,w.useState)(null);return(0,w.useEffect)(()=>{t&&(i("CREATE_PROJECT"),c(null))},[t]),(0,r.jsx)(I.u.Root,{show:t,as:w.Fragment,children:(0,r.jsxs)(E.V,{as:"div",className:"relative z-20",onClose:s,children:[(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-20 overflow-y-auto",children:(0,r.jsx)("div",{className:"my-10 flex items-center justify-center p-4 text-center sm:p-0 md:my-20",children:(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsxs)(E.V.Panel,{className:"w-full transform rounded-lg bg-custom-background-100 p-3 text-left shadow-custom-shadow-md transition-all sm:w-3/5 lg:w-1/2 xl:w-2/5",children:["CREATE_PROJECT"===a&&(0,r.jsx)(eb,{setToFavorite:l,workspaceSlug:n,onClose:s,handleNextStep:e=>{e&&(c(e),i("FEATURE_SELECTION"))}}),"FEATURE_SELECTION"===a&&(0,r.jsx)(ey,{projectId:o,workspaceSlug:n,onClose:s})]})})})})]})})};var eN=s(80986);let ek={projectName:"",confirmDelete:""},eC=e=>{let{isOpen:t,project:s,onClose:l}=e,{captureProjectEvent:n}=(0,x.DN)(),{deleteProject:a}=(0,x.PY)(),i=(0,N.useRouter)(),{workspaceSlug:o,projectId:c}=i.query,{control:d,formState:{errors:u,isSubmitting:m},handleSubmit:h,reset:f,watch:v}=(0,k.cI)({defaultValues:ek}),g=v("projectName")===(null==s?void 0:s.name)&&"delete my project"===v("confirmDelete"),j=()=>{let e=setTimeout(()=>{f(ek),clearTimeout(e)},350);l()},b=async()=>{o&&g&&await a(o.toString(),s.id).then(()=>{c&&c.toString()===s.id&&i.push("/".concat(o,"/projects")),j(),n({eventName:ex.Xc,payload:{...s,state:"SUCCESS",element:"Project general settings"}}),(0,p.fz)({type:p.do.SUCCESS,title:"Success!",message:"Project deleted successfully."})}).catch(()=>{n({eventName:ex.Xc,payload:{...s,state:"FAILED",element:"Project general settings"}}),(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Something went wrong. Please try again later."})})};return(0,r.jsx)(I.u.Root,{show:t,as:w.Fragment,children:(0,r.jsxs)(E.V,{as:"div",className:"relative z-20",onClose:j,children:[(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-20 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsx)(E.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:(0,r.jsxs)("form",{onSubmit:h(b),className:"flex flex-col gap-6 p-6",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-start gap-6",children:[(0,r.jsx)("span",{className:"place-items-center rounded-full bg-red-500/20 p-4",children:(0,r.jsx)(eN.Z,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),(0,r.jsx)("span",{className:"flex items-center justify-start",children:(0,r.jsx)("h3",{className:"text-xl font-medium 2xl:text-2xl",children:"Delete Project"})})]}),(0,r.jsx)("span",{children:(0,r.jsxs)("p",{className:"text-sm leading-7 text-custom-text-200",children:["Are you sure you want to delete project"," ",(0,r.jsx)("span",{className:"break-words font-semibold",children:null==s?void 0:s.name}),"? All of the data related to the project will be permanently removed. This action cannot be undone"]})}),(0,r.jsxs)("div",{className:"text-custom-text-200",children:[(0,r.jsxs)("p",{className:"break-words text-sm ",children:["Enter the project name ",(0,r.jsx)("span",{className:"font-medium text-custom-text-100",children:null==s?void 0:s.name})," ","to continue:"]}),(0,r.jsx)(k.Qr,{control:d,name:"projectName",render:e=>{let{field:{value:t,onChange:s,ref:l}}=e;return(0,r.jsx)(p.II,{id:"projectName",name:"projectName",type:"text",value:t,onChange:s,ref:l,hasError:!!u.projectName,placeholder:"Project name",className:"mt-2 w-full",autoComplete:"off"})}})]}),(0,r.jsxs)("div",{className:"text-custom-text-200",children:[(0,r.jsxs)("p",{className:"text-sm",children:["To confirm, type ",(0,r.jsx)("span",{className:"font-medium text-custom-text-100",children:"delete my project"})," ","below:"]}),(0,r.jsx)(k.Qr,{control:d,name:"confirmDelete",render:e=>{let{field:{value:t,onChange:s,ref:l}}=e;return(0,r.jsx)(p.II,{id:"confirmDelete",name:"confirmDelete",type:"text",value:t,onChange:s,ref:l,hasError:!!u.confirmDelete,placeholder:"Enter 'delete my project'",className:"mt-2 w-full",autoComplete:"off"})}})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(p.zx,{variant:"neutral-primary",size:"sm",onClick:j,children:"Cancel"}),(0,r.jsx)(p.zx,{variant:"danger",size:"sm",type:"submit",disabled:!g,loading:m,children:m?"Deleting...":"Delete Project"})]})]})})})})})]})})},eS=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"relative mt-6 h-44 w-full",children:[(0,r.jsx)(p.aN,{children:(0,r.jsx)(p.aN.Item,{height:"auto",width:"46px"})}),(0,r.jsxs)("div",{className:"absolute bottom-4 flex w-full items-end justify-between gap-3 px-4",children:[(0,r.jsx)("div",{className:"flex flex-grow gap-3 truncate",children:(0,r.jsx)("div",{className:"flex h-[52px] w-[52px] flex-shrink-0 items-center justify-center rounded-lg bg-custom-background-90",children:(0,r.jsx)(p.aN,{children:(0,r.jsx)(p.aN.Item,{height:"46px",width:"46px"})})})}),(0,r.jsx)("div",{className:"flex flex-shrink-0 justify-center",children:(0,r.jsx)(p.aN,{children:(0,r.jsx)(p.aN.Item,{height:"32px",width:"108px"})})})]})]}),(0,r.jsxs)("div",{className:"my-8 flex flex-col gap-8",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h4",{className:"text-sm",children:"Project Name"}),(0,r.jsx)(p.aN,{children:(0,r.jsx)(p.aN.Item,{height:"46px",width:"100%"})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h4",{className:"text-sm",children:"Description"}),(0,r.jsx)(p.aN,{className:"w-full",children:(0,r.jsx)(p.aN.Item,{height:"102px",width:"full"})})]}),(0,r.jsxs)("div",{className:"flex w-full items-center justify-between gap-10",children:[(0,r.jsxs)("div",{className:"flex w-1/2 flex-col gap-1",children:[(0,r.jsx)("h4",{className:"text-sm",children:"Identifier"}),(0,r.jsx)(p.aN,{children:(0,r.jsx)(p.aN.Item,{height:"36px",width:"100%"})})]}),(0,r.jsxs)("div",{className:"flex w-1/2 flex-col gap-1",children:[(0,r.jsx)("h4",{className:"text-sm",children:"Network"}),(0,r.jsx)(p.aN,{className:"w-full",children:(0,r.jsx)(p.aN.Item,{height:"46px",width:"100%"})})]})]}),(0,r.jsx)("div",{className:"flex items-center justify-between py-2",children:(0,r.jsx)(p.aN,{className:"mt-2 w-full",children:(0,r.jsx)(p.aN.Item,{height:"34px",width:"100px"})})})]})]});var e_=s(12447);let eI=new e_.Y4,eE=e=>{var t,s;let{project:l,workspaceSlug:n,projectId:a,isAdmin:i}=e,[c,d]=(0,w.useState)(!1),{captureProjectEvent:m}=(0,x.DN)(),{updateProject:h}=(0,x.PY)(),{isMobile:f}=(0,eu.L)(),{handleSubmit:v,watch:g,control:j,setValue:b,setError:y,reset:N,formState:{errors:C,dirtyFields:S},getValues:_}=(0,k.cI)({defaultValues:{...l,workspace:l.workspace.id}});(0,w.useEffect)(()=>{l&&a!==_("id")&&N({...l,workspace:l.workspace.id})},[l,a]);let I=e=>{let{value:t}=e.target;b("identifier",t.replace(/[^a-zA-Z0-9]/g,"").toUpperCase())},E=async e=>{if(n&&l)return h(n.toString(),l.id,e).then(e=>{let t=Object.keys(S);m({eventName:ex.$s,payload:{...e,changed_properties:t,state:"SUCCESS",element:"Project general settings"}}),(0,p.fz)({type:p.do.SUCCESS,title:"Success!",message:"Project updated successfully"})}).catch(t=>{var s;m({eventName:ex.$s,payload:{...e,state:"FAILED",element:"Project general settings"}}),(0,p.fz)({type:p.do.ERROR,title:"Error!",message:null!==(s=null==t?void 0:t.error)&&void 0!==s?s:"Project could not be updated. Please try again."})})},P=async e=>{var t;if(!n)return;d(!0);let s={name:e.name,network:e.network,identifier:e.identifier,description:e.description,cover_image:e.cover_image,logo_props:e.logo_props};l.identifier!==e.identifier?await eI.checkProjectIdentifierAvailability(n,null!==(t=s.identifier)&&void 0!==t?t:"").then(async e=>{e.exists?y("identifier",{message:"Identifier already exists"}):await E(s)}):await E(s),setTimeout(()=>{d(!1)},300)},R=o.SQ.find(e=>e.key===(null==l?void 0:l.network));return(0,r.jsxs)("form",{onSubmit:v(P),children:[(0,r.jsxs)("div",{className:"relative mt-6 h-44 w-full",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"}),(0,r.jsx)("img",{src:g("cover_image"),alt:g("cover_image"),className:"h-44 w-full rounded-md object-cover"}),(0,r.jsxs)("div",{className:"z-5 absolute bottom-4 flex w-full items-end justify-between gap-3 px-4",children:[(0,r.jsxs)("div",{className:"flex flex-grow gap-3 truncate",children:[(0,r.jsx)("div",{className:"flex h-[52px] w-[52px] flex-shrink-0 items-center justify-center rounded-lg bg-custom-background-90",children:(0,r.jsx)(k.Qr,{control:j,name:"logo_props",render:e=>{var t;let{field:{value:s,onChange:l}}=e;return(0,r.jsx)(p.DI,{label:(0,r.jsx)("span",{className:"grid h-7 w-7 place-items-center",children:(0,r.jsx)(eg,{logo:s,className:"text-lg"})}),onChange:e=>{let t={};(null==e?void 0:e.type)==="emoji"?t={value:(0,ef.US)(e.value.unified),url:e.value.imageUrl}:(null==e?void 0:e.type)==="icon"&&(t=e.value),l({in_use:null==e?void 0:e.type,[null==e?void 0:e.type]:t})},defaultIconColor:(null==s?void 0:s.in_use)&&"icon"===s.in_use?null==s?void 0:null===(t=s.icon)||void 0===t?void 0:t.color:void 0,defaultOpen:s.in_use&&"emoji"===s.in_use?p.Ml.EMOJI:p.Ml.ICON,disabled:!i})}})}),(0,r.jsxs)("div",{className:"flex flex-col gap-1 truncate text-white",children:[(0,r.jsx)("span",{className:"truncate text-lg font-semibold",children:g("name")}),(0,r.jsxs)("span",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsxs)("span",{children:[g("identifier")," ."]}),(0,r.jsxs)("span",{className:"flex items-center gap-1.5",children:[0===l.network&&(0,r.jsx)(eo.Z,{className:"h-2.5 w-2.5 text-white "}),null==R?void 0:R.label]})]})]})]}),(0,r.jsx)("div",{className:"flex flex-shrink-0 justify-center",children:(0,r.jsx)("div",{children:(0,r.jsx)(k.Qr,{control:j,name:"cover_image",render:e=>{let{field:{value:t,onChange:s}}=e;return(0,r.jsx)(ec.pq,{label:"Change cover",control:j,onChange:s,value:t,disabled:!i})}})})})]})]}),(0,r.jsxs)("div",{className:"my-8 flex flex-col gap-8",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h4",{className:"text-sm",children:"Project Name"}),(0,r.jsx)(k.Qr,{control:j,name:"name",rules:{required:"Name is required",maxLength:{value:255,message:"Project name should be less than 255 characters"}},render:e=>{let{field:{value:t,onChange:s,ref:l}}=e;return(0,r.jsx)(p.II,{id:"name",name:"name",type:"text",ref:l,value:t,onChange:s,hasError:!!C.name,className:"rounded-md !p-3 font-medium",placeholder:"Project Name",disabled:!i})}}),(0,r.jsx)("span",{className:"text-xs text-red-500",children:null==C?void 0:null===(t=C.name)||void 0===t?void 0:t.message})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h4",{className:"text-sm",children:"Description"}),(0,r.jsx)(k.Qr,{name:"description",control:j,render:e=>{let{field:{value:t,onChange:s}}=e;return(0,r.jsx)(p.Kx,{id:"description",name:"description",value:t,placeholder:"Enter project description",onChange:s,className:"min-h-[102px] text-sm font-medium",hasError:!!(null==C?void 0:C.description),disabled:!i})}})]}),(0,r.jsxs)("div",{className:"flex w-full justify-between gap-10",children:[(0,r.jsxs)("div",{className:"flex w-1/2 flex-col gap-1",children:[(0,r.jsx)("h4",{className:"text-sm",children:"Project ID"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(k.Qr,{control:j,name:"identifier",rules:{required:"Project ID is required",validate:e=>/^[IA-Z0-9]+$/.test(e.toUpperCase())||"Only Alphanumeric & Non-latin characters are allowed.",minLength:{value:1,message:"Project ID must at least be of 1 character"},maxLength:{value:5,message:"Project ID must at most be of 5 characters"}},render:e=>{let{field:{value:t,ref:s}}=e;return(0,r.jsx)(p.II,{id:"identifier",name:"identifier",type:"text",value:t,onChange:I,ref:s,hasError:!!C.identifier,placeholder:"Enter Project ID",className:"w-full font-medium",disabled:!i})}}),(0,r.jsx)(p.u,{isMobile:f,tooltipContent:"Helps you identify issues in the project uniquely, (e.g. APP-123). Max 5 characters.",className:"text-sm",position:"right-top",children:(0,r.jsx)(eh.Z,{className:"absolute right-2 top-2.5 h-4 w-4 text-custom-text-400"})})]}),(0,r.jsx)("span",{className:"text-xs text-red-500",children:(0,r.jsx)(r.Fragment,{children:null==C?void 0:null===(s=C.identifier)||void 0===s?void 0:s.message})})]}),(0,r.jsxs)("div",{className:"flex w-1/2 flex-col gap-1",children:[(0,r.jsx)("h4",{className:"text-sm",children:"Network"}),(0,r.jsx)(k.Qr,{name:"network",control:j,render:e=>{let{field:{value:t,onChange:s}}=e,l=o.SQ.find(e=>e.key===t);return(0,r.jsx)(p.AP,{value:t,onChange:s,label:(0,r.jsx)("div",{className:"flex items-center gap-1",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.icon,{className:"h-3.5 w-3.5"}),l.label]}):(0,r.jsx)("span",{className:"text-custom-text-400",children:"Select network"})}),buttonClassName:"!border-custom-border-200 !shadow-none font-medium rounded-md",input:!0,disabled:!i,children:o.SQ.map(e=>(0,r.jsx)(p.AP.Option,{value:e.key,children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(e.icon,{className:"h-3.5 w-3.5"}),(0,r.jsxs)("div",{className:"-mt-1",children:[(0,r.jsx)("p",{children:e.label}),(0,r.jsx)("p",{className:"text-xs text-custom-text-400",children:e.description})]})]})},e.key))})}})]})]}),(0,r.jsx)("div",{className:"flex items-center justify-between py-2",children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.zx,{variant:"primary",type:"submit",loading:c,disabled:!i,children:c?"Updating...":"Update project"}),(0,r.jsxs)("span",{className:"text-sm italic text-custom-sidebar-text-400",children:["Created on ",(0,u.ot)(null==l?void 0:l.created_at)]})]})})]})]})},eP=e=>{let{handleClose:t,isOpen:s,project:l,workspaceSlug:n}=e,[a,i]=(0,w.useState)(!1),{membership:{joinProject:o}}=(0,x.aF)(),{fetchProjects:c}=(0,x.PY)(),d=(0,N.useRouter)();return(0,r.jsx)(I.u.Root,{show:s,as:w.Fragment,children:(0,r.jsxs)(E.V,{as:"div",className:"relative z-20",onClose:t,children:[(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-20 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center sm:p-0",children:(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsxs)(E.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 px-5 py-8 text-left shadow-custom-shadow-md transition-all sm:w-full sm:max-w-xl sm:p-6",children:[(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsx)(E.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-custom-text-100",children:"Join Project?"}),(0,r.jsxs)("p",{children:["Are you sure you want to join the project"," ",(0,r.jsx)("span",{className:"break-words font-semibold",children:null==l?void 0:l.name}),"? Please click the 'Join Project' button below to continue."]}),(0,r.jsx)("div",{className:"space-y-3"})]}),(0,r.jsxs)("div",{className:"mt-5 flex justify-end gap-2",children:[(0,r.jsx)(p.zx,{variant:"neutral-primary",size:"sm",onClick:t,children:"Cancel"}),(0,r.jsx)(p.zx,{variant:"primary",size:"sm",tabIndex:1,type:"submit",onClick:()=>{i(!0),o(n,[l.id]).then(()=>{d.push("/".concat(n,"/projects/").concat(l.id,"/issues")),c(n),t()}).finally(()=>{i(!1)})},loading:a,children:a?"Joining...":"Join Project"})]})]})})})})]})})},eR={projectName:"",confirmLeave:""},eF=(0,a.Pi)(e=>{let{project:t,isOpen:s,onClose:l}=e,n=(0,N.useRouter)(),{workspaceSlug:a}=n.query,{captureEvent:i}=(0,x.DN)(),{membership:{leaveProject:o}}=(0,x.aF)(),{control:c,formState:{errors:d,isSubmitting:u},handleSubmit:m,reset:h}=(0,k.cI)({defaultValues:eR}),f=()=>{h({...eR}),l()},v=async e=>{if(a){if(e){if(e.projectName===(null==t?void 0:t.name)){if("Leave Project"===e.confirmLeave)return o(a.toString(),t.id).then(()=>{f(),n.push("/".concat(a,"/projects")),i(ex.Dv,{state:"SUCCESS",element:"Project settings members page"})}).catch(()=>{(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Something went wrong please try again later."}),i(ex.Dv,{state:"FAILED",element:"Project settings members page"})});(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Please confirm leaving the project by typing the 'Leave Project'."})}else(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Please enter the project name as shown in the description."})}else(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Please fill all fields."})}};return(0,r.jsx)(I.u.Root,{show:s,as:w.Fragment,children:(0,r.jsxs)(E.V,{as:"div",className:"relative z-20",onClose:f,children:[(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-20 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsx)(E.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:(0,r.jsxs)("form",{onSubmit:m(v),className:"flex flex-col gap-6 p-6",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-start gap-6",children:[(0,r.jsx)("span",{className:"place-items-center rounded-full bg-red-500/20 p-4",children:(0,r.jsx)(eN.Z,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),(0,r.jsx)("span",{className:"flex items-center justify-start",children:(0,r.jsx)("h3",{className:"text-xl font-medium 2xl:text-2xl",children:"Leave Project"})})]}),(0,r.jsx)("span",{children:(0,r.jsxs)("p",{className:"text-sm leading-7 text-custom-text-200",children:["Are you sure you want to leave the project -",(0,r.jsx)("span",{className:"font-medium text-custom-text-100",children:' "'.concat(null==t?void 0:t.name,'" ')}),"? All of the issues associated with you will become inaccessible."]})}),(0,r.jsxs)("div",{className:"text-custom-text-200",children:[(0,r.jsxs)("p",{className:"break-words text-sm ",children:["Enter the project name ",(0,r.jsx)("span",{className:"font-medium text-custom-text-100",children:null==t?void 0:t.name})," ","to continue:"]}),(0,r.jsx)(k.Qr,{control:c,name:"projectName",rules:{required:"Label title is required"},render:e=>{let{field:{value:t,onChange:s,ref:l}}=e;return(0,r.jsx)(p.II,{id:"projectName",name:"projectName",type:"text",value:t,onChange:s,ref:l,hasError:!!d.projectName,placeholder:"Enter project name",className:"mt-2 w-full"})}})]}),(0,r.jsxs)("div",{className:"text-custom-text-200",children:[(0,r.jsxs)("p",{className:"text-sm",children:["To confirm, type ",(0,r.jsx)("span",{className:"font-medium text-custom-text-100",children:"Leave Project"})," below:"]}),(0,r.jsx)(k.Qr,{control:c,name:"confirmLeave",render:e=>{let{field:{value:t,onChange:s,ref:l}}=e;return(0,r.jsx)(p.II,{id:"confirmLeave",name:"confirmLeave",type:"text",value:t,onChange:s,ref:l,hasError:!!d.confirmLeave,placeholder:"Enter 'leave project'",className:"mt-2 w-full"})}})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(p.zx,{variant:"neutral-primary",size:"sm",onClick:f,children:"Cancel"}),(0,r.jsx)(p.zx,{variant:"danger",size:"sm",type:"submit",loading:u,children:u?"Leaving...":"Leave Project"})]})]})})})})})]})})});var eO=s(70538);let eT=(0,a.Pi)(e=>{var t,s,l;let{value:n,onChange:a,isDisabled:i=!1}=e,{project:{projectMemberIds:o,getProjectMemberDetails:c}}=(0,x.Kb)(),d=null==o?void 0:o.map(e=>{let t=c(e);if(null==t?void 0:t.member)return{value:"".concat(null==t?void 0:t.member.id),query:"".concat(null==t?void 0:t.member.display_name),content:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(p.qE,{name:null==t?void 0:t.member.display_name,src:null==t?void 0:t.member.avatar}),null==t?void 0:t.member.display_name]})}}).filter(e=>!!e),u=c(n);return(0,r.jsx)(p.RO,{value:n,label:(0,r.jsxs)("div",{className:"flex items-center gap-2 h-5",children:[u&&(0,r.jsx)(p.qE,{name:null===(t=u.member)||void 0===t?void 0:t.display_name,src:null===(s=u.member)||void 0===s?void 0:s.avatar}),u?null===(l=u.member)||void 0===l?void 0:l.display_name:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eO.Z,{className:"h-3.5 w-3.5 rotate-90 text-custom-sidebar-text-400"}),(0,r.jsx)("span",{className:"text-sm text-custom-sidebar-text-400",children:"None"})]})]}),buttonClassName:"!px-3 !py-2",options:d&&d&&[...d,{value:"none",query:"none",content:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eO.Z,{className:"h-3.5 w-3.5 rotate-90 text-custom-sidebar-text-400"}),(0,r.jsx)("span",{className:"py-0.5 text-sm text-custom-sidebar-text-400",children:"None"})]})}],maxHeight:"md",onChange:a,disabled:i})});var eA=s(38330),eD=s(12248),eM=s(67522),ez=s(98399),eL=s(54375),eZ=s(46679),eq=s(70609),eB=s(42683);let eU=(e,t)=>[{name:"Issues",href:"/".concat(e,"/projects/").concat(t,"/issues"),Icon:p.uQ},{name:"Cycles",href:"/".concat(e,"/projects/").concat(t,"/cycles"),Icon:p.sI},{name:"Modules",href:"/".concat(e,"/projects/").concat(t,"/modules"),Icon:p.kB},{name:"Views",href:"/".concat(e,"/projects/").concat(t,"/views"),Icon:p.DK},{name:"Pages",href:"/".concat(e,"/projects/").concat(t,"/pages"),Icon:Z.Z},{name:"Inbox",href:"/".concat(e,"/projects/").concat(t,"/inbox"),Icon:q.Z},{name:"Settings",href:"/".concat(e,"/projects/").concat(t,"/settings"),Icon:eA.Z}],eV=(0,a.Pi)(e=>{let{projectId:t,provided:s,snapshot:l,handleCopyText:n,shortContextMenu:a=!1,disableDrag:i}=e,{theme:c}=(0,x.IX)(),{setTrackElement:d}=(0,x.DN)(),{addProjectToFavorites:u,removeProjectFromFavorites:m,getProjectById:h}=(0,x.PY)(),{isMobile:f}=(0,eu.L)(),[v,g]=(0,w.useState)(!1),[j,b]=(0,w.useState)(!1),[y,k]=(0,w.useState)(!1),C=(0,w.useRef)(null),S=(0,N.useRouter)(),{workspaceSlug:_,projectId:E}=S.query,R=h(t),F=c.sidebarCollapsed,O=(null==R?void 0:R.member_role)===o.MC.ADMIN,T=(null==R?void 0:R.member_role)&&[o.MC.VIEWER,o.MC.GUEST].includes(R.member_role),A=()=>{if(!_||!R)return;let e=u(_.toString(),R.id);(0,p.uW)(e,{loading:"Adding project to favorites...",success:{title:"Success!",message:()=>"Project added to favorites."},error:{title:"Error!",message:()=>"Couldn't add the project to favorites. Please try again."}})},M=()=>{if(!_||!R)return;let e=m(_.toString(),R.id);(0,p.uW)(e,{loading:"Removing project from favorites...",success:{title:"Success!",message:()=>"Project removed from favorites."},error:{title:"Error!",message:()=>"Couldn't remove the project from favorites. Please try again."}})},L=()=>{d("APP_SIDEBAR_PROJECT_DROPDOWN"),g(!0)},Z=()=>{window.innerWidth<768&&c.toggleSidebar()};return((0,eB.Z)(C,()=>k(!1)),R)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D,{isOpen:j,project:R,onClose:()=>b(!1)}),(0,r.jsx)(eF,{project:R,isOpen:v,onClose:()=>{g(!1)}}),(0,r.jsx)(z.p,{defaultOpen:E===R.id,children:e=>{let{open:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:(0,ed.cn)("group relative flex w-full items-center rounded-md px-2 py-1 text-custom-sidebar-text-100 hover:bg-custom-sidebar-background-80",{"opacity-60":null==l?void 0:l.isDragging,"bg-custom-sidebar-background-80":y}),children:[s&&!i&&(0,r.jsx)(p.u,{isMobile:f,tooltipContent:null===R.sort_order?"Join the project to rearrange":"Drag to rearrange",position:"top-right",children:(0,r.jsxs)("button",{type:"button",className:(0,ed.cn)("absolute -left-2.5 top-1/2 hidden -translate-y-1/2 rounded p-0.5 text-custom-sidebar-text-400",{"group-hover:flex":!F,"cursor-not-allowed opacity-60":null===R.sort_order,flex:y}),...null==s?void 0:s.dragHandleProps,children:[(0,r.jsx)(eD.Z,{className:"h-3.5"}),(0,r.jsx)(eD.Z,{className:"-ml-5 h-3.5"})]})}),(0,r.jsx)(p.u,{tooltipContent:"".concat(R.name),position:"right",className:"ml-2",disabled:!F,isMobile:f,children:(0,r.jsxs)(z.p.Button,{as:"div",className:(0,ed.cn)("flex items-center justify-between flex-grow cursor-pointer select-none truncate text-left text-sm font-medium",{"justify-center":F}),children:[(0,r.jsxs)("div",{className:(0,ed.cn)("w-full flex-grow flex items-center gap-1 truncate",{"justify-center":F}),children:[(0,r.jsx)("div",{className:"h-7 w-7 grid place-items-center flex-shrink-0",children:(0,r.jsx)(eg,{logo:R.logo_props})}),!F&&(0,r.jsx)("p",{className:"truncate text-custom-sidebar-text-200",children:R.name})]}),!F&&(0,r.jsx)(P.Z,{className:(0,ed.cn)("hidden h-4 w-4 flex-shrink-0 mb-0.5 text-custom-sidebar-text-400 duration-300 group-hover:block",{"rotate-180":t,block:y})})]})}),!F&&(0,r.jsxs)(p.fR,{customButton:(0,r.jsx)("div",{ref:C,className:"my-auto mt-1.5 w-full cursor-pointer px-1 text-custom-sidebar-text-400 duration-300",onClick:()=>k(!y),children:(0,r.jsx)(eM.Z,{className:"h-3.5 w-3.5"})}),className:(0,ed.cn)("hidden flex-shrink-0 group-hover:block",{"!block":y}),buttonClassName:"!text-custom-sidebar-text-400",ellipsis:!0,placement:"bottom-start",children:[!R.is_favorite&&(0,r.jsx)(p.fR.MenuItem,{onClick:A,children:(0,r.jsxs)("span",{className:"flex items-center justify-start gap-2",children:[(0,r.jsx)(ez.Z,{className:"h-3.5 w-3.5 stroke-[1.5]"}),(0,r.jsx)("span",{children:"Add to favorites"})]})}),R.is_favorite&&(0,r.jsx)(p.fR.MenuItem,{onClick:M,children:(0,r.jsxs)("span",{className:"flex items-center justify-start gap-2",children:[(0,r.jsx)(ez.Z,{className:"h-3.5 w-3.5 fill-yellow-500 stroke-yellow-500"}),(0,r.jsx)("span",{children:"Remove from favorites"})]})}),O&&(0,r.jsx)(p.fR.MenuItem,{onClick:()=>b(!0),children:(0,r.jsxs)("div",{className:"relative flex flex-shrink-0 items-center justify-start gap-2",children:[(0,r.jsx)("div",{className:"flex h-4 w-4 cursor-pointer items-center justify-center rounded text-custom-sidebar-text-200 transition-all duration-300 hover:bg-custom-sidebar-background-80",children:(0,r.jsx)(eL.Z,{className:"h-3.5 w-3.5 stroke-[1.5]"})}),(0,r.jsx)("div",{children:R.is_deployed?"Publish settings":"Publish"})]})}),(0,r.jsx)(p.fR.MenuItem,{children:(0,r.jsx)(et(),{href:"/".concat(_,"/projects/").concat(null==R?void 0:R.id,"/draft-issues/"),children:(0,r.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[(0,r.jsx)(eZ.Z,{className:"h-3.5 w-3.5 stroke-[1.5] text-custom-text-300"}),(0,r.jsx)("span",{children:"Draft issues"})]})})}),(0,r.jsx)(p.fR.MenuItem,{onClick:n,children:(0,r.jsxs)("span",{className:"flex items-center justify-start gap-2",children:[(0,r.jsx)(er.Z,{className:"h-3.5 w-3.5 stroke-[1.5]"}),(0,r.jsx)("span",{children:"Copy link"})]})}),!T&&(0,r.jsx)(p.fR.MenuItem,{children:(0,r.jsx)(et(),{href:"/".concat(_,"/projects/").concat(null==R?void 0:R.id,"/archives/issues"),children:(0,r.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[(0,r.jsx)(p.rK,{className:"h-3.5 w-3.5 stroke-[1.5]"}),(0,r.jsx)("span",{children:"Archives"})]})})}),(0,r.jsx)(p.fR.MenuItem,{children:(0,r.jsx)(et(),{href:"/".concat(_,"/projects/").concat(null==R?void 0:R.id,"/settings"),children:(0,r.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[(0,r.jsx)(eA.Z,{className:"h-3.5 w-3.5 stroke-[1.5]"}),(0,r.jsx)("span",{children:"Settings"})]})})}),T&&(0,r.jsx)(p.fR.MenuItem,{onClick:L,children:(0,r.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[(0,r.jsx)(eq.Z,{className:"h-3.5 w-3.5 stroke-[1.5]"}),(0,r.jsx)("span",{children:"Leave project"})]})})]})]}),(0,r.jsx)(I.u,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,r.jsx)(z.p.Panel,{className:"mt-1 space-y-1 ".concat(F?"":"ml-[2.25rem]"),children:eU(_,null==R?void 0:R.id).map(e=>{if(("Cycles"!==e.name||R.cycle_view)&&("Modules"!==e.name||R.module_view)&&("Views"!==e.name||R.issue_views_view)&&("Pages"!==e.name||R.page_view)&&("Inbox"!==e.name||R.inbox_view))return(0,r.jsx)(et(),{href:e.href,onClick:Z,children:(0,r.jsx)("span",{className:"block w-full",children:(0,r.jsx)(p.u,{isMobile:f,tooltipContent:"".concat(null==R?void 0:R.name,": ").concat(e.name),position:"right",className:"ml-2",disabled:!F,children:(0,r.jsxs)("div",{className:"group flex items-center gap-2.5 rounded-md px-2 py-1.5 text-xs font-medium outline-none ".concat(S.asPath.includes(e.href)?"bg-custom-primary-100/10 text-custom-primary-100":"text-custom-sidebar-text-300 hover:bg-custom-sidebar-background-80 focus:bg-custom-sidebar-background-80"," ").concat(F?"justify-center":""),children:[(0,r.jsx)(e.Icon,{className:"h-4 w-4 stroke-[1.5]"}),!F&&e.name]})})})},e.name)})})})]})}},"".concat(R.id," ").concat(E))]}):null});var eW=s(54533),eK=s(47542),eY=s(93116);let eJ=(0,a.Pi)(()=>{let[e,t]=(0,w.useState)(!1),[s,l]=(0,w.useState)(!1),[n,a]=(0,w.useState)(!1),i=(0,w.useRef)(null),{theme:{sidebarCollapsed:o},commandPalette:{toggleCreateProjectModal:c}}=(0,x.IX)(),{setTrackElement:d}=(0,x.DN)(),{membership:{currentWorkspaceRole:u}}=(0,x.aF)(),{getProjectById:h,joinedProjectIds:f,favoriteProjectIds:v,updateProjectView:g}=(0,x.PY)(),{workspaceSlug:j}=(0,N.useRouter)().query,b=!!u&&u>=eY.fp.MEMBER,y=e=>{(0,m.fQ)("".concat(j,"/projects/").concat(e,"/issues")).then(()=>{(0,p.fz)({type:p.do.SUCCESS,title:"Link Copied!",message:"Project link copied to clipboard."})})},k=e=>{let{source:t,destination:s,draggableId:l}=e;if(!s||!j||t.index===s.index)return;let n=[];if(f.map(e=>{let t=h(e);t&&n.push(t)}),n.length<=0)return;let r=(0,ev.i$)(t.index,s.index,l,n);void 0!=r&&g(j.toString(),l,{sort_order:r}).catch(()=>{(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Something went wrong. Please try again."})})},C=o||!1;return(0,w.useEffect)(()=>{let e=()=>{i.current&&a(i.current.scrollTop>0)},t=i.current;return t&&t.addEventListener("scroll",e),()=>{t&&t.removeEventListener("scroll",e)}},[]),(0,r.jsxs)(r.Fragment,{children:[j&&(0,r.jsx)(ew,{isOpen:s,onClose:()=>{l(!1)},setToFavorite:e,workspaceSlug:j.toString()}),(0,r.jsxs)("div",{ref:i,className:(0,ed.cn)("h-full space-y-2 !overflow-y-scroll pl-4 vertical-scrollbar",C?"scrollbar-sm":"scrollbar-md",{"border-t border-custom-sidebar-border-300":n,"pr-1":!C}),children:[(0,r.jsx)(eW.Z5,{onDragEnd:k,children:(0,r.jsx)(eW.bK,{droppableId:"favorite-projects",children:e=>(0,r.jsx)("div",{ref:e.innerRef,...e.droppableProps,children:v&&v.length>0&&(0,r.jsx)(z.p,{as:"div",className:"flex flex-col",defaultOpen:!0,children:s=>{let{open:n}=s;return(0,r.jsxs)(r.Fragment,{children:[!C&&(0,r.jsxs)("div",{className:"group flex w-full items-center justify-between rounded p-1.5 text-xs text-custom-sidebar-text-400 hover:bg-custom-sidebar-background-80",children:[(0,r.jsxs)(z.p.Button,{as:"button",type:"button",className:"group flex w-full items-center gap-1 whitespace-nowrap rounded px-1.5 text-left text-sm font-semibold text-custom-sidebar-text-400 hover:bg-custom-sidebar-background-80",children:["Favorites",n?(0,r.jsx)(P.Z,{className:"h-3.5 w-3.5"}):(0,r.jsx)(M.Z,{className:"h-3.5 w-3.5"})]}),b&&(0,r.jsx)("button",{className:"opacity-0 group-hover:opacity-100",onClick:()=>{d("APP_SIDEBAR_FAVORITES_BLOCK"),t(!0),l(!0)},children:(0,r.jsx)(eK.Z,{className:"h-3 w-3"})})]}),(0,r.jsx)(I.u,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,r.jsx)(z.p.Panel,{as:"div",className:"space-y-2",children:v.map((e,t)=>(0,r.jsx)(eW._l,{draggableId:e,index:t,children:(t,s)=>(0,r.jsx)("div",{ref:t.innerRef,...t.draggableProps,children:(0,r.jsx)(eV,{projectId:e,provided:t,snapshot:s,handleCopyText:()=>y(e),shortContextMenu:!0,disableDrag:!0},e)})},e))})}),e.placeholder]})}})})})}),(0,r.jsx)(eW.Z5,{onDragEnd:k,children:(0,r.jsx)(eW.bK,{droppableId:"joined-projects",children:e=>(0,r.jsx)("div",{ref:e.innerRef,...e.droppableProps,children:f&&f.length>0&&(0,r.jsx)(z.p,{as:"div",className:"flex flex-col",defaultOpen:!0,children:s=>{let{open:n}=s;return(0,r.jsxs)(r.Fragment,{children:[!C&&(0,r.jsxs)("div",{className:"group flex w-full items-center justify-between rounded p-1.5 text-xs text-custom-sidebar-text-400 hover:bg-custom-sidebar-background-80",children:[(0,r.jsxs)(z.p.Button,{as:"button",type:"button",className:"group flex w-full items-center gap-1 whitespace-nowrap rounded px-1.5 text-left text-sm font-semibold text-custom-sidebar-text-400 hover:bg-custom-sidebar-background-80",children:["Your projects",n?(0,r.jsx)(P.Z,{className:"h-3.5 w-3.5"}):(0,r.jsx)(M.Z,{className:"h-3.5 w-3.5"})]}),b&&(0,r.jsx)("button",{className:"opacity-0 group-hover:opacity-100",onClick:()=>{d("Sidebar"),t(!1),l(!0)},children:(0,r.jsx)(eK.Z,{className:"h-3 w-3"})})]}),(0,r.jsx)(I.u,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,r.jsx)(z.p.Panel,{as:"div",className:"space-y-2",children:f.map((e,t)=>(0,r.jsx)(eW._l,{draggableId:e,index:t,children:(t,s)=>(0,r.jsx)("div",{ref:t.innerRef,...t.draggableProps,children:(0,r.jsx)(eV,{projectId:e,provided:t,snapshot:s,handleCopyText:()=>y(e)},e)})},e))})}),e.placeholder]})}})})})}),b&&f&&0===f.length&&(0,r.jsxs)("button",{type:"button",className:"flex w-full items-center gap-2 px-3 text-sm text-custom-sidebar-text-200",onClick:()=>{d("Sidebar"),c(!0)},children:[(0,r.jsx)(eK.Z,{className:"h-5 w-5"}),!C&&"Add Project"]})]})]})});var eH=s(30201),eQ=s(82680),eG=s(82750);let e$={github:{logo:{src:"/_next/static/media/github-square.30940da3.png",height:70,width:70,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAPFBMVEUGBgYsLCzu7u5UVFQhISEAAAAREREBAQEdHR02NjaFhYXU1NT///9ra2vMzMy5ublGRkZwcHCurq7n5+cHNHmdAAAACnRSTlP+/////P//tf7+5YnTEwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAD5JREFUeJwdxkkSgDAIBMABHIhAEpf//9Uq+9QIQgQMUFZ3CYGV885yXOok1GB/XsOodH/0AG0P6UkET3dhfDobAajIHSiGAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},description:"Select GitHub repository to enable sync."},slack:{logo:s(90288).Z,description:"Get regular updates and control which notification you want to receive."}},eX=new e_.Y4,e0=e=>{let{integration:t}=e,{workspaceSlug:s,projectId:l}=(0,N.useRouter)().query,{data:n}=(0,eH.ZP)(l?(0,eG.N0)(l):null,()=>s&&l&&t?eX.getProjectGithubRepository(s,l,t.id):null);return(0,r.jsx)(r.Fragment,{children:t&&(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2 border-b border-custom-border-100 bg-custom-background-100 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:"h-10 w-10 flex-shrink-0",children:(0,r.jsx)(Y(),{src:e$[t.integration_detail.provider].logo,alt:"".concat(t.integration_detail.title," Logo")})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"flex items-center gap-4 text-sm font-medium",children:t.integration_detail.title}),(0,r.jsx)("p",{className:"text-sm tracking-tight text-custom-text-200",children:e$[t.integration_detail.provider].description})]})]}),"github"===t.integration_detail.provider&&(0,r.jsx)(eQ.NO,{integration:t,value:n&&n.length>0?"".concat(n[0].repo_detail.owner,"/").concat(n[0].repo_detail.name):null,label:n&&n.length>0?"".concat(n[0].repo_detail.owner,"/").concat(n[0].repo_detail.name):"Select Repository",onChange:e=>{if(!s||!l||!t)return;let{html_url:n,owner:{login:r},id:a,name:i}=e;eX.syncGithubRepository(s,l,t.id,{name:i,owner:r,repository_id:a,url:n}).then(()=>{(0,eH.JG)((0,eG.N0)(l)),(0,p.fz)({type:p.do.SUCCESS,title:"Success!",message:"".concat(r,"/").concat(i," repository synced with the project successfully.")})}).catch(e=>{console.error(e),(0,p.fz)({type:p.do.ERROR,title:"Error!",message:"Repository could not be synced with the project. Please try again."})})}}),"slack"===t.integration_detail.provider&&(0,r.jsx)(eQ.lC,{integration:t})]})})};var e1=s(81630);let e2=(0,a.Pi)(()=>{let[e,t]=(0,w.useState)(!1),[s,l]=(0,w.useState)(""),{setTrackElement:n}=(0,x.DN)(),{project:{projectMemberIds:a,getProjectMemberDetails:i}}=(0,x.Kb)(),o=(null!=a?a:[]).filter(e=>{let t=i(e);if(!(null==t?void 0:t.member))return!1;let l="".concat(null==t?void 0:t.member.first_name," ").concat(null==t?void 0:t.member.last_name).toLowerCase(),n=null==t?void 0:t.member.display_name.toLowerCase();return(null==n?void 0:n.includes(s.toLowerCase()))||l.includes(s.toLowerCase())});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e9,{isOpen:e,onClose:()=>t(!1)}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4 border-b border-custom-border-100 py-3.5",children:[(0,r.jsx)("h4",{className:"text-xl font-medium",children:"Members"}),(0,r.jsxs)("div",{className:"ml-auto flex items-center justify-start gap-1 rounded-md border border-custom-border-200 bg-custom-background-100 px-2.5 py-1.5 text-custom-text-400",children:[(0,r.jsx)(e1.Z,{className:"h-3.5 w-3.5"}),(0,r.jsx)("input",{className:"w-full max-w-[234px] border-none bg-transparent text-sm focus:outline-none",placeholder:"Search",value:s,autoFocus:!0,onChange:e=>l(e.target.value)})]}),(0,r.jsx)(p.zx,{variant:"primary",onClick:()=>{n("PROJECT_SETTINGS_MEMBERS_PAGE_HEADER"),t(!0)},children:"Add member"})]}),a?(0,r.jsxs)("div",{className:"divide-y divide-custom-border-100",children:[a.length>0?o.map(e=>(0,r.jsx)(e4,{userId:e},e)):null,0===o.length&&(0,r.jsx)("h4",{className:"text-sm mt-16 text-center text-custom-text-400",children:"No matching members"})]}):(0,r.jsx)(H._V,{})]})});var e5=s(98563),e3=s(25262);let e4=(0,a.Pi)(e=>{var t,s,l,n,a,i,c,d,u,m,h,f,v,g,j,b,y,k,C,S;let{userId:_}=e,[I,E]=(0,w.useState)(!1),R=(0,N.useRouter)(),{workspaceSlug:F,projectId:O}=R.query,{currentUser:T,membership:{currentProjectRole:A,leaveProject:D}}=(0,x.aF)(),{fetchProjects:M}=(0,x.PY)(),{project:{removeMemberFromProject:z,getProjectMemberDetails:L,updateMember:Z}}=(0,x.Kb)(),{captureEvent:q}=(0,x.DN)(),{isMobile:B}=(0,eu.L)(),U=A===o.MC.ADMIN,V=L(_),W=async()=>{var e,t;F&&O&&V&&((null===(e=V.member)||void 0===e?void 0:e.id)===(null==T?void 0:T.id)?await D(F.toString(),O.toString()).then(async()=>{q(ex.Dv,{state:"SUCCESS",element:"Project settings members page"}),await M(F.toString()),R.push("/".concat(F,"/projects"))}).catch(e=>(0,p.fz)({type:p.do.ERROR,title:"Error!",message:(null==e?void 0:e.error)||"Something went wrong. Please try again."})):await z(F.toString(),O.toString(),null===(t=V.member)||void 0===t?void 0:t.id).catch(e=>(0,p.fz)({type:p.do.ERROR,title:"Error!",message:(null==e?void 0:e.error)||"Something went wrong. Please try again."})))};return V?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(te,{isOpen:I,onClose:()=>E(!1),data:V.member,onSubmit:W}),(0,r.jsxs)("div",{className:"group flex items-center justify-between px-3 py-4 hover:bg-custom-background-90",children:[(0,r.jsxs)("div",{className:"flex items-center gap-x-4 gap-y-2",children:[(null===(t=V.member)||void 0===t?void 0:t.avatar)&&(null===(s=V.member)||void 0===s?void 0:s.avatar)!==""?(0,r.jsx)(et(),{href:"/".concat(F,"/profile/").concat(null===(l=V.member)||void 0===l?void 0:l.id),children:(0,r.jsx)("span",{className:"relative flex h-10 w-10 items-center justify-center rounded p-4 capitalize text-white",children:(0,r.jsx)("img",{src:null===(n=V.member)||void 0===n?void 0:n.avatar,alt:(null===(a=V.member)||void 0===a?void 0:a.display_name)||(null===(i=V.member)||void 0===i?void 0:i.email),className:"absolute left-0 top-0 h-full w-full rounded object-cover"})})}):(0,r.jsx)(et(),{href:"/".concat(F,"/profile/").concat(V.id),children:(0,r.jsx)("span",{className:"relative flex h-10 w-10 items-center justify-center rounded bg-gray-700 p-4 capitalize text-white",children:(null!==(S=null!==(C=null===(c=V.member)||void 0===c?void 0:c.display_name)&&void 0!==C?C:null===(d=V.member)||void 0===d?void 0:d.email)&&void 0!==S?S:"?")[0]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(et(),{href:"/".concat(F,"/profile/").concat(null===(u=V.member)||void 0===u?void 0:u.id),children:(0,r.jsxs)("span",{className:"text-sm font-medium",children:[null===(m=V.member)||void 0===m?void 0:m.first_name," ",null===(h=V.member)||void 0===h?void 0:h.last_name]})}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("p",{className:"text-xs text-custom-text-300",children:null===(f=V.member)||void 0===f?void 0:f.display_name}),U&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e5.Z,{height:16,width:16,className:"text-custom-text-300"}),(0,r.jsx)("p",{className:"text-xs text-custom-text-300",children:null===(v=V.member)||void 0===v?void 0:v.email})]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)(p.AP,{customButton:(0,r.jsxs)("div",{className:"item-center flex gap-1 rounded px-2 py-0.5",children:[(0,r.jsx)("span",{className:"flex items-center rounded text-xs font-medium ".concat((null===(g=V.member)||void 0===g?void 0:g.id)!==(null==T?void 0:T.id)?"":"text-custom-text-400"),children:eY.HB[V.role]}),(null===(j=V.member)||void 0===j?void 0:j.id)!==(null==T?void 0:T.id)&&(0,r.jsx)("span",{className:"grid place-items-center",children:(0,r.jsx)(P.Z,{className:"h-3 w-3"})})]}),value:V.role,onChange:e=>{var t;F&&O&&Z(F.toString(),O.toString(),null===(t=V.member)||void 0===t?void 0:t.id,{role:e}).catch(e=>{let t=e.error,s=Array.isArray(t)?t[0]:t;(0,p.fz)({type:p.do.ERROR,title:"Error!",message:null!=s?s:"An error occurred while updating member role. Please try again."})})},disabled:(null===(b=V.member)||void 0===b?void 0:b.id)===(null==T?void 0:T.id)||!A||A<V.role,placement:"bottom-end",children:Object.keys(eY.HB).map(e=>A&&!U&&A<parseInt(e)?null:(0,r.jsx)(p.AP.Option,{value:parseInt(e,10),children:(0,r.jsx)(r.Fragment,{children:eY.HB[parseInt(e)]})},e))}),(U||(null===(y=V.member)||void 0===y?void 0:y.id)===(null==T?void 0:T.id))&&(0,r.jsx)(p.u,{tooltipContent:(null===(k=V.member)||void 0===k?void 0:k.id)===(null==T?void 0:T.id)?"Leave project":"Remove member",isMobile:B,children:(0,r.jsx)("button",{type:"button",onClick:()=>E(!0),className:"pointer-events-none opacity-0 group-hover:pointer-events-auto group-hover:opacity-100",children:(0,r.jsx)(e3.Z,{className:"h-3.5 w-3.5 text-red-500",strokeWidth:2})})})]})]})]}):null}),e8={project_lead:null,default_assignee:null},e6=(0,a.Pi)(()=>{let{workspaceSlug:e,projectId:t}=(0,N.useRouter)().query,{membership:{currentProjectRole:s}}=(0,x.aF)(),{currentProjectDetails:l,fetchProjectDetails:n,updateProject:a}=(0,x.PY)(),i=s===o.MC.ADMIN,{reset:c,control:d}=(0,k.cI)({defaultValues:e8});(0,eH.ZP)(e&&t?(0,eG.xF)(t.toString()):null,e&&t?()=>n(e.toString(),t.toString()):null),(0,w.useEffect)(()=>{var e,t,s,n;l&&c({...l,default_assignee:null!==(s=null===(e=l.default_assignee)||void 0===e?void 0:e.id)&&void 0!==s?s:l.default_assignee,project_lead:null!==(n=null===(t=l.project_lead)||void 0===t?void 0:t.id)&&void 0!==n?n:l.project_lead,workspace:l.workspace.id})},[l,c]);let u=async s=>{var n,r,i,o,d,u;e&&t&&(c({...l,default_assignee:null!==(i=null===(n=null==l?void 0:l.default_assignee)||void 0===n?void 0:n.id)&&void 0!==i?i:null==l?void 0:l.default_assignee,project_lead:null!==(o=null===(r=null==l?void 0:l.project_lead)||void 0===r?void 0:r.id)&&void 0!==o?o:null==l?void 0:l.project_lead,...s}),await a(e.toString(),t.toString(),{default_assignee:"none"===s.default_assignee?null:null!==(d=s.default_assignee)&&void 0!==d?d:null==l?void 0:l.default_assignee,project_lead:"none"===s.project_lead?null:null!==(u=s.project_lead)&&void 0!==u?u:null==l?void 0:l.project_lead}).then(()=>{(0,p.fz)({title:"Success!",type:p.do.SUCCESS,message:"Project updated successfully"})}).catch(e=>{console.error(e)}))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex items-center border-b border-custom-border-100 py-3.5",children:(0,r.jsx)("h3",{className:"text-xl font-medium",children:"Defaults"})}),(0,r.jsx)("div",{className:"flex w-full flex-col gap-2 pb-4",children:(0,r.jsxs)("div",{className:"flex w-full items-center gap-4 py-8",children:[(0,r.jsxs)("div",{className:"flex w-1/2 flex-col gap-2",children:[(0,r.jsx)("h4",{className:"text-sm",children:"Project Lead"}),(0,r.jsx)("div",{className:"",children:l?(0,r.jsx)(k.Qr,{control:d,name:"project_lead",render:e=>{let{field:{value:t}}=e;return(0,r.jsx)(eT,{value:t,onChange:e=>{u({project_lead:e})},isDisabled:!i})}}):(0,r.jsx)(p.aN,{className:"h-9 w-full",children:(0,r.jsx)(p.aN.Item,{width:"100%",height:"100%"})})})]}),(0,r.jsxs)("div",{className:"flex w-1/2 flex-col gap-2",children:[(0,r.jsx)("h4",{className:"text-sm",children:"Default Assignee"}),(0,r.jsx)("div",{className:"",children:l?(0,r.jsx)(k.Qr,{control:d,name:"default_assignee",render:e=>{let{field:{value:t}}=e;return(0,r.jsx)(eT,{value:t,onChange:e=>{u({default_assignee:e})},isDisabled:!i})}}):(0,r.jsx)(p.aN,{className:"h-9 w-full",children:(0,r.jsx)(p.aN.Item,{width:"100%",height:"100%"})})})]})]})})]})}),e7={members:[{role:5,member_id:""}]},e9=(0,a.Pi)(e=>{let{isOpen:t,onClose:s,onSuccess:l}=e,{workspaceSlug:n,projectId:a}=(0,N.useRouter)().query,{captureEvent:c}=(0,x.DN)(),{membership:{currentProjectRole:d}}=(0,x.aF)(),{project:{projectMemberIds:u,bulkAddMembersToProject:m},workspace:{workspaceMemberIds:h,getWorkspaceMemberDetails:f}}=(0,x.Kb)(),{formState:{errors:v,isSubmitting:g},reset:j,handleSubmit:b,control:y}=(0,k.cI)(),{fields:C,append:S,remove:_}=(0,k.Dq)({control:y,name:"members"}),R=null==h?void 0:h.filter(e=>!(null==u?void 0:u.find(t=>t===e))),F=async e=>{if(!n||!a||g)return;let t={...e};await m(n.toString(),a.toString(),t).then(()=>{l&&l(),s(),(0,p.fz)({title:"Success!",type:p.do.SUCCESS,message:"Members added successfully."}),c(ex.bF,{members:[...t.members.map(e=>({member_id:e.member_id,role:eY.HB[e.role]}))],state:"SUCCESS",element:"Project settings members page"})}).catch(e=>{console.error(e),c(ex.bF,{state:"FAILED",element:"Project settings members page"})}).finally(()=>{j(e7)})},O=()=>{s();let e=setTimeout(()=>{j(e7),clearTimeout(e)},500)};(0,w.useEffect)(()=>{0===C.length&&S([{role:5,member_id:""}])},[C,S]);let T=null==R?void 0:R.map(e=>{let t=f(e);if(null==t?void 0:t.member)return{value:"".concat(null==t?void 0:t.member.id),query:"".concat(null==t?void 0:t.member.first_name," ").concat(null==t?void 0:t.member.last_name," ").concat(null==t?void 0:t.member.display_name.toLowerCase()),content:(0,r.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,r.jsx)("div",{className:"flex-shrink-0 pt-0.5",children:(0,r.jsx)(p.qE,{name:null==t?void 0:t.member.display_name,src:null==t?void 0:t.member.avatar})}),(0,r.jsxs)("div",{className:"truncate",children:[null==t?void 0:t.member.display_name," (",(null==t?void 0:t.member.first_name)+" "+(null==t?void 0:t.member.last_name),")"]})]})}}).filter(e=>!!e);return(0,r.jsx)(I.u.Root,{show:t,as:w.Fragment,children:(0,r.jsxs)(E.V,{as:"div",className:"relative z-20",onClose:O,children:[(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-20 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsx)(E.V.Panel,{className:"relative transform rounded-lg bg-custom-background-100 p-5 text-left shadow-custom-shadow-md transition-all sm:w-full sm:max-w-2xl",children:(0,r.jsxs)("form",{onSubmit:b(F),children:[(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsx)(E.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-custom-text-100",children:"Invite Members"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-custom-text-200",children:"Invite members to work on your project."})}),(0,r.jsx)("div",{className:"mb-3 space-y-4",children:C.map((e,t)=>{var s,l,n,a,c,u;return(0,r.jsxs)("div",{className:"group mb-1 grid grid-cols-6  sm:grid-cols-12 items-start gap-x-4 text-sm",children:[(0,r.jsxs)("div",{className:"col-span-4 sm:col-span-10 flex flex-col gap-1",children:[(0,r.jsx)(k.Qr,{control:y,name:"members.".concat(t,".member_id"),rules:{required:"Please select a member"},render:e=>{let{field:{value:t,onChange:s}}=e,l=f(t);return(0,r.jsx)(p.RO,{value:t,customButton:(0,r.jsxs)("button",{className:"flex w-full items-center justify-between gap-1 rounded-md border border-custom-border-200 px-3 py-2 text-left text-sm text-custom-text-200 shadow-sm duration-300 hover:bg-custom-background-80 hover:text-custom-text-100 focus:outline-none",children:[t&&""!==t?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(p.qE,{name:null==l?void 0:l.member.display_name,src:null==l?void 0:l.member.avatar}),null==l?void 0:l.member.display_name]}):(0,r.jsx)("div",{className:"flex items-center gap-2 py-0.5",children:"Select co-worker"}),(0,r.jsx)(P.Z,{className:"h-3 w-3","aria-hidden":"true"})]}),onChange:e=>{s(e)},options:T,optionsClassName:"w-full"})}}),v.members&&(null===(s=v.members[t])||void 0===s?void 0:s.member_id)&&(0,r.jsx)("span",{className:"px-1 text-sm text-red-500",children:null===(n=v.members[t])||void 0===n?void 0:null===(l=n.member_id)||void 0===l?void 0:l.message})]}),(0,r.jsxs)("div",{className:"col-span-2 sm:col-span-2 flex items-center justify-between gap-2",children:[(0,r.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,r.jsx)(k.Qr,{name:"members.".concat(t,".role"),control:y,rules:{required:"Select Role"},render:e=>{let{field:t}=e;return(0,r.jsx)(p.AP,{...t,customButton:(0,r.jsxs)("div",{className:"flex w-full items-center justify-between gap-1 rounded-md border border-custom-border-200 px-3 py-2.5 text-left text-sm text-custom-text-200 shadow-sm duration-300 hover:bg-custom-background-80 hover:text-custom-text-100 focus:outline-none",children:[(0,r.jsx)("span",{className:"capitalize",children:t.value?eY.HB[t.value]:"Select role"}),(0,r.jsx)(P.Z,{className:"h-3 w-3","aria-hidden":"true"})]}),input:!0,optionsClassName:"w-full",children:Object.entries(eY.HB).map(e=>{let[t,s]=e;return parseInt(t)>(null!=d?d:o.MC.GUEST)?null:(0,r.jsx)(p.AP.Option,{value:t,children:s},t)})})}}),v.members&&(null===(a=v.members[t])||void 0===a?void 0:a.role)&&(0,r.jsx)("span",{className:"px-1 text-sm text-red-500",children:null===(u=v.members[t])||void 0===u?void 0:null===(c=u.role)||void 0===c?void 0:c.message})]}),C.length>1&&(0,r.jsx)("div",{className:"flex-item flex w-6",children:(0,r.jsx)("button",{type:"button",className:"place-items-center self-center rounded",onClick:()=>_(t),children:(0,r.jsx)(i.Z,{className:"h-4 w-4 text-custom-text-200"})})})]})]},e.id)})})]}),(0,r.jsxs)("div",{className:"mt-5 flex items-center justify-between gap-2",children:[(0,r.jsxs)("button",{type:"button",className:"flex items-center gap-2 bg-transparent py-2 pr-3 text-sm font-medium text-custom-primary outline-custom-primary",onClick:()=>{S({role:5,member_id:""})},children:[(0,r.jsx)(eK.Z,{className:"h-4 w-4"}),"Add more"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(p.zx,{variant:"neutral-primary",size:"sm",onClick:O,children:"Cancel"}),(0,r.jsx)(p.zx,{variant:"primary",size:"sm",type:"submit",loading:g,children:g?"".concat(C&&C.length>1?"Adding Members...":"Adding Member..."):"".concat(C&&C.length>1?"Add Members":"Add Member")})]})]})]})})})})})]})})}),te=(0,a.Pi)(e=>{let{data:t,onSubmit:s,isOpen:l,onClose:n}=e,{projectId:a}=(0,N.useRouter)().query,[i,o]=(0,w.useState)(!1),{currentUser:c}=(0,x.aF)(),{getProjectById:d}=(0,x.PY)(),u=()=>{n(),o(!1)},m=async()=>{o(!0),await s(),u()};if(!a)return(0,r.jsx)(r.Fragment,{});let h=(null==c?void 0:c.id)===(null==t?void 0:t.id),f=d(a.toString());return(0,r.jsx)(I.u.Root,{show:l,as:w.Fragment,children:(0,r.jsxs)(E.V,{as:"div",className:"relative z-20",onClose:u,children:[(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-custom-backdrop transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-20 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,r.jsx)(I.u.Child,{as:w.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsxs)(E.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-custom-background-100 text-left shadow-custom-shadow-md transition-all sm:my-8 sm:w-[40rem]",children:[(0,r.jsx)("div",{className:"bg-custom-background-100 px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:(0,r.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,r.jsx)("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:(0,r.jsx)(eN.Z,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),(0,r.jsxs)("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[(0,r.jsx)(E.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-custom-text-100",children:h?"Leave project?":"Remove ".concat(null==t?void 0:t.display_name,"?")}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-custom-text-200",children:h?(0,r.jsxs)(r.Fragment,{children:["Are you sure you want to leave the"," ",(0,r.jsx)("span",{className:"font-bold",children:null==f?void 0:f.name})," project? You will be able to join the project if invited again or if it","'","s public."]}):(0,r.jsxs)(r.Fragment,{children:["Are you sure you want to remove member-"," ",(0,r.jsx)("span",{className:"font-bold",children:null==t?void 0:t.display_name}),"? They will no longer have access to this project. This action cannot be undone."]})})})]})]})}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 p-4 sm:px-6",children:[(0,r.jsx)(p.zx,{variant:"neutral-primary",size:"sm",onClick:u,children:"Cancel"}),(0,r.jsx)(p.zx,{variant:"danger",size:"sm",tabIndex:1,onClick:m,loading:i,children:h?i?"Leaving...":"Leave":i?"Removing...":"Remove"})]})]})})})})]})})})},31408:function(e,t,s){s.d(t,{xB:function(){return f},PQ:function(){return d},Em:function(){return x},oj:function(){return I},oe:function(){return A},_4:function(){return M},h7:function(){return C}});var l=s(24246),n=s(27378),r=s(43659),a=s(86677),i=s(25449),o=s(23258),c=s(10634);let d=(0,r.Pi)(e=>{let{data:t,isOpen:s,onClose:r}=e,[d,u]=(0,n.useState)(!1),{workspaceSlug:m,projectId:h}=(0,a.useRouter)().query,{deleteView:p}=(0,c.QJ)(),x=()=>{r(),u(!1)},f=async()=>{m&&h&&(u(!0),await p(m.toString(),h.toString(),t.id).then(()=>{x(),(0,i.fz)({type:i.do.SUCCESS,title:"Success!",message:"View deleted successfully."})}).catch(()=>(0,i.fz)({type:i.do.ERROR,title:"Error!",message:"View could not be deleted. Please try again."})).finally(()=>{u(!1)}))};return(0,l.jsx)(o.qv,{handleClose:x,handleSubmit:f,isDeleting:d,isOpen:s,title:"Delete View",content:(0,l.jsxs)(l.Fragment,{children:["Are you sure you want to delete view-"," ",(0,l.jsx)("span",{className:"break-all font-medium text-custom-text-100",children:null==t?void 0:t.name}),"? All of the data related to the view will be permanently removed. This action cannot be undone."]})})});var u=s(88039),m=s(68114),h=s(93997);let p={name:"",description:""},x=(0,r.Pi)(e=>{var t,s;let{handleFormSubmit:r,handleClose:a,data:o,preLoadedData:d}=e,{currentProjectDetails:x}=(0,c.PY)(),{projectStates:f}=(0,c.eD)(),{projectLabels:v}=(0,c.NP)(),{project:{projectMemberIds:g}}=(0,c.Kb)(),{control:j,formState:{errors:b,isSubmitting:y},handleSubmit:w,reset:N,setValue:k,watch:C}=(0,u.cI)({defaultValues:p}),S={};Object.entries(null!==(s=C("filters"))&&void 0!==s?s:{}).forEach(e=>{let[t,s]=e;s&&(Array.isArray(s)&&0===s.length||(S[t]=s))});let _=async e=>{await r({name:e.name,description:e.description,filters:e.filters}),N({...p})};return(0,n.useEffect)(()=>{N({...p,...d,...o})},[o,d,N]),(0,l.jsxs)("form",{onSubmit:w(_),children:[(0,l.jsxs)("div",{className:"space-y-5 p-5",children:[(0,l.jsxs)("h3",{className:"text-xl font-medium text-custom-text-200",children:[o?"Update":"Create"," View"]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)(u.Qr,{control:j,name:"name",rules:{required:"Title is required",maxLength:{value:255,message:"Title should be less than 255 characters"}},render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(i.II,{id:"name",type:"name",name:"name",value:t,onChange:s,hasError:!!b.name,placeholder:"Title",className:"w-full text-base",tabIndex:1,autoFocus:!0})}}),(0,l.jsx)("span",{className:"text-xs text-red-500",children:null==b?void 0:null===(t=b.name)||void 0===t?void 0:t.message})]}),(0,l.jsx)("div",{children:(0,l.jsx)(u.Qr,{name:"description",control:j,render:e=>{let{field:{value:t,onChange:s}}=e;return(0,l.jsx)(i.Kx,{id:"description",name:"description",placeholder:"Description",className:"w-full text-base resize-none min-h-24",hasError:!!(null==b?void 0:b.description),value:t,onChange:s,tabIndex:2})}})}),(0,l.jsx)("div",{children:(0,l.jsx)(u.Qr,{control:j,name:"filters",render:e=>{let{field:{onChange:t,value:s}}=e;return(0,l.jsx)(m.lqY,{title:"Filters",tabIndex:3,children:(0,l.jsx)(m.dGX,{filters:null!=s?s:{},handleFiltersUpdate:(e,l)=>{var n,r;let a=null!==(n=null==s?void 0:s[e])&&void 0!==n?n:[];Array.isArray(l)?l.forEach(e=>{a.includes(e)||a.push(e)}):(null==s?void 0:null===(r=s[e])||void 0===r?void 0:r.includes(l))?a.splice(a.indexOf(l),1):a.push(l),t({...s,[e]:a})},layoutDisplayFiltersOptions:h.BI.issues.list,labels:null!=v?v:void 0,memberIds:null!=g?g:void 0,states:f,cycleViewDisabled:!(null==x?void 0:x.cycle_view),moduleViewDisabled:!(null==x?void 0:x.module_view)})})}})}),S&&Object.keys(S).length>0&&(0,l.jsx)("div",{children:(0,l.jsx)(m.v4D,{appliedFilters:S,handleClearAllFilters:()=>{S&&k("filters",{})},handleRemoveFilter:(e,t)=>{var s,l;if(!t){k("filters",{...S,[e]:null});return}let n=null!==(s=null==S?void 0:S[e])&&void 0!==s?s:[];Array.isArray(t)?t.forEach(e=>{n.includes(e)&&n.splice(n.indexOf(e),1)}):(null==S?void 0:null===(l=S[e])||void 0===l?void 0:l.includes(t))&&n.splice(n.indexOf(t),1),k("filters",{...S,[e]:n})},labels:null!=v?v:[],states:f})})]})]}),(0,l.jsxs)("div",{className:"px-5 py-4 flex items-center justify-end gap-2 border-t-[0.5px] border-custom-border-200",children:[(0,l.jsx)(i.zx,{variant:"neutral-primary",size:"sm",onClick:a,tabIndex:4,children:"Cancel"}),(0,l.jsx)(i.zx,{variant:"primary",size:"sm",type:"submit",tabIndex:5,loading:y,children:o?y?"Updating":"Update View":y?"Creating":"Create View"})]})]})}),f=(0,r.Pi)(e=>{let{data:t,isOpen:s,onClose:n,preLoadedData:r,workspaceSlug:a,projectId:d}=e,{createView:u,updateView:m}=(0,c.QJ)(),h=()=>{n()},p=async e=>{await u(a,d,e).then(()=>{h(),(0,i.fz)({type:i.do.SUCCESS,title:"Success!",message:"View created successfully."})}).catch(()=>(0,i.fz)({type:i.do.ERROR,title:"Error!",message:"Something went wrong. Please try again."}))},f=async e=>{await m(a,d,null==t?void 0:t.id,e).then(()=>h()).catch(e=>{var t;return(0,i.fz)({type:i.do.ERROR,title:"Error!",message:null!==(t=null==e?void 0:e.detail)&&void 0!==t?t:"Something went wrong. Please try again."})})},v=async e=>{t?await f(e):await p(e)};return(0,l.jsx)(o.QU,{isOpen:s,handleClose:h,position:o.fM.TOP,width:o.j4.XXL,children:(0,l.jsx)(x,{data:t,handleClose:h,handleFormSubmit:v,preLoadedData:r})})});var v=s(50649),g=s(62468),j=s(37969),b=s(3515),y=s(54129),w=s(51374),N=s(6780),k=s(10712);let C=(0,v.Pi)(e=>{let{parentRef:t,projectId:s,view:r,workspaceSlug:a}=e,[o,u]=(0,n.useState)(!1),[m,h]=(0,n.useState)(!1),{membership:{currentProjectRole:p}}=(0,c.aF)(),x=!!p&&p>=w.MC.MEMBER,v="".concat(a,"/projects/").concat(s,"/views/").concat(r.id),C=[{key:"edit",action:()=>u(!0),title:"Edit",icon:g.Z,shouldRender:x},{key:"open-new-tab",action:()=>window.open("/".concat(v),"_blank"),title:"Open in new tab",icon:j.Z},{key:"copy-link",action:()=>(0,k.fQ)(v).then(()=>{(0,i.fz)({type:i.do.SUCCESS,title:"Link Copied!",message:"View link copied to clipboard."})}),title:"Copy link",icon:b.Z},{key:"delete",action:()=>h(!0),title:"Delete",icon:y.Z,shouldRender:x}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f,{isOpen:o,onClose:()=>u(!1),workspaceSlug:a,projectId:s,data:r}),(0,l.jsx)(d,{data:r,isOpen:m,onClose:()=>h(!1)}),(0,l.jsx)(i.xV,{parentRef:t,items:C}),(0,l.jsx)(i.fR,{ellipsis:!0,placement:"bottom-end",closeOnSelect:!0,children:C.map(e=>!1===e.shouldRender?null:(0,l.jsxs)(i.fR.MenuItem,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.action()},className:(0,N.cn)("flex items-center gap-2",{"text-custom-text-400":e.disabled},e.className),disabled:e.disabled,children:[e.icon&&(0,l.jsx)(e.icon,{className:(0,N.cn)("h-3 w-3",e.iconClassName)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:e.title}),e.description&&(0,l.jsx)("p",{className:(0,N.cn)("text-custom-text-300 whitespace-pre-line",{"text-custom-text-400":e.disabled}),children:e.description})]})]},e.key))})]})});var S=s(4314),_=s(18894);let I=(0,r.Pi)(e=>{let{view:t}=e,s=(0,n.useRef)(null),{workspaceSlug:r,projectId:i}=(0,a.useRouter)().query,{isMobile:o}=(0,_.L)();return(0,l.jsx)(S.H,{title:t.name,itemLink:"/".concat(r,"/projects/").concat(i,"/views/").concat(t.id),actionableItems:(0,l.jsx)(M,{parentRef:s,view:t}),isMobile:o,parentRef:s})});var E=s(81630),P=s(82558),R=s(74371),F=s(92775),O=s(70540),T=s(42683);let A=(0,r.Pi)(()=>{let[e,t]=(0,n.useState)(""),[s,r]=(0,n.useState)(""!==e),a=(0,n.useRef)(null),{commandPalette:{toggleCreateViewModal:i}}=(0,c.IX)(),{projectViewIds:o,getViewById:d,loader:u}=(0,c.QJ)();if((0,T.Z)(a,()=>{s&&""===e.trim()&&r(!1)}),u||!o)return(0,l.jsx)(F.vU,{});let m=o.map(e=>d(e)),h=m.filter(t=>null==t?void 0:t.name.toLowerCase().includes(e.toLowerCase()));return(0,l.jsx)(l.Fragment,{children:m.length>0?(0,l.jsxs)("div",{className:"flex h-full w-full flex-col",children:[(0,l.jsxs)("div",{className:"h-[50px] flex-shrink-0 w-full border-b border-custom-border-200 px-6 relative flex items-center gap-4 justify-between",children:[(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)("span",{className:"block text-sm font-medium",children:"Project Views"})}),(0,l.jsx)("div",{className:"h-full flex items-center gap-2",children:(0,l.jsxs)("div",{className:"flex items-center",children:[!s&&(0,l.jsx)("button",{type:"button",className:"-mr-1 p-2 hover:bg-custom-background-80 rounded text-custom-text-400 grid place-items-center",onClick:()=>{var e;r(!0),null===(e=a.current)||void 0===e||e.focus()},children:(0,l.jsx)(E.Z,{className:"h-3.5 w-3.5"})}),(0,l.jsxs)("div",{className:(0,N.cn)("ml-auto flex items-center justify-start gap-1 rounded-md border border-transparent bg-custom-background-100 text-custom-text-400 w-0 transition-[width] ease-linear overflow-hidden opacity-0",{"w-64 px-2.5 py-1.5 border-custom-border-200 opacity-100":s}),children:[(0,l.jsx)(E.Z,{className:"h-3.5 w-3.5"}),(0,l.jsx)("input",{ref:a,className:"w-full max-w-[234px] border-none bg-transparent text-sm text-custom-text-100 placeholder:text-custom-text-400 focus:outline-none",placeholder:"Search",value:e,onChange:e=>t(e.target.value),onKeyDown:s=>{if("Escape"===s.key){if(e&&""!==e.trim())t("");else{var l;r(!1),null===(l=a.current)||void 0===l||l.blur()}}}}),s&&(0,l.jsx)("button",{type:"button",className:"grid place-items-center",onClick:()=>{t(""),r(!1)},children:(0,l.jsx)(P.Z,{className:"h-3 w-3"})})]})]})})]}),(0,l.jsx)(S.P,{children:h.length>0?h.map(e=>(0,l.jsx)(I,{view:e},e.id)):(0,l.jsx)("p",{className:"mt-10 text-center text-sm text-custom-text-300",children:"No results found"})})]}):(0,l.jsx)(R.ub,{type:O.C.PROJECT_VIEW,primaryButtonOnClick:()=>i(!0)})})});var D=s(1422);let M=(0,v.Pi)(e=>{var t;let{parentRef:s,view:r}=e,[i,u]=(0,n.useState)(!1),[m,h]=(0,n.useState)(!1),{workspaceSlug:p,projectId:x}=(0,a.useRouter)().query,{membership:{currentProjectRole:v}}=(0,c.aF)(),{addViewToFavorites:g,removeViewFromFavorites:j}=(0,c.QJ)(),b=!!v&&v>=w.MC.MEMBER,y=(0,D.w)(null!==(t=r.filters)&&void 0!==t?t:{}),N=()=>{p&&x&&g(p.toString(),x.toString(),r.id)},k=()=>{p&&x&&j(p.toString(),x.toString(),r.id)};return(0,l.jsxs)(l.Fragment,{children:[p&&x&&r&&(0,l.jsx)(f,{isOpen:i,onClose:()=>u(!1),workspaceSlug:p.toString(),projectId:x.toString(),data:r}),(0,l.jsx)(d,{data:r,isOpen:m,onClose:()=>h(!1)}),(0,l.jsxs)("p",{className:"hidden rounded bg-custom-background-80 px-2 py-1 text-xs text-custom-text-200 group-hover:block",children:[y," ",1===y?"filter":"filters"]}),b&&(0,l.jsx)(o.MD,{onClick:e=>{e.preventDefault(),e.stopPropagation(),r.is_favorite?k():N()},selected:r.is_favorite}),x&&p&&(0,l.jsx)(C,{parentRef:s,projectId:x.toString(),view:r,workspaceSlug:p.toString()})]})})},66410:function(e,t,s){s.d(t,{Z:function(){return r},c:function(){return n}});var l=s(25449);let n=[{key:"issues",label:"Issues",shouldRender:()=>!0},{key:"cycles",label:"Cycles",shouldRender:e=>e.cycle_view},{key:"modules",label:"Modules",shouldRender:e=>e.module_view}],r={issues:{label:"Issues",href:"/issues",icon:l.uQ},cycles:{label:"Cycles",href:"/cycles",icon:l.sI},modules:{label:"Modules",href:"/modules",icon:l.kB}}},34220:function(e,t,s){s.d(t,{eS:function(){return n},fW:function(){return l},oW:function(){return r}});let l={1:{shortTitle:"Jan",title:"January"},2:{shortTitle:"Feb",title:"February"},3:{shortTitle:"Mar",title:"March"},4:{shortTitle:"Apr",title:"April"},5:{shortTitle:"May",title:"May"},6:{shortTitle:"Jun",title:"June"},7:{shortTitle:"Jul",title:"July"},8:{shortTitle:"Aug",title:"August"},9:{shortTitle:"Sep",title:"September"},10:{shortTitle:"Oct",title:"October"},11:{shortTitle:"Nov",title:"November"},12:{shortTitle:"Dec",title:"December"}},n={1:{shortTitle:"Sun",title:"Sunday"},2:{shortTitle:"Mon",title:"Monday"},3:{shortTitle:"Tue",title:"Tuesday"},4:{shortTitle:"Wed",title:"Wednesday"},5:{shortTitle:"Thu",title:"Thursday"},6:{shortTitle:"Fri",title:"Friday"},7:{shortTitle:"Sat",title:"Saturday"}},r={month:{key:"month",title:"Month layout"},week:{key:"week",title:"Week layout"}}},14522:function(e,t,s){s.d(t,{Js:function(){return v},PI:function(){return p},Rf:function(){return f},UY:function(){return h},pT:function(){return m},zV:function(){return x}});var l=s(58645),n=s(97151),r=s(16588),a=s(63217),i=s(83074),o=s(65886),c=s(92120),d=s(81630),u=s(33728);let m=[{key:"active",name:"Active"},{key:"all",name:"All"}],h=[{key:"list",icon:l.Z,title:"List layout"},{key:"board",icon:n.Z,title:"Grid layout"},{key:"gantt",icon:r.Z,title:"Gantt layout"}],p=[{label:"day left",value:"current",title:"Active",color:"#F59E0B",textColor:"text-amber-500",bgColor:"bg-amber-50"},{label:"Yet to start",value:"upcoming",title:"Yet to start",color:"#3F76FF",textColor:"text-blue-500",bgColor:"bg-indigo-50"},{label:"Completed",value:"completed",title:"Completed",color:"#16A34A",textColor:"text-green-600",bgColor:"bg-green-50"},{label:"Draft",value:"draft",title:"Draft",color:"#525252",textColor:"text-custom-text-300",bgColor:"bg-custom-background-90"}],x=[{key:"completed_issues",title:"Completed",color:"#6490FE"},{key:"started_issues",title:"Started",color:"#FDD97F"},{key:"unstarted_issues",title:"Unstarted",color:"#FEB055"},{key:"backlog_issues",title:"Backlog",color:"#F0F0F3"}],f=[{title:"10,000-feet view of all active cycles.",description:"Zoom out to see running cycles across all your projects at once instead of going from Cycle to Cycle in each project.",icon:a.Z},{title:"Get a snapshot of each active cycle.",description:"Track high-level metrics for all active cycles, see their state of progress, and get a sense of scope against deadlines.",icon:i.Z},{title:"Compare burndowns.",description:"Monitor how each of your teams are performing with a peek into each cycles burndown report.",icon:o.Z},{title:"Quickly see make-or-break issues. ",description:"Preview high-priority issues for each cycle against due dates. See all of them per cycle in one click.",icon:c.Z},{title:"Zoom into cycles that need attention. ",description:"Investigate the state of any cycle that doesnt conform to expectations in one click.",icon:d.Z},{title:"Stay ahead of blockers.",description:"Spot challenges from one project to another and see inter-cycle dependencies that arent obvious from any other view.",icon:u.Z}],v=[{key:"completed_issues",title:"Completed",color:"#6490FE"},{key:"started_issues",title:"Started",color:"#FDD97F"},{key:"unstarted_issues",title:"Unstarted",color:"#FEB055"},{key:"backlog_issues",title:"Backlog",color:"#F0F0F3"}]},12021:function(e,t,s){s.d(t,{D:function(){return y},O:function(){return S}});var l=s(63399),n=s(74129),r=s(55883),a=s(47519),i=s(65973),o=s(29300),c=s(70898),d=s(51885),u=s(32147),m=s(22677),h=s(32051),p=s(58645),x=s(16867),f=s(30747),v=s(38006),g=s(37542),j=s(20962),b=s(20339);let y=[{key:"text",name:"Text",icon:l.Z,editors:["document"]},{key:"h1",name:"Heading 1",icon:n.Z,editors:["document"]},{key:"h2",name:"Heading 2",icon:r.Z,editors:["document"]},{key:"h3",name:"Heading 3",icon:a.Z,editors:["document"]},{key:"h4",name:"Heading 4",icon:i.Z,editors:["document"]},{key:"h5",name:"Heading 5",icon:o.Z,editors:["document"]},{key:"h6",name:"Heading 6",icon:c.Z,editors:["document"]}],w=[{key:"bold",name:"Bold",icon:d.Z,shortcut:["Cmd","B"],editors:["lite","document"]},{key:"italic",name:"Italic",icon:u.Z,shortcut:["Cmd","I"],editors:["lite","document"]},{key:"underline",name:"Underline",icon:m.Z,shortcut:["Cmd","U"],editors:["lite","document"]},{key:"strikethrough",name:"Strikethrough",icon:h.Z,shortcut:["Cmd","Shift","S"],editors:["lite","document"]}],N=[{key:"bulleted-list",name:"Bulleted list",icon:p.Z,shortcut:["Cmd","Shift","7"],editors:["lite","document"]},{key:"numbered-list",name:"Numbered list",icon:x.Z,shortcut:["Cmd","Shift","8"],editors:["lite","document"]},{key:"to-do-list",name:"To-do list",icon:f.Z,shortcut:["Cmd","Shift","9"],editors:["lite","document"]}],k=[{key:"quote",name:"Quote",icon:v.Z,editors:["lite","document"]},{key:"code",name:"Code",icon:g.Z,editors:["lite","document"]}],C=[{key:"table",name:"Table",icon:j.Z,editors:["document"]},{key:"image",name:"Image",icon:b.Z,editors:["lite","document"]}],S={lite:{basic:w.filter(e=>e.editors.includes("lite")),list:N.filter(e=>e.editors.includes("lite")),userAction:k.filter(e=>e.editors.includes("lite")),complex:C.filter(e=>e.editors.includes("lite"))},document:{basic:w.filter(e=>e.editors.includes("document")),list:N.filter(e=>e.editors.includes("document")),userAction:k.filter(e=>e.editors.includes("document")),complex:C.filter(e=>e.editors.includes("document"))}}},60801:function(e,t,s){s.d(t,{UC:function(){return l},XX:function(){return r},kB:function(){return n}});let l=[{name:"1 week from now",value:"1_weeks;after;fromnow"},{name:"2 weeks from now",value:"2_weeks;after;fromnow"},{name:"1 month from now",value:"1_months;after;fromnow"},{name:"2 months from now",value:"2_months;after;fromnow"}],n=[{name:"1 week ago",value:"1_weeks;before;fromnow"},{name:"2 weeks ago",value:"2_weeks;before;fromnow"},{name:"1 month ago",value:"1_months;before;fromnow"}],r=[{name:"Today",value:"today;custom;custom"},{name:"Yesterday",value:"yesterday;custom;custom"},{name:"Last 7 days",value:"last_7_days;custom;custom"},{name:"Last 30 days",value:"last_30_days;custom;custom"}]},27234:function(e,t,s){s.d(t,{D8:function(){return a},SE:function(){return o},SU:function(){return i}});var l=s(58645),n=s(97151),r=s(16588);let a=[{label:"Backlog",value:"backlog",color:"#a3a3a2",textColor:"text-custom-text-400",bgColor:"bg-custom-background-80"},{label:"Planned",value:"planned",color:"#3f76ff",textColor:"text-blue-500",bgColor:"bg-indigo-50"},{label:"In Progress",value:"in-progress",color:"#f39e1f",textColor:"text-amber-500",bgColor:"bg-amber-50"},{label:"Paused",value:"paused",color:"#525252",textColor:"text-custom-text-300",bgColor:"bg-custom-background-90"},{label:"Completed",value:"completed",color:"#16a34a",textColor:"text-green-600",bgColor:"bg-green-100"},{label:"Cancelled",value:"cancelled",color:"#ef4444",textColor:"text-red-500",bgColor:"bg-red-50"}],i=[{key:"list",icon:l.Z,title:"List layout"},{key:"board",icon:n.Z,title:"Grid layout"},{key:"gantt",icon:r.Z,title:"Gantt layout"}],o=[{key:"name",label:"Name"},{key:"progress",label:"Progress"},{key:"issues_length",label:"Number of issues"},{key:"target_date",label:"Due date"},{key:"created_at",label:"Created date"},{key:"sort_order",label:"Manual"}]},76926:function(e,t,s){s.d(t,{C:function(){return a}});var l=s(27378),n=s(93997),r=s(10634);let a=e=>{let t=i(),s=o(),l=c(),r=d(),a=u(),x=m(),f=h(),v=p();switch(e){case n.rS.PROJECT_VIEW:return a;case n.rS.PROFILE:return r;case n.rS.CYCLE:return s;case n.rS.MODULE:return l;case n.rS.ARCHIVED:return f;case n.rS.DRAFT:return x;case n.rS.GLOBAL:return v;case n.rS.PROJECT:default:return t}},i=()=>{let{issues:e,issuesFilter:t}=(0,r.gk)(n.rS.PROJECT),{router:{workspaceSlug:s}}=(0,r.IX)(),a=(0,l.useCallback)(async(t,l)=>{if(s)return await e.fetchIssues(s,t,l)},[e.fetchIssues,s]),i=(0,l.useCallback)(async(t,l)=>{if(s)return await e.createIssue(s,t,l)},[e.createIssue,s]),o=(0,l.useCallback)(async(t,l,n)=>{if(s)return await e.updateIssue(s,t,l,n)},[e.updateIssue,s]),c=(0,l.useCallback)(async(t,l)=>{if(s)return await e.removeIssue(s,t,l)},[e.removeIssue,s]),d=(0,l.useCallback)(async(t,l)=>{if(s)return await e.archiveIssue(s,t,l)},[e.archiveIssue,s]),u=(0,l.useCallback)(async(e,l,n)=>{if(s)return await t.updateFilters(s,e,l,n)},[t.updateFilters,s]);return(0,l.useMemo)(()=>({fetchIssues:a,createIssue:i,updateIssue:o,removeIssue:c,archiveIssue:d,updateFilters:u}),[a,i,o,c,d,u])},o=()=>{let{issues:e,issuesFilter:t}=(0,r.gk)(n.rS.CYCLE),{router:{workspaceSlug:s,cycleId:a}}=(0,r.IX)(),i=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.fetchIssues(s,t,l,a)},[e.fetchIssues,a,s]),o=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.createIssue(s,t,l,a)},[e.createIssue,a,s]),c=(0,l.useCallback)(async(t,l,n)=>{if(a&&s)return await e.updateIssue(s,t,l,n,a)},[e.updateIssue,a,s]),d=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.removeIssue(s,t,l,a)},[e.removeIssue,a,s]),u=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.removeIssueFromCycle(s,t,a,l)},[e.removeIssueFromCycle,a,s]),m=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.archiveIssue(s,t,l,a)},[e.archiveIssue,a,s]),h=(0,l.useCallback)(async(e,l,n)=>{if(a&&s)return await t.updateFilters(s,e,l,n,a)},[t.updateFilters,a,s]);return(0,l.useMemo)(()=>({fetchIssues:i,createIssue:o,updateIssue:c,removeIssue:d,removeIssueFromView:u,archiveIssue:m,updateFilters:h}),[i,o,c,d,u,m,h])},c=()=>{let{issues:e,issuesFilter:t}=(0,r.gk)(n.rS.MODULE),{router:{workspaceSlug:s,moduleId:a}}=(0,r.IX)(),i=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.fetchIssues(s,t,l,a)},[e.fetchIssues,a,s]),o=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.createIssue(s,t,l,a)},[e.createIssue,a,s]),c=(0,l.useCallback)(async(t,l,n)=>{if(a&&s)return await e.updateIssue(s,t,l,n,a)},[e.updateIssue,a,s]),d=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.removeIssue(s,t,l,a)},[e.removeIssue,a,s]),u=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.removeIssuesFromModule(s,t,a,[l])},[e.removeIssuesFromModule,a,s]),m=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.archiveIssue(s,t,l,a)},[e.archiveIssue,a,s]),h=(0,l.useCallback)(async(e,l,n)=>{if(a&&s)return await t.updateFilters(s,e,l,n,a)},[t.updateFilters,a]);return(0,l.useMemo)(()=>({fetchIssues:i,createIssue:o,updateIssue:c,removeIssue:d,removeIssueFromView:u,archiveIssue:m,updateFilters:h}),[i,o,c,d,u,m,h])},d=()=>{let{issues:e,issuesFilter:t}=(0,r.gk)(n.rS.PROFILE),{router:{workspaceSlug:s,userId:a}}=(0,r.IX)(),i=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.fetchIssues(s,t,l,a)},[e.fetchIssues,a,s]),o=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.createIssue(s,t,l,a)},[e.createIssue,a,s]),c=(0,l.useCallback)(async(t,l,n)=>{if(a&&s)return await e.updateIssue(s,t,l,n,a)},[e.updateIssue,a,s]),d=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.removeIssue(s,t,l,a)},[e.removeIssue,a,s]),u=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.archiveIssue(s,t,l,a)},[e.archiveIssue,a,s]),m=(0,l.useCallback)(async(e,l,n)=>{if(a&&s)return await t.updateFilters(s,e,l,n,a)},[t.updateFilters,a,s]);return(0,l.useMemo)(()=>({fetchIssues:i,createIssue:o,updateIssue:c,removeIssue:d,archiveIssue:u,updateFilters:m}),[i,o,c,d,u,m])},u=()=>{let{issues:e,issuesFilter:t}=(0,r.gk)(n.rS.PROJECT_VIEW),{router:{workspaceSlug:s,viewId:a}}=(0,r.IX)(),i=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.fetchIssues(s,t,l,a)},[e.fetchIssues,a,s]),o=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.createIssue(s,t,l,a)},[e.createIssue,a,s]),c=(0,l.useCallback)(async(t,l,n)=>{if(a&&s)return await e.updateIssue(s,t,l,n,a)},[e.updateIssue,a,s]),d=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.removeIssue(s,t,l,a)},[e.removeIssue,a,s]),u=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.archiveIssue(s,t,l,a)},[e.archiveIssue,a,s]),m=(0,l.useCallback)(async(e,l,n)=>{if(a&&s)return await t.updateFilters(s,e,l,n,a)},[t.updateFilters,a,s]);return(0,l.useMemo)(()=>({fetchIssues:i,createIssue:o,updateIssue:c,removeIssue:d,archiveIssue:u,updateFilters:m}),[i,o,c,d,u,m])},m=()=>{let{issues:e,issuesFilter:t}=(0,r.gk)(n.rS.DRAFT),{router:{workspaceSlug:s}}=(0,r.IX)(),a=(0,l.useCallback)(async(t,l)=>{if(s)return await e.fetchIssues(s,t,l)},[e.fetchIssues,s]),i=(0,l.useCallback)(async(t,l)=>{if(s)return await e.createIssue(s,t,l)},[e.createIssue,s]),o=(0,l.useCallback)(async(t,l,n)=>{if(s)return await e.updateIssue(s,t,l,n)},[e.updateIssue,s]),c=(0,l.useCallback)(async(t,l)=>{if(s)return await e.removeIssue(s,t,l)},[e.removeIssue,s]),d=(0,l.useCallback)(async(e,l,n)=>{if(s)return await t.updateFilters(s,e,l,n)},[t.updateFilters]);return(0,l.useMemo)(()=>({fetchIssues:a,createIssue:i,updateIssue:o,removeIssue:c,updateFilters:d}),[a,i,o,c,d])},h=()=>{let{issues:e,issuesFilter:t}=(0,r.gk)(n.rS.ARCHIVED),{router:{workspaceSlug:s}}=(0,r.IX)(),a=(0,l.useCallback)(async(t,l)=>{if(s)return await e.fetchIssues(s,t,l)},[e.fetchIssues]),i=(0,l.useCallback)(async(t,l)=>{if(s)return await e.removeIssue(s,t,l)},[e.removeIssue]),o=(0,l.useCallback)(async(t,l)=>{if(s)return await e.restoreIssue(s,t,l)},[e.restoreIssue]),c=(0,l.useCallback)(async(e,l,n)=>{if(s)return await t.updateFilters(s,e,l,n)},[t.updateFilters]);return(0,l.useMemo)(()=>({fetchIssues:a,removeIssue:i,restoreIssue:o,updateFilters:c}),[a,i,o,c])},p=()=>{let{issues:e,issuesFilter:t}=(0,r.gk)(n.rS.GLOBAL),{router:{workspaceSlug:s,globalViewId:a}}=(0,r.IX)(),i=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.createIssue(s,t,l,a)},[e.createIssue,a,s]),o=(0,l.useCallback)(async(t,l,n)=>{if(a&&s)return await e.updateIssue(s,t,l,n,a)},[e.updateIssue,a,s]),c=(0,l.useCallback)(async(t,l)=>{if(a&&s)return await e.removeIssue(s,t,l,a)},[e.removeIssue,a,s]),d=(0,l.useCallback)(async(e,l,n)=>{if(a&&s)return await t.updateFilters(s,e,l,n,a)},[t.updateFilters,a,s]);return(0,l.useMemo)(()=>({createIssue:i,updateIssue:o,removeIssue:c,updateFilters:d}),[i,o,c,d])}},38758:function(e,t,s){var l=s(27378);t.Z=(e,t)=>{(0,l.useEffect)(()=>{let s=s=>{s.key===e&&t()};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}})}},83114:function(e,t,s){var l=s(27378),n=s(86677);t.Z=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[t,s]=(0,l.useState)(!1),r=(0,n.useRouter)(),a=(0,l.useCallback)(s=>{e&&t&&(s.preventDefault(),s.returnValue="")},[e,t]),i=(0,l.useCallback)(s=>{e&&t&&(confirm("Are you sure you want to leave? Changes you made may not be saved.")||r.events.emit("routeChangeError"))},[e,t,r.events]);return(0,l.useEffect)(()=>(window.addEventListener("beforeunload",a),r.events.on("routeChangeStart",i),()=>{window.removeEventListener("beforeunload",a),r.events.off("routeChangeStart",i)}),[a,i,r.events]),{setShowAlert:s}}},89789:function(e,t,s){var l=s(27378),n=s(86677);let r=new(s(16933)).A;t.Z=e=>{let{routeAuth:t,user:s,isLoading:a}=e,[i,o]=(0,l.useState)(!0),c=(0,n.useRouter)(),{next_path:d}=c.query,u=e=>!/^(https?|ftp):\/\//i.test(e);return(0,l.useEffect)(()=>{let e=async()=>{r.userWorkspaces().then(async e=>{var t;if(!s)return;let l=null===(t=Object.values(null!=e?e:{}))||void 0===t?void 0:t[0],n=e.find(e=>e.id===(null==s?void 0:s.last_workspace_id));if(n){c.push("/".concat(n.slug));return}if(l){c.push("/".concat(l.slug));return}c.push("/profile")})},l=async()=>{if(s&&s.is_active){if("sign-in"===t){if(s.is_onboarded)e();else{c.push("/onboarding");return}}else if("onboarding"===t){if(s.is_onboarded)e();else{o(()=>!1);return}}else{if(s.is_onboarded){o(()=>!1);return}c.push("/onboarding");return}}};if(null===t){o(()=>!1);return}if(!a){if(o(()=>!0),s){if(d){if(u(d.toString())){c.push(d.toString());return}c.push("/");return}l()}else{if("sign-in"===t){o(()=>!1);return}c.push("/");return}}},[s,a,t,c,d]),{isLoading:i}}},45530:function(e,t,s){var l=s(27378);t.Z=()=>{let[e,t]=(0,l.useState)([window.innerWidth,window.innerHeight]);return(0,l.useEffect)(()=>{let e=()=>{t([window.innerWidth,window.innerHeight])};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e}},40923:function(e,t,s){s.d(t,{z:function(){return r}});var l=s(6780),n=s(82283);class r extends n.t{async addInstallationApp(e,t,s){return this.post("/api/workspaces/".concat(e,"/workspace-integrations/").concat(t,"/"),s).then(e=>null==e?void 0:e.data).catch(e=>{throw null==e?void 0:e.response})}async addSlackChannel(e,t,s,l){return this.post("/api/workspaces/".concat(e,"/projects/").concat(t,"/workspace-integrations/").concat(s,"/project-slack-sync/"),l).then(e=>null==e?void 0:e.data).catch(e=>{throw null==e?void 0:e.response})}async getSlackChannelDetail(e,t,s){return this.get("/api/workspaces/".concat(e,"/projects/").concat(t,"/workspace-integrations/").concat(s,"/project-slack-sync/")).then(e=>null==e?void 0:e.data).catch(e=>{throw null==e?void 0:e.response})}async removeSlackChannel(e,t,s,l){return this.delete("/api/workspaces/".concat(e,"/projects/").concat(t,"/workspace-integrations/").concat(s,"/project-slack-sync/").concat(l)).then(e=>null==e?void 0:e.data).catch(e=>{throw null==e?void 0:e.response})}constructor(){super(l.C)}}},90893:function(e,t,s){s.d(t,{Sz:function(){return a},Vo:function(){return i.V},ig:function(){return o}});var l=s(6780),n=s(82283);let r="github";class a extends n.t{async listAllRepositories(e,t){return this.get("/api/workspaces/".concat(e,"/workspace-integrations/").concat(t,"/github-repositories")).then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}async getGithubRepoInfo(e,t){return this.get("/api/workspaces/".concat(e,"/importers/").concat(r,"/"),{params:t}).then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}async createGithubServiceImport(e,t){return this.post("/api/workspaces/".concat(e,"/projects/importers/").concat(r,"/"),t).then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}constructor(){super(l.C)}}var i=s(34353);class o extends n.t{async getJiraProjectInfo(e,t){return this.get("/api/workspaces/".concat(e,"/importers/jira"),{params:t}).then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}async createJiraImporter(e,t){return this.post("/api/workspaces/".concat(e,"/projects/importers/jira/"),t).then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}constructor(){super(l.C)}}},34353:function(e,t,s){s.d(t,{V:function(){return r}});var l=s(6780),n=s(82283);class r extends n.t{async getAppIntegrationsList(){return this.get("/api/integrations/").then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}async getWorkspaceIntegrationsList(e){return this.get("/api/workspaces/".concat(e,"/workspace-integrations/")).then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}async deleteWorkspaceIntegration(e,t){return this.delete("/api/workspaces/".concat(e,"/workspace-integrations/").concat(t,"/provider/")).then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}async getImporterServicesList(e){return this.get("/api/workspaces/".concat(e,"/importers/")).then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}async getExportsServicesList(e,t,s){return this.get("/api/workspaces/".concat(e,"/export-issues"),{params:{per_page:s,cursor:t}}).then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}async deleteImporterService(e,t,s){return this.delete("/api/workspaces/".concat(e,"/importers/").concat(t,"/").concat(s,"/")).then(e=>null==e?void 0:e.data).catch(e=>{var t;throw null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data})}constructor(){super(l.C)}}},80473:function(e,t,s){s.d(t,{_j:function(){return tD},sq:function(){return tz}});var l,n=s(27378),r=s(18469),a=s(24246),i=Object.defineProperty,o=Object.defineProperties,c=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,h=(e,t,s)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,p=(e,t)=>{for(var s in t||(t={}))u.call(t,s)&&h(e,s,t[s]);if(d)for(var s of d(t))m.call(t,s)&&h(e,s,t[s]);return e},x=(e,t)=>o(e,c(t)),f=class e{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let t=0;t<e.length;t++)this.size+=e[t].nodeSize}nodesBetween(e,t,s,l=0,n){for(let r=0,a=0;a<t;r++){let i=this.content[r],o=a+i.nodeSize;if(o>e&&!1!==s(i,l+a,n||null,r)&&i.content.size){let n=a+1;i.nodesBetween(Math.max(0,e-n),Math.min(i.content.size,t-n),s,l+n)}a=o}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,s,l){let n="",r=!0;return this.nodesBetween(e,t,(a,i)=>{let o=a.isText?a.text.slice(Math.max(e,i)-i,t-i):a.isLeaf?l?"function"==typeof l?l(a):l:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&o||a.isTextblock)&&s&&(r?r=!1:n+=s),n+=o},0),n}append(t){if(!t.size)return this;if(!this.size)return t;let s=this.lastChild,l=t.firstChild,n=this.content.slice(),r=0;for(s.isText&&s.sameMarkup(l)&&(n[n.length-1]=s.withText(s.text+l.text),r=1);r<t.content.length;r++)n.push(t.content[r]);return new e(n,this.size+t.size)}cut(t,s=this.size){if(0==t&&s==this.size)return this;let l=[],n=0;if(s>t)for(let e=0,r=0;r<s;e++){let a=this.content[e],i=r+a.nodeSize;i>t&&((r<t||i>s)&&(a=a.isText?a.cut(Math.max(0,t-r),Math.min(a.text.length,s-r)):a.cut(Math.max(0,t-r-1),Math.min(a.content.size,s-r-1))),l.push(a),n+=a.nodeSize),r=i}return new e(l,n)}cutByIndex(t,s){return t==s?e.empty:0==t&&s==this.content.length?this:new e(this.content.slice(t,s))}replaceChild(t,s){let l=this.content[t];if(l==s)return this;let n=this.content.slice(),r=this.size+s.nodeSize-l.nodeSize;return n[t]=s,new e(n,r)}addToStart(t){return new e([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new e(this.content.concat(t),this.size+t.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,s=0;t<this.content.length;t++){let l=this.content[t];e(l,s,t),s+=l.nodeSize}}findDiffStart(e,t=0){return function e(t,s,l){for(let n=0;;n++){if(n==t.childCount||n==s.childCount)return t.childCount==s.childCount?null:l;let r=t.child(n),a=s.child(n);if(r==a){l+=r.nodeSize;continue}if(!r.sameMarkup(a))return l;if(r.isText&&r.text!=a.text){for(let e=0;r.text[e]==a.text[e];e++)l++;return l}if(r.content.size||a.content.size){let t=e(r.content,a.content,l+1);if(null!=t)return t}l+=r.nodeSize}}(this,e,t)}findDiffEnd(e,t=this.size,s=e.size){return function e(t,s,l,n){for(let r=t.childCount,a=s.childCount;;){if(0==r||0==a)return r==a?null:{a:l,b:n};let i=t.child(--r),o=s.child(--a),c=i.nodeSize;if(i==o){l-=c,n-=c;continue}if(!i.sameMarkup(o))return{a:l,b:n};if(i.isText&&i.text!=o.text){let e=0,t=Math.min(i.text.length,o.text.length);for(;e<t&&i.text[i.text.length-e-1]==o.text[o.text.length-e-1];)e++,l--,n--;return{a:l,b:n}}if(i.content.size||o.content.size){let t=e(i.content,o.content,l-1,n-1);if(t)return t}l-=c,n-=c}}(this,e,t,s)}findIndex(e,t=-1){if(0==e)return g(0,e);if(e==this.size)return g(this.content.length,e);if(e>this.size||e<0)throw RangeError(`Position ${e} outside of fragment (${this})`);for(let s=0,l=0;;s++){let n=l+this.child(s).nodeSize;if(n>=e)return n==e||t>0?g(s+1,n):g(s,l);l=n}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(t,s){if(!s)return e.empty;if(!Array.isArray(s))throw RangeError("Invalid input for Fragment.fromJSON");return new e(s.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return e.empty;let s,l=0;for(let e=0;e<t.length;e++){let n=t[e];l+=n.nodeSize,e&&n.isText&&t[e-1].sameMarkup(n)?(s||(s=t.slice(0,e)),s[s.length-1]=n.withText(s[s.length-1].text+n.text)):s&&s.push(n)}return new e(s||t,l)}static from(t){if(!t)return e.empty;if(t instanceof e)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new e([t],t.nodeSize);throw RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};f.empty=new f([],0);var v={index:0,offset:0};function g(e,t){return v.index=e,v.offset=t,v}function j(e,t){if(e===t)return!0;if(!(e&&"object"==typeof e)||!(t&&"object"==typeof t))return!1;let s=Array.isArray(e);if(Array.isArray(t)!=s)return!1;if(s){if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++)if(!j(e[s],t[s]))return!1}else{for(let s in e)if(!(s in t)||!j(e[s],t[s]))return!1;for(let s in t)if(!(s in e))return!1}return!0}var b=class e{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,s=!1;for(let l=0;l<e.length;l++){let n=e[l];if(this.eq(n))return e;if(this.type.excludes(n.type))t||(t=e.slice(0,l));else{if(n.type.excludes(this.type))return e;!s&&n.type.rank>this.type.rank&&(t||(t=e.slice(0,l)),t.push(this),s=!0),t&&t.push(n)}}return t||(t=e.slice()),s||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&j(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw RangeError("Invalid input for Mark.fromJSON");let s=e.marks[t.type];if(!s)throw RangeError(`There is no mark type ${t.type} in this schema`);return s.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++)if(!e[s].eq(t[s]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&0==t.length)return e.none;if(t instanceof e)return[t];let s=t.slice();return s.sort((e,t)=>e.type.rank-t.type.rank),s}};b.none=[];var y=class extends Error{},w=class e{constructor(e,t,s){this.content=e,this.openStart=t,this.openEnd=s}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,s){let l=function e(t,s,l,n){let{index:r,offset:a}=t.findIndex(s),i=t.maybeChild(r);if(a==s||i.isText)return n&&!n.canReplace(r,r,l)?null:t.cut(0,s).append(l).append(t.cut(s));let o=e(i.content,s-a-1,l);return o&&t.replaceChild(r,i.copy(o))}(this.content,t+this.openStart,s);return l&&new e(l,this.openStart,this.openEnd)}removeBetween(t,s){return new e(function e(t,s,l){let{index:n,offset:r}=t.findIndex(s),a=t.maybeChild(n),{index:i,offset:o}=t.findIndex(l);if(r==s||a.isText){if(o!=l&&!t.child(i).isText)throw RangeError("Removing non-flat range");return t.cut(0,s).append(t.cut(l))}if(n!=i)throw RangeError("Removing non-flat range");return t.replaceChild(n,a.copy(e(a.content,s-r-1,l-r-1)))}(this.content,t+this.openStart,s+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(t,s){if(!s)return e.empty;let l=s.openStart||0,n=s.openEnd||0;if("number"!=typeof l||"number"!=typeof n)throw RangeError("Invalid input for Slice.fromJSON");return new e(f.fromJSON(t,s.content),l,n)}static maxOpen(t,s=!0){let l=0,n=0;for(let e=t.firstChild;e&&!e.isLeaf&&(s||!e.type.spec.isolating);e=e.firstChild)l++;for(let e=t.lastChild;e&&!e.isLeaf&&(s||!e.type.spec.isolating);e=e.lastChild)n++;return new e(t,l,n)}};function N(e,t){if(!t.type.compatibleContent(e.type))throw new y("Cannot join "+t.type.name+" onto "+e.type.name)}function k(e,t,s){let l=e.node(s);return N(l,t.node(s)),l}function C(e,t){let s=t.length-1;s>=0&&e.isText&&e.sameMarkup(t[s])?t[s]=e.withText(t[s].text+e.text):t.push(e)}function S(e,t,s,l){let n=(t||e).node(s),r=0,a=t?t.index(s):n.childCount;e&&(r=e.index(s),e.depth>s?r++:e.textOffset&&(C(e.nodeAfter,l),r++));for(let e=r;e<a;e++)C(n.child(e),l);t&&t.depth==s&&t.textOffset&&C(t.nodeBefore,l)}function _(e,t){return e.type.checkContent(t),e.copy(t)}function I(e,t,s){let l=[];return S(null,e,s,l),e.depth>s&&C(_(k(e,t,s+1),I(e,t,s+1)),l),S(t,null,s,l),new f(l)}w.empty=new w(f.empty,0,0);var E=class e{constructor(e,t,s){this.pos=e,this.path=t,this.parentOffset=s,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let s=this.pos-this.path[this.path.length-1],l=e.child(t);return s?e.child(t).cut(s):l}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let s=this.path[3*t],l=0==t?0:this.path[3*t-1]+1;for(let t=0;t<e;t++)l+=s.child(t).nodeSize;return l}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return b.none;if(this.textOffset)return e.child(t).marks;let s=e.maybeChild(t-1),l=e.maybeChild(t);if(!s){let e=s;s=l,l=e}let n=s.marks;for(var r=0;r<n.length;r++)!1!==n[r].type.spec.inclusive||l&&n[r].isInSet(l.marks)||(n=n[r--].removeFromSet(n));return n}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let s=t.marks,l=e.parent.maybeChild(e.index());for(var n=0;n<s.length;n++)!1!==s[n].type.spec.inclusive||l&&s[n].isInSet(l.marks)||(s=s[n--].removeFromSet(s));return s}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let s=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);s>=0;s--)if(e.pos<=this.end(s)&&(!t||t(this.node(s))))return new O(this,e,s);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(t,s){if(!(s>=0&&s<=t.content.size))throw RangeError("Position "+s+" out of range");let l=[],n=0,r=s;for(let e=t;;){let{index:t,offset:s}=e.content.findIndex(r),a=r-s;if(l.push(e,t,n+s),!a||(e=e.child(t)).isText)break;r=a-1,n+=s+1}return new e(s,l,r)}static resolveCached(t,s){for(let e=0;e<P.length;e++){let l=P[e];if(l.pos==s&&l.doc==t)return l}let l=P[R]=e.resolve(t,s);return R=(R+1)%F,l}},P=[],R=0,F=12,O=class{constructor(e,t,s){this.$from=e,this.$to=t,this.depth=s}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}},T=Object.create(null);(class e{constructor(e,t,s,l=b.none){this.type=e,this.attrs=t,this.marks=l,this.content=s||f.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,s,l=0){this.content.nodesBetween(e,t,s,l,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,s,l){return this.content.textBetween(e,t,s,l)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,s){return this.type==e&&j(this.attrs,t||e.defaultAttrs||T)&&b.sameSet(this.marks,s||b.none)}copy(t=null){return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,s=!1){if(e==t)return w.empty;let l=this.resolve(e),n=this.resolve(t),r=s?0:l.sharedDepth(t),a=l.start(r);return new w(l.node(r).content.cut(l.pos-a,n.pos-a),l.depth-r,n.depth-r)}replace(e,t,s){return function(e,t,s){if(s.openStart>e.depth)throw new y("Inserted content deeper than insertion position");if(e.depth-s.openStart!=t.depth-s.openEnd)throw new y("Inconsistent open depths");return function e(t,s,l,n){let r=t.index(n),a=t.node(n);if(r==s.index(n)&&n<t.depth-l.openStart){let i=e(t,s,l,n+1);return a.copy(a.content.replaceChild(r,i))}if(!l.content.size)return _(a,I(t,s,n));if(l.openStart||l.openEnd||t.depth!=n||s.depth!=n){let{start:e,end:r}=function(e,t){let s=t.depth-e.openStart,l=t.node(s).copy(e.content);for(let e=s-1;e>=0;e--)l=t.node(e).copy(f.from(l));return{start:l.resolveNoCache(e.openStart+s),end:l.resolveNoCache(l.content.size-e.openEnd-s)}}(l,t);return _(a,function e(t,s,l,n,r){let a=t.depth>r&&k(t,s,r+1),i=n.depth>r&&k(l,n,r+1),o=[];return S(null,t,r,o),a&&i&&s.index(r)==l.index(r)?(N(a,i),C(_(a,e(t,s,l,n,r+1)),o)):(a&&C(_(a,I(t,s,r+1)),o),S(s,l,r,o),i&&C(_(i,I(l,n,r+1)),o)),S(n,null,r,o),new f(o)}(t,e,r,s,n))}{let e=t.parent,n=e.content;return _(e,n.cut(0,t.parentOffset).append(l.content).append(n.cut(s.parentOffset)))}}(e,t,s,0)}(this.resolve(e),this.resolve(t),s)}nodeAt(e){for(let t=this;;){let{index:s,offset:l}=t.content.findIndex(e);if(!(t=t.maybeChild(s)))return null;if(l==e||t.isText)return t;e-=l+1}}childAfter(e){let{index:t,offset:s}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:s}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:s}=this.content.findIndex(e);if(s<e)return{node:this.content.child(t),index:t,offset:s};let l=this.content.child(t-1);return{node:l,index:t-1,offset:s-l.nodeSize}}resolve(e){return E.resolveCached(this,e)}resolveNoCache(e){return E.resolve(this,e)}rangeHasMark(e,t,s){let l=!1;return t>e&&this.nodesBetween(e,t,e=>(s.isInSet(e.marks)&&(l=!0),!l)),l}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),function(e,t){for(let s=e.length-1;s>=0;s--)t=e[s].type.name+"("+t+")";return t}(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,s=f.empty,l=0,n=s.childCount){let r=this.contentMatchAt(e).matchFragment(s,l,n),a=r&&r.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let e=l;e<n;e++)if(!this.type.allowsMarks(s.child(e).marks))return!1;return!0}canReplaceWith(e,t,s,l){if(l&&!this.type.allowsMarks(l))return!1;let n=this.contentMatchAt(e).matchType(s),r=n&&n.matchFragment(this.content,t);return!!r&&r.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=b.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!b.sameSet(e,this.marks))throw RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){if(!t)throw RangeError("Invalid input for Node.fromJSON");let s=null;if(t.marks){if(!Array.isArray(t.marks))throw RangeError("Invalid mark data for Node.fromJSON");s=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw RangeError("Invalid text node in JSON");return e.text(t.text,s)}let l=f.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,l,s)}}).prototype.text=void 0;var A=class e{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(t,s){var l;let n,r=new D(t,s);if(null==r.next)return e.empty;let a=function e(t){let s=[];do s.push(function(t){let s=[];do s.push(function(t){let s=function(t){if(t.eat("(")){let s=e(t);return t.eat(")")||t.err("Missing closing paren"),s}if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=(function(e,t){let s=e.nodeTypes,l=s[t];if(l)return[l];let n=[];for(let e in s){let l=s[e];l.groups.indexOf(t)>-1&&n.push(l)}return 0==n.length&&e.err("No node type or group '"+t+"' found"),n})(t,t.next).map(e=>(null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}}(t);for(;;)if(t.eat("+"))s={type:"plus",expr:s};else if(t.eat("*"))s={type:"star",expr:s};else if(t.eat("?"))s={type:"opt",expr:s};else if(t.eat("{"))s=function(e,t){let s=M(e),l=s;return e.eat(",")&&(l="}"!=e.next?M(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:s,max:l,expr:t}}(t,s);else break;return s}(t));while(t.next&&")"!=t.next&&"|"!=t.next);return 1==s.length?s[0]:{type:"seq",exprs:s}}(t));while(t.eat("|"));return 1==s.length?s[0]:{type:"choice",exprs:s}}(r);r.next&&r.err("Unexpected trailing text");let i=(l=function(e){let t=[[]];return n(function e(t,r){if("choice"==t.type)return t.exprs.reduce((t,s)=>t.concat(e(s,r)),[]);if("seq"==t.type)for(let l=0;;l++){let a=e(t.exprs[l],r);if(l==t.exprs.length-1)return a;n(a,r=s())}else if("star"==t.type){let a=s();return l(r,a),n(e(t.expr,a),a),[l(a)]}else if("plus"==t.type){let a=s();return n(e(t.expr,r),a),n(e(t.expr,a),a),[l(a)]}else{if("opt"==t.type)return[l(r)].concat(e(t.expr,r));if("range"==t.type){let a=r;for(let l=0;l<t.min;l++){let l=s();n(e(t.expr,a),l),a=l}if(-1==t.max)n(e(t.expr,a),a);else for(let r=t.min;r<t.max;r++){let r=s();l(a,r),n(e(t.expr,a),r),a=r}return[l(a)]}if("name"==t.type)return[l(r,void 0,t.value)];throw Error("Unknown expr type")}}(e,0),s()),t;function s(){return t.push([])-1}function l(e,s,l){let n={term:l,to:s};return t[e].push(n),n}function n(e,t){e.forEach(e=>e.to=t)}}(a),n=Object.create(null),function e(t){let s=[];t.forEach(e=>{l[e].forEach(({term:e,to:t})=>{let n;if(e){for(let t=0;t<s.length;t++)s[t][0]==e&&(n=s[t][1]);L(l,t).forEach(t=>{n||s.push([e,n=[]]),-1==n.indexOf(t)&&n.push(t)})}})});let r=n[t.join(",")]=new A(t.indexOf(l.length-1)>-1);for(let t=0;t<s.length;t++){let l=s[t][1].sort(z);r.next.push({type:s[t][0],next:n[l.join(",")]||e(l)})}return r}(L(l,0)));return function(e,t){for(let s=0,l=[e];s<l.length;s++){let e=l[s],n=!e.validEnd,r=[];for(let t=0;t<e.next.length;t++){let{type:s,next:a}=e.next[t];r.push(s.name),n&&!(s.isText||s.hasRequiredAttrs())&&(n=!1),-1==l.indexOf(a)&&l.push(a)}n&&t.err("Only non-generatable nodes ("+r.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,s=e.childCount){let l=this;for(let n=t;l&&n<s;n++)l=l.matchType(e.child(n).type);return l}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let s=0;s<e.next.length;s++)if(this.next[t].type==e.next[s].type)return!0;return!1}fillBefore(e,t=!1,s=0){let l=[this];return function n(r,a){let i=r.matchFragment(e,s);if(i&&(!t||i.validEnd))return f.from(a.map(e=>e.createAndFill()));for(let e=0;e<r.next.length;e++){let{type:t,next:s}=r.next[e];if(!(t.isText||t.hasRequiredAttrs())&&-1==l.indexOf(s)){l.push(s);let e=n(s,a.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),s=[{match:this,type:null,via:null}];for(;s.length;){let l=s.shift(),n=l.match;if(n.matchType(e)){let e=[];for(let t=l;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<n.next.length;e++){let{type:r,next:a}=n.next[e];r.isLeaf||r.hasRequiredAttrs()||r.name in t||l.type&&!a.validEnd||(s.push({match:r.contentMatch,type:r,via:l}),t[r.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function t(s){e.push(s);for(let l=0;l<s.next.length;l++)-1==e.indexOf(s.next[l].next)&&t(s.next[l].next)}(this),e.map((t,s)=>{let l=s+(t.validEnd?"*":" ")+" ";for(let s=0;s<t.next.length;s++)l+=(s?", ":"")+t.next[s].type.name+"->"+e.indexOf(t.next[s].next);return l}).join(`
`)}};A.empty=new A(!0);var D=class{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw SyntaxError(e+" (in content expression '"+this.string+"')")}};function M(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function z(e,t){return t-e}function L(e,t){let s=[];return function t(l){let n=e[l];if(1==n.length&&!n[0].term)return t(n[0].to);s.push(l);for(let e=0;e<n.length;e++){let{term:l,to:r}=n[e];l||-1!=s.indexOf(r)||t(r)}}(t),s.sort(z)}var Z=class e{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(e=>{e.tag?this.tags.push(e):e.style&&this.styles.push(e)}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let s=e.nodes[t.node];return s.contentMatch.matchType(s)})}parse(e,t={}){let s=new K(this,t,!1);return s.addAll(e,t.from,t.to),s.finish()}parseSlice(e,t={}){let s=new K(this,t,!0);return s.addAll(e,t.from,t.to),w.maxOpen(s.finish())}matchTag(e,t,s){for(let n=s?this.tags.indexOf(s)+1:0;n<this.tags.length;n++){var l;let s=this.tags[n];if(l=s.tag,(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,l)&&(void 0===s.namespace||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let t=s.getAttrs(e);if(!1===t)continue;s.attrs=t||void 0}return s}}}matchStyle(e,t,s,l){for(let n=l?this.styles.indexOf(l)+1:0;n<this.styles.length;n++){let l=this.styles[n],r=l.style;if(!(0!=r.indexOf(e)||l.context&&!s.matchesContext(l.context)||r.length>e.length&&(61!=r.charCodeAt(e.length)||r.slice(e.length+1)!=t))){if(l.getAttrs){let e=l.getAttrs(t);if(!1===e)continue;l.attrs=e||void 0}return l}}}static schemaRules(e){let t=[];function s(e){let s=null==e.priority?50:e.priority,l=0;for(;l<t.length;l++){let e=t[l];if((null==e.priority?50:e.priority)<s)break}t.splice(l,0,e)}for(let t in e.marks){let l=e.marks[t].spec.parseDOM;l&&l.forEach(e=>{s(e=Y(e)),e.mark||e.ignore||e.clearMark||(e.mark=t)})}for(let t in e.nodes){let l=e.nodes[t].spec.parseDOM;l&&l.forEach(e=>{s(e=Y(e)),e.node||e.ignore||e.mark||(e.node=t)})}return t}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new e(t,e.schemaRules(t)))}},q={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},B={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},U={ol:!0,ul:!0};function V(e,t,s){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&s}var W=class{constructor(e,t,s,l,n,r,a){this.type=e,this.attrs=t,this.marks=s,this.pendingMarks=l,this.solid=n,this.options=a,this.content=[],this.activeMarks=b.none,this.stashMarks=[],this.match=r||(4&a?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(f.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let t=this.type.contentMatch,s;return(s=t.findWrapping(e.type))?(this.match=t,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e=this.content[this.content.length-1],t;e&&e.isText&&(t=/[ \t\r\n\u000c]+$/.exec(e.text))&&(e.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=e.withText(e.text.slice(0,e.text.length-t[0].length)))}let t=f.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(f.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,s=this.pendingMarks;t<s.length;t++){let l=s[t];(this.type?this.type.allowsMarkType(l.type):function(e,t){let s=t.schema.nodes;for(let l in s){let n=s[l];if(!n.allowsMarkType(e))continue;let r=[],a=e=>{r.push(e);for(let s=0;s<e.edgeCount;s++){let{type:l,next:n}=e.edge(s);if(l==t||0>r.indexOf(n)&&a(n))return!0}};if(a(n.contentMatch))return!0}}(l.type,e))&&!l.isInSet(this.activeMarks)&&(this.activeMarks=l.addToSet(this.activeMarks),this.pendingMarks=l.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!q.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}},K=class{constructor(e,t,s){this.parser=e,this.options=t,this.isOpen=s,this.open=0;let l=t.topNode,n,r=V(null,t.preserveWhitespace,0)|(s?4:0);n=l?new W(l.type,l.attrs,b.none,b.none,!0,t.topMatch||l.type.contentMatch,r):s?new W(null,null,b.none,b.none,!0,null,r):new W(e.schema.topNodeType,null,b.none,b.none,!0,null,r),this.nodes=[n],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){3==e.nodeType?this.addTextNode(e):1==e.nodeType&&this.addElement(e)}withStyleRules(e,t){let s=e.getAttribute("style");if(!s)return t();let l=this.readStyles(function(e){let t=/\s*([\w-]+)\s*:\s*([^;]+)/g,s,l=[];for(;s=t.exec(e);)l.push(s[1],s[2].trim());return l}(s));if(!l)return;let[n,r]=l,a=this.top;for(let e=0;e<r.length;e++)this.removePendingMark(r[e],a);for(let e=0;e<n.length;e++)this.addPendingMark(n[e]);t();for(let e=0;e<n.length;e++)this.removePendingMark(n[e],a);for(let e=0;e<r.length;e++)this.addPendingMark(r[e])}addTextNode(e){let t=e.nodeValue,s=this.top;if(2&s.options||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(1&s.options)t=2&s.options?t.replace(/\r\n?/g,`
`):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let l=s.content[s.content.length-1],n=e.previousSibling;(!l||n&&"BR"==n.nodeName||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let s=e.nodeName.toLowerCase(),l;U.hasOwnProperty(s)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,s=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&U.hasOwnProperty(e)&&s?(s.appendChild(t),t=s):"li"==e?s=t:e&&(s=null)}}(e);let n=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,t));if(n?n.ignore:B.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e);else if(!n||n.skip||n.closeParent){n&&n.closeParent?this.open=Math.max(0,this.open-1):n&&n.skip.nodeType&&(e=n.skip);let t,l=this.top,r=this.needsBlock;if(q.hasOwnProperty(s))l.content.length&&l.content[0].isInline&&this.open&&(this.open--,l=this.top),t=!0,l.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}n&&n.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),t&&this.sync(l),this.needsBlock=r}else this.withStyleRules(e,()=>{this.addElementByRule(e,n,!1===n.consuming?l:void 0)})}leafFallback(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=b.none,s=b.none;for(let l=0;l<e.length;l+=2)for(let n;;){let r=this.parser.matchStyle(e[l],e[l+1],this,n);if(!r)break;if(r.ignore)return null;if(r.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(e=>{r.clearMark(e)&&(s=e.addToSet(s))}):t=this.parser.schema.marks[r.mark].create(r.attrs).addToSet(t),!1===r.consuming)n=r;else break}return[t,s]}addElementByRule(e,t,s){let l,n,r;t.node?(n=this.parser.schema.nodes[t.node]).isLeaf?this.insertNode(n.create(t.attrs))||this.leafFallback(e):l=this.enter(n,t.attrs||null,t.preserveWhitespace):(r=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(r));let a=this.top;if(n&&n.isLeaf)this.findInside(e);else if(s)this.addElement(e,s);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e));else{let s=e;"string"==typeof t.contentElement?s=e.querySelector(t.contentElement):"function"==typeof t.contentElement?s=t.contentElement(e):t.contentElement&&(s=t.contentElement),this.findAround(e,s,!0),this.addAll(s)}l&&this.sync(a)&&this.open--,r&&this.removePendingMark(r,a)}addAll(e,t,s){let l=t||0;for(let n=t?e.childNodes[t]:e.firstChild,r=null==s?null:e.childNodes[s];n!=r;n=n.nextSibling,++l)this.findAtPoint(e,l),this.addDOM(n);this.findAtPoint(e,l)}findPlace(e){let t,s;for(let l=this.open;l>=0;l--){let n=this.nodes[l],r=n.findWrapping(e);if(r&&(!t||t.length>r.length)&&(t=r,s=n,!r.length)||n.solid)break}if(!t)return!1;this.sync(s);for(let e=0;e<t.length;e++)this.enterInner(t[e],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let s=t.activeMarks;for(let l=0;l<e.marks.length;l++)(!t.type||t.type.allowsMarkType(e.marks[l].type))&&(s=e.marks[l].addToSet(s));return t.content.push(e.mark(s)),!0}return!1}enter(e,t,s){let l=this.findPlace(e.create(t));return l&&this.enterInner(e,t,!0,s),l}enterInner(e,t=null,s=!1,l){this.closeExtra();let n=this.top;n.applyPending(e),n.match=n.match&&n.match.matchType(e);let r=V(e,l,n.options);4&n.options&&0==n.content.length&&(r|=4),this.nodes.push(new W(e,t,n.activeMarks,n.pendingMarks,s,null,r)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let s=this.nodes[t].content;for(let t=s.length-1;t>=0;t--)e+=s[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let s=0;s<this.find.length;s++)this.find[s].node==e&&this.find[s].offset==t&&(this.find[s].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,s){if(e!=t&&this.find)for(let l=0;l<this.find.length;l++)null==this.find[l].pos&&1==e.nodeType&&e.contains(this.find[l].node)&&t.compareDocumentPosition(this.find[l].node)&(s?2:4)&&(this.find[l].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),s=this.options.context,l=!this.isOpen&&(!s||s.parent.type==this.nodes[0].type),n=-(s?s.depth+1:0)+(l?0:1),r=(e,a)=>{for(;e>=0;e--){let i=t[e];if(""==i){if(e==t.length-1||0==e)continue;for(;a>=n;a--)if(r(e-1,a))return!0;return!1}{let e=a>0||0==a&&l?this.nodes[a].type:s&&a>=n?s.node(a-n).type:null;if(!e||e.name!=i&&-1==e.groups.indexOf(i))return!1;a--}}return!0};return r(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(s&&s.isTextblock&&s.defaultAttrs)return s}for(let e in this.parser.schema.nodes){let t=this.parser.schema.nodes[e];if(t.isTextblock&&t.defaultAttrs)return t}}addPendingMark(e){let t=function(e,t){for(let s=0;s<t.length;s++)if(e.eq(t[s]))return t[s]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let s=this.open;s>=0;s--){let l=this.nodes[s];if(l.pendingMarks.lastIndexOf(e)>-1)l.pendingMarks=e.removeFromSet(l.pendingMarks);else{l.activeMarks=e.removeFromSet(l.activeMarks);let t=l.popFromStashMark(e);t&&l.type&&l.type.allowsMarkType(t.type)&&(l.activeMarks=t.addToSet(l.activeMarks))}if(l==t)break}}};function Y(e){let t={};for(let s in e)t[s]=e[s];return t}var J=class{constructor(e,t,s){this.pos=e,this.delInfo=t,this.recover=s}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}},H=class e{constructor(t,s=!1){if(this.ranges=t,this.inverted=s,!t.length&&e.empty)return e.empty}recover(e){let t=0,s=65535&e;if(!this.inverted)for(let e=0;e<s;e++)t+=this.ranges[3*e+2]-this.ranges[3*e+1];return this.ranges[3*s]+t+(e-(65535&e))/65536}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,s){let l=0,n=this.inverted?2:1,r=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let i=this.ranges[a]-(this.inverted?l:0);if(i>e)break;let o=this.ranges[a+n],c=this.ranges[a+r],d=i+o;if(e<=d){let n=o?e==i?-1:e==d?1:t:t,r=i+l+(n<0?0:c);if(s)return r;let u=e==(t<0?i:d)?null:a/3+(e-i)*65536,m=e==i?2:e==d?1:4;return(t<0?e!=i:e!=d)&&(m|=8),new J(r,m,u)}l+=c-o}return s?e+l:new J(e+l,0,null)}touches(e,t){let s=0,l=65535&t,n=this.inverted?2:1,r=this.inverted?1:2;for(let t=0;t<this.ranges.length;t+=3){let a=this.ranges[t]-(this.inverted?s:0);if(a>e)break;let i=this.ranges[t+n];if(e<=a+i&&t==3*l)return!0;s+=this.ranges[t+r]-i}return!1}forEach(e){let t=this.inverted?2:1,s=this.inverted?1:2;for(let l=0,n=0;l<this.ranges.length;l+=3){let r=this.ranges[l],a=r-(this.inverted?n:0),i=r+(this.inverted?0:n),o=this.ranges[l+t],c=this.ranges[l+s];e(a,a+o,i,i+c),n+=c-o}}invert(){return new e(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return 0==t?e.empty:new e(t<0?[0,-t,0]:[0,0,t])}};H.empty=new H([]);var Q=Object.create(null),G=class{getMap(){return H.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw RangeError("Invalid input for Step.fromJSON");let s=Q[t.stepType];if(!s)throw RangeError(`No step type ${t.stepType} defined`);return s.fromJSON(e,t)}static jsonID(e,t){if(e in Q)throw RangeError("Duplicate use of step JSON ID "+e);return Q[e]=t,t.prototype.jsonID=e,t}},$=class e{constructor(e,t){this.doc=e,this.failed=t}static ok(t){return new e(t,null)}static fail(t){return new e(null,t)}static fromReplace(t,s,l,n){try{return e.ok(t.replace(s,l,n))}catch(t){if(t instanceof y)return e.fail(t.message);throw t}}};function X(e,t,s){let l=[];for(let n=0;n<e.childCount;n++){let r=e.child(n);r.content.size&&(r=r.copy(X(r.content,t,r))),r.isInline&&(r=t(r,s,n)),l.push(r)}return f.fromArray(l)}var ee=class e extends G{constructor(e,t,s){super(),this.from=e,this.to=t,this.mark=s}apply(e){let t=e.slice(this.from,this.to),s=e.resolve(this.from),l=s.node(s.sharedDepth(this.to)),n=new w(X(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,l),t.openStart,t.openEnd);return $.fromReplace(e,this.from,this.to,n)}invert(){return new et(this.from,this.to,this.mark)}map(t){let s=t.mapResult(this.from,1),l=t.mapResult(this.to,-1);return s.deleted&&l.deleted||s.pos>=l.pos?null:new e(s.pos,l.pos,this.mark)}merge(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,s){if("number"!=typeof s.from||"number"!=typeof s.to)throw RangeError("Invalid input for AddMarkStep.fromJSON");return new e(s.from,s.to,t.markFromJSON(s.mark))}};G.jsonID("addMark",ee);var et=class e extends G{constructor(e,t,s){super(),this.from=e,this.to=t,this.mark=s}apply(e){let t=e.slice(this.from,this.to),s=new w(X(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return $.fromReplace(e,this.from,this.to,s)}invert(){return new ee(this.from,this.to,this.mark)}map(t){let s=t.mapResult(this.from,1),l=t.mapResult(this.to,-1);return s.deleted&&l.deleted||s.pos>=l.pos?null:new e(s.pos,l.pos,this.mark)}merge(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,s){if("number"!=typeof s.from||"number"!=typeof s.to)throw RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(s.from,s.to,t.markFromJSON(s.mark))}};G.jsonID("removeMark",et);var es=class e extends G{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return $.fail("No node at mark step's position");let s=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return $.fromReplace(e,this.pos,this.pos+1,new w(f.from(s),0,t.isLeaf?0:1))}invert(t){let s=t.nodeAt(this.pos);if(s){let t=this.mark.addToSet(s.marks);if(t.length==s.marks.length){for(let l=0;l<s.marks.length;l++)if(!s.marks[l].isInSet(t))return new e(this.pos,s.marks[l]);return new e(this.pos,this.mark)}}return new el(this.pos,this.mark)}map(t){let s=t.mapResult(this.pos,1);return s.deletedAfter?null:new e(s.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,s){if("number"!=typeof s.pos)throw RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new e(s.pos,t.markFromJSON(s.mark))}};G.jsonID("addNodeMark",es);var el=class e extends G{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return $.fail("No node at mark step's position");let s=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return $.fromReplace(e,this.pos,this.pos+1,new w(f.from(s),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new es(this.pos,this.mark):this}map(t){let s=t.mapResult(this.pos,1);return s.deletedAfter?null:new e(s.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,s){if("number"!=typeof s.pos)throw RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new e(s.pos,t.markFromJSON(s.mark))}};G.jsonID("removeNodeMark",el);var en=class e extends G{constructor(e,t,s,l=!1){super(),this.from=e,this.to=t,this.slice=s,this.structure=l}apply(e){return this.structure&&ea(e,this.from,this.to)?$.fail("Structure replace would overwrite content"):$.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new H([this.from,this.to-this.from,this.slice.size])}invert(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let s=t.mapResult(this.from,1),l=t.mapResult(this.to,-1);return s.deletedAcross&&l.deletedAcross?null:new e(s.pos,Math.max(s.pos,l.pos),this.slice)}merge(t){if(!(t instanceof e)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;{let s=this.slice.size+t.slice.size==0?w.empty:new w(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,s,this.structure)}}{let s=this.slice.size+t.slice.size==0?w.empty:new w(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),s,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(t,s){if("number"!=typeof s.from||"number"!=typeof s.to)throw RangeError("Invalid input for ReplaceStep.fromJSON");return new e(s.from,s.to,w.fromJSON(t,s.slice),!!s.structure)}};G.jsonID("replace",en);var er=class e extends G{constructor(e,t,s,l,n,r,a=!1){super(),this.from=e,this.to=t,this.gapFrom=s,this.gapTo=l,this.slice=n,this.insert=r,this.structure=a}apply(e){if(this.structure&&(ea(e,this.from,this.gapFrom)||ea(e,this.gapTo,this.to)))return $.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return $.fail("Gap is not a flat range");let s=this.slice.insertAt(this.insert,t.content);return s?$.fromReplace(e,this.from,this.to,s):$.fail("Content does not fit in gap")}getMap(){return new H([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let s=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+s,this.from+this.insert,this.from+this.insert+s,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let s=t.mapResult(this.from,1),l=t.mapResult(this.to,-1),n=t.map(this.gapFrom,-1),r=t.map(this.gapTo,1);return s.deletedAcross&&l.deletedAcross||n<s.pos||r>l.pos?null:new e(s.pos,l.pos,n,r,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(t,s){if("number"!=typeof s.from||"number"!=typeof s.to||"number"!=typeof s.gapFrom||"number"!=typeof s.gapTo||"number"!=typeof s.insert)throw RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(s.from,s.to,s.gapFrom,s.gapTo,w.fromJSON(t,s.slice),s.insert,!!s.structure)}};function ea(e,t,s){let l=e.resolve(t),n=s-t,r=l.depth;for(;n>0&&r>0&&l.indexAfter(r)==l.node(r).childCount;)r--,n--;if(n>0){let e=l.node(r).maybeChild(l.indexAfter(r));for(;n>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,n--}}return!1}function ei(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let s=e.depth;;--s){let l=e.$from.node(s),n=e.$from.index(s),r=e.$to.indexAfter(s);if(s<e.depth&&l.canReplace(n,r,t))return s;if(0==s||l.type.spec.isolating||!((0==n||l.canReplace(n,l.childCount))&&(r==l.childCount||l.canReplace(0,r))))break}return null}function eo(e,t,s=null,l=e){let n=function(e,t){let{parent:s,startIndex:l,endIndex:n}=e,r=s.contentMatchAt(l).findWrapping(t);if(!r)return null;let a=r.length?r[0]:t;return s.canReplaceWith(l,n,a)?r:null}(e,t),r=n&&function(e,t){let{parent:s,startIndex:l,endIndex:n}=e,r=s.child(l),a=t.contentMatch.findWrapping(r.type);if(!a)return null;let i=(a.length?a[a.length-1]:t).contentMatch;for(let e=l;i&&e<n;e++)i=i.matchType(s.child(e).type);return i&&i.validEnd?a:null}(l,t);return r?n.map(ec).concat({type:t,attrs:s}).concat(r.map(ec)):null}function ec(e){return{type:e,attrs:null}}function ed(e,t,s=1,l){let n=e.resolve(t),r=n.depth-s,a=l&&l[l.length-1]||n.parent;if(r<0||n.parent.type.spec.isolating||!n.parent.canReplace(n.index(),n.parent.childCount)||!a.type.validContent(n.parent.content.cutByIndex(n.index(),n.parent.childCount)))return!1;for(let e=n.depth-1,t=s-2;e>r;e--,t--){let s=n.node(e),r=n.index(e);if(s.type.spec.isolating)return!1;let a=s.content.cutByIndex(r,s.childCount),i=l&&l[t+1];i&&(a=a.replaceChild(0,i.type.create(i.attrs)));let o=l&&l[t]||s;if(!s.canReplace(r+1,s.childCount)||!o.type.validContent(a))return!1}let i=n.indexAfter(r),o=l&&l[0];return n.node(r).canReplaceWith(i,i,o?o.type:n.node(r+1).type)}function eu(e,t){let s=e.resolve(t),l=s.index();return em(s.nodeBefore,s.nodeAfter)&&s.parent.canReplace(l,l+1)}function em(e,t){return!!(e&&t&&!e.isLeaf&&e.canAppend(t))}function eh(e,t,s=-1){let l=e.resolve(t);for(let e=l.depth;;e--){let n,r,a=l.index(e);if(e==l.depth?(n=l.nodeBefore,r=l.nodeAfter):s>0?(n=l.node(e+1),a++,r=l.node(e).maybeChild(a)):(n=l.node(e).maybeChild(a-1),r=l.node(e+1)),n&&!n.isTextblock&&em(n,r)&&l.node(e).canReplace(a,a+1))return t;if(0==e)break;t=s<0?l.before(e):l.after(e)}}function ep(e,t,s=t,l=w.empty){if(t==s&&!l.size)return null;let n=e.resolve(t),r=e.resolve(s);return!l.openStart&&!l.openEnd&&n.start()==r.start()&&n.parent.canReplace(n.index(),r.index(),l.content)?new en(t,s,l):new ex(n,r,l).fit()}G.jsonID("replaceAround",er);var ex=class{constructor(e,t,s){this.$from=e,this.$to=t,this.unplaced=s,this.frontier=[],this.placed=f.empty;for(let t=0;t<=e.depth;t++){let s=e.node(t);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(t))})}for(let t=e.depth;t>0;t--)this.placed=f.from(e.node(t).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,s=this.$from,l=this.close(e<0?this.$to:s.doc.resolve(e));if(!l)return null;let n=this.placed,r=s.depth,a=l.depth;for(;r&&a&&1==n.childCount;)n=n.firstChild.content,r--,a--;let i=new w(n,r,a);return e>-1?new er(s.pos,e,this.$to.pos,this.$to.end(),i,t):i.size||s.pos!=this.$to.pos?new en(s.pos,l.pos,i):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,s=0,l=this.unplaced.openEnd;s<e;s++){let n=t.firstChild;if(t.childCount>1&&(l=0),n.type.spec.isolating&&l<=s){e=s;break}t=n.content}for(let t=1;t<=2;t++)for(let s=1==t?e:this.unplaced.openStart;s>=0;s--){let e=null,l=(s?(e=eg(this.unplaced.content,s-1).firstChild).content:this.unplaced.content).firstChild;for(let n=this.depth;n>=0;n--){let{type:r,match:a}=this.frontier[n],i,o=null;if(1==t&&(l?a.matchType(l.type)||(o=a.fillBefore(f.from(l),!1)):e&&r.compatibleContent(e.type)))return{sliceDepth:s,frontierDepth:n,parent:e,inject:o};if(2==t&&l&&(i=a.findWrapping(l.type)))return{sliceDepth:s,frontierDepth:n,parent:e,wrap:i};if(e&&a.matchType(e.type))break}}}openMore(){let{content:e,openStart:t,openEnd:s}=this.unplaced,l=eg(e,t);return!!l.childCount&&!l.firstChild.isLeaf&&(this.unplaced=new w(e,t+1,Math.max(s,l.size+t>=e.size-s?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:s}=this.unplaced,l=eg(e,t);if(l.childCount<=1&&t>0){let n=e.size-t<=t+l.size;this.unplaced=new w(ef(e,t-1,1),t-1,n?t-1:s)}else this.unplaced=new w(ef(e,t,1),t,s)}placeNodes({sliceDepth:e,frontierDepth:t,parent:s,inject:l,wrap:n}){for(;this.depth>t;)this.closeFrontierNode();if(n)for(let e=0;e<n.length;e++)this.openFrontierNode(n[e]);let r=this.unplaced,a=s?s.content:r.content,i=r.openStart-e,o=0,c=[],{match:d,type:u}=this.frontier[t];if(l){for(let e=0;e<l.childCount;e++)c.push(l.child(e));d=d.matchFragment(l)}let m=a.size+e-(r.content.size-r.openEnd);for(;o<a.childCount;){let e=a.child(o),t=d.matchType(e.type);if(!t)break;(++o>1||0==i||e.content.size)&&(d=t,c.push(function e(t,s,l){if(s<=0)return t;let n=t.content;return s>1&&(n=n.replaceChild(0,e(n.firstChild,s-1,1==n.childCount?l-1:0))),s>0&&(n=t.type.contentMatch.fillBefore(n).append(n),l<=0&&(n=n.append(t.type.contentMatch.matchFragment(n).fillBefore(f.empty,!0)))),t.copy(n)}(e.mark(u.allowedMarks(e.marks)),1==o?i:0,o==a.childCount?m:-1)))}let h=o==a.childCount;h||(m=-1),this.placed=ev(this.placed,t,f.from(c)),this.frontier[t].match=d,h&&m<0&&s&&s.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let e=0,t=a;e<m;e++){let e=t.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),t=e.content}this.unplaced=h?0==e?w.empty:new w(ef(r.content,e-1,1),e-1,m<0?r.openEnd:e-1):new w(ef(r.content,e,o),r.openStart,r.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return -1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!ej(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return -1;let{depth:s}=this.$to,l=this.$to.after(s);for(;s>1&&l==this.$to.end(--s);)++l;return l}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:s,type:l}=this.frontier[t],n=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),r=ej(e,t,l,s,n);if(r){for(let s=t-1;s>=0;s--){let{match:t,type:l}=this.frontier[s],n=ej(e,s,l,t,!0);if(!n||n.childCount)continue e}return{depth:t,fit:r,move:n?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=ev(this.placed,t.depth,t.fit)),e=t.move;for(let s=t.depth+1;s<=e.depth;s++){let t=e.node(s),l=t.type.contentMatch.fillBefore(t.content,!0,e.index(s));this.openFrontierNode(t.type,t.attrs,l)}return e}openFrontierNode(e,t=null,s){let l=this.frontier[this.depth];l.match=l.match.matchType(e),this.placed=ev(this.placed,this.depth,f.from(e.create(t,s))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(f.empty,!0);e.childCount&&(this.placed=ev(this.placed,this.frontier.length,e))}};function ef(e,t,s){return 0==t?e.cutByIndex(s,e.childCount):e.replaceChild(0,e.firstChild.copy(ef(e.firstChild.content,t-1,s)))}function ev(e,t,s){return 0==t?e.append(s):e.replaceChild(e.childCount-1,e.lastChild.copy(ev(e.lastChild.content,t-1,s)))}function eg(e,t){for(let s=0;s<t;s++)e=e.firstChild.content;return e}function ej(e,t,s,l,n){let r=e.node(t),a=n?e.indexAfter(t):e.index(t);if(a==r.childCount&&!s.compatibleContent(r.type))return null;let i=l.fillBefore(r.content,!0,a);return i&&!function(e,t,s){for(let l=s;l<t.childCount;l++)if(!e.allowsMarks(t.child(l).marks))return!0;return!1}(s,r.content,a)?i:null}var eb=class e extends G{constructor(e,t,s){super(),this.pos=e,this.attr=t,this.value=s}apply(e){let t=e.nodeAt(this.pos);if(!t)return $.fail("No node at attribute step's position");let s=Object.create(null);for(let e in t.attrs)s[e]=t.attrs[e];s[this.attr]=this.value;let l=t.type.create(s,null,t.marks);return $.fromReplace(e,this.pos,this.pos+1,new w(f.from(l),0,t.isLeaf?0:1))}getMap(){return H.empty}invert(t){return new e(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let s=t.mapResult(this.pos,1);return s.deletedAfter?null:new e(s.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,s){if("number"!=typeof s.pos||"string"!=typeof s.attr)throw RangeError("Invalid input for AttrStep.fromJSON");return new e(s.pos,s.attr,s.value)}};G.jsonID("attr",eb);var ey=class e extends G{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let s=e.type.create(t,e.content,e.marks);return $.ok(s)}getMap(){return H.empty}invert(t){return new e(this.attr,t.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,s){if("string"!=typeof s.attr)throw RangeError("Invalid input for DocAttrStep.fromJSON");return new e(s.attr,s.value)}};G.jsonID("docAttr",ey);var ew=class extends Error{};(ew=function e(t){let s=Error.call(this,t);return s.__proto__=e.prototype,s}).prototype=Object.create(Error.prototype),ew.prototype.constructor=ew,ew.prototype.name="TransformError";var eN=Object.create(null),ek=class{constructor(e,t,s){this.$anchor=e,this.$head=t,this.ranges=s||[new eC(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=w.empty){let s=t.content.lastChild,l=null;for(let e=0;e<t.openEnd;e++)l=s,s=s.lastChild;let n=e.steps.length,r=this.ranges;for(let a=0;a<r.length;a++){let{$from:i,$to:o}=r[a],c=e.mapping.slice(n);e.replaceRange(c.map(i.pos),c.map(o.pos),a?w.empty:t),0==a&&eA(e,n,(s?s.isInline:l&&l.isTextblock)?-1:1)}}replaceWith(e,t){let s=e.steps.length,l=this.ranges;for(let n=0;n<l.length;n++){let{$from:r,$to:a}=l[n],i=e.mapping.slice(s),o=i.map(r.pos),c=i.map(a.pos);n?e.deleteRange(o,c):(e.replaceRangeWith(o,c,t),eA(e,s,t.isInline?-1:1))}}static findFrom(e,t,s=!1){let l=e.parent.inlineContent?new eI(e):eT(e.node(0),e.parent,e.pos,e.index(),t,s);if(l)return l;for(let l=e.depth-1;l>=0;l--){let n=t<0?eT(e.node(0),e.node(l),e.before(l+1),e.index(l),t,s):eT(e.node(0),e.node(l),e.after(l+1),e.index(l)+1,t,s);if(n)return n}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new eF(e.node(0))}static atStart(e){return eT(e,e,0,0,1)||new eF(e)}static atEnd(e){return eT(e,e,e.content.size,e.childCount,-1)||new eF(e)}static fromJSON(e,t){if(!t||!t.type)throw RangeError("Invalid input for Selection.fromJSON");let s=eN[t.type];if(!s)throw RangeError(`No selection type ${t.type} defined`);return s.fromJSON(e,t)}static jsonID(e,t){if(e in eN)throw RangeError("Duplicate use of selection JSON ID "+e);return eN[e]=t,t.prototype.jsonID=e,t}getBookmark(){return eI.between(this.$anchor,this.$head).getBookmark()}};ek.prototype.visible=!0;var eC=class{constructor(e,t){this.$from=e,this.$to=t}},eS=!1;function e_(e){eS||e.parent.inlineContent||(eS=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}var eI=class e extends ek{constructor(e,t=e){e_(e),e_(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,s){let l=t.resolve(s.map(this.head));if(!l.parent.inlineContent)return ek.near(l);let n=t.resolve(s.map(this.anchor));return new e(n.parent.inlineContent?n:l,l)}replace(e,t=w.empty){if(super.replace(e,t),t==w.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new eE(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,s){if("number"!=typeof s.anchor||"number"!=typeof s.head)throw RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(s.anchor),t.resolve(s.head))}static create(e,t,s=t){let l=e.resolve(t);return new this(l,s==t?l:e.resolve(s))}static between(t,s,l){let n=t.pos-s.pos;if((!l||n)&&(l=n>=0?1:-1),!s.parent.inlineContent){let e=ek.findFrom(s,l,!0)||ek.findFrom(s,-l,!0);if(!e)return ek.near(s,l);s=e.$head}return t.parent.inlineContent||(0==n?t=s:(t=(ek.findFrom(t,-l,!0)||ek.findFrom(t,l,!0)).$anchor).pos<s.pos!=n<0&&(t=s)),new e(t,s)}};ek.jsonID("text",eI);var eE=class e{constructor(e,t){this.anchor=e,this.head=t}map(t){return new e(t.map(this.anchor),t.map(this.head))}resolve(e){return eI.between(e.resolve(this.anchor),e.resolve(this.head))}},eP=class e extends ek{constructor(e){let t=e.nodeAfter;super(e,e.node(0).resolve(e.pos+t.nodeSize)),this.node=t}map(t,s){let{deleted:l,pos:n}=s.mapResult(this.anchor),r=t.resolve(n);return l?ek.near(r):new e(r)}content(){return new w(f.from(this.node),0,0)}eq(t){return t instanceof e&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new eR(this.anchor)}static fromJSON(t,s){if("number"!=typeof s.anchor)throw RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(s.anchor))}static create(t,s){return new e(t.resolve(s))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}};eP.prototype.visible=!1,ek.jsonID("node",eP);var eR=class e{constructor(e){this.anchor=e}map(t){let{deleted:s,pos:l}=t.mapResult(this.anchor);return s?new eE(l,l):new e(l)}resolve(e){let t=e.resolve(this.anchor),s=t.nodeAfter;return s&&eP.isSelectable(s)?new eP(t):ek.near(t)}},eF=class e extends ek{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=w.empty){if(t==w.empty){e.delete(0,e.doc.content.size);let t=ek.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(t){return new e(t)}map(t){return new e(t)}eq(t){return t instanceof e}getBookmark(){return eO}};ek.jsonID("all",eF);var eO={map(){return this},resolve:e=>new eF(e)};function eT(e,t,s,l,n,r=!1){if(t.inlineContent)return eI.create(e,s);for(let a=l-(n>0?0:1);n>0?a<t.childCount:a>=0;a+=n){let l=t.child(a);if(l.isAtom){if(!r&&eP.isSelectable(l))return eP.create(e,s-(n<0?l.nodeSize:0))}else{let t=eT(e,l,s+n,n<0?l.childCount:0,n,r);if(t)return t}s+=l.nodeSize*n}return null}function eA(e,t,s){let l,n=e.steps.length-1;if(n<t)return;let r=e.steps[n];(r instanceof en||r instanceof er)&&(e.mapping.maps[n].forEach((e,t,s,n)=>{null==l&&(l=n)}),e.setSelection(ek.near(e.doc.resolve(l),s)))}function eD(e,t){return t&&e?e.bind(t):e}var eM=class{constructor(e,t,s){this.name=e,this.init=eD(t.init,s),this.apply=eD(t.apply,s)}};new eM("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new eM("selection",{init:(e,t)=>e.selection||ek.atStart(t.doc),apply:e=>e.selection}),new eM("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,s,l)=>l.selection.$cursor?e.storedMarks:null}),new eM("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t});var ez=class{constructor(e){this.spec=e,this.props={},e.props&&function e(t,s,l){for(let n in t){let r=t[n];r instanceof Function?r=r.bind(s):"handleDOMEvents"==n&&(r=e(r,s,{})),l[n]=r}return l}(e.props,this,this.props),this.key=e.key?e.key.key:eZ("plugin")}getState(e){return e[this.key]}},eL=Object.create(null);function eZ(e){return e in eL?e+"$"+ ++eL[e]:(eL[e]=0,e+"$")}var eq=class{constructor(e="key"){this.key=eZ(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}},eB=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0),eU=(e,t,s)=>{let l=function(e,t){let{$cursor:s}=e.selection;return s&&(t?t.endOfTextblock("backward",e):!(s.parentOffset>0))?s:null}(e,s);if(!l)return!1;let n=eK(l);if(!n){let s=l.blockRange(),n=s&&ei(s);return null!=n&&(t&&t(e.tr.lift(s,n).scrollIntoView()),!0)}let r=n.nodeBefore;if(!r.type.spec.isolating&&e4(e,n,t))return!0;if(0==l.parent.content.size&&(eV(r,"end")||eP.isSelectable(r))){let s=ep(e.doc,l.before(),l.after(),w.empty);if(s&&s.slice.size<s.to-s.from){if(t){let l=e.tr.step(s);l.setSelection(eV(r,"end")?ek.findFrom(l.doc.resolve(l.mapping.map(n.pos,-1)),-1):eP.create(l.doc,n.pos-r.nodeSize)),t(l.scrollIntoView())}return!0}}return!!r.isAtom&&n.depth==l.depth-1&&(t&&t(e.tr.delete(n.pos-r.nodeSize,n.pos).scrollIntoView()),!0)};function eV(e,t,s=!1){for(let l=e;l;l="start"==t?l.firstChild:l.lastChild){if(l.isTextblock)return!0;if(s&&1!=l.childCount)break}return!1}var eW=(e,t,s)=>{let{$head:l,empty:n}=e.selection,r=l;if(!n)return!1;if(l.parent.isTextblock){if(s?!s.endOfTextblock("backward",e):l.parentOffset>0)return!1;r=eK(l)}let a=r&&r.nodeBefore;return!!(a&&eP.isSelectable(a))&&(t&&t(e.tr.setSelection(eP.create(e.doc,r.pos-a.nodeSize)).scrollIntoView()),!0)};function eK(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}var eY=(e,t,s)=>{let l=function(e,t){let{$cursor:s}=e.selection;return s&&(t?t.endOfTextblock("forward",e):!(s.parentOffset<s.parent.content.size))?s:null}(e,s);if(!l)return!1;let n=eH(l);if(!n)return!1;let r=n.nodeAfter;if(e4(e,n,t))return!0;if(0==l.parent.content.size&&(eV(r,"start")||eP.isSelectable(r))){let s=ep(e.doc,l.before(),l.after(),w.empty);if(s&&s.slice.size<s.to-s.from){if(t){let l=e.tr.step(s);l.setSelection(eV(r,"start")?ek.findFrom(l.doc.resolve(l.mapping.map(n.pos)),1):eP.create(l.doc,l.mapping.map(n.pos))),t(l.scrollIntoView())}return!0}}return!!r.isAtom&&n.depth==l.depth-1&&(t&&t(e.tr.delete(n.pos,n.pos+r.nodeSize).scrollIntoView()),!0)},eJ=(e,t,s)=>{let{$head:l,empty:n}=e.selection,r=l;if(!n)return!1;if(l.parent.isTextblock){if(s?!s.endOfTextblock("forward",e):l.parentOffset<l.parent.content.size)return!1;r=eH(l)}let a=r&&r.nodeAfter;return!!(a&&eP.isSelectable(a))&&(t&&t(e.tr.setSelection(eP.create(e.doc,r.pos)).scrollIntoView()),!0)};function eH(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let s=e.node(t);if(e.index(t)+1<s.childCount)return e.doc.resolve(e.after(t+1));if(s.type.spec.isolating)break}return null}var eQ=(e,t)=>{let s=e.selection,l=s instanceof eP,n;if(l){if(s.node.isTextblock||!eu(e.doc,s.from))return!1;n=s.from}else if(null==(n=eh(e.doc,s.from,-1)))return!1;if(t){let s=e.tr.join(n);l&&s.setSelection(eP.create(s.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(s.scrollIntoView())}return!0},eG=(e,t)=>{let s=e.selection,l;if(s instanceof eP){if(s.node.isTextblock||!eu(e.doc,s.to))return!1;l=s.to}else if(null==(l=eh(e.doc,s.to,1)))return!1;return t&&t(e.tr.join(l).scrollIntoView()),!0},e$=(e,t)=>{let{$from:s,$to:l}=e.selection,n=s.blockRange(l),r=n&&ei(n);return null!=r&&(t&&t(e.tr.lift(n,r).scrollIntoView()),!0)},eX=(e,t)=>{let{$head:s,$anchor:l}=e.selection;return!!(s.parent.type.spec.code&&s.sameParent(l))&&(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function e0(e){for(let t=0;t<e.edgeCount;t++){let{type:s}=e.edge(t);if(s.isTextblock&&!s.hasRequiredAttrs())return s}return null}var e1=(e,t)=>{let{$head:s,$anchor:l}=e.selection;if(!s.parent.type.spec.code||!s.sameParent(l))return!1;let n=s.node(-1),r=s.indexAfter(-1),a=e0(n.contentMatchAt(r));if(!a||!n.canReplaceWith(r,r,a))return!1;if(t){let l=s.after(),n=e.tr.replaceWith(l,l,a.createAndFill());n.setSelection(ek.near(n.doc.resolve(l),1)),t(n.scrollIntoView())}return!0},e2=(e,t)=>{let s=e.selection,{$from:l,$to:n}=s;if(s instanceof eF||l.parent.inlineContent||n.parent.inlineContent)return!1;let r=e0(n.parent.contentMatchAt(n.indexAfter()));if(!r||!r.isTextblock)return!1;if(t){let s=(!l.parentOffset&&n.index()<n.parent.childCount?l:n).pos,a=e.tr.insert(s,r.createAndFill());a.setSelection(eI.create(a.doc,s+1)),t(a.scrollIntoView())}return!0},e5=(e,t)=>{let{$cursor:s}=e.selection;if(!s||s.parent.content.size)return!1;if(s.depth>1&&s.after()!=s.end(-1)){let l=s.before();if(ed(e.doc,l))return t&&t(e.tr.split(l).scrollIntoView()),!0}let l=s.blockRange(),n=l&&ei(l);return null!=n&&(t&&t(e.tr.lift(l,n).scrollIntoView()),!0)},e3=(e,t)=>{let{$from:s,to:l}=e.selection,n,r=s.sharedDepth(l);return 0!=r&&(n=s.before(r),t&&t(e.tr.setSelection(eP.create(e.doc,n))),!0)};function e4(e,t,s){let l,n,r,a=t.nodeBefore,i=t.nodeAfter,o,c;if(a.type.spec.isolating||i.type.spec.isolating)return!1;if(l=t.nodeBefore,n=t.nodeAfter,r=t.index(),l&&n&&l.type.compatibleContent(n.type)&&(!l.content.size&&t.parent.canReplace(r-1,r)?(s&&s(e.tr.delete(t.pos-l.nodeSize,t.pos).scrollIntoView()),!0):!!(t.parent.canReplace(r,r+1)&&(n.isTextblock||eu(e.doc,t.pos)))&&(s&&s(e.tr.clearIncompatible(t.pos,l.type,l.contentMatchAt(l.childCount)).join(t.pos).scrollIntoView()),!0)))return!0;let d=t.parent.canReplace(t.index(),t.index()+1);if(d&&(o=(c=a.contentMatchAt(a.childCount)).findWrapping(i.type))&&c.matchType(o[0]||i.type).validEnd){if(s){let l=t.pos+i.nodeSize,n=f.empty;for(let e=o.length-1;e>=0;e--)n=f.from(o[e].create(null,n));n=f.from(a.copy(n));let r=e.tr.step(new er(t.pos-1,l,t.pos,l,new w(n,1,0),o.length,!0)),c=l+2*o.length;eu(r.doc,c)&&r.join(c),s(r.scrollIntoView())}return!0}let u=ek.findFrom(t,1),m=u&&u.$from.blockRange(u.$to),h=m&&ei(m);if(null!=h&&h>=t.depth)return s&&s(e.tr.lift(m,h).scrollIntoView()),!0;if(d&&eV(i,"start",!0)&&eV(a,"end")){let l=a,n=[];for(;n.push(l),!l.isTextblock;)l=l.lastChild;let r=i,o=1;for(;!r.isTextblock;r=r.firstChild)o++;if(l.canReplace(l.childCount,l.childCount,r.content)){if(s){let l=f.empty;for(let e=n.length-1;e>=0;e--)l=f.from(n[e].copy(l));s(e.tr.step(new er(t.pos-n.length,t.pos+i.nodeSize,t.pos+o,t.pos+i.nodeSize-o,new w(l,n.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function e8(e){return function(t,s){let l=t.selection,n=e<0?l.$from:l.$to,r=n.depth;for(;n.node(r).isInline;){if(!r)return!1;r--}return!!n.node(r).isTextblock&&(s&&s(t.tr.setSelection(eI.create(t.doc,e<0?n.start(r):n.end(r)))),!0)}}var e6=e8(-1),e7=e8(1);function e9(e,t=null){return function(s,l){let n=!1;for(let l=0;l<s.selection.ranges.length&&!n;l++){let{$from:{pos:r},$to:{pos:a}}=s.selection.ranges[l];s.doc.nodesBetween(r,a,(l,r)=>{if(n)return!1;if(!(!l.isTextblock||l.hasMarkup(e,t))){if(l.type==e)n=!0;else{let t=s.doc.resolve(r),l=t.index();n=t.parent.canReplaceWith(l,l+1,e)}}})}if(!n)return!1;if(l){let n=s.tr;for(let l=0;l<s.selection.ranges.length;l++){let{$from:{pos:r},$to:{pos:a}}=s.selection.ranges[l];n.setBlockType(r,a,e,t)}l(n.scrollIntoView())}return!0}}function te(...e){return function(t,s,l){for(let n=0;n<e.length;n++)if(e[n](t,s,l))return!0;return!1}}var tt=te(eB,eU,eW),ts=te(eB,eY,eJ),tl={Enter:te(eX,e2,e5,(e,t)=>{let{$from:s,$to:n}=e.selection;if(e.selection instanceof eP&&e.selection.node.isBlock)return!!(s.parentOffset&&ed(e.doc,s.pos))&&(t&&t(e.tr.split(s.pos).scrollIntoView()),!0);if(!s.parent.isBlock)return!1;if(t){let r=n.parentOffset==n.parent.content.size,a=e.tr;(e.selection instanceof eI||e.selection instanceof eF)&&a.deleteSelection();let i=0==s.depth?null:e0(s.node(-1).contentMatchAt(s.indexAfter(-1))),o=l&&l(n.parent,r),c=o?[o]:r&&i?[{type:i}]:void 0,d=ed(a.doc,a.mapping.map(s.pos),1,c);if(!c&&!d&&ed(a.doc,a.mapping.map(s.pos),1,i?[{type:i}]:void 0)&&(i&&(c=[{type:i}]),d=!0),d&&(a.split(a.mapping.map(s.pos),1,c),!r&&!s.parentOffset&&s.parent.type!=i)){let e=a.mapping.map(s.before()),t=a.doc.resolve(e);i&&s.node(-1).canReplaceWith(t.index(),t.index()+1,i)&&a.setNodeMarkup(a.mapping.map(s.before()),i)}t(a.scrollIntoView())}return!0}),"Mod-Enter":e1,Backspace:tt,"Mod-Backspace":tt,"Shift-Backspace":tt,Delete:ts,"Mod-Delete":ts,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new eF(e.doc))),!0)},tn={"Ctrl-h":tl.Backspace,"Alt-Backspace":tl["Mod-Backspace"],"Ctrl-d":tl.Delete,"Ctrl-Alt-Backspace":tl["Mod-Delete"],"Alt-Delete":tl["Mod-Delete"],"Alt-d":tl["Mod-Delete"],"Ctrl-a":e6,"Ctrl-e":e7};for(let e in tl)tn[e]=tl[e];function tr(e){let{state:t,transaction:s}=e,{selection:l}=s,{doc:n}=s,{storedMarks:r}=s;return x(p({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return r},get selection(){return l},get doc(){return n},get tr(){return l=s.selection,n=s.doc,r=s.storedMarks,s}})}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();var ta=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:s}=this,{view:l}=t,{tr:n}=s,r=this.buildProps(n);return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,(...e)=>{let s=t(...e)(r);return n.getMeta("preventDispatch")||this.hasCustomState||l.dispatch(n),s}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:s,editor:l,state:n}=this,{view:r}=l,a=[],i=!!e,o=e||n.tr,c=x(p({},Object.fromEntries(Object.entries(s).map(([e,s])=>[e,(...e)=>{let l=this.buildProps(o,t),n=s(...e)(l);return a.push(n),c}]))),{run:()=>(i||!t||o.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(o),a.every(e=>!0===e))});return c}createCan(e){let{rawCommands:t,state:s}=this,l=e||s.tr,n=this.buildProps(l,!1),r=Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)(x(p({},n),{dispatch:void 0}))]));return x(p({},r),{chain:()=>this.createChain(l,!1)})}buildProps(e,t=!0){let{rawCommands:s,editor:l,state:n}=this,{view:r}=l,a={tr:e,editor:l,view:r,state:tr({state:n,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(s).map(([e,t])=>[e,(...e)=>t(...e)(a)]))}};return a}};function ti(e,t,s){return void 0===e.config[t]&&e.parent?ti(e.parent,t,s):"function"==typeof e.config[t]?e.config[t].bind(x(p({},s),{parent:e.parent?ti(e.parent,t,s):null})):e.config[t]}function to(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function tc(e,t,...s){return"function"==typeof e?t?e.bind(t)(...s):e(...s):e}function td(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}var tu=class e{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=p(p({},this.config),e),this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=tc(ti(this,"addOptions",{name:this.name}))),this.storage=tc(ti(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new e(t)}configure(e={}){let t=this.extend();return t.options=function e(t,s){let l=p({},t);return td(t)&&td(s)&&Object.keys(s).forEach(n=>{td(s[n])&&n in t?l[n]=e(t[n],s[n]):Object.assign(l,{[n]:s[n]})}),l}(this.options,e),t.storage=tc(ti(t,"addStorage",{name:t.name,options:t.options})),t}extend(t={}){let s=new e(t);return s.parent=this,this.child=s,s.name=t.name?t.name:s.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${s.name}".`),s.options=tc(ti(s,"addOptions",{name:s.name})),s.storage=tc(ti(s,"addStorage",{name:s.name,options:s.options})),s}};function tm(e,t,s={strict:!0}){let l=Object.keys(t);return!l.length||l.every(l=>{var n;return s.strict?t[l]===e[l]:(n=t[l],"[object RegExp]"===Object.prototype.toString.call(n))?t[l].test(e[l]):t[l]===e[l]})}function th(e,t,s={}){return e.find(e=>e.type===t&&tm(e.attrs,s))}function tp(e,t,s={}){if(!e||!t)return;let l=e.parent.childAfter(e.parentOffset);if(e.parentOffset===l.offset&&0!==l.offset&&(l=e.parent.childBefore(e.parentOffset)),!l.node)return;let n=th([...l.node.marks],t,s);if(!n)return;let r=l.index,a=e.start()+l.offset,i=r+1,o=a+l.node.nodeSize;for(th([...l.node.marks],t,s);r>0&&n.isInSet(e.parent.child(r-1).marks);)r-=1,a-=e.parent.child(r).nodeSize;for(;i<e.parent.childCount&&function(e,t,s={}){return!!th(e,t,s)}([...e.parent.child(i).marks],t,s);)o+=e.parent.child(i).nodeSize,i+=1;return{from:a,to:o}}function tx(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function tf(e){return e instanceof eI}function tv(e=0,t=0,s=0){return Math.min(Math.max(e,t),s)}function tg(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function tj(e){let t=`<body>${e}</body>`;return new window.DOMParser().parseFromString(t,"text/html").body}function tb(e,t,s){if(s=p({slice:!0,parseOptions:{}},s),"object"==typeof e&&null!==e)try{return Array.isArray(e)&&e.length>0?f.fromArray(e.map(e=>t.nodeFromJSON(e))):t.nodeFromJSON(e)}catch(l){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",l),tb("",t,s)}if("string"==typeof e){let l=Z.fromSchema(t);return s.slice?l.parseSlice(tj(e),s.parseOptions).content:l.parse(tj(e),s.parseOptions)}return tb("",t,s)}tu.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new ez({key:new eq("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:s}=e,{doc:l,selection:n}=t,{ranges:r}=n;return function(e,t,s){let{from:l,to:n}=t,{blockSeparator:r=`

`,textSerializers:a={}}=s||{},i="",o=!0;return e.nodesBetween(l,n,(e,s,c,d)=>{var u;let m=null==a?void 0:a[e.type.name];m?(e.isBlock&&!o&&(i+=r,o=!0),c&&(i+=m({node:e,pos:s,parent:c,index:d,range:t}))):e.isText?(i+=null===(u=null==e?void 0:e.text)||void 0===u?void 0:u.slice(Math.max(l,s)-s,n-s),o=!1):e.isBlock&&!o&&(i+=r,o=!0)}),i}(l,{from:Math.min(...r.map(e=>e.$from.pos)),to:Math.max(...r.map(e=>e.$to.pos))},{textSerializers:Object.fromEntries(Object.entries(s.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))})}}})]}});var ty=e=>e.toString().startsWith("<");function tw(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function tN(e,t,s={}){let{from:l,to:n,empty:r}=e.selection,a=t?to(t,e.schema):null,i=[];e.doc.nodesBetween(l,n,(e,t)=>{if(e.isText)return;let s=Math.max(l,t),r=Math.min(n,t+e.nodeSize);i.push({node:e,from:s,to:r})});let o=n-l,c=i.filter(e=>!a||a.name===e.node.type.name).filter(e=>tm(e.node.attrs,s,{strict:!1}));return r?!!c.length:c.reduce((e,t)=>e+t.to-t.from,0)>=o}function tk(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function tC(e,t){let s="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,l)=>(s.includes(l)||(t[l]=e[l]),t),{})}function tS(e){return t=>(function(e,t){for(let s=e.depth;s>0;s-=1){let l=e.node(s);if(t(l))return{pos:s>0?e.before(s):0,start:e.start(s),depth:s,node:l}}})(t.$from,e)}function t_(e,t,s){return Object.fromEntries(Object.entries(s).filter(([s])=>{let l=e.find(e=>e.type===t&&e.name===s);return!!l&&l.attribute.keepOnSplit}))}function tI(e,t){let{nodeExtensions:s}={baseExtensions:t.filter(e=>"extension"===e.type),nodeExtensions:t.filter(e=>"node"===e.type),markExtensions:t.filter(e=>"mark"===e.type)},l=s.find(t=>t.name===e);if(!l)return!1;let n={name:l.name,options:l.options,storage:l.storage},r=tc(ti(l,"group",n));return"string"==typeof r&&r.split(" ").includes("list")}function tE(e,t){let s=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(s){let l=s.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(l)}}var tP=(e,t)=>{let s=tS(e=>e.type===t)(e.selection);if(!s)return!0;let l=e.doc.resolve(Math.max(0,s.pos-1)).before(s.depth);if(void 0===l)return!0;let n=e.doc.nodeAt(l);return s.node.type===(null==n?void 0:n.type)&&eu(e.doc,s.pos)&&e.join(s.pos),!0},tR=(e,t)=>{let s=tS(e=>e.type===t)(e.selection);if(!s)return!0;let l=e.doc.resolve(s.start).after(s.depth);if(void 0===l)return!0;let n=e.doc.nodeAt(l);return s.node.type===(null==n?void 0:n.type)&&eu(e.doc,l)&&e.join(l),!0},tF=Object.freeze({__proto__:null,blur:()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var s;e.isDestroyed||(t.dom.blur(),null===(s=null==window?void 0:window.getSelection())||void 0===s||s.removeAllRanges())}),!0),clearContent:(e=!1)=>({commands:t})=>t.setContent("",e),clearNodes:()=>({state:e,tr:t,dispatch:s})=>{let{selection:l}=t,{ranges:n}=l;return s&&n.forEach(({$from:s,$to:l})=>{e.doc.nodesBetween(s.pos,l.pos,(e,s)=>{if(e.type.isText)return;let{doc:l,mapping:n}=t,r=l.resolve(n.map(s)),a=l.resolve(n.map(s+e.nodeSize)),i=r.blockRange(a);if(!i)return;let o=ei(i);if(e.type.isTextblock){let{defaultType:e}=r.parent.contentMatchAt(r.index());t.setNodeMarkup(i.start,e)}(o||0===o)&&t.lift(i,o)})}),!0},command:e=>t=>e(t),createParagraphNear:()=>({state:e,dispatch:t})=>e2(e,t),cut:(e,t)=>({editor:s,tr:l})=>{let{state:n}=s,r=n.doc.slice(e.from,e.to);l.deleteRange(e.from,e.to);let a=l.mapping.map(t);return l.insert(a,r.content),l.setSelection(new eI(l.doc.resolve(a-1))),!0},deleteCurrentNode:()=>({tr:e,dispatch:t})=>{let{selection:s}=e,l=s.$anchor.node();if(l.content.size>0)return!1;let n=e.selection.$anchor;for(let s=n.depth;s>0;s-=1)if(n.node(s).type===l.type){if(t){let t=n.before(s),l=n.after(s);e.delete(t,l).scrollIntoView()}return!0}return!1},deleteNode:e=>({tr:t,state:s,dispatch:l})=>{let n=to(e,s.schema),r=t.selection.$anchor;for(let e=r.depth;e>0;e-=1)if(r.node(e).type===n){if(l){let s=r.before(e),l=r.after(e);t.delete(s,l).scrollIntoView()}return!0}return!1},deleteRange:e=>({tr:t,dispatch:s})=>{let{from:l,to:n}=e;return s&&t.delete(l,n),!0},deleteSelection:()=>({state:e,dispatch:t})=>eB(e,t),enter:()=>({commands:e})=>e.keyboardShortcut("Enter"),exitCode:()=>({state:e,dispatch:t})=>e1(e,t),extendMarkRange:(e,t={})=>({tr:s,state:l,dispatch:n})=>{let r=tx(e,l.schema),{doc:a,selection:i}=s,{$from:o,from:c,to:d}=i;if(n){let e=tp(o,r,t);if(e&&e.from<=c&&e.to>=d){let t=eI.create(a,e.from,e.to);s.setSelection(t)}}return!0},first:e=>t=>{let s="function"==typeof e?e(t):e;for(let e=0;e<s.length;e+=1)if(s[e](t))return!0;return!1},focus:(e=null,t={})=>({editor:s,view:l,tr:n,dispatch:r})=>{t=p({scrollIntoView:!0},t);let a=()=>{tg()&&l.dom.focus(),requestAnimationFrame(()=>{s.isDestroyed||(l.focus(),null!=t&&t.scrollIntoView&&s.commands.scrollIntoView())})};if(l.hasFocus()&&null===e||!1===e)return!0;if(r&&null===e&&!tf(s.state.selection))return a(),!0;let i=function(e,t=null){if(!t)return null;let s=ek.atStart(e),l=ek.atEnd(e);if("start"===t||!0===t)return s;if("end"===t)return l;let n=s.from,r=l.to;return"all"===t?eI.create(e,tv(0,n,r),tv(e.content.size,n,r)):eI.create(e,tv(t,n,r),tv(t,n,r))}(n.doc,e)||s.state.selection,o=s.state.selection.eq(i);return r&&(o||n.setSelection(i),o&&n.storedMarks&&n.setStoredMarks(n.storedMarks),a()),!0},forEach:(e,t)=>s=>e.every((e,l)=>t(e,x(p({},s),{index:l}))),insertContent:(e,t)=>({tr:s,commands:l})=>l.insertContentAt({from:s.selection.from,to:s.selection.to},e,t),insertContentAt:(e,t,s)=>({tr:l,dispatch:n,editor:r})=>{if(n){s=p({parseOptions:{},updateSelection:!0},s);let n=tb(t,r.schema,{parseOptions:p({preserveWhitespace:"full"},s.parseOptions)});if("<>"===n.toString())return!0;let{from:a,to:i}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},o=!0,c=!0;if((ty(n)?n:[n]).forEach(e=>{e.check(),o=!!o&&e.isText&&0===e.marks.length,c=!!c&&e.isBlock}),a===i&&c){let{parent:e}=l.doc.resolve(a);!e.isTextblock||e.type.spec.code||e.childCount||(a-=1,i+=1)}o?Array.isArray(t)?l.insertText(t.map(e=>e.text||"").join(""),a,i):"object"==typeof t&&t&&t.text?l.insertText(t.text,a,i):l.insertText(t,a,i):l.replaceWith(a,i,n),s.updateSelection&&function(e,t,s){let l=e.steps.length-1;if(l<t)return;let n=e.steps[l];if(!(n instanceof en||n instanceof er))return;let r=e.mapping.maps[l],a=0;r.forEach((e,t,s,l)=>{0===a&&(a=l)}),e.setSelection(ek.near(e.doc.resolve(a),-1))}(l,l.steps.length-1,0)}return!0},joinUp:()=>({state:e,dispatch:t})=>eQ(e,t),joinDown:()=>({state:e,dispatch:t})=>eG(e,t),joinBackward:()=>({state:e,dispatch:t})=>eU(e,t),joinForward:()=>({state:e,dispatch:t})=>eY(e,t),joinItemBackward:()=>({tr:e,state:t,dispatch:s})=>{try{let l=eh(t.doc,t.selection.$from.pos,-1);return null!=l&&(e.join(l,2),s&&s(e),!0)}catch(e){return!1}},joinItemForward:()=>({state:e,dispatch:t,tr:s})=>{try{let l=eh(e.doc,e.selection.$from.pos,1);return null!=l&&(s.join(l,2),t&&t(s),!0)}catch(e){return!1}},keyboardShortcut:e=>({editor:t,view:s,tr:l,dispatch:n})=>{let r=(function(e){let t,s,l,n,r=e.split(/-(?!$)/),a=r[r.length-1];"Space"===a&&(a=" ");for(let e=0;e<r.length-1;e+=1){let a=r[e];if(/^(cmd|meta|m)$/i.test(a))n=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))s=!0;else if(/^s(hift)?$/i.test(a))l=!0;else if(/^mod$/i.test(a))tg()||tw()?n=!0:s=!0;else throw Error(`Unrecognized modifier name: ${a}`)}return t&&(a=`Alt-${a}`),s&&(a=`Ctrl-${a}`),n&&(a=`Meta-${a}`),l&&(a=`Shift-${a}`),a})(e).split(/-(?!$)/),a=r.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),i=new KeyboardEvent("keydown",{key:"Space"===a?" ":a,altKey:r.includes("Alt"),ctrlKey:r.includes("Ctrl"),metaKey:r.includes("Meta"),shiftKey:r.includes("Shift"),bubbles:!0,cancelable:!0}),o=t.captureTransaction(()=>{s.someProp("handleKeyDown",e=>e(s,i))});return null==o||o.steps.forEach(e=>{let t=e.map(l.mapping);t&&n&&l.maybeStep(t)}),!0},lift:(e,t={})=>({state:s,dispatch:l})=>{let n=to(e,s.schema);return!!tN(s,n,t)&&e$(s,l)},liftEmptyBlock:()=>({state:e,dispatch:t})=>e5(e,t),liftListItem:e=>({state:t,dispatch:s})=>{var l;return(l=to(e,t.schema),function(e,t){let{$from:s,$to:n}=e.selection,r=s.blockRange(n,e=>e.childCount>0&&e.firstChild.type==l);return!!r&&(!t||(s.node(r.depth-1).type==l?function(e,t,s,l){let n=e.tr,r=l.end,a=l.$to.end(l.depth);r<a&&(n.step(new er(r-1,a,r,a,new w(f.from(s.create(null,l.parent.copy())),1,0),1,!0)),l=new O(n.doc.resolve(l.$from.pos),n.doc.resolve(a),l.depth));let i=ei(l);if(null==i)return!1;n.lift(l,i);let o=n.mapping.map(r,-1)-1;return eu(n.doc,o)&&n.join(o),t(n.scrollIntoView()),!0}(e,t,l,r):function(e,t,s){let l=e.tr,n=s.parent;for(let e=s.end,t=s.endIndex-1,r=s.startIndex;t>r;t--)e-=n.child(t).nodeSize,l.delete(e-1,e+1);let r=l.doc.resolve(s.start),a=r.nodeAfter;if(l.mapping.map(s.end)!=s.start+r.nodeAfter.nodeSize)return!1;let i=0==s.startIndex,o=s.endIndex==n.childCount,c=r.node(-1),d=r.index(-1);if(!c.canReplace(d+(i?0:1),d+1,a.content.append(o?f.empty:f.from(n))))return!1;let u=r.pos,m=u+a.nodeSize;return l.step(new er(u-(i?1:0),m+(o?1:0),u+1,m-1,new w((i?f.empty:f.from(n.copy(f.empty))).append(o?f.empty:f.from(n.copy(f.empty))),i?0:1,o?0:1),i?0:1)),t(l.scrollIntoView()),!0}(e,t,r)))})(t,s)},newlineInCode:()=>({state:e,dispatch:t})=>eX(e,t),resetAttributes:(e,t)=>({tr:s,state:l,dispatch:n})=>{let r=null,a=null,i=tk("string"==typeof e?e:e.name,l.schema);return!!i&&("node"===i&&(r=to(e,l.schema)),"mark"===i&&(a=tx(e,l.schema)),n&&s.selection.ranges.forEach(e=>{l.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,l)=>{r&&r===e.type&&s.setNodeMarkup(l,void 0,tC(e.attrs,t)),a&&e.marks.length&&e.marks.forEach(n=>{a===n.type&&s.addMark(l,l+e.nodeSize,a.create(tC(n.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),selectAll:()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),selectNodeBackward:()=>({state:e,dispatch:t})=>eW(e,t),selectNodeForward:()=>({state:e,dispatch:t})=>eJ(e,t),selectParentNode:()=>({state:e,dispatch:t})=>e3(e,t),selectTextblockEnd:()=>({state:e,dispatch:t})=>e7(e,t),selectTextblockStart:()=>({state:e,dispatch:t})=>e6(e,t),setContent:(e,t=!1,s={})=>({tr:l,editor:n,dispatch:r})=>{let{doc:a}=l,i=function(e,t,s={}){return tb(e,t,{slice:!1,parseOptions:s})}(e,n.schema,s);return r&&l.replaceWith(0,a.content.size,i).setMeta("preventUpdate",!t),!0},setMark:(e,t={})=>({tr:s,state:l,dispatch:n})=>{let{selection:r}=s,{empty:a,ranges:i}=r,o=tx(e,l.schema);if(n){if(a){let e=function(e,t){let s=tx(t,e.schema),{from:l,to:n,empty:r}=e.selection,a=[];r?(e.storedMarks&&a.push(...e.storedMarks),a.push(...e.selection.$head.marks())):e.doc.nodesBetween(l,n,e=>{a.push(...e.marks)});let i=a.find(e=>e.type.name===s.name);return i?p({},i.attrs):{}}(l,o);s.addStoredMark(o.create(p(p({},e),t)))}else i.forEach(e=>{let n=e.$from.pos,r=e.$to.pos;l.doc.nodesBetween(n,r,(e,l)=>{let a=Math.max(l,n),i=Math.min(l+e.nodeSize,r);e.marks.find(e=>e.type===o)?e.marks.forEach(e=>{o===e.type&&s.addMark(a,i,o.create(p(p({},e.attrs),t)))}):s.addMark(a,i,o.create(t))})})}return function(e,t,s){var l;let{selection:n}=t,r=null;if(tf(n)&&(r=n.$cursor),r){let t=null!==(l=e.storedMarks)&&void 0!==l?l:r.marks();return!!s.isInSet(t)||!t.some(e=>e.type.excludes(s))}let{ranges:a}=n;return a.some(({$from:t,$to:l})=>{let n=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(s);return e.doc.nodesBetween(t.pos,l.pos,(e,t,l)=>{if(n)return!1;if(e.isInline){let t=!l||l.type.allowsMarkType(s),r=!!s.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(s));n=t&&r}return!n}),n})}(l,s,o)},setMeta:(e,t)=>({tr:s})=>(s.setMeta(e,t),!0),setNode:(e,t={})=>({state:s,dispatch:l,chain:n})=>{let r=to(e,s.schema);return r.isTextblock?n().command(({commands:e})=>!!e9(r,t)(s)||e.clearNodes()).command(({state:e})=>e9(r,t)(e,l)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:e=>({tr:t,dispatch:s})=>{if(s){let{doc:s}=t,l=tv(e,0,s.content.size),n=eP.create(s,l);t.setSelection(n)}return!0},setTextSelection:e=>({tr:t,dispatch:s})=>{if(s){let{doc:s}=t,{from:l,to:n}="number"==typeof e?{from:e,to:e}:e,r=eI.atStart(s).from,a=eI.atEnd(s).to,i=tv(l,r,a),o=tv(n,r,a),c=eI.create(s,i,o);t.setSelection(c)}return!0},sinkListItem:e=>({state:t,dispatch:s})=>{var l;return(l=to(e,t.schema),function(e,t){let{$from:s,$to:n}=e.selection,r=s.blockRange(n,e=>e.childCount>0&&e.firstChild.type==l);if(!r)return!1;let a=r.startIndex;if(0==a)return!1;let i=r.parent,o=i.child(a-1);if(o.type!=l)return!1;if(t){let s=o.lastChild&&o.lastChild.type==i.type,n=f.from(s?l.create():null),a=new w(f.from(l.create(null,f.from(i.type.create(null,n)))),s?3:1,0),c=r.start,d=r.end;t(e.tr.step(new er(c-(s?3:1),d,c,d,a,1,!0)).scrollIntoView())}return!0})(t,s)},splitBlock:({keepMarks:e=!0}={})=>({tr:t,state:s,dispatch:l,editor:n})=>{let{selection:r,doc:a}=t,{$from:i,$to:o}=r,c=t_(n.extensionManager.attributes,i.node().type.name,i.node().attrs);if(r instanceof eP&&r.node.isBlock)return!!(i.parentOffset&&ed(a,i.pos))&&(l&&(e&&tE(s,n.extensionManager.splittableMarks),t.split(i.pos).scrollIntoView()),!0);if(!i.parent.isBlock)return!1;if(l){let l=o.parentOffset===o.parent.content.size;r instanceof eI&&t.deleteSelection();let a=0===i.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){let{type:s}=e.edge(t);if(s.isTextblock&&!s.hasRequiredAttrs())return s}return null}(i.node(-1).contentMatchAt(i.indexAfter(-1))),d=l&&a?[{type:a,attrs:c}]:void 0,u=ed(t.doc,t.mapping.map(i.pos),1,d);if(!d&&!u&&ed(t.doc,t.mapping.map(i.pos),1,a?[{type:a}]:void 0)&&(u=!0,d=a?[{type:a,attrs:c}]:void 0),u&&(t.split(t.mapping.map(i.pos),1,d),a&&!l&&!i.parentOffset&&i.parent.type!==a)){let e=t.mapping.map(i.before()),s=t.doc.resolve(e);i.node(-1).canReplaceWith(s.index(),s.index()+1,a)&&t.setNodeMarkup(t.mapping.map(i.before()),a)}e&&tE(s,n.extensionManager.splittableMarks),t.scrollIntoView()}return!0},splitListItem:e=>({tr:t,state:s,dispatch:l,editor:n})=>{var r;let a=to(e,s.schema),{$from:i,$to:o}=s.selection,c=s.selection.node;if(c&&c.isBlock||i.depth<2||!i.sameParent(o))return!1;let d=i.node(-1);if(d.type!==a)return!1;let u=n.extensionManager.attributes;if(0===i.parent.content.size&&i.node(-1).childCount===i.indexAfter(-1)){if(2===i.depth||i.node(-3).type!==a||i.index(-2)!==i.node(-2).childCount-1)return!1;if(l){let e=f.empty,s=i.index(-1)?1:i.index(-2)?2:3;for(let t=i.depth-s;t>=i.depth-3;t-=1)e=f.from(i.node(t).copy(e));let l=i.indexAfter(-1)<i.node(-2).childCount?1:i.indexAfter(-2)<i.node(-3).childCount?2:3,n=t_(u,i.node().type.name,i.node().attrs),o=(null===(r=a.contentMatch.defaultType)||void 0===r?void 0:r.createAndFill(n))||void 0;e=e.append(f.from(a.createAndFill(null,o)||void 0));let c=i.before(i.depth-(s-1));t.replace(c,i.after(-l),new w(e,4-s,0));let d=-1;t.doc.nodesBetween(c,t.doc.content.size,(e,t)=>{if(d>-1)return!1;e.isTextblock&&0===e.content.size&&(d=t+1)}),d>-1&&t.setSelection(eI.near(t.doc.resolve(d))),t.scrollIntoView()}return!0}let m=o.pos===i.end()?d.contentMatchAt(0).defaultType:null,h=t_(u,d.type.name,d.attrs),p=t_(u,i.node().type.name,i.node().attrs);if(t.delete(i.pos,o.pos),!ed(t.doc,i.pos,2))return!1;if(l){let{selection:e,storedMarks:r}=s,{splittableMarks:o}=n.extensionManager,c=r||e.$to.parentOffset&&e.$from.marks();if(t.split(i.pos,2,m?[{type:a,attrs:h},{type:m,attrs:p}]:[{type:a,attrs:h}]).scrollIntoView(),!c||!l)return!0;let d=c.filter(e=>o.includes(e.type.name));t.ensureMarks(d)}return!0},toggleList:(e,t,s,l={})=>({editor:n,tr:r,state:a,dispatch:i,chain:o,commands:c,can:d})=>{let{extensions:u,splittableMarks:m}=n.extensionManager,h=to(e,a.schema),p=to(t,a.schema),{selection:x,storedMarks:f}=a,{$from:v,$to:g}=x,j=v.blockRange(g),b=f||x.$to.parentOffset&&x.$from.marks();if(!j)return!1;let y=tS(e=>tI(e.type.name,u))(x);if(j.depth>=1&&y&&j.depth-y.depth<=1){if(y.node.type===h)return c.liftListItem(p);if(tI(y.node.type.name,u)&&h.validContent(y.node.content)&&i)return o().command(()=>(r.setNodeMarkup(y.pos,h),!0)).command(()=>tP(r,h)).command(()=>tR(r,h)).run()}return s&&b&&i?o().command(()=>{let e=d().wrapInList(h,l),t=b.filter(e=>m.includes(e.type.name));return r.ensureMarks(t),!!e||c.clearNodes()}).wrapInList(h,l).command(()=>tP(r,h)).command(()=>tR(r,h)).run():o().command(()=>!!d().wrapInList(h,l)||c.clearNodes()).wrapInList(h,l).command(()=>tP(r,h)).command(()=>tR(r,h)).run()},toggleMark:(e,t={},s={})=>({state:l,commands:n})=>{let{extendEmptyMarkRange:r=!1}=s,a=tx(e,l.schema);return!function(e,t,s={}){let{empty:l,ranges:n}=e.selection,r=t?tx(t,e.schema):null;if(l)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!r||r.name===e.type.name).find(e=>tm(e.attrs,s,{strict:!1}));let a=0,i=[];if(n.forEach(({$from:t,$to:s})=>{let l=t.pos,n=s.pos;e.doc.nodesBetween(l,n,(e,t)=>{if(!e.isText&&!e.marks.length)return;let s=Math.max(l,t),r=Math.min(n,t+e.nodeSize);a+=r-s,i.push(...e.marks.map(e=>({mark:e,from:s,to:r})))})}),0===a)return!1;let o=i.filter(e=>!r||r.name===e.mark.type.name).filter(e=>tm(e.mark.attrs,s,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=i.filter(e=>!r||e.mark.type!==r&&e.mark.type.excludes(r)).reduce((e,t)=>e+t.to-t.from,0);return(o>0?o+c:o)>=a}(l,a,t)?n.setMark(a,t):n.unsetMark(a,{extendEmptyMarkRange:r})},toggleNode:(e,t,s={})=>({state:l,commands:n})=>{let r=to(e,l.schema),a=to(t,l.schema);return tN(l,r,s)?n.setNode(a):n.setNode(r,s)},toggleWrap:(e,t={})=>({state:s,commands:l})=>{let n=to(e,s.schema);return tN(s,n,t)?l.lift(n):l.wrapIn(n,t)},undoInputRule:()=>({state:e,dispatch:t})=>{let s=e.plugins;for(let l=0;l<s.length;l+=1){let n=s[l],r;if(n.spec.isInputRules&&(r=n.getState(e))){if(t){let t=e.tr,s=r.transform;for(let e=s.steps.length-1;e>=0;e-=1)t.step(s.steps[e].invert(s.docs[e]));if(r.text){let s=t.doc.resolve(r.from).marks();t.replaceWith(r.from,r.to,e.schema.text(r.text,s))}else t.delete(r.from,r.to)}return!0}}return!1},unsetAllMarks:()=>({tr:e,dispatch:t})=>{let{selection:s}=e,{empty:l,ranges:n}=s;return l||t&&n.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0},unsetMark:(e,t={})=>({tr:s,state:l,dispatch:n})=>{var r;let{extendEmptyMarkRange:a=!1}=t,{selection:i}=s,o=tx(e,l.schema),{$from:c,empty:d,ranges:u}=i;if(!n)return!0;if(d&&a){let{from:e,to:t}=i,l=null===(r=c.marks().find(e=>e.type===o))||void 0===r?void 0:r.attrs,n=tp(c,o,l);n&&(e=n.from,t=n.to),s.removeMark(e,t,o)}else u.forEach(e=>{s.removeMark(e.$from.pos,e.$to.pos,o)});return s.removeStoredMark(o),!0},updateAttributes:(e,t={})=>({tr:s,state:l,dispatch:n})=>{let r=null,a=null,i=tk("string"==typeof e?e:e.name,l.schema);return!!i&&("node"===i&&(r=to(e,l.schema)),"mark"===i&&(a=tx(e,l.schema)),n&&s.selection.ranges.forEach(e=>{let n=e.$from.pos,i=e.$to.pos;l.doc.nodesBetween(n,i,(e,l)=>{r&&r===e.type&&s.setNodeMarkup(l,void 0,p(p({},e.attrs),t)),a&&e.marks.length&&e.marks.forEach(r=>{if(a===r.type){let o=Math.max(l,n),c=Math.min(l+e.nodeSize,i);s.addMark(o,c,a.create(p(p({},r.attrs),t)))}})})}),!0)},wrapIn:(e,t={})=>({state:s,dispatch:l})=>(function(e,t=null){return function(s,l){let{$from:n,$to:r}=s.selection,a=n.blockRange(r),i=a&&eo(a,e,t);return!!i&&(l&&l(s.tr.wrap(a,i).scrollIntoView()),!0)}})(to(e,s.schema),t)(s,l),wrapInList:(e,t={})=>({state:s,dispatch:l})=>(function(e,t=null){return function(s,l){let{$from:n,$to:r}=s.selection,a=n.blockRange(r),i=!1,o=a;if(!a)return!1;if(a.depth>=2&&n.node(a.depth-1).type.compatibleContent(e)&&0==a.startIndex){if(0==n.index(a.depth-1))return!1;let e=s.doc.resolve(a.start-2);o=new O(e,e,a.depth),a.endIndex<a.parent.childCount&&(a=new O(n,s.doc.resolve(r.end(a.depth)),a.depth)),i=!0}let c=eo(o,e,t,a);return!!c&&(l&&l((function(e,t,s,l,n){let r=f.empty;for(let e=s.length-1;e>=0;e--)r=f.from(s[e].type.create(s[e].attrs,r));e.step(new er(t.start-(l?2:0),t.end,t.start,t.end,new w(r,0,0),s.length,!0));let a=0;for(let e=0;e<s.length;e++)s[e].type==n&&(a=e+1);let i=s.length-a,o=t.start+s.length-(l?2:0),c=t.parent;for(let s=t.startIndex,l=t.endIndex,n=!0;s<l;s++,n=!1)!n&&ed(e.doc,o,i)&&(e.split(o,i),o+=2*i),o+=c.child(s).nodeSize;return e})(s.tr,a,c,i,e).scrollIntoView()),!0)}})(to(e,s.schema),t)(s,l)});tu.create({name:"commands",addCommands:()=>p({},tF)}),tu.create({name:"editable",addProseMirrorPlugins(){return[new ez({key:new eq("editable"),props:{editable:()=>this.editor.options.editable}})]}}),tu.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new ez({key:new eq("focusEvents"),props:{handleDOMEvents:{focus:(t,s)=>{e.isFocused=!0;let l=e.state.tr.setMeta("focus",{event:s}).setMeta("addToHistory",!1);return t.dispatch(l),!1},blur:(t,s)=>{e.isFocused=!1;let l=e.state.tr.setMeta("blur",{event:s}).setMeta("addToHistory",!1);return t.dispatch(l),!1}}}})]}}),tu.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.command(({tr:t})=>{let{selection:s,doc:l}=t,{empty:n,$anchor:r}=s,{pos:a,parent:i}=r,o=r.parent.isTextblock?t.doc.resolve(a-1):r,c=o.parent.type.spec.isolating,d=r.pos-r.parentOffset,u=c&&1===o.parent.childCount?d===r.pos:ek.atStart(l).from===a;return!!n&&!!u&&!!i.type.isTextblock&&!i.textContent.length&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},l=p({},s),n=x(p({},s),{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return tg()||tw()?n:l},addProseMirrorPlugins(){return[new ez({key:new eq("clearDocument"),appendTransaction:(e,t,s)=>{if(!(e.some(e=>e.docChanged)&&!t.doc.eq(s.doc)))return;let{empty:l,from:n,to:r}=t.selection,a=ek.atStart(t.doc).from,i=ek.atEnd(t.doc).to;if(l||!(n===a&&r===i)||0!==s.doc.textBetween(0,s.doc.content.size," "," ").length)return;let o=s.tr,c=tr({state:s,transaction:o}),{commands:d}=new ta({editor:this.editor,state:c});if(d.clearNodes(),o.steps.length)return o}})]}}),tu.create({name:"tabindex",addProseMirrorPlugins(){return[new ez({key:new eq("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var tO=e=>tu.create({name:"enterKey",addKeyboardShortcuts(){return{Enter:()=>!this.editor.storage.mentionsOpen&&(e&&e(),!0),"Shift-Enter":({editor:e})=>e.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.splitListItem("listItem"),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()])}}}),tT=e=>[tO(e)],tA=e=>{let{onChange:t,initialValue:s,fileHandler:l,value:n,containerClassName:i,editorClassName:o="",forwardedRef:c,onEnterKeyPress:d,tabIndex:u,mentionHandler:m,placeholder:h="Add comment...",id:p=""}=e,x=(0,r.jE)({onChange:t,initialValue:s,value:n,id:p,editorClassName:o,restoreFile:l.restore,uploadFile:l.upload,deleteFile:l.delete,cancelUploadImage:l.cancel,forwardedRef:c,extensions:tT(d),mentionHandler:m,placeholder:h,tabIndex:u}),f=(0,r.mo)({noBorder:!0,borderOnFocus:!1,containerClassName:i});return x?(0,a.jsx)(r.Nf,{editor:x,editorContainerClassName:f,children:(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsx)(r.zg,{tabIndex:u,editor:x})})}):null},tD=n.forwardRef((e,t)=>(0,a.jsx)(tA,x(p({},e),{forwardedRef:t})));tD.displayName="LiteTextEditorWithRef";var tM=({containerClassName:e,editorClassName:t="",initialValue:s,forwardedRef:l,mentionHandler:n,tabIndex:i})=>{let o=(0,r.oz)({initialValue:s,editorClassName:t,forwardedRef:l,mentionHandler:n}),c=(0,r.mo)({containerClassName:e});return o?(0,a.jsx)(r.Nf,{editor:o,editorContainerClassName:c,children:(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsx)(r.zg,{tabIndex:i,editor:o})})}):null},tz=n.forwardRef((e,t)=>(0,a.jsx)(tM,x(p({},e),{forwardedRef:t})));tz.displayName="LiteReadOnlyEditorWithRef"}}]);